<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Media Library</title>
<link rel="stylesheet" href="styles/style.css">
</head>
<body>
<header>
    <div class="header-top">
        <h1>Media Library</h1>
        <div class="auth-section">
            <div id="authButtons" class="auth-buttons">
                <button id="loginBtn" class="auth-btn">Login</button>
                <button id="registerBtn" class="auth-btn">Register</button>
            </div>
            <div id="userInfo" class="user-info" style="display: none;">
                <span id="userName"></span>
                <button id="logoutBtn" class="auth-btn">Logout</button>
            </div>
        </div>
    </div>
    <div class="controls">
        <div class="controls-row">
            <div class="controls-group">
                <button id="btnGames" class="cat-btn">Games <span id="countGames" class="count-badge">0</span></button>
                <button id="btnSeries" class="cat-btn">Series <span id="countSeries" class="count-badge">0</span></button>
                <button id="btnMovies" class="cat-btn">Movies <span id="countMovies" class="count-badge">0</span></button>
                <button id="btnGamesNew" class="cat-btn">Games <span class="tag-new">New</span></button>
                <button id="btnSeriesNew" class="cat-btn">Series <span class="tag-new">New</span></button>
                <button id="btnMoviesNew" class="cat-btn">Movies <span class="tag-new">New</span></button>
                <button id="btnCalendar" class="cat-btn">ðŸ“… Calendar</button>
            </div>
            <div class="controls-group search-group">
                <div class="search-wrapper">
                    <input type="text" id="searchInput" placeholder="Search title..." />
                    <button id="searchClear" title="Clear">Ã—</button>
                </div>
            </div>
            <div class="controls-group" id="playtimeGroup">
                <label>Spielzeit:</label>
                <div class="playtime-wrapper">
                    <input type="number" id="playMin" min="0" placeholder="min" style="width:80px">-
                    <input type="number" id="playMax" min="0" placeholder="max" style="width:80px">
                </div>
            </div>
            <div class="controls-group" id="airingGroup" style="display:none;">
                <label>Airing Status:</label>
                <div class="airing-wrapper">
                    <button id="airingAll" class="filter-chip active">All</button>
                    <button id="airingTrue" class="filter-chip">Airing</button>
                    <button id="airingFalse" class="filter-chip">Finished</button>
                </div>
            </div>
            <div class="controls-group">
                <span class="slider-inline"><span class="slider-title">Columns</span><input type="range" id="gridSlider" min="1" max="15" value="10" title="Grid Columns"><span id="columnDisplay" style="color: #1a73e8; font-weight: bold; margin-left: 8px;">10</span></span>
            </div>
            <div class="controls-group">
                <label>Display:</label>
                <div class="toggle-group">
                    <label class="toggle-label">
                        <input type="checkbox" id="showImages" checked>
                        <span class="toggle-text">Images</span>
                    </label>
                    <label class="toggle-label">
                        <input type="checkbox" id="showRatings" checked>
                        <span class="toggle-text">Ratings</span>
                    </label>
                    <label class="toggle-label">
                        <input type="checkbox" id="showPlatforms" checked>
                        <span class="toggle-text">Platforms</span>
                    </label>
                    <label class="toggle-label">
                        <input type="checkbox" id="showGenres" checked>
                        <span class="toggle-text">Genres</span>
                    </label>
                    <label class="toggle-label">
                        <input type="checkbox" id="landscapeMode" title="Switch to landscape orientation">
                        <span class="toggle-text">Landscape</span>
                    </label>
                </div>
                <span class="slider-inline"><span class="slider-title">Animation</span><input type="range" id="animationSlider" min="0" max="2" step="0.1" value="1" title="Animation Speed"></span>
            </div>
            <div class="controls-group">
            <select id="sortSelect">
                    <option value="order_asc" selected>Original order â†‘</option>
                    <option value="order_desc">Original order â†“</option>
                <option value="title_asc">Title A-Z</option>
                <option value="title_desc">Title Z-A</option>
                <option value="release_asc">Release â†‘</option>
                <option value="release_desc">Release â†“</option>
                <option value="rating_asc">Rating â†‘</option>
                <option value="rating_desc">Rating â†“</option>
                    <option value="discovered_asc">Entdeckt am â†‘</option>
                    <option value="discovered_desc">Entdeckt am â†“</option>
            </select>
            </div>
            <div class="controls-group">
                <button id="exportBtn" class="export-btn" title="Export all data as ZIP package">ðŸ“¦ Export</button>
                <button id="importBtn" class="import-btn" title="Import data from ZIP package">ðŸ“¥ Import</button>
                <button id="bulkAddBtn" class="bulk-add-btn" title="Add multiple items via API">âž• Bulk Add</button>
                <input type="file" id="importFileInput" accept=".zip" style="display:none">
            </div>
            <div id="filterBar" class="controls-group filter-bar">
                <button id="filterExpandBtn" class="filter-expand-btn" title="Filter erweitern/zusammenklappen">+</button>
            </div>
        </div>
    </div>
</header>

<main>
    <div id="grid" class="grid"></div>
</main>

<!-- Edit/Add Modal -->
<div id="editModal" class="modal">
    <div class="modal-content">
        <h2 id="modalTitle">Edit / Add Item</h2>
        <input type="hidden" id="editId">
        <label>Category:
            <select id="editCategory">
                <option value="game">Game</option>
                <option value="series">Series</option>
                <option value="movie">Movie</option>
                <option value="games_new">Games New</option>
                <option value="series_new">Series New</option>
                <option value="movie_new">Movies New</option>
            </select>
        </label>
        <label>Title: 
            <div class="autocomplete-container">
                <input type="text" id="editTitle" autocomplete="off">
                <div id="autocompleteResults" class="autocomplete-results"></div>
            </div>
        </label>
        <label>Release: <input type="text" id="editRelease"></label>
        <label>Rating: <input type="number" id="editRating" step="0.1" min="0" max="10"></label>
        <label>Views: <input type="number" id="editCount" min="0"></label>
        <label>Platforms: <input type="text" id="editPlatforms"></label>
        <label>Genre: <input type="text" id="editGenre"></label>
        <label>Link: <input type="text" id="editLink"></label>
        <label>Path: <input type="text" id="editPath" placeholder="images/movies/filename.jpg"></label>
        <label>Entdeckt am: <input type="date" id="editDiscovered"></label>
        <label>Spielzeit (Minuten): <input type="number" id="editPlaytime" min="0" step="1"></label>
        <label>Is Airing: 
            <select id="editIsAiring">
                <option value="false">Finished</option>
                <option value="true">Airing</option>
            </select>
        </label>
        <label>Next Season (if airing): <input type="number" id="editNextSeason" min="1"></label>
        <label>Next Season Release: <input type="date" id="editNextSeasonRelease"></label>
        <label>Image URL: <input type="text" id="editImageUrl" placeholder="https://..."></label>
        <div class="image-actions">
            <button id="openImagePicker">Choose Image from Serverâ€¦</button>
            <input type="file" id="uploadImageInput" accept="image/*" style="display:none">
            <button id="uploadImageBtn">Upload Imageâ€¦</button>
        </div>
        <label><input type="checkbox" id="checkApi"> Fetch from API</label>
        <div class="api-search-options" style="display:none;">
            <label>IMDb ID: <input type="text" id="editImdbId" placeholder="tt1234567"></label>
            <label>TMDb ID: <input type="text" id="editTmdbId" placeholder="12345"></label>
        </div>
        <button id="checkInfoBtn">Check Infos</button>
        <p id="apiMessage"></p>
        <p id="checkInfoMessage"></p>
        <details class="api-debug"><summary>API Debug</summary>
            <pre id="apiDebugPre" style="white-space:pre-wrap; max-height:200px; overflow:auto;"></pre>
        </details>
        <div class="sticky-buttons">
            <div class="modal-buttons">
                <button id="saveEdit">Save</button>
                <button id="deleteFromEditBtn">Delete</button>
                <button id="cancelEdit">Cancel</button>
            </div>
        </div>
    </div>
</div>

<!-- Detail Modal -->
<div id="detailModal" class="modal">
    <div class="modal-content detail-content">
        <div class="detail-grid">
            <div class="detail-left">
                <img id="detailImage" alt="" />
            </div>
            <div class="detail-right">
                <h2 id="detailTitle"></h2>
                <div class="detail-row editable-row">
                    <label>Release</label>
                    <input type="date" id="detailReleaseInput" class="detail-input" style="display:none;">
                    <span id="detailRelease"></span>
                </div>
                <div class="detail-row editable-row">
                    <label>Rating</label>
                    <div class="rating-container">
                        <div class="star-rating" id="detailStarRating"></div>
                        <span id="detailRating"></span>
                    </div>
                </div>
                <div class="detail-row editable-row" data-cat="game">
                    <label>Spielzeit</label>
                    <input type="number" id="detailPlaytimeInput" class="detail-input" min="0" style="display:none;">
                    <span id="detailPlaytime"></span>
                </div>
                <div class="detail-row"><label>Views</label><span id="detailCount"></span></div>
                <div class="detail-row editable-row">
                    <label>Entdeckt am</label>
                    <input type="date" id="detailDiscoveredInput" class="detail-input" style="display:none;">
                    <span id="detailDiscovered"></span>
                </div>
                <div class="detail-row editable-row" data-cat="series">
                    <label>Airing</label>
                    <select id="detailIsAiringInput" class="detail-input" style="display:none;">
                        <option value="true">Airing</option>
                        <option value="false">Finished</option>
                    </select>
                    <span id="detailIsAiring"></span>
                </div>
                <div class="detail-row editable-row" data-cat="series">
                    <label>Next Season</label>
                    <input type="text" id="detailNextSeasonInput" class="detail-input" style="display:none;">
                    <span id="detailNextSeason"></span>
                </div>
                <div class="detail-row editable-row" data-cat="series">
                    <label>Next Season Release</label>
                    <input type="date" id="detailNextSeasonReleaseInput" class="detail-input" style="display:none;">
                    <span id="detailNextSeasonRelease"></span>
                </div>
                <div class="detail-row editable-row" data-cat="game">
                    <label>Platforms</label>
                    <input type="text" id="detailPlatformsInput" class="detail-input" style="display:none;">
                    <span id="detailPlatforms"></span>
                </div>
                <div class="detail-row editable-row" data-cat="series movie">
                    <label>Genre</label>
                    <input type="text" id="detailGenreInput" class="detail-input" style="display:none;">
                    <span id="detailGenre"></span>
                </div>
                <div class="detail-row"><label>Link</label><a id="detailLink" href="#" target="_blank" rel="noopener"></a></div>
                <div class="modal-buttons detail-actions">
                    <button id="detailSaveBtn">Save Changes</button>
                    <button id="detailEditBtn">Full Edit</button>
                    <button id="detailDeleteBtn">Delete</button>
                    <button id="detailCloseBtn">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Image Picker Modal -->
<div id="imagePickerModal" class="modal">
    <div class="modal-content">
        <h2>Choose Image</h2>
        <div id="imageList" style="max-height:300px; overflow:auto"></div>
        <div class="modal-buttons">
            <button id="imagePickConfirm">Use Selected</button>
            <button id="imagePickCancel">Cancel</button>
        </div>
    </div>
</div>

<!-- Progress Modal -->
<div id="progressModal" class="modal">
    <div class="modal-content progress-content">
        <h2 id="progressTitle">Processing...</h2>
        <div class="progress-container">
            <div class="progress-bar">
                <div id="progressFill" class="progress-fill"></div>
            </div>
            <div id="progressText" class="progress-text">0%</div>
        </div>
        <div id="progressStatus" class="progress-status">Preparing...</div>
        <div class="progress-details">
            <div id="progressDetails" class="progress-details-text"></div>
        </div>
        <div class="modal-buttons">
            <button id="progressCancel" class="cancel-btn" style="display:none;">Cancel</button>
            <button id="progressClose" class="close-btn" style="display:none;">Close</button>
        </div>
    </div>
</div>

    <!-- Floating Add Button -->
    <button id="floatingAddButton" class="floating-add-btn" onclick="openAddModal()" title="Add Item">
        <span class="plus-icon">+</span>
    </button>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content auth-modal">
            <h2>Login</h2>
            <form id="loginForm">
                <label>Email:
                    <input type="email" id="loginEmail" required>
                </label>
                <label>Password:
                    <input type="password" id="loginPassword" required>
                </label>
                <div class="modal-buttons">
                    <button type="submit">Login</button>
                    <button type="button" id="loginCancel">Cancel</button>
                </div>
            </form>
            <div id="loginError" class="error-message" style="display: none;"></div>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="registerModal" class="modal">
        <div class="modal-content auth-modal">
            <h2>Register</h2>
            <form id="registerForm">
                <label>Name:
                    <input type="text" id="registerName" required>
                </label>
                <label>Email:
                    <input type="email" id="registerEmail" required>
                </label>
                <label>Password:
                    <input type="password" id="registerPassword" required minlength="8">
                </label>
                <label>Confirm Password:
                    <input type="password" id="registerPasswordConfirm" required minlength="8">
                </label>
                <div class="modal-buttons">
                    <button type="submit">Register</button>
                    <button type="button" id="registerCancel">Cancel</button>
                </div>
            </form>
            <div id="registerError" class="error-message" style="display: none;"></div>
        </div>
    </div>

    <!-- Bulk Add Modal -->
    <div id="bulkAddModal" class="modal">
        <div class="modal-content">
            <h2>Bulk Add Items</h2>
            <div class="bulk-add-form">
                <label>Category:
                    <select id="bulkCategory">
                        <option value="game">Games</option>
                        <option value="series">Series</option>
                        <option value="movie">Movies</option>
                        <option value="games_new">Games New</option>
                        <option value="series_new">Series New</option>
                        <option value="movie_new">Movies New</option>
                    </select>
                </label>
                <label>Titles (one per line):
                    <textarea id="bulkTitles" placeholder="Enter titles, one per line:&#10;The Witcher 3&#10;Cyberpunk 2077&#10;Red Dead Redemption 2" rows="10"></textarea>
                </label>
                <div class="bulk-options">
                    <label>
                        <input type="checkbox" id="bulkFetchImages" checked>
                        Fetch images from API
                    </label>
                    <label>
                        <input type="checkbox" id="bulkSkipExisting" checked>
                        Skip existing titles
                    </label>
                </div>
                <div class="bulk-progress" id="bulkProgress" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="bulkProgressFill"></div>
                    </div>
                    <div class="progress-text" id="bulkProgressText">Processing...</div>
                </div>
                <div class="bulk-results" id="bulkResults" style="display: none;">
                    <h3>Results:</h3>
                    <div id="bulkResultsContent"></div>
                </div>
            </div>
            <div class="modal-buttons">
                <button id="bulkAddStart" class="bulk-start-btn">Start Bulk Add</button>
                <button id="bulkAddCancel" class="bulk-cancel-btn">Cancel</button>
            </div>
        </div>
    </div>

    <script src="scripts/script.js"></script>
</body>
</html>
