import{_ as ie,b as f,e as t,z as k,A as I,f as M,n as ce,B as F,k as de,m as ge,x as ue,t as c,g as R,F as me,p as ve,a as he,r as g,c as b,C as fe,q as L,u as be,o as u}from"./index-CjBXyH3Y.js";import{u as ye}from"./media-CM9D7_Re.js";import{u as Ce}from"./message-ZvZWQzDI.js";import{S as we}from"./Sidebar-BIvwtO3x.js";import{M as Se}from"./MainHeader-B3bwRkAp.js";import{R as pe,L as Te}from"./RegisterModal-C1qPTswJ.js";const Me={name:"Features",components:{Sidebar:we,MainHeader:Se,LoginModal:Te,RegisterModal:pe},setup(){const a=be(),o=he(),l=ye(),e=Ce(),w=g(!1),d=g(!1),S=g(!1),p=g(!1),y=g(""),C=g(!1),s=g(!1),v=g(null),m=g(""),T=b(()=>o.isLoggedIn),E=b(()=>o.userName),D=b(()=>l.currentCategory),N=b(()=>l.categoryCounts),A=b(()=>l.platforms),B=b(()=>l.genres),z=b(()=>[{key:"game",name:"Games",icon:"üéÆ"},{key:"series",name:"Series",icon:"üì∫"},{key:"movie",name:"Movies",icon:"üé¨"},{key:"buecher",name:"B√ºcher",icon:"üìö"},{key:"watchlist",name:"Watchlist",icon:"‚ù§Ô∏è"}]),U=()=>{w.value=!w.value},P=()=>{d.value=!d.value},x=()=>{d.value=!1},V=n=>{l.setCategory(n)},G=()=>{l.setSearchQuery("")},H=(n,i)=>{i?l.addFilter({type:"platform",value:n}):l.removeFilter({type:"platform",value:n})},K=(n,i)=>{i?l.addFilter({type:"genre",value:n}):l.removeFilter({type:"genre",value:n})},O=(n,i)=>{i?l.addFilter({type:"airing",value:n}):l.removeFilter({type:"airing",value:n})},Q=n=>{a.push("/")},q=async()=>{await o.logout(),e.showMessage("Erfolgreich abgemeldet","success")},j=()=>{a.push("/statistics"),d.value=!1},W=()=>{a.push("/calendar"),d.value=!1},J=()=>{a.push("/features"),d.value=!1},X=()=>{a.push("/profile"),d.value=!1},Y=async()=>{if(y.value.trim()){C.value=!0,m.value="",v.value=null;try{const n=await L.searchApi(y.value,"movie",1);if(!n||n.length===0)throw new Error("Kein Film mit diesem Namen gefunden");const r=n[0].id.replace("tmdb_movie_",""),h=await Z(r);if(!h.belongs_to_collection)throw new Error("Dieser Film geh√∂rt zu keiner Collection");const ae=h.belongs_to_collection.id,_=await $(ae);if(!_.parts||_.parts.length<2)throw new Error("Collection hat weniger als 2 Filme");v.value={movie:h,collection:_},e.showMessage("Collection erfolgreich gefunden!","success")}catch(n){console.error("Collection test failed:",n),m.value=n.message||"Unbekannter Fehler beim Testen der Collection",e.showMessage("Collection-Test fehlgeschlagen","error")}finally{C.value=!1}}},Z=async n=>{const r=await fetch(`https://teabubble.attrebi.ch/api/tmdb/movie/${n}`);if(!r.ok)throw new Error("Film-Details konnten nicht abgerufen werden");return await r.json()},$=async n=>{const r=await fetch(`https://teabubble.attrebi.ch/api/tmdb/collection/${n}`);if(!r.ok)throw new Error("Collection-Details konnten nicht abgerufen werden");return await r.json()},ee=async()=>{if(!(!v.value||!T.value)){s.value=!0;try{const n=v.value.collection.parts;let i=0;for(const r of n)try{const h={title:r.title,category:"movie",watchlistType:"watchlist",release:r.release_date,rating:Math.round(r.vote_average),platforms:"Cinema",genre:"Collection",link:`https://www.themoviedb.org/movie/${r.id}`,path:null,discovered:new Date().toISOString().split("T")[0],externalId:`tmdb_movie_${r.id}`};await L.addMediaItem(h),i++}catch(h){console.warn(`Failed to add movie ${r.title}:`,h)}e.showMessage(`${i} von ${n.length} Filmen erfolgreich hinzugef√ºgt`,"success"),await l.loadMedia()}catch(n){console.error("Failed to add collection:",n),e.showMessage("Fehler beim Hinzuf√ºgen der Collection","error")}finally{s.value=!1}}},oe=()=>{v.value=null,m.value="",y.value=""},te=()=>{m.value=""},se=n=>n?new Date(n).toLocaleDateString("de-DE"):"Unbekannt",ne=n=>{n.target.style.display="none"},le=()=>{S.value=!1,e.showMessage("Erfolgreich angemeldet","success")},re=()=>{p.value=!1,e.showMessage("Erfolgreich registriert","success")};return fe(async()=>{await l.loadMedia()}),{sidebarCollapsed:w,mobileSidebarOpen:d,showLoginModal:S,showRegisterModal:p,movieInput:y,isTesting:C,isAddingCollection:s,testResults:v,testError:m,isLoggedIn:T,userName:E,currentCategory:D,categoryCounts:N,platforms:A,genres:B,categories:z,toggleSidebar:U,toggleMobileSidebar:P,closeMobileSidebar:x,setCategory:V,clearSearch:G,togglePlatformFilter:H,toggleGenreFilter:K,toggleAiringFilter:O,addItemFromSidebar:Q,logout:q,navigateToStatistics:j,navigateToCalendar:W,navigateToFeatures:J,navigateToProfile:X,testCollection:Y,addCollectionToLibrary:ee,clearResults:oe,clearError:te,formatDate:se,handleImageError:ne,handleLoginSuccess:le,handleRegisterSuccess:re}}},Fe={class:"vue-app"},_e={class:"main-content"},ke={class:"content-area"},Ie={class:"features-container"},Re={class:"feature-card"},Le={class:"feature-content"},Ee={class:"input-group"},De={class:"input-with-button"},Ne=["disabled"],Ae=["disabled"],Be={key:0,class:"test-results"},ze={class:"result-header"},Ue={class:"collection-movies"},Pe={class:"movie-list"},xe={class:"movie-poster"},Ve=["src","alt"],Ge={key:1,class:"no-poster"},He={class:"movie-info"},Ke={class:"movie-release"},Oe={class:"movie-overview"},Qe={class:"movie-meta"},qe={class:"rating"},je={class:"id"},We={class:"collection-actions"},Je=["disabled"],Xe={key:1,class:"error-message"};function Ye(a,o,l,e,w,d){const S=F("Sidebar"),p=F("MainHeader"),y=F("LoginModal"),C=F("RegisterModal");return u(),f("div",Fe,[t("div",{class:ce(["mobile-overlay",{show:e.mobileSidebarOpen}]),onClick:o[0]||(o[0]=(...s)=>e.closeMobileSidebar&&e.closeMobileSidebar(...s))},null,2),k(S,{collapsed:e.sidebarCollapsed,"mobile-open":e.mobileSidebarOpen,"is-logged-in":e.isLoggedIn,"user-name":e.userName,"current-category":e.currentCategory,"category-counts":e.categoryCounts,platforms:e.platforms,genres:e.genres,categories:e.categories,onToggle:e.toggleSidebar,onSetCategory:e.setCategory,onNavigateToStatistics:e.navigateToStatistics,onNavigateToCalendar:e.navigateToCalendar,onNavigateToFeatures:e.navigateToFeatures,onNavigateToProfile:e.navigateToProfile,onTogglePlatformFilter:e.togglePlatformFilter,onToggleGenreFilter:e.toggleGenreFilter,onToggleAiringFilter:e.toggleAiringFilter,onAddItem:e.addItemFromSidebar,onShowLogin:o[1]||(o[1]=s=>e.showLoginModal=!0),onShowRegister:o[2]||(o[2]=s=>e.showRegisterModal=!0),onLogout:e.logout},null,8,["collapsed","mobile-open","is-logged-in","user-name","current-category","category-counts","platforms","genres","categories","onToggle","onSetCategory","onNavigateToStatistics","onNavigateToCalendar","onNavigateToFeatures","onNavigateToProfile","onTogglePlatformFilter","onToggleGenreFilter","onToggleAiringFilter","onAddItem","onLogout"]),t("div",_e,[k(p,{"search-query":a.searchQuery,"onUpdate:searchQuery":o[3]||(o[3]=s=>a.searchQuery=s),"grid-columns":a.gridColumns,"onUpdate:gridColumns":o[4]||(o[4]=s=>a.gridColumns=s),"sort-by":a.sortBy,"onUpdate:sortBy":o[5]||(o[5]=s=>a.sortBy=s),onToggleMobileSidebar:e.toggleMobileSidebar,onClearSearch:e.clearSearch},null,8,["search-query","grid-columns","sort-by","onToggleMobileSidebar","onClearSearch"]),t("main",ke,[t("div",Ie,[o[20]||(o[20]=t("h1",null,"Features",-1)),o[21]||(o[21]=t("p",{class:"features-description"}," Erweiterte Funktionen f√ºr Ihre Media Library ",-1)),t("div",Re,[o[19]||(o[19]=t("div",{class:"feature-header"},[t("h2",null,"üé¨ TMDb Collection Test"),t("p",null,"Testen Sie TMDb Collections und f√ºgen Sie ganze Filmreihen hinzu")],-1)),t("div",Le,[t("div",Ee,[o[15]||(o[15]=t("label",{for:"movieInput"},"Film-Titel oder TMDb ID eingeben:",-1)),t("div",De,[de(t("input",{id:"movieInput","onUpdate:modelValue":o[6]||(o[6]=s=>e.movieInput=s),type:"text",placeholder:"z.B. 'The Lord of the Rings', 'Matrix' oder '120'",onKeyup:o[7]||(o[7]=ue((...s)=>e.testCollection&&e.testCollection(...s),["enter"])),disabled:e.isTesting},null,40,Ne),[[ge,e.movieInput]]),t("button",{onClick:o[8]||(o[8]=(...s)=>e.testCollection&&e.testCollection(...s)),disabled:!e.movieInput.trim()||e.isTesting,class:"test-button"},c(e.isTesting?"Teste...":"Collection testen"),9,Ae)]),o[16]||(o[16]=t("div",{class:"input-hint"},[t("p",null,[R("üí° "),t("strong",null,"Tipp:"),R(' Versuchen Sie "The Lord of the Rings", "Matrix", "Star Wars" oder "Harry Potter"')])],-1))]),e.testResults?(u(),f("div",Be,[t("div",ze,[o[17]||(o[17]=t("h3",null,"Collection gefunden!",-1)),t("p",null,[t("strong",null,c(e.testResults.collection.name),1)]),t("p",null,c(e.testResults.collection.overview||"Keine Beschreibung verf√ºgbar"),1)]),t("div",Ue,[t("h4",null,"Filme in der Collection ("+c(e.testResults.collection.parts.length)+"):",1),t("div",Pe,[(u(!0),f(me,null,ve(e.testResults.collection.parts,(s,v)=>{var m;return u(),f("div",{key:s.id,class:"movie-item"},[t("div",xe,[s.poster_path?(u(),f("img",{key:0,src:`https://image.tmdb.org/t/p/w200${s.poster_path}`,alt:s.title,onError:o[9]||(o[9]=(...T)=>e.handleImageError&&e.handleImageError(...T))},null,40,Ve)):(u(),f("div",Ge,"üé¨"))]),t("div",He,[t("h5",null,c(s.title),1),t("p",Ke,c(e.formatDate(s.release_date)),1),t("p",Oe,c(s.overview||"Keine Beschreibung verf√ºgbar"),1),t("div",Qe,[t("span",qe,"‚≠ê "+c(((m=s.vote_average)==null?void 0:m.toFixed(1))||"N/A"),1),t("span",je,"ID: "+c(s.id),1)])])])}),128))])]),t("div",We,[t("button",{onClick:o[10]||(o[10]=(...s)=>e.addCollectionToLibrary&&e.addCollectionToLibrary(...s)),disabled:e.isAddingCollection,class:"add-collection-button"},c(e.isAddingCollection?"F√ºge hinzu...":`Alle ${e.testResults.collection.parts.length} Filme zur Bibliothek hinzuf√ºgen`),9,Je),t("button",{onClick:o[11]||(o[11]=(...s)=>e.clearResults&&e.clearResults(...s)),class:"clear-button"}," Neuen Test starten ")])])):M("",!0),e.testError?(u(),f("div",Xe,[o[18]||(o[18]=t("h4",null,"‚ùå Test fehlgeschlagen",-1)),t("p",null,c(e.testError),1),t("button",{onClick:o[12]||(o[12]=(...s)=>e.clearError&&e.clearError(...s)),class:"clear-button"},"Erneut versuchen")])):M("",!0)])])])])]),e.showLoginModal?(u(),I(y,{key:0,onClose:o[13]||(o[13]=s=>e.showLoginModal=!1),onSuccess:e.handleLoginSuccess},null,8,["onSuccess"])):M("",!0),e.showRegisterModal?(u(),I(C,{key:1,onClose:o[14]||(o[14]=s=>e.showRegisterModal=!1),onSuccess:e.handleRegisterSuccess},null,8,["onSuccess"])):M("",!0)])}const no=ie(Me,[["render",Ye],["__scopeId","data-v-337d855d"]]);export{no as default};
