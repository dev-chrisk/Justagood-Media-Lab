import{E as U,_ as A,r as m,C as M,b as a,e as n,f as v,k,m as g,t as i,j as V,g as B,F as E,p as L,o as d,z as R,B as N}from"./index-DyVFTtEu.js";const p=U.create({baseURL:"https://teabubble.attrebi.ch/api",headers:{"Content-Type":"application/json"}});p.interceptors.request.use(t=>{const o=localStorage.getItem("authToken");return console.log("üìö Books API Request:",{url:t.url,method:t.method,baseURL:t.baseURL,fullURL:`${t.baseURL}${t.url}`,data:t.data,token:o?`${o.substring(0,20)}...`:"none"}),o&&(t.headers.Authorization=`Bearer ${o}`),t});p.interceptors.response.use(t=>(console.log("üìö Books API Success:",{url:t.config.url,status:t.status,data:t.data}),t),t=>{var o,r,e,c;return console.log("üìö Books API Error:",{url:(o=t.config)==null?void 0:o.url,status:(r=t.response)==null?void 0:r.status,statusText:(e=t.response)==null?void 0:e.statusText,data:(c=t.response)==null?void 0:c.data,message:t.message}),Promise.reject(t)});const y={async getBooks(){try{return(await p.get("/books")).data}catch(t){throw console.error("üìö Get books failed:",t),t}},async addBook(t){try{console.log("üìö Adding book with data:",t);const o={title:t.title,author:t.author||null,release:t.release||null,rating:t.rating?parseInt(t.rating):null,count:parseInt(t.count)||1,genre:t.genre||null,link:t.link||null,path:null,discovered:null};return Object.keys(o).forEach(e=>{(o[e]===null||o[e]==="")&&delete o[e]}),console.log("üìö Cleaned book data:",o),(await p.post("/books",o)).data}catch(o){throw console.error("üìö Add book failed:",o),o}},async updateBook(t,o){try{return console.log("üìö Updating book:",t,o),(await p.put(`/books/${t}`,o)).data}catch(r){throw console.error("üìö Update book failed:",r),r}},async deleteBook(t){try{return console.log("üìö Deleting book:",t),(await p.delete(`/books/${t}`)).data}catch(o){throw console.error("üìö Delete book failed:",o),o}}},T={name:"BooksManager",setup(){const t=m([]),o=m(!1),r=m(""),e=m(!1),c=m(!0),b=m({title:"",author:"",release:"",rating:"",count:1,genre:"",link:""}),s=async()=>{console.log("üìö Loading books..."),o.value=!0,r.value="";try{const l=await y.getBooks();console.log("üìö Books loaded:",l),l.success?t.value=l.data:r.value=l.error||"Failed to load books"}catch(l){console.error("üìö Error loading books:",l),r.value=l.message||"Failed to load books"}finally{o.value=!1}},f=async()=>{console.log("üìö Adding book:",b.value),o.value=!0,r.value="";try{const l=await y.addBook(b.value);console.log("üìö Book added:",l),l.success?(t.value.unshift(l.data),w(),e.value=!1):r.value=l.error||"Failed to add book"}catch(l){console.error("üìö Error adding book:",l),r.value=l.message||"Failed to add book"}finally{o.value=!1}},h=l=>{console.log("üìö Editing book:",l),alert("Edit functionality coming soon!")},_=async l=>{if(console.log("üìö Deleting book:",l),!!confirm("Are you sure you want to delete this book?")){o.value=!0,r.value="";try{const u=await y.deleteBook(l);console.log("üìö Book deleted:",u),u.success?t.value=t.value.filter(x=>x.id!==l):r.value=u.error||"Failed to delete book"}catch(u){console.error("üìö Error deleting book:",u),r.value=u.message||"Failed to delete book"}finally{o.value=!1}}},w=()=>{b.value={title:"",author:"",release:"",rating:"",count:1,genre:"",link:""}},F=()=>{w(),e.value=!1},C=l=>l?new Date(l).getFullYear():"";return M(()=>{console.log("üìö BooksManager mounted, loading books..."),s()}),{books:t,loading:o,error:r,showAddForm:e,newBook:b,debugMode:c,loadBooks:s,addBook:f,editBook:h,deleteBook:_,cancelAdd:F,formatYear:C}}},I={class:"books-manager"},Y={class:"books-header"},j={key:0,class:"add-book-form"},P={class:"form-group"},S={class:"form-group"},q={class:"form-group"},G={class:"form-group"},z={class:"form-group"},O={class:"form-group"},J={class:"form-group"},D={class:"form-actions"},H=["disabled"],K={class:"books-list"},Q={key:0,class:"loading"},W={key:1,class:"error"},X={key:2,class:"no-books"},Z={key:3,class:"books-grid"},$={key:0},oo={key:1},eo={key:2},to={key:3},no={class:"book-actions"},so=["onClick"],lo=["onClick"],ro={key:1,class:"debug-info"};function ao(t,o,r,e,c,b){return d(),a("div",I,[n("div",Y,[o[11]||(o[11]=n("h2",null,"üìö Books Manager",-1)),n("button",{onClick:o[0]||(o[0]=s=>e.showAddForm=!0),class:"add-book-btn"}," + Add Book ")]),e.showAddForm?(d(),a("div",j,[o[19]||(o[19]=n("h3",null,"Add New Book",-1)),n("form",{onSubmit:o[9]||(o[9]=V((...s)=>e.addBook&&e.addBook(...s),["prevent"]))},[n("div",P,[o[12]||(o[12]=n("label",null,"Title *",-1)),k(n("input",{"onUpdate:modelValue":o[1]||(o[1]=s=>e.newBook.title=s),type:"text",required:""},null,512),[[g,e.newBook.title]])]),n("div",S,[o[13]||(o[13]=n("label",null,"Author",-1)),k(n("input",{"onUpdate:modelValue":o[2]||(o[2]=s=>e.newBook.author=s),type:"text"},null,512),[[g,e.newBook.author]])]),n("div",q,[o[14]||(o[14]=n("label",null,"Release Year",-1)),k(n("input",{"onUpdate:modelValue":o[3]||(o[3]=s=>e.newBook.release=s),type:"number",min:"1900",max:"2030"},null,512),[[g,e.newBook.release]])]),n("div",G,[o[15]||(o[15]=n("label",null,"Rating (0-10)",-1)),k(n("input",{"onUpdate:modelValue":o[4]||(o[4]=s=>e.newBook.rating=s),type:"number",min:"0",max:"10"},null,512),[[g,e.newBook.rating]])]),n("div",z,[o[16]||(o[16]=n("label",null,"Count",-1)),k(n("input",{"onUpdate:modelValue":o[5]||(o[5]=s=>e.newBook.count=s),type:"number",min:"0",value:"1"},null,512),[[g,e.newBook.count]])]),n("div",O,[o[17]||(o[17]=n("label",null,"Genre",-1)),k(n("input",{"onUpdate:modelValue":o[6]||(o[6]=s=>e.newBook.genre=s),type:"text"},null,512),[[g,e.newBook.genre]])]),n("div",J,[o[18]||(o[18]=n("label",null,"Link",-1)),k(n("input",{"onUpdate:modelValue":o[7]||(o[7]=s=>e.newBook.link=s),type:"url"},null,512),[[g,e.newBook.link]])]),n("div",D,[n("button",{type:"submit",disabled:e.loading},i(e.loading?"Adding...":"Add Book"),9,H),n("button",{type:"button",onClick:o[8]||(o[8]=(...s)=>e.cancelAdd&&e.cancelAdd(...s))}," Cancel ")])],32)])):v("",!0),n("div",K,[e.loading?(d(),a("div",Q," Loading books... ")):e.error?(d(),a("div",W,[B(i(e.error)+" ",1),n("button",{onClick:o[10]||(o[10]=(...s)=>e.loadBooks&&e.loadBooks(...s))},"Retry")])):e.books.length===0?(d(),a("div",X," No books found. Add your first book! ")):(d(),a("div",Z,[(d(!0),a(E,null,L(e.books,s=>(d(),a("div",{key:s.id,class:"book-card"},[n("h4",null,i(s.title),1),s.author?(d(),a("p",$,[o[20]||(o[20]=n("strong",null,"Author:",-1)),B(" "+i(s.author),1)])):v("",!0),s.release?(d(),a("p",oo,[o[21]||(o[21]=n("strong",null,"Year:",-1)),B(" "+i(e.formatYear(s.release)),1)])):v("",!0),s.rating?(d(),a("p",eo,[o[22]||(o[22]=n("strong",null,"Rating:",-1)),B(" "+i(s.rating)+"/10",1)])):v("",!0),s.genre?(d(),a("p",to,[o[23]||(o[23]=n("strong",null,"Genre:",-1)),B(" "+i(s.genre),1)])):v("",!0),n("p",null,[o[24]||(o[24]=n("strong",null,"Count:",-1)),B(" "+i(s.count),1)]),n("div",no,[n("button",{onClick:f=>e.editBook(s),class:"edit-btn"},"Edit",8,so),n("button",{onClick:f=>e.deleteBook(s.id),class:"delete-btn"},"Delete",8,lo)])]))),128))]))]),e.debugMode?(d(),a("div",ro,[o[25]||(o[25]=n("h4",null,"üêõ Debug Info",-1)),n("pre",null,i(JSON.stringify({books:e.books.length,loading:e.loading,error:e.error,showAddForm:e.showAddForm},null,2)),1)])):v("",!0)])}const io=A(T,[["render",ao],["__scopeId","data-v-23da8ea0"]]),uo={name:"Books",components:{BooksManager:io}},ko={class:"books-page"};function go(t,o,r,e,c,b){const s=N("BooksManager");return d(),a("div",ko,[o[0]||(o[0]=n("div",{class:"page-header"},[n("h1",null,"üìö Books Library"),n("p",null,"Manage your book collection")],-1)),R(s)])}const bo=A(uo,[["render",go],["__scopeId","data-v-4644d0a5"]]);export{bo as default};
