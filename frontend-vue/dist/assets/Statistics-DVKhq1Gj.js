import{_ as ot,b as c,e as s,z as it,A as R,f as N,n as et,B as w,t as a,F as h,p as b,a as at,r as u,c as v,C as nt,u as rt,o as n,h as M}from"./index-CjBXyH3Y.js";import{u as lt}from"./media-CM9D7_Re.js";import{S as ct}from"./Sidebar-BIvwtO3x.js";import{L as dt}from"./LoadingSpinner-CR2swoq2.js";import{R as gt,L as vt}from"./RegisterModal-C1qPTswJ.js";const mt={name:"Statistics",components:{Sidebar:ct,LoadingSpinner:dt,LoginModal:vt,RegisterModal:gt},setup(){const m=rt(),o=lt(),_=at(),t=u(!1),S=u(""),T=u(!1),y=u(!1),k=u(!1),C=u(!1),A=v(()=>_.isLoggedIn),i=v(()=>_.isAdmin),d=v(()=>{var g;return((g=_.user)==null?void 0:g.name)||""}),x=v(()=>"statistics"),P=v(()=>({})),B=v(()=>[]),p=v(()=>[]),z=v(()=>[{key:"game",name:"Games",icon:"🎮"},{key:"series",name:"Series",icon:"📺"},{key:"movie",name:"Movies",icon:"🎬"},{key:"buecher",name:"Bücher",icon:"📚"},{key:"watchlist",name:"Watchlist",icon:"❤️"}]),G=v(()=>{const g=o.mediaData,l={totalItems:g.length,totalCollections:0,totalPlaytime:0,avgRating:0,categoryDistribution:{},ratingDistribution:{},platformDistribution:{},genreDistribution:{},recentActivity:[],airingSeries:[]};let I=0,L=0;return g.forEach(e=>{const D=e.category||"unknown";if(l.categoryDistribution[D]=(l.categoryDistribution[D]||0)+1,e.rating&&e.rating>0){const f=Math.floor(e.rating);l.ratingDistribution[f]=(l.ratingDistribution[f]||0)+1,I+=e.rating,L++}if(e.platforms&&e.category==="game"&&e.platforms.split(",").map(r=>r.trim()).filter(r=>r).forEach(r=>{l.platformDistribution[r]=(l.platformDistribution[r]||0)+1}),e.genre&&(e.category==="series"||e.category==="movie")&&e.genre.split(",").map(r=>r.trim()).filter(r=>r).forEach(r=>{l.genreDistribution[r]=(l.genreDistribution[r]||0)+1}),e.spielzeit&&e.spielzeit>0&&(l.totalPlaytime+=e.spielzeit),e.category==="series"&&e.isAiring===!0&&l.airingSeries.push({title:e.title,nextSeason:e.nextSeason,nextSeasonRelease:e.nextSeasonRelease}),e.discovered){const f=new Date(e.discovered),r=new Date;r.setDate(r.getDate()-30),f>=r&&l.recentActivity.push({title:e.title,category:e.category,discovered:e.discovered})}}),L>0&&(l.avgRating=(I/L).toFixed(1)),l.totalPlaytime=Math.round(l.totalPlaytime/60),l.recentActivity.sort((e,D)=>new Date(D.discovered)-new Date(e.discovered)),l}),E=()=>{T.value=!T.value},O=()=>{y.value=!y.value},V=()=>{y.value=!1},W=g=>{},j=()=>{m.push("/books")},q=()=>{},H=()=>{m.push("/calendar")},J=()=>{m.push("/features")},K=()=>{m.push("/profile")},Q=()=>{console.log("Admin navigation clicked"),m.push("/admin")},U=()=>{},X=()=>{},Y=()=>{},Z=()=>{},$=()=>{},tt=()=>{_.logout(),m.push("/")},F=async()=>{t.value=!0,S.value="";try{await o.loadMedia()}catch{S.value="Failed to refresh statistics"}finally{t.value=!1}},st=g=>g?new Date(g).toLocaleDateString():"";return nt(async()=>{await F()}),{loading:t,error:S,sidebarCollapsed:T,mobileSidebarOpen:y,showLoginModal:k,showRegisterModal:C,isLoggedIn:A,isAdmin:i,userName:d,currentCategory:x,categoryCounts:P,platforms:B,genres:p,categories:z,statistics:G,toggleSidebar:E,toggleMobileSidebar:O,closeMobileSidebar:V,setCategory:W,navigateToBooks:j,navigateToStatistics:q,navigateToCalendar:H,navigateToFeatures:J,navigateToProfile:K,debugNavigateToAdmin:Q,togglePlatformFilter:U,toggleGenreFilter:X,toggleAiringFilter:Y,addItemFromSidebar:Z,showAdminLogin:$,logout:tt,refreshStatistics:F,formatDate:st}}},yt={class:"vue-app"},ft={class:"main-content"},ht={class:"main-header"},bt={class:"header-left"},ut={class:"header-right"},_t={class:"content-area"},St={key:1,class:"error"},Tt={key:2,class:"statistics-container"},Dt={class:"statistics-header"},wt={class:"refresh-controls"},Mt={class:"statistics-content"},kt={class:"stats-summary"},Ct={class:"summary-card"},At={class:"summary-number"},Lt={class:"summary-card"},Rt={class:"summary-number"},Ft={class:"summary-card"},It={class:"summary-number"},Nt={class:"summary-card"},xt={class:"summary-number"},Pt={class:"chart-container"},Bt={class:"category-stats"},pt={class:"category-name"},zt={class:"category-bar"},Gt={class:"category-count"},Et={class:"chart-container"},Ot={class:"rating-stats"},Vt={class:"rating-stars"},Wt={class:"rating-bar"},jt={class:"rating-count"},qt={class:"chart-container"},Ht={class:"platform-stats"},Jt={class:"platform-name"},Kt={class:"platform-bar"},Qt={class:"platform-count"},Ut={class:"chart-container"},Xt={class:"genre-stats"},Yt={class:"genre-name"},Zt={class:"genre-bar"},$t={class:"genre-count"},ts={class:"chart-container"},ss={class:"recent-activity"},os={class:"activity-title"},is={class:"activity-category"},es={class:"activity-date"},as={class:"chart-container"},ns={class:"airing-series"},rs={class:"airing-title"},ls={class:"airing-next"},cs={class:"airing-date"};function ds(m,o,_,t,S,T){const y=w("Sidebar"),k=w("LoadingSpinner"),C=w("LoginModal"),A=w("RegisterModal");return n(),c("div",yt,[s("div",{class:et(["mobile-overlay",{show:t.mobileSidebarOpen}]),onClick:o[0]||(o[0]=(...i)=>t.closeMobileSidebar&&t.closeMobileSidebar(...i))},null,2),it(y,{collapsed:t.sidebarCollapsed,"mobile-open":t.mobileSidebarOpen,"is-logged-in":t.isLoggedIn,"is-admin":t.isAdmin,"user-name":t.userName,"current-category":t.currentCategory,"category-counts":t.categoryCounts,platforms:t.platforms,genres:t.genres,categories:t.categories,onToggle:t.toggleSidebar,onSetCategory:t.setCategory,onNavigateToBooks:t.navigateToBooks,onNavigateToStatistics:t.navigateToStatistics,onNavigateToCalendar:t.navigateToCalendar,onNavigateToFeatures:t.navigateToFeatures,onNavigateToProfile:t.navigateToProfile,onNavigateToAdmin:t.debugNavigateToAdmin,onTogglePlatformFilter:t.togglePlatformFilter,onToggleGenreFilter:t.toggleGenreFilter,onToggleAiringFilter:t.toggleAiringFilter,onAddItem:t.addItemFromSidebar,onShowLogin:o[1]||(o[1]=i=>t.showLoginModal=!0),onShowRegister:o[2]||(o[2]=i=>t.showRegisterModal=!0),onShowAdminLogin:t.showAdminLogin,onLogout:t.logout},null,8,["collapsed","mobile-open","is-logged-in","is-admin","user-name","current-category","category-counts","platforms","genres","categories","onToggle","onSetCategory","onNavigateToBooks","onNavigateToStatistics","onNavigateToCalendar","onNavigateToFeatures","onNavigateToProfile","onNavigateToAdmin","onTogglePlatformFilter","onToggleGenreFilter","onToggleAiringFilter","onAddItem","onShowAdminLogin","onLogout"]),s("div",ft,[s("header",ht,[s("div",bt,[s("button",{class:"mobile-sidebar-toggle",onClick:o[3]||(o[3]=(...i)=>t.toggleMobileSidebar&&t.toggleMobileSidebar(...i))},"☰"),o[12]||(o[12]=s("h1",{class:"page-title"},"📊 Statistics",-1))]),s("div",ut,[s("button",{class:"refresh-stats-btn",onClick:o[4]||(o[4]=(...i)=>t.refreshStatistics&&t.refreshStatistics(...i)),title:"Refresh statistics"},[...o[13]||(o[13]=[s("span",{class:"refresh-icon"},"🔄",-1)])])])]),s("main",_t,[t.loading?(n(),R(k,{key:0,message:"Loading statistics..."})):t.error?(n(),c("div",St,[s("p",null,a(t.error),1),s("button",{onClick:o[5]||(o[5]=(...i)=>t.refreshStatistics&&t.refreshStatistics(...i))},"Retry")])):(n(),c("div",Tt,[s("div",Dt,[o[14]||(o[14]=s("h1",null,"📊 Media Library Statistics",-1)),o[15]||(o[15]=s("p",null,"Übersicht über deine Media Collection",-1)),s("div",wt,[s("button",{class:"refresh-btn",onClick:o[6]||(o[6]=(...i)=>t.refreshStatistics&&t.refreshStatistics(...i))},"🔄 Refresh Statistics")])]),s("div",Mt,[s("div",kt,[s("div",Ct,[s("div",At,a(t.statistics.totalItems),1),o[16]||(o[16]=s("div",{class:"summary-label"},"Total Items",-1))]),s("div",Lt,[s("div",Rt,a(t.statistics.totalCollections),1),o[17]||(o[17]=s("div",{class:"summary-label"},"Collections",-1))]),s("div",Ft,[s("div",It,a(t.statistics.totalPlaytime)+"h",1),o[18]||(o[18]=s("div",{class:"summary-label"},"Total Playtime",-1))]),s("div",Nt,[s("div",xt,a(t.statistics.avgRating),1),o[19]||(o[19]=s("div",{class:"summary-label"},"Avg Rating",-1))])]),s("div",Pt,[o[20]||(o[20]=s("h3",{class:"chart-title"},"📈 Category Distribution",-1)),s("div",Bt,[(n(!0),c(h,null,b(t.statistics.categoryDistribution,(i,d)=>(n(),c("div",{key:d,class:"category-stat"},[s("div",pt,a(d),1),s("div",zt,[s("div",{class:"category-fill",style:M({width:`${i/t.statistics.totalItems*100}%`})},null,4)]),s("div",Gt,a(i)+" ("+a((i/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",Et,[o[21]||(o[21]=s("h3",{class:"chart-title"},"⭐ Rating Distribution",-1)),s("div",Ot,[(n(!0),c(h,null,b(t.statistics.ratingDistribution,(i,d)=>(n(),c("div",{key:d,class:"rating-stat"},[s("div",Vt,a("★".repeat(parseInt(d)))+a("☆".repeat(5-parseInt(d))),1),s("div",Wt,[s("div",{class:"rating-fill",style:M({width:`${i/t.statistics.totalItems*100}%`})},null,4)]),s("div",jt,a(i)+" ("+a((i/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",qt,[o[22]||(o[22]=s("h3",{class:"chart-title"},"🎮 Platform Distribution",-1)),s("div",Ht,[(n(!0),c(h,null,b(t.statistics.platformDistribution,(i,d)=>(n(),c("div",{key:d,class:"platform-stat"},[s("div",Jt,a(d),1),s("div",Kt,[s("div",{class:"platform-fill",style:M({width:`${i/t.statistics.totalItems*100}%`})},null,4)]),s("div",Qt,a(i)+" ("+a((i/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",Ut,[o[23]||(o[23]=s("h3",{class:"chart-title"},"🎭 Top Genres",-1)),s("div",Xt,[(n(!0),c(h,null,b(t.statistics.genreDistribution,(i,d)=>(n(),c("div",{key:d,class:"genre-stat"},[s("div",Yt,a(d),1),s("div",Zt,[s("div",{class:"genre-fill",style:M({width:`${i/t.statistics.totalItems*100}%`})},null,4)]),s("div",$t,a(i)+" ("+a((i/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",ts,[o[24]||(o[24]=s("h3",{class:"chart-title"},"📅 Recent Activity",-1)),s("div",ss,[(n(!0),c(h,null,b(t.statistics.recentActivity,i=>(n(),c("div",{key:i.title,class:"activity-item"},[s("div",os,a(i.title),1),s("div",is,a(i.category),1),s("div",es,a(t.formatDate(i.discovered)),1)]))),128))])]),s("div",as,[o[25]||(o[25]=s("h3",{class:"chart-title"},"📺 Currently Airing Series",-1)),s("div",ns,[(n(!0),c(h,null,b(t.statistics.airingSeries,i=>(n(),c("div",{key:i.title,class:"airing-item"},[s("div",rs,a(i.title),1),s("div",ls,"Next: Season "+a(i.nextSeason),1),s("div",cs,a(i.nextSeasonRelease?t.formatDate(i.nextSeasonRelease):"TBA"),1)]))),128))])])])]))])]),t.showLoginModal?(n(),R(C,{key:0,onClose:o[7]||(o[7]=i=>t.showLoginModal=!1),onSuccess:o[8]||(o[8]=()=>{t.showLoginModal=!1}),onSwitchToRegister:o[9]||(o[9]=()=>{t.showLoginModal=!1,t.showRegisterModal=!0})})):N("",!0),t.showRegisterModal?(n(),R(A,{key:1,onClose:o[10]||(o[10]=i=>t.showRegisterModal=!1),onSuccess:o[11]||(o[11]=()=>{t.showRegisterModal=!1})})):N("",!0)])}const hs=ot(mt,[["render",ds],["__scopeId","data-v-26c8160d"]]);export{hs as default};
