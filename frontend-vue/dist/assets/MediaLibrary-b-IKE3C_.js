import{d as Xe,r as p,u as ot,a as Ye,c as P,_ as Z,b as d,e as o,t as u,f as g,n as Y,g as ve,h as je,o as l,i as Ze,w as Se,j as oe,k as U,v as pe,l as ze,m as B,F as ae,p as ie,q as We,s as st,x as nt,y as at,z as te,A as fe,B as O,C as it,D as rt}from"./index-DeAROFQM.js";import{u as Ie,S as lt}from"./Sidebar-Dufn7ZdB.js";import{u as $e}from"./message-PILtCDav.js";import{M as dt}from"./MainHeader-eAA7FYpX.js";import{R as ct,L as mt}from"./RegisterModal-COmWdJVQ.js";import{L as ut}from"./LoadingSpinner-CjpuDAcY.js";const et=Xe("confirm",()=>{const i=p(!1),t=p("Confirm Action"),a=p(""),e=p(null);function c(w){return new Promise(r=>{t.value=w.title||"Confirm Action",a.value=w.message||"",i.value=!0,e.value=r})}function f(){e.value&&(e.value(!0),e.value=null),i.value=!1}function s(){e.value&&(e.value(!1),e.value=null),i.value=!1}return{show:i,title:t,message:a,showConfirm:c,confirm:f,cancel:s}}),tt=Xe("input",()=>{const i=p(!1),t=p("Input Required"),a=p(""),e=p(""),c=p("text"),f=p(""),s=p(null);function w(_){return new Promise(E=>{t.value=_.title||"Input Required",a.value=_.message||"",e.value=_.placeholder||"",c.value=_.inputType||"text",f.value=_.defaultValue||"",i.value=!0,s.value=E})}function r(_){s.value&&(s.value(_),s.value=null),i.value=!1}function k(){s.value&&(s.value(null),s.value=null),i.value=!1}return{show:i,title:t,message:a,placeholder:e,inputType:c,defaultValue:f,showInput:w,confirm:r,cancel:k}});function gt(){const i=ot(),t=Ye(),a=Ie(),e=$e(),c=et(),f=tt(),s=p(!1),w=p(!1),r=p(!1),k=p(!1),_=p(!1),E=p(!1),z=p(!1),W=p(!1),N=p(!1),M=p(null),Q=()=>typeof window<"u"?window.innerWidth>768?8:3:8,$=p(Q()),K=p("order_asc"),q=p(null),b=()=>{$.value=Q()};typeof window<"u"&&window.addEventListener("resize",b);const G=[{key:"game",name:"Games",icon:"ðŸŽ®"},{key:"series",name:"Series",icon:"ðŸ“º"},{key:"movie",name:"Movies",icon:"ðŸŽ¬"},{key:"buecher",name:"BÃ¼cher",icon:"ðŸ“š"},{key:"watchlist",name:"Watchlist",icon:"â¤ï¸"}],H=P(()=>{try{return t.isLoggedIn}catch(m){return console.error("Error accessing authStore.isLoggedIn:",m),!1}}),se=P(()=>{try{return t.userName}catch(m){return console.error("Error accessing authStore.userName:",m),""}}),ee=P(()=>{try{return t.isAdmin}catch(m){return console.error("Error accessing authStore.isAdmin:",m),!1}}),j=P(()=>{try{return a.currentCategory}catch(m){return console.error("Error accessing mediaStore.currentCategory:",m),"game"}}),D=P({get:()=>{try{return a.searchQuery}catch(m){return console.error("Error accessing mediaStore.searchQuery:",m),""}},set:m=>{try{a.setSearchQuery(m)}catch(y){console.error("Error setting mediaStore.searchQuery:",y)}}}),A=P(()=>{try{return a.categoryCounts}catch(m){return console.error("Error accessing mediaStore.categoryCounts:",m),{}}}),C=P(()=>{try{return a.loading}catch(m){return console.error("Error accessing mediaStore.loading:",m),!1}}),L=P(()=>{try{return a.error}catch(m){return console.error("Error accessing mediaStore.error:",m),null}}),re=P(()=>{try{const m=[...a.filteredMedia||[]],[y,R]=K.value.split("_");return m.sort((I,T)=>{let V=I[y],h=T[y];return y==="order"?(V=I.__order||0,h=T.__order||0):y==="airing"&&(V=I.isAiring?1:0,h=T.isAiring?1:0),typeof V=="string"&&(V=V.toLowerCase(),h=h.toLowerCase()),R==="asc"?V>h?1:-1:V<h?1:-1})}catch(m){return console.error("Error in sortedMedia computed:",m),[]}}),n=P(()=>re.value),v=P(()=>{try{if(!a||!a.mediaData)return[];const m=new Set;return a.mediaData.forEach(y=>{y.platforms&&y.platforms.split(",").forEach(R=>m.add(R.trim()))}),Array.from(m).sort()}catch(m){return console.error("Error in platforms computed:",m),[]}}),F=P(()=>{try{if(!a||!a.mediaData)return[];const m=new Set;return a.mediaData.forEach(y=>{y.genre&&y.genre.split(",").forEach(R=>m.add(R.trim()))}),Array.from(m).sort()}catch(m){return console.error("Error in genres computed:",m),[]}}),S=()=>{s.value=!s.value},x=()=>{w.value=!w.value},J=()=>{w.value=!1},X=m=>{a.setCategory(m),w.value=!1},Ce=()=>{a.setSearchQuery("")},ke=(m,y)=>{y?a.addFilter({type:"platform",value:m}):a.removeFilter({type:"platform",value:m})},Te=(m,y)=>{y?a.addFilter({type:"genre",value:m}):a.removeFilter({type:"genre",value:m})},_e=(m,y)=>{y?a.addFilter({type:"airing",value:m}):a.removeFilter({type:"airing",value:m})},Ae=m=>{M.value=m,_.value=!0},ye=()=>{_.value=!1,M.value=null},xe=()=>{z.value=!1},Me=async m=>{console.log("handleBulkAddItems called but not used in new workflow")},De=async m=>{M.value?await a.updateMediaItem(M.value.id,m):await a.addMediaItem(m),ye()},ne=async m=>{var y;try{await a.deleteMediaItem(m.id)}catch(R){((y=R.response)==null?void 0:y.status)!==404&&!R.silent&&(console.error("Delete failed:",R),e.showError("Failed to delete item: "+(R.message||"Unknown error"),"Delete Failed"))}},Ue=async()=>{await t.logout(),await le()},le=async()=>{try{await a.loadMedia()}catch(m){console.error("Error loading media:",m)}},Re=()=>{E.value=!E.value},Ee=()=>{if(E.value=!1,!H.value){e.showWarning("Bitte loggen Sie sich ein, um neue Items hinzuzufÃ¼gen.","Login erforderlich");return}M.value=null,_.value=!0},Fe=()=>{if(E.value=!1,!H.value){e.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}z.value=!0},Pe=()=>{if(E.value=!1,!H.value){e.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}W.value=!0},Le=()=>{if(E.value=!1,!H.value){e.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}e.showInfo("API Import feature coming soon!","Feature in Entwicklung")},Be=()=>{if(E.value=!1,!H.value){e.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}he()},de=m=>{if(!m)return"Unknown";const y=G.find(R=>R.key===m);return y?y.name:m},Ne=async()=>{const m=de(j.value),y=A.value[j.value]||0;if(y===0){e.showInfo("No items to delete in this category.","Nothing to Delete");return}const R=`Are you sure you want to delete ALL ${y} items in "${m}"?

This action cannot be undone!`;if(await c.showConfirm({title:"Delete All Items",message:R}))try{const V=((a==null?void 0:a.mediaData)||[]).filter(h=>j.value==="watchlist"?h.category==="watchlist"||h.isNew===!0:h.category===j.value).map(h=>h.id);await a.batchDeleteMediaItems(V),await le(),e.showSuccess(`Successfully deleted ${y} items from "${m}"`,"Items Deleted")}catch(T){console.error("Error deleting items:",T),e.showError("Error occurred while deleting items. Please try again.","Delete Failed")}},Ve=m=>{const y=m.split(`
`).map(h=>h.trim()).filter(h=>h.length>0);if(y.length===0){e.showWarning("Die TXT-Datei ist leer oder enthÃ¤lt keine gÃ¼ltigen EintrÃ¤ge.","Leere Datei");return}const I=a.filteredMedia.map(h=>h.title.toLowerCase().trim()),T=y.filter(h=>{const ue=h.toLowerCase().trim();return!I.some(ge=>ge.includes(ue)||ue.includes(ge))}),V=y.filter(h=>{const ue=h.toLowerCase().trim();return I.some(ge=>ge.includes(ue)||ue.includes(ge))});q.value={totalInFile:y.length,missingItems:T,existingItems:V,currentCategory:j.value,categoryName:de(j.value)},W.value=!1,N.value=!0},ce=()=>{q.value=null,N.value=!1},he=async()=>{const m=(a==null?void 0:a.mediaData)||[];if(m.length===0){e.showInfo("Keine Media Items zum Exportieren gefunden.","Nichts zu exportieren");return}const y=await f.showInput({title:"Export Format wÃ¤hlen",message:`1 = CSV
2 = JSON
3 = Beide

Geben Sie die Nummer ein:`,placeholder:"1",defaultValue:"1"});if(!y||!["1","2","3"].includes(y))return;const R=new Date().toISOString().split("T")[0];(y==="1"||y==="3")&&we(m,R),(y==="2"||y==="3")&&be(m,R),e.showSuccess(`Collection mit ${m.length} Items wurde erfolgreich exportiert!`,"Export erfolgreich")},we=(m,y)=>{const I=[["Titel","Kategorie","Release","Rating","Platforms","Genre","Spielzeit","Status","Beschreibung"].join(","),...m.map(T=>[`"${(T.title||"").replace(/"/g,'""')}"`,`"${(T.category||T.category_name||"Unbekannt").replace(/"/g,'""')}"`,`"${T.release||""}"`,`"${T.rating||""}"`,`"${(T.platforms||"").replace(/"/g,'""')}"`,`"${(T.genre||"").replace(/"/g,'""')}"`,`"${T.spielzeit||""}"`,`"${T.isAiring?"Airing":"Abgeschlossen"}"`,`"${(T.description||"").replace(/"/g,'""')}"`].join(","))].join(`
`);me(I,`media_collection_${y}.csv`,"text/csv;charset=utf-8;")},be=(m,y)=>{const R={exportDate:new Date().toISOString(),totalItems:m.length,categories:[...new Set(m.map(I=>I.category||I.category_name||"Unbekannt"))],items:m.map(I=>({id:I.id,title:I.title||"",category:I.category||I.category_name||"Unbekannt",release:I.release||"",rating:I.rating||null,platforms:I.platforms||"",genre:I.genre||"",spielzeit:I.spielzeit||null,status:I.isAiring?"Airing":"Abgeschlossen",description:I.description||"",isNew:I.isNew||!1,nextSeason:I.nextSeason||null,discovered:I.discovered||null}))};me(JSON.stringify(R,null,2),`media_collection_${y}.json`,"application/json;charset=utf-8;")},me=(m,y,R)=>{const I=new Blob([m],{type:R}),T=document.createElement("a"),V=URL.createObjectURL(I);T.setAttribute("href",V),T.setAttribute("download",y),T.style.visibility="hidden",document.body.appendChild(T),T.click(),document.body.removeChild(T),URL.revokeObjectURL(V)};return{sidebarCollapsed:s,mobileSidebarOpen:w,showLoginModal:r,showRegisterModal:k,showEditModal:_,showFloatingMenu:E,showBulkAddModal:z,showTxtImportModal:W,showTxtImportResults:N,editingItem:M,gridColumns:$,sortBy:K,categories:G,txtImportResults:q,isLoggedIn:H,isAdmin:ee,userName:se,currentCategory:j,searchQuery:D,categoryCounts:A,loading:C,error:L,paginatedMedia:n,platforms:v,genres:F,toggleSidebar:S,toggleMobileSidebar:x,closeMobileSidebar:J,setCategory:X,clearSearch:Ce,togglePlatformFilter:ke,toggleGenreFilter:Te,toggleAiringFilter:_e,editItem:Ae,closeEditModal:ye,closeBulkAddModal:xe,handleBulkAddItems:Me,handleSaveItem:De,handleDeleteItem:ne,logout:Ue,loadMedia:le,toggleFloatingMenu:Re,addNewItem:Ee,bulkAddItems:Fe,importFromTxt:Pe,importFromAPI:Le,createCollection:Be,exportMediaCollection:he,exportAsCSV:we,exportAsJSON:be,downloadFile:me,deleteAllInCategory:Ne,getCategoryDisplayName:de,navigateToStatistics:()=>{i.push("/statistics")},navigateToCalendar:()=>{i.push("/calendar")},navigateToFeatures:()=>{i.push("/features")},navigateToProfile:()=>{i.push("/profile")},navigateToAdmin:()=>{console.log("ðŸ”¥ navigateToAdmin function called!"),console.log("ðŸ”¥ Router object:",i),console.log("ðŸ”¥ Pushing to /admin...");try{i.push("/admin"),console.log("ðŸ”¥ Successfully navigated to /admin!")}catch(m){console.error("ðŸ”¥ Error navigating to admin:",m)}},processTxtContent:Ve,closeTxtImportResults:ce,cleanup:()=>{typeof window<"u"&&window.removeEventListener("resize",b)},router:i}}const ft={name:"MediaItem",props:{item:{type:Object,required:!0}},emits:["edit"],computed:{showWatchlistTag(){return this.item.category==="watchlist"||this.item.isNew===!0},isWatchlistItem(){return this.item.category==="watchlist"||this.item.isNew===!0}},methods:{getImageUrl(i){return i?i.startsWith("http")?i.startsWith("http://")?i.replace("http://","https://"):i:i.startsWith("/")?i:`/storage/${i}`:""},handleImageError(i){var t;i.target.style.display="none",(t=i.target.nextElementSibling)==null||t.classList.add("show")},formatDate(i){return i?new Date(i).toLocaleDateString():""},editItem(){this.$emit("edit",this.item)},getWatchlistReleaseStatus(){if(!this.item.release)return"";const i=new Date(this.item.release),t=new Date;t.setHours(0,0,0,0),i.setHours(0,0,0,0);const a=i.getTime()-t.getTime(),e=Math.ceil(a/(1e3*3600*24));if(e>0)return e===1?"Tomorrow!":e<=7?`${e} days left`:e<=30?`${e} days left`:`${Math.ceil(e/30)} months left`;if(e===0)return"Released today!";{const c=this.getTypeTagText().toLowerCase();return c==="game"?"Unplayed yet":c==="series"||c==="movie"?"Unwatched yet":c==="buecher"?"Unread yet":"Unconsumed yet"}},getWatchlistReleaseStatusClass(){if(!this.item.release)return"";const i=new Date(this.item.release),t=new Date;t.setHours(0,0,0,0),i.setHours(0,0,0,0);const a=i.getTime()-t.getTime(),e=Math.ceil(a/(1e3*3600*24));return e>0?"countdown":e===0?"released-today":"unconsumed"},getTypeTagText(){var t,a,e;const i=this.item.watchlistType||this.item.watchlist_type;if(i)return i.charAt(0).toUpperCase()+i.slice(1);if(this.item.genre){const c=this.item.genre.toLowerCase();if(c.includes("game")||c.includes("gaming")||(t=this.item.platforms)!=null&&t.toLowerCase().includes("steam")||(a=this.item.platforms)!=null&&a.toLowerCase().includes("ps")||(e=this.item.platforms)!=null&&e.toLowerCase().includes("xbox"))return"Game";if(c.includes("series")||c.includes("tv")||c.includes("episode")||this.item.isAiring)return"Series";if(c.includes("movie")||c.includes("film")||c.includes("cinema"))return"Movie";if(c.includes("book")||c.includes("literature")||c.includes("novel")||c.includes("author"))return"BÃ¼cher"}if(this.item.platforms){const c=this.item.platforms.toLowerCase();if(c.includes("steam")||c.includes("ps")||c.includes("xbox")||c.includes("nintendo")||c.includes("pc"))return"Game";if(c.includes("netflix")||c.includes("hulu")||c.includes("disney")||c.includes("hbo"))return"Series";if(c.includes("cinema")||c.includes("theater"))return"Movie";if(c.includes("book")||c.includes("kindle")||c.includes("audible")||c.includes("author"))return"BÃ¼cher"}return"Media"},getTypeTagClass(){return`type-${this.getTypeTagText().toLowerCase()}`},getNextSeasonCountdown(){if(!this.item.nextSeasonRelease)return"";const i=new Date(this.item.nextSeasonRelease),t=new Date;t.setHours(0,0,0,0),i.setHours(0,0,0,0);const a=i.getTime()-t.getTime(),e=Math.ceil(a/(1e3*3600*24));return e>0?e===1?"Tomorrow!":e<=7?`${e} days`:e<=30?`${e} days`:`${Math.ceil(e/30)} months`:e===0?"Today!":"Released"},getCategoryClass(){var t;const i=(t=this.item.category)==null?void 0:t.toLowerCase();return i==="movies"||i==="movie"?"category-movies":i==="books"||i==="buecher"?"category-books":i==="series"||i==="tv"?"category-series":i==="games"||i==="game"?"category-games":"category-default"},getCategoryIcon(){var t;const i=(t=this.item.category)==null?void 0:t.toLowerCase();return i==="movies"||i==="movie"?"ðŸŽ¬":i==="books"||i==="buecher"?"ðŸ“š":i==="series"||i==="tv"?"ðŸ“º":i==="games"||i==="game"?"ðŸŽ®":"ðŸ“"},getCategoryStyle(){var t;const i=(t=this.item.category)==null?void 0:t.toLowerCase();if(i==="games"||i==="game"){const a=this.item.rating||0;return this.getGameStyleByRating(a)}return{}},getGameStyleByRating(i){return i>=4.5?{"--game-primary":"#ffd700","--game-secondary":"#ffed4e","--game-accent":"#ff6b35","--game-glow":"0 0 20px rgba(255, 215, 0, 0.6)","--game-border":"3px solid #ffd700"}:i>=4?{"--game-primary":"#00d4ff","--game-secondary":"#4a9eff","--game-accent":"#00ff88","--game-glow":"0 0 15px rgba(0, 212, 255, 0.5)","--game-border":"3px solid #00d4ff"}:i>=3.5?{"--game-primary":"#00ff88","--game-secondary":"#4caf50","--game-accent":"#8bc34a","--game-glow":"0 0 12px rgba(0, 255, 136, 0.4)","--game-border":"3px solid #00ff88"}:i>=3?{"--game-primary":"#ff9800","--game-secondary":"#ffc107","--game-accent":"#ff5722","--game-glow":"0 0 10px rgba(255, 152, 0, 0.3)","--game-border":"3px solid #ff9800"}:i>=2?{"--game-primary":"#ff5722","--game-secondary":"#f44336","--game-accent":"#d32f2f","--game-glow":"0 0 8px rgba(255, 87, 34, 0.3)","--game-border":"3px solid #ff5722"}:{"--game-primary":"#9e9e9e","--game-secondary":"#757575","--game-accent":"#616161","--game-glow":"0 0 5px rgba(158, 158, 158, 0.2)","--game-border":"3px solid #9e9e9e"}}}},vt={class:"media-image"},pt=["src","alt"],yt={key:1,class:"no-image"},ht={class:"no-image-icon"},wt={class:"media-info"},bt={class:"media-title"},St={class:"media-meta"},It={key:0,class:"media-release"},Ct={key:1},kt={key:1,class:"media-rating"},Tt={key:0,class:"media-platforms"},_t={key:1,class:"media-genre"},At={key:2,class:"media-description"},xt={key:3,class:"media-airing"},Mt={key:0,class:"next-season"},Dt={key:1,class:"countdown"},Ut={key:4,class:"watchlist-type-tag"};function Rt(i,t,a,e,c,f){return l(),d("div",{class:Y(["media-item",f.getCategoryClass()]),style:je(f.getCategoryStyle()),onClick:t[1]||(t[1]=(...s)=>f.editItem&&f.editItem(...s))},[o("div",vt,[a.item.path?(l(),d("img",{key:0,src:f.getImageUrl(a.item.path),alt:a.item.title,onError:t[0]||(t[0]=(...s)=>f.handleImageError&&f.handleImageError(...s))},null,40,pt)):(l(),d("div",yt,[o("span",ht,u(f.getCategoryIcon()),1)]))]),o("div",wt,[o("h3",bt,u(a.item.title),1),o("div",St,[a.item.release?(l(),d("span",It,[f.isWatchlistItem&&a.item.release?(l(),d("span",{key:0,class:Y(f.getWatchlistReleaseStatusClass())},u(f.getWatchlistReleaseStatus()),3)):(l(),d("span",Ct,u(f.formatDate(a.item.release)),1))])):g("",!0),a.item.rating?(l(),d("span",kt,u("â˜…".repeat(Math.max(0,Math.min(5,Math.floor(a.item.rating)))))+u("â˜†".repeat(Math.max(0,5-Math.max(0,Math.min(5,Math.floor(a.item.rating)))))),1)):g("",!0)]),a.item.platforms?(l(),d("div",Tt,u(a.item.platforms),1)):g("",!0),a.item.genre?(l(),d("div",_t,u(a.item.genre),1)):g("",!0),a.item.description?(l(),d("div",At,u(a.item.description),1)):g("",!0),a.item.isAiring?(l(),d("div",xt,[t[2]||(t[2]=o("span",{class:"airing-badge"},[o("span",{class:"airing-dot"}),ve(" Airing ")],-1)),a.item.nextSeason?(l(),d("span",Mt,"S"+u(a.item.nextSeason),1)):g("",!0),a.item.nextSeasonRelease?(l(),d("span",Dt,u(f.getNextSeasonCountdown()),1)):g("",!0)])):g("",!0),f.showWatchlistTag?(l(),d("div",Ut,[o("span",{class:Y(["type-tag",f.getTypeTagClass()])},u(f.getTypeTagText()),3)])):g("",!0)]),t[3]||(t[3]=o("div",{class:"edit-indicator"},[o("span",{class:"edit-icon"},"âœï¸")],-1))],6)}const Et=Z(ft,[["render",Rt],["__scopeId","data-v-a0d9c4df"]]),Ft={name:"FloatingActionButton",props:{showMenu:{type:Boolean,default:!1},showDeleteAll:{type:Boolean,default:!1},categoryName:{type:String,default:""},itemCount:{type:Number,default:0}},emits:["toggleMenu","addNewItem","bulkAddItems","importFromTxt","importFromAPI","createCollection","deleteAllInCategory"]},Pt={class:"floating-actions"},Lt={class:"menu-text"},Bt={class:"item-count-badge"};function Nt(i,t,a,e,c,f){return l(),d("div",Pt,[o("div",{class:Y(["floating-menu",{show:a.showMenu}])},[o("button",{class:"floating-menu-item",onClick:t[0]||(t[0]=s=>i.$emit("addNewItem"))},[...t[7]||(t[7]=[o("span",{class:"menu-icon"},"âž•",-1),o("span",{class:"menu-text"},"Add Item",-1)])]),o("button",{class:"floating-menu-item",onClick:t[1]||(t[1]=s=>i.$emit("bulkAddItems"))},[...t[8]||(t[8]=[o("span",{class:"menu-icon"},"ðŸ“¦",-1),o("span",{class:"menu-text"},"Bulk Add",-1)])]),o("button",{class:"floating-menu-item",onClick:t[2]||(t[2]=s=>i.$emit("importFromTxt"))},[...t[9]||(t[9]=[o("span",{class:"menu-icon"},"ðŸ“„",-1),o("span",{class:"menu-text"},"Import from TXT",-1)])]),o("button",{class:"floating-menu-item",onClick:t[3]||(t[3]=s=>i.$emit("importFromAPI"))},[...t[10]||(t[10]=[o("span",{class:"menu-icon"},"ðŸŒ",-1),o("span",{class:"menu-text"},"Import from API",-1)])]),o("button",{class:"floating-menu-item",onClick:t[4]||(t[4]=s=>i.$emit("createCollection"))},[...t[11]||(t[11]=[o("span",{class:"menu-icon"},"ðŸ“š",-1),o("span",{class:"menu-text"},"Create Collection",-1)])]),a.showDeleteAll&&a.itemCount>0?(l(),d("button",{key:0,class:"floating-menu-item delete-all-item",onClick:t[5]||(t[5]=s=>i.$emit("deleteAllInCategory"))},[t[12]||(t[12]=o("span",{class:"menu-icon"},"ðŸ—‘ï¸",-1)),o("span",Lt,"Delete All "+u(a.categoryName),1),o("span",Bt,"("+u(a.itemCount)+")",1)])):g("",!0)],2),o("button",{class:"floating-add-btn",onClick:t[6]||(t[6]=s=>i.$emit("toggleMenu"))},u(a.showMenu?"âœ•":"+"),1)])}const Vt=Z(Ft,[["render",Nt],["__scopeId","data-v-19731834"]]),Je="http://127.0.0.1:8000/api",Gt={async getConfig(){try{console.log("ðŸ“š Simple Google Books - Getting config...");const i=await fetch(`${Je}/google-books-config`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);const t=await i.json();return console.log("ðŸ“š Simple Google Books - Config loaded:",t),t}catch(i){throw console.error("ðŸ“š Simple Google Books - Config failed:",i),i}},async searchBooks(i,t=10){try{console.log("ðŸ“š Simple Google Books - Searching:",i);const a=await fetch(`${Je}/google-books/search?q=${encodeURIComponent(i)}&maxResults=${t}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const e=await a.json();return console.log("ðŸ“š Simple Google Books - Search success:",e),e}catch(a){throw console.error("ðŸ“š Simple Google Books - Search failed:",a),a}}},zt={name:"EditModal",props:{item:{type:Object,default:null},currentCategory:{type:String,default:"watchlist"}},emits:["close","save","delete"],setup(i,{emit:t}){const a=p(!1),e=p(""),c=p([]),f=p(null),s=p(null),w=p(""),r=Ze({category:"watchlist",title:"",release:"",rating:"",count:"",platforms:"",genre:"",description:"",link:"",path:"",discovered:"",spielzeit:"",isAiring:!1,nextSeason:"",nextSeasonRelease:"",imageUrl:"",watchlistType:""}),k=P(()=>!!i.item),_=P(()=>r.category==="game"),E=P(()=>r.category==="series"),z=P(()=>r.category==="watchlist");Se(()=>i.item,n=>{n?(console.log("ðŸ” [EditModal] Loading item into form:",{genre:n.genre,description:n.description,fullItem:n}),Object.keys(r).forEach(v=>{n.hasOwnProperty(v)&&n[v]!==null&&n[v]!==void 0&&(r[v]=n[v])}),console.log("ðŸ” [EditModal] Form after loading:",{genre:r.genre,description:r.description})):Object.keys(r).forEach(v=>{v==="category"?r[v]=i.currentCategory||"watchlist":v==="release"?r[v]=new Date().toISOString().split("T")[0]:r[v]=""})},{immediate:!0}),Se(()=>i.currentCategory,n=>{!i.item&&n&&(r.category=n)});const W=async()=>{if(!r.title){e.value="Title is required";return}if(r.category==="watchlist"&&!r.watchlistType){e.value="Please select a type for watchlist items";return}if(r.category==="watchlist"&&!r.release){e.value="Release date is required for watchlist items";return}a.value=!0,e.value="";try{const n={...r};console.log("ðŸ” [EditModal] Saving item data:",{genre:n.genre,description:n.description,fullItemData:n}),w.value?(n.path=w.value,n.imageUrl=w.value):n.imageUrl&&n.imageUrl.trim()?n.path||(n.path=n.imageUrl):((!n.imageUrl||n.imageUrl.trim()==="")&&(n.imageUrl=null),(!n.path||n.path.trim()==="")&&(n.path=null)),Object.keys(n).forEach(v=>{n[v]===""&&v!=="watchlistType"&&(n[v]=null)}),n.rating&&(n.rating=parseFloat(n.rating)),n.count&&(n.count=parseInt(n.count)),n.spielzeit&&(n.spielzeit=parseInt(n.spielzeit)),n.nextSeason&&(n.nextSeason=parseInt(n.nextSeason)),await re(n)}catch(n){n.isDuplicate?e.value=n.message:e.value=n.message||"Failed to save item"}finally{a.value=!1}},N=()=>{e.value="",t("close")},M=()=>{t("delete",i.item),N()},Q=async()=>{if(w.value){c.value=[];return}if(f.value&&clearTimeout(f.value),!r.title||r.title.length<3){c.value=[];return}f.value=setTimeout(async()=>{try{const n=r.category==="watchlist"?r.watchlistType:r.category;if(r.category==="watchlist"&&!r.watchlistType){c.value=[];return}let v=[],F=[];if(n==="buecher"){const S=await Gt.searchBooks(r.title,10);S.success&&S.data&&(F=S.data.map(x=>({title:x.title,release:x.publishedDate?G(x.publishedDate):"",genre:x.categories?x.categories.join(", "):"",platforms:"",link:x.infoLink||x.previewLink||"",imageUrl:x.imageUrl||"",rating:"",apiSource:"google_books",id:x.id,author:x.author,description:x.description,publisher:x.publisher,isbn10:x.isbn10,isbn13:x.isbn13})))}else v=await We.searchApi(r.title,n,10),v&&v.length>0&&(F=v.map(S=>({title:S.title,release:S.release,genre:S.genre||S.genres||"",platforms:S.platforms||"",link:S.link||"",imageUrl:S.image||"",rating:S.rating||"",apiSource:S.api_source||"",id:S.id||"",description:S.overview||""})));F.length>0?c.value=F:c.value=[{title:`"${r.title}" - Keine Ergebnisse gefunden`,release:"",genre:"Bitte manuell ausfÃ¼llen",isPlaceholder:!0}]}catch{c.value=[{title:`"${r.title}" - API nicht verfÃ¼gbar`,release:"",genre:"Bitte manuell ausfÃ¼llen",isPlaceholder:!0}]}},500)},$=async n=>{if(n.isPlaceholder){c.value=[];return}if(console.log("ðŸ” [EditModal] Selecting API result:",{title:n.title,genre:n.genre,fullResult:n}),r.title=n.title,n.release&&(r.release=n.release),n.platforms&&(r.platforms=n.platforms),n.genre&&(r.genre=n.genre,console.log("ðŸ” [EditModal] Set genre from API:",n.genre)),n.link&&(r.link=n.link),n.rating&&(r.rating=n.rating),n.description&&(r.description=n.description),!n.genre||n.genre.trim()===""){console.log("No genre provided, trying to extract from description...");const v=n.description||n.overview||"",F=q(v);if(F.length>0)r.genre=F.join(", "),console.log("Extracted genre from description:",r.genre);else{const S=b(n.category,n.api_source);r.genre=S,console.log("Using category-based genre:",r.genre)}}else console.log("Genre already provided from API:",n.genre);if(n.apiSource==="google_books"&&(n.author&&(r.platforms=n.author),n.publisher)){const v=r.link||"";r.link=v||`Publisher: ${n.publisher}`}n.imageUrl&&(r.imageUrl=n.imageUrl,r.path||(r.path=n.imageUrl)),c.value=[]},K=n=>n?new Date(n).toLocaleDateString():"",q=n=>{if(!n)return[];const v={drama:["drama","dramatic","emotional","serious","tragedy"],comedy:["comedy","funny","humor","comic","laugh"],action:["action","fight","battle","adventure","thriller","martial arts","champion","defend"],horror:["horror","scary","frightening","terror","monster"],romance:["romance","love","romantic","relationship"],mystery:["mystery","detective","investigation","crime","suspense"],"sci-fi":["sci-fi","science fiction","futuristic","space","alien","extraterrestrial"],fantasy:["fantasy","magic","supernatural","wizard","fairy tale"],thriller:["thriller","suspense","tense","edge-of-seat"],documentary:["documentary","real","factual","educational"],animation:["animation","animated","cartoon","anime"],adventure:["adventure","journey","quest","exploration"]},F=[],S=n.toLowerCase();for(const[x,J]of Object.entries(v))J.some(X=>S.includes(X))&&F.push(x.charAt(0).toUpperCase()+x.slice(1));return F.slice(0,3)},b=(n,v)=>({series:"Drama, Action, Adventure",movie:"Drama, Action, Adventure",game:"Action, Adventure, RPG",buecher:"Fiction, Non-fiction"})[n]||"Drama",G=n=>{if(!n)return"";let v;if(typeof n=="string"){if(/^\d{4}$/.test(n))return`${n}-01-01`;if(/^\d{4}-\d{2}$/.test(n))return`${n}-01`;if(/^\d{4}-\d{2}-\d{2}$/.test(n))return n;v=new Date(n)}else v=new Date(n);return isNaN(v.getTime())?"":v.toISOString().split("T")[0]},H=n=>n&&(n.startsWith("http://")?n.replace("http://","https://"):n),se=()=>{var x;if(!r.release)return"";const n=new Date(r.release),v=new Date;v.setHours(0,0,0,0),n.setHours(0,0,0,0);const F=n.getTime()-v.getTime(),S=Math.ceil(F/(1e3*3600*24));if(S>0)return S===1?"Tomorrow!":S<=7?`${S} days left`:S<=30?`${S} days left`:`${Math.ceil(S/30)} months left`;if(S===0)return"Released today!";{const J=((x=r.watchlistType)==null?void 0:x.toLowerCase())||"media";return J==="game"?"Unplayed yet":J==="series"||J==="movie"?"Unwatched yet":"Unconsumed yet"}},ee=()=>{var n;(n=s.value)==null||n.click()},j=async n=>{const v=n.target.files[0];if(v){if(!v.type.startsWith("image/")){e.value="Please select a valid image file";return}if(v.size>10*1024*1024){e.value="Image file too large. Maximum size is 10MB";return}a.value=!0,e.value="";try{const F=r.title.replace(/[^a-zA-Z0-9\s\-_\.]/g,"").trim()||"item",S=Date.now(),x=v.name.split(".").pop()||"jpg",J=`images_downloads/uploads/${F}_${S}.${x}`,X=await We.uploadImage(v,J);X.success?(w.value=X.saved,r.path=X.saved,r.imageUrl=X.saved):e.value=X.error||"Failed to upload image"}catch(F){e.value=F.message||"Failed to upload image"}finally{a.value=!1}}},D=()=>w.value?`/storage/${w.value}`:r.imageUrl?r.imageUrl.startsWith("http")?r.imageUrl:`/storage/${r.imageUrl}`:"",A=n=>{n.target.style.display="none"},C=()=>{r.imageUrl="",r.path="",w.value="",s.value&&(s.value.value="")},L=()=>{w.value="",r.imageUrl===w.value&&(r.imageUrl=""),r.path===w.value&&(r.path=""),s.value&&(s.value.value="")},re=async n=>{const v=Ie();i.item?await v.updateMediaItem(i.item.id,n):await v.addMediaItem(n),N()};return{form:r,loading:a,error:e,apiResults:c,isEditing:k,isGame:_,isSeries:E,isWatchlist:z,imageUploadRef:s,uploadedImagePath:w,handleSave:W,closeModal:N,deleteItem:M,searchApi:Q,selectApiResult:$,formatDate:K,formatDateForInput:G,ensureHttpsUrl:H,getReleasePreview:se,triggerImageUpload:ee,handleImageUpload:j,getImagePreviewUrl:D,handleImageError:A,clearImage:C,removeUploadedImage:L}}},Wt={class:"form-header"},jt={class:"form-group category-group"},Ot={class:"form-group title-group"},qt={class:"search-container"},Ht=["placeholder","disabled"],Qt={key:0,class:"search-results"},Kt=["onClick"],Jt={class:"result-thumbnail"},Xt=["src","alt"],Yt={key:1,class:"no-image"},Zt={class:"result-content"},$t={class:"result-title"},eo={class:"result-meta"},to={key:0},oo={key:1},so={key:2,class:"rating"},no={class:"form-row"},ao={class:"form-group"},io={for:"release"},ro={key:0,class:"required"},lo=["required"],co={key:0,class:"field-hint"},mo={key:1,class:"release-preview"},uo={class:"form-group"},go={class:"form-row"},fo={class:"form-group"},vo={class:"form-group"},po={class:"form-row"},yo={class:"form-group"},ho={class:"form-group"},wo={class:"form-row"},bo={class:"form-group full-width"},So={key:0,class:"form-row"},Io={class:"form-group"},Co={key:0,class:"field-error"},ko={class:"form-row"},To={class:"form-group"},_o={class:"form-group"},Ao={key:1,class:"form-row"},xo={class:"form-group"},Mo={key:2,class:"form-row"},Do={class:"form-group"},Uo={key:0,class:"form-group"},Ro={key:3,class:"form-row"},Eo={class:"form-group"},Fo={class:"form-row"},Po={class:"form-group"},Lo={class:"form-group"},Bo={class:"image-upload-container"},No=["disabled"],Vo={key:0,class:"upload-success"},Go={key:4,class:"form-row"},zo={class:"form-group image-preview-group"},Wo={class:"image-preview"},jo=["src","alt"],Oo={key:5,class:"error-message"},qo={class:"modal-buttons"},Ho=["disabled"],Qo=["disabled"],Ko=["disabled"],Jo=["disabled"];function Xo(i,t,a,e,c,f){return l(),d("div",{class:"modal",onClick:t[28]||(t[28]=(...s)=>e.closeModal&&e.closeModal(...s))},[o("div",{class:"modal-content",onClick:t[27]||(t[27]=oe(()=>{},["stop"]))},[o("h2",null,u(e.isEditing?"Edit Item":"Add Item"),1),o("form",{onSubmit:t[26]||(t[26]=oe((...s)=>e.handleSave&&e.handleSave(...s),["prevent"]))},[o("div",Wt,[o("div",jt,[t[30]||(t[30]=o("label",{for:"category"},"Category:",-1)),U(o("select",{id:"category","onUpdate:modelValue":t[0]||(t[0]=s=>e.form.category=s),required:""},[...t[29]||(t[29]=[ze('<option value="watchlist" data-v-e0ec6e02>Watchlist</option><option value="game" data-v-e0ec6e02>Game</option><option value="series" data-v-e0ec6e02>Series</option><option value="movie" data-v-e0ec6e02>Movie</option><option value="buecher" data-v-e0ec6e02>BÃ¼cher</option>',5)])],512),[[pe,e.form.category]])]),o("div",Ot,[t[31]||(t[31]=o("label",{for:"title"},"Title:",-1)),o("div",qt,[U(o("input",{type:"text",id:"title","onUpdate:modelValue":t[1]||(t[1]=s=>e.form.title=s),onInput:t[2]||(t[2]=(...s)=>e.searchApi&&e.searchApi(...s)),required:"",placeholder:e.isWatchlist?"Enter title (API search + manual input available)":"Enter title",disabled:e.loading},null,40,Ht),[[B,e.form.title]]),e.apiResults.length>0?(l(),d("div",Qt,[(l(!0),d(ae,null,ie(e.apiResults,s=>(l(),d("div",{key:s.title,class:"search-result-item",onClick:w=>e.selectApiResult(s)},[o("div",Jt,[s.imageUrl?(l(),d("img",{key:0,src:e.ensureHttpsUrl(s.imageUrl),alt:s.title},null,8,Xt)):(l(),d("div",Yt,[o("span",null,u(s.title.charAt(0).toUpperCase()),1)]))]),o("div",Zt,[o("div",$t,u(s.title),1),o("div",eo,[s.release?(l(),d("span",to,u(e.formatDate(s.release)),1)):g("",!0),s.genre?(l(),d("span",oo,u(s.genre),1)):g("",!0),s.rating?(l(),d("span",so,"â­ "+u(s.rating),1)):g("",!0)])])],8,Kt))),128))])):g("",!0)])])]),o("div",no,[o("div",ao,[o("label",io,[ve(u(e.isWatchlist?"Release Date:":"Release:")+" ",1),e.isWatchlist?(l(),d("span",ro,"*")):g("",!0)]),U(o("input",{type:"date",id:"release","onUpdate:modelValue":t[3]||(t[3]=s=>e.form.release=s),required:e.isWatchlist},null,8,lo),[[B,e.form.release]]),e.isWatchlist?(l(),d("div",co," ðŸ“… Set the release date to track countdown or status ")):g("",!0),e.isWatchlist&&e.form.release?(l(),d("div",mo,[t[32]||(t[32]=o("strong",null,"Preview:",-1)),ve(" "+u(e.getReleasePreview()),1)])):g("",!0)]),o("div",uo,[t[33]||(t[33]=o("label",{for:"rating"},"Rating:",-1)),U(o("input",{type:"number",id:"rating","onUpdate:modelValue":t[4]||(t[4]=s=>e.form.rating=s),step:"0.1",min:"0",max:"10",placeholder:"0-10"},null,512),[[B,e.form.rating]])])]),o("div",go,[o("div",fo,[t[34]||(t[34]=o("label",{for:"views"},"Views:",-1)),U(o("input",{type:"number",id:"views","onUpdate:modelValue":t[5]||(t[5]=s=>e.form.count=s),min:"0",placeholder:"0"},null,512),[[B,e.form.count]])]),o("div",vo,[t[35]||(t[35]=o("label",{for:"discovered"},"Discovered:",-1)),U(o("input",{type:"date",id:"discovered","onUpdate:modelValue":t[6]||(t[6]=s=>e.form.discovered=s)},null,512),[[B,e.form.discovered]])])]),o("div",po,[o("div",yo,[t[36]||(t[36]=o("label",{for:"platforms"},"Platforms:",-1)),U(o("input",{type:"text",id:"platforms","onUpdate:modelValue":t[7]||(t[7]=s=>e.form.platforms=s),placeholder:"PC, PS5, Xbox"},null,512),[[B,e.form.platforms]])]),o("div",ho,[t[37]||(t[37]=o("label",{for:"genre"},"Genre:",-1)),U(o("input",{type:"text",id:"genre","onUpdate:modelValue":t[8]||(t[8]=s=>e.form.genre=s),placeholder:"Action, Adventure, RPG"},null,512),[[B,e.form.genre]])])]),o("div",wo,[o("div",bo,[t[38]||(t[38]=o("label",{for:"description"},"Description:",-1)),U(o("textarea",{id:"description","onUpdate:modelValue":t[9]||(t[9]=s=>e.form.description=s),placeholder:"Enter a description...",rows:"3"},null,512),[[B,e.form.description]])])]),e.form.category==="watchlist"?(l(),d("div",So,[o("div",Io,[t[40]||(t[40]=o("label",{for:"watchlistType"},[ve("Type: "),o("span",{class:"required"},"*")],-1)),U(o("select",{id:"watchlistType","onUpdate:modelValue":t[10]||(t[10]=s=>e.form.watchlistType=s)},[...t[39]||(t[39]=[ze('<option value="" data-v-e0ec6e02>Select Type</option><option value="game" data-v-e0ec6e02>Game</option><option value="series" data-v-e0ec6e02>Series</option><option value="movie" data-v-e0ec6e02>Movie</option><option value="buecher" data-v-e0ec6e02>BÃ¼cher</option>',5)])],512),[[pe,e.form.watchlistType]]),e.form.category==="watchlist"&&!e.form.watchlistType?(l(),d("div",Co," Please select a type for watchlist items ")):g("",!0)])])):g("",!0),o("div",ko,[o("div",To,[t[41]||(t[41]=o("label",{for:"link"},"Link:",-1)),U(o("input",{type:"url",id:"link","onUpdate:modelValue":t[11]||(t[11]=s=>e.form.link=s),placeholder:"https://..."},null,512),[[B,e.form.link]])]),o("div",_o,[t[42]||(t[42]=o("label",{for:"path"},"Image Path:",-1)),U(o("input",{type:"text",id:"path","onUpdate:modelValue":t[12]||(t[12]=s=>e.form.path=s),placeholder:"images/movies/filename.jpg"},null,512),[[B,e.form.path]])])]),e.isGame?(l(),d("div",Ao,[o("div",xo,[t[43]||(t[43]=o("label",{for:"playtime"},"Playtime (Minutes):",-1)),U(o("input",{type:"number",id:"playtime","onUpdate:modelValue":t[13]||(t[13]=s=>e.form.spielzeit=s),min:"0",placeholder:"0"},null,512),[[B,e.form.spielzeit]])])])):g("",!0),e.isSeries?(l(),d("div",Mo,[o("div",Do,[t[45]||(t[45]=o("label",{for:"isAiring"},"Status:",-1)),U(o("select",{id:"isAiring","onUpdate:modelValue":t[14]||(t[14]=s=>e.form.isAiring=s)},[...t[44]||(t[44]=[o("option",{value:!1},"Finished",-1),o("option",{value:!0},"Airing",-1)])],512),[[pe,e.form.isAiring]])]),e.form.isAiring?(l(),d("div",Uo,[t[46]||(t[46]=o("label",{for:"nextSeason"},"Next Season:",-1)),U(o("input",{type:"number",id:"nextSeason","onUpdate:modelValue":t[15]||(t[15]=s=>e.form.nextSeason=s),min:"1",placeholder:"1"},null,512),[[B,e.form.nextSeason]])])):g("",!0)])):g("",!0),e.form.isAiring?(l(),d("div",Ro,[o("div",Eo,[t[47]||(t[47]=o("label",{for:"nextSeasonRelease"},"Next Season Release:",-1)),U(o("input",{type:"date",id:"nextSeasonRelease","onUpdate:modelValue":t[16]||(t[16]=s=>e.form.nextSeasonRelease=s)},null,512),[[B,e.form.nextSeasonRelease]])])])):g("",!0),o("div",Fo,[o("div",Po,[t[48]||(t[48]=o("label",{for:"imageUrl"},"Image URL (optional):",-1)),U(o("input",{type:"text",id:"imageUrl","onUpdate:modelValue":t[17]||(t[17]=s=>e.form.imageUrl=s),placeholder:"https://... or leave empty for API images"},null,512),[[B,e.form.imageUrl]])]),o("div",Lo,[t[49]||(t[49]=o("label",{for:"imageUpload"},"Upload Image:",-1)),o("div",Bo,[o("input",{type:"file",id:"imageUpload",ref:"imageUploadRef",onChange:t[18]||(t[18]=(...s)=>e.handleImageUpload&&e.handleImageUpload(...s)),accept:"image/*",style:{display:"none"}},null,544),o("button",{type:"button",onClick:t[19]||(t[19]=(...s)=>e.triggerImageUpload&&e.triggerImageUpload(...s)),class:"upload-btn",disabled:e.loading}," ðŸ“ Choose Image ",8,No),e.uploadedImagePath?(l(),d("div",Vo,[ve(" âœ… Image uploaded: "+u(e.uploadedImagePath)+" ",1),o("button",{type:"button",onClick:t[20]||(t[20]=(...s)=>e.removeUploadedImage&&e.removeUploadedImage(...s)),class:"remove-uploaded-btn",title:"Remove uploaded image to enable API search"}," âœ• Remove ")])):g("",!0)])])]),e.form.imageUrl||e.uploadedImagePath?(l(),d("div",Go,[o("div",zo,[t[50]||(t[50]=o("label",null,"Image Preview:",-1)),o("div",Wo,[o("img",{src:e.getImagePreviewUrl(),alt:e.form.title,onError:t[21]||(t[21]=(...s)=>e.handleImageError&&e.handleImageError(...s))},null,40,jo),o("button",{type:"button",onClick:t[22]||(t[22]=(...s)=>e.clearImage&&e.clearImage(...s)),class:"clear-image-btn",title:"Remove image"}," âœ• ")])])])):g("",!0),e.error?(l(),d("div",Oo,u(e.error),1)):g("",!0),o("div",qo,[o("button",{type:"submit",disabled:e.loading},u(e.loading?"Saving...":"Save"),9,Ho),o("button",{type:"button",onClick:t[23]||(t[23]=(...s)=>e.closeModal&&e.closeModal(...s)),disabled:e.loading}," Cancel ",8,Qo),e.isEditing?(l(),d("button",{key:0,type:"button",onClick:t[24]||(t[24]=(...s)=>e.deleteItem&&e.deleteItem(...s)),disabled:e.loading,class:"delete-btn"}," Delete ",8,Ko)):g("",!0),o("button",{type:"button",onClick:t[25]||(t[25]=(...s)=>e.handleSave&&e.handleSave(...s)),disabled:e.loading,class:"check-btn",title:"Add to list"}," âœ“ ",8,Jo)])],32)])])}const Yo=Z(zt,[["render",Xo],["__scopeId","data-v-e0ec6e02"]]),Zo={name:"BulkAddModal",props:{show:{type:Boolean,default:!1},currentCategory:{type:String,default:""}},emits:["close"],setup(i,{emit:t}){const a=Ie(),e=p(1),c=p(!1),f=p(!0),s=p(0),w=p(0),r=p(0),k=p(0),_=p(null),E=p(""),z=p(""),W=p([]),N=p([]),M=p({category:"",itemsText:"",defaultRating:null}),Q=P(()=>M.value.category&&M.value.itemsText.trim()&&!c.value),$=P(()=>{const D=K().length;return D>0?Math.round(s.value/D*100):0}),K=()=>!M.value.itemsText||!M.value.itemsText.trim()?[]:M.value.itemsText.split(`
`).map(D=>D.trim()).filter(D=>D.length>0).map(D=>{const A=D.split("|").map(C=>C.trim());return{searchTerm:A[0]||"",additionalInfo:A[1]||null}}),q=()=>{s.value=0,w.value=0,r.value=0,k.value=0,_.value=null,E.value="",z.value="",W.value=[],N.value=[]},b=(D,A,C)=>{_.value=D,E.value=A,z.value=C},G=(D,A,C="")=>{const L={searching:"Searching...",found:"Found",adding:"Adding...",added:"Added",skipped:"Skipped",error:"Error"}[A]||A;W.value.push({title:D,status:A,statusText:L,message:C})},H=async()=>{if(!Q.value)return;e.value=2,c.value=!0,f.value=!0,q();const D=K();try{for(let A=0;A<D.length;A++){const C=D[A];s.value=A+1,b({title:C.searchTerm,description:C.additionalInfo},"searching","Searching...");try{G(C.searchTerm,"searching","Searching API..."),console.log(`ðŸ” Searching for: "${C.searchTerm}" in category: ${M.value.category}`);const L=await We.searchApi(C.searchTerm,M.value.category,1);if(console.log(`ðŸ” Search results for "${C.searchTerm}":`,L),L&&L.length>0&&L[0]&&L[0].api_source&&L[0].image){const n=L[0];console.log(`âœ… Found real API data for "${C.searchTerm}":`,{title:n.title,api_source:n.api_source,has_image:!!n.image,has_genre:!!n.genre,has_release:!!n.release}),b({title:n.title,description:`Found: ${n.genre||"Unknown genre"} â€¢ ${n.release||"Unknown year"} â€¢ ${n.api_source}`},"found","Found in API with data"),G(C.searchTerm,"found",`Found: ${n.title} (${n.api_source})`),b({title:n.title},"adding","Adding to library...");const v={title:n.title,category:M.value.category,release:n.release||null,rating:n.rating?Math.round(n.rating):M.value.defaultRating||null,platforms:n.platforms||null,genre:n.genre||null,link:n.link||null,path:n.image||null,external_id:n.id||null,count:1,is_airing:!1,spielzeit:0,description:C.additionalInfo||null};await a.addMediaItem(v),w.value++,b({title:n.title},"added","Successfully added with API data"),G(C.searchTerm,"added",`Added: ${n.title} with API data`)}else console.log(`âŒ No real API data found for "${C.searchTerm}"`),b({title:C.searchTerm},"skipped","No API data found - will retry"),N.value.push({searchTerm:C.searchTerm,additionalInfo:C.additionalInfo}),r.value++,G(C.searchTerm,"skipped","No API data found - ready for retry")}catch(L){console.error(`Error processing "${C.searchTerm}":`,L),b({title:C.searchTerm},"error","Error occurred"),k.value++,G(C.searchTerm,"error",L.message||"Unknown error")}await new Promise(L=>setTimeout(L,500))}e.value=3,b(null,"","")}catch(A){console.error("Bulk processing error:",A),k.value++}finally{c.value=!1,f.value=!1}},se=()=>{c.value=!1,f.value=!1,e.value=1,q()},ee=()=>{const D=N.value.map(A=>A.additionalInfo?`${A.searchTerm} | ${A.additionalInfo}`:A.searchTerm).join(`
`);M.value.itemsText=D,s.value=0,w.value=0,k.value=0,_.value=null,E.value="",z.value="",W.value=[],e.value=1},j=()=>{e.value=1,c.value=!1,f.value=!0,q(),M.value={category:"",itemsText:"",defaultRating:null},t("close")};return Se(()=>i.show,D=>{D&&i.currentCategory?M.value.category=i.currentCategory:D||j()}),{currentStep:e,isProcessing:c,canCancel:f,processedCount:s,addedCount:w,skippedCount:r,errorCount:k,currentItem:_,currentItemStatus:E,currentItemStatusText:z,processingResults:W,skippedItems:N,bulkData:M,canStart:Q,progressPercentage:$,startProcessing:H,cancelProcessing:se,retrySkippedItems:ee,closeModal:j}}},$o={class:"modal-header"},es={class:"modal-body"},ts={key:0,class:"step-container"},os={class:"bulk-add-form"},ss={class:"form-group"},ns={class:"form-group"},as={class:"form-group"},is={key:1,class:"step-container"},rs={class:"processing-container"},ls={class:"progress-overview"},ds={class:"progress-stats"},cs={class:"stat"},ms={class:"stat-number"},us={class:"stat"},gs={class:"stat-number"},fs={class:"stat"},vs={class:"stat-number"},ps={class:"stat"},ys={class:"stat-number"},hs={class:"progress-bar"},ws={class:"progress-text"},bs={class:"current-item"},Ss={class:"current-item-header"},Is={class:"current-item-title"},Cs={key:0,class:"current-item-description"},ks={key:1,class:"api-data-indicator"},Ts={key:2,class:"no-api-indicator"},_s={class:"results-list"},As={class:"result-header"},xs={class:"result-title"},Ms={class:"result-status"},Ds={key:0,class:"result-message"},Us={key:2,class:"step-container"},Rs={class:"results-summary"},Es={class:"summary-stats"},Fs={class:"summary-stat success"},Ps={class:"stat-number"},Ls={class:"summary-stat warning"},Bs={class:"stat-number"},Ns={class:"summary-stat error"},Vs={class:"stat-number"},Gs={key:0,class:"retry-section"},zs={class:"retry-list"},Ws=["onUpdate:modelValue"],js={key:0,class:"retry-additional"},Os={key:1,class:"detailed-results"},qs={class:"results-list"},Hs={class:"result-header"},Qs={class:"result-title"},Ks={class:"result-status"},Js={key:0,class:"result-message"},Xs={class:"modal-footer"},Ys=["disabled"],Zs=["disabled"],$s={key:3,class:"footer-buttons"};function en(i,t,a,e,c,f){var s,w;return a.show?(l(),d("div",{key:0,class:"modal-overlay",onClick:t[10]||(t[10]=(...r)=>e.closeModal&&e.closeModal(...r))},[o("div",{class:"modal-content",onClick:t[9]||(t[9]=oe(()=>{},["stop"]))},[o("div",$o,[t[11]||(t[11]=o("h2",null,"Bulk Add Items",-1)),o("button",{class:"close-btn",onClick:t[0]||(t[0]=(...r)=>e.closeModal&&e.closeModal(...r))},"âœ•")]),o("div",es,[e.currentStep===1?(l(),d("div",ts,[t[17]||(t[17]=o("div",{class:"step-header"},[o("div",{class:"step-number"},"1"),o("h3",null,"Enter Your List")],-1)),o("div",os,[o("div",ss,[t[13]||(t[13]=o("label",{for:"category"},"Category *",-1)),U(o("select",{id:"category","onUpdate:modelValue":t[1]||(t[1]=r=>e.bulkData.category=r),required:""},[...t[12]||(t[12]=[ze('<option value="" data-v-45e8999c>Select Category</option><option value="game" data-v-45e8999c>Game</option><option value="series" data-v-45e8999c>Series</option><option value="movie" data-v-45e8999c>Movie</option><option value="buecher" data-v-45e8999c>BÃ¼cher</option><option value="watchlist" data-v-45e8999c>Watchlist</option>',6)])],512),[[pe,e.bulkData.category]])]),o("div",ns,[t[14]||(t[14]=o("label",{for:"items-text"},"Items (one per line) *",-1)),U(o("textarea",{id:"items-text","onUpdate:modelValue":t[2]||(t[2]=r=>e.bulkData.itemsText=r),placeholder:`Enter items one per line, for example:
The Witcher 3
Cyberpunk 2077
Red Dead Redemption 2`,rows:"10",required:""},null,512),[[B,e.bulkData.itemsText]]),t[15]||(t[15]=o("small",{class:"help-text"},"Enter one item per line. The system will automatically search and add each item individually.",-1))]),o("div",as,[t[16]||(t[16]=o("label",{for:"default-rating"},"Default Rating",-1)),U(o("input",{id:"default-rating","onUpdate:modelValue":t[3]||(t[3]=r=>e.bulkData.defaultRating=r),type:"number",min:"0",max:"10",step:"0.1",placeholder:"Optional rating for all items"},null,512),[[B,e.bulkData.defaultRating,void 0,{number:!0}]])])])])):g("",!0),e.currentStep===2?(l(),d("div",is,[t[22]||(t[22]=o("div",{class:"step-header"},[o("div",{class:"step-number"},"2"),o("h3",null,"Processing Items")],-1)),o("div",rs,[o("div",ls,[o("div",ds,[o("span",cs,[o("span",ms,u(e.processedCount),1),t[18]||(t[18]=o("span",{class:"stat-label"},"Processed",-1))]),o("span",us,[o("span",gs,u(e.addedCount),1),t[19]||(t[19]=o("span",{class:"stat-label"},"Added",-1))]),o("span",fs,[o("span",vs,u(e.skippedCount),1),t[20]||(t[20]=o("span",{class:"stat-label"},"Skipped",-1))]),o("span",ps,[o("span",ys,u(e.errorCount),1),t[21]||(t[21]=o("span",{class:"stat-label"},"Errors",-1))])]),o("div",hs,[o("div",{class:"progress-fill",style:je({width:e.progressPercentage+"%"})},null,4)]),o("div",ws,u(e.progressPercentage)+"% Complete",1)]),o("div",bs,[o("div",Ss,[o("span",Is,"Processing: "+u(((s=e.currentItem)==null?void 0:s.title)||"..."),1),o("span",{class:Y(["current-item-status",e.currentItemStatus])},u(e.currentItemStatusText),3)]),(w=e.currentItem)!=null&&w.description?(l(),d("div",Cs,u(e.currentItem.description),1)):g("",!0),e.currentItemStatus==="found"?(l(),d("div",ks," âœ… Real API data found with image and metadata ")):g("",!0),e.currentItemStatus==="skipped"?(l(),d("div",Ts," âŒ No API data found - will be retried ")):g("",!0)]),o("div",_s,[(l(!0),d(ae,null,ie(e.processingResults,(r,k)=>(l(),d("div",{key:k,class:Y(["result-item",r.status])},[o("div",As,[o("span",xs,u(r.title),1),o("span",Ms,u(r.statusText),1)]),r.message?(l(),d("div",Ds,u(r.message),1)):g("",!0)],2))),128))])])])):g("",!0),e.currentStep===3?(l(),d("div",Us,[t[29]||(t[29]=o("div",{class:"step-header"},[o("div",{class:"step-number"},"3"),o("h3",null,"Results")],-1)),o("div",Rs,[o("div",Es,[o("div",Fs,[o("span",Ps,u(e.addedCount),1),t[23]||(t[23]=o("span",{class:"stat-label"},"Successfully Added",-1))]),o("div",Ls,[o("span",Bs,u(e.skippedCount),1),t[24]||(t[24]=o("span",{class:"stat-label"},"Not Found (Ready for Retry)",-1))]),o("div",Ns,[o("span",Vs,u(e.errorCount),1),t[25]||(t[25]=o("span",{class:"stat-label"},"Errors",-1))])]),e.skippedItems.length>0?(l(),d("div",Gs,[t[26]||(t[26]=o("h4",null,"Items Not Found - Ready for Retry",-1)),t[27]||(t[27]=o("p",{class:"retry-description"}," The following items were not found in the API. You can edit them and try again: ",-1)),o("div",zs,[(l(!0),d(ae,null,ie(e.skippedItems,(r,k)=>(l(),d("div",{key:k,class:"retry-item"},[U(o("input",{"onUpdate:modelValue":_=>r.searchTerm=_,class:"retry-input",placeholder:"Edit search term..."},null,8,Ws),[[B,r.searchTerm]]),r.additionalInfo?(l(),d("span",js," | "+u(r.additionalInfo),1)):g("",!0)]))),128))])])):g("",!0),e.processingResults.length>0?(l(),d("div",Os,[t[28]||(t[28]=o("h4",null,"Detailed Results",-1)),o("div",qs,[(l(!0),d(ae,null,ie(e.processingResults,(r,k)=>(l(),d("div",{key:k,class:Y(["result-item",r.status])},[o("div",Hs,[o("span",Qs,u(r.title),1),o("span",Ks,u(r.statusText),1)]),r.message?(l(),d("div",Js,u(r.message),1)):g("",!0)],2))),128))])])):g("",!0)])])):g("",!0)]),o("div",Xs,[e.currentStep===1?(l(),d("button",{key:0,class:"btn btn-secondary",onClick:t[4]||(t[4]=(...r)=>e.closeModal&&e.closeModal(...r))}," Cancel ")):g("",!0),e.currentStep===1?(l(),d("button",{key:1,class:"btn btn-primary",onClick:t[5]||(t[5]=(...r)=>e.startProcessing&&e.startProcessing(...r)),disabled:!e.canStart}," Check All and Add ",8,Ys)):g("",!0),e.currentStep===2?(l(),d("button",{key:2,class:"btn btn-secondary",onClick:t[6]||(t[6]=(...r)=>e.cancelProcessing&&e.cancelProcessing(...r)),disabled:!e.canCancel}," Cancel ",8,Zs)):g("",!0),e.currentStep===3?(l(),d("div",$s,[e.skippedItems.length>0?(l(),d("button",{key:0,class:"btn btn-warning",onClick:t[7]||(t[7]=(...r)=>e.retrySkippedItems&&e.retrySkippedItems(...r))}," Retry "+u(e.skippedItems.length)+" Items ",1)):g("",!0),o("button",{class:"btn btn-primary",onClick:t[8]||(t[8]=(...r)=>e.closeModal&&e.closeModal(...r))}," Done ")])):g("",!0)])])])):g("",!0)}const tn=Z(Zo,[["render",en],["__scopeId","data-v-45e8999c"]]),on={name:"TxtImportModal",props:{show:{type:Boolean,default:!1}},emits:["close","fileProcessed"],methods:{handleFileUpload(i){const t=i.target.files[0];if(!t)return;if(!t.name.toLowerCase().endsWith(".txt")){alert("Bitte wÃ¤hlen Sie eine .txt Datei aus.");return}const a=new FileReader;a.onload=e=>{const c=e.target.result;this.$emit("fileProcessed",c)},a.readAsText(t,"UTF-8")}}},sn={class:"file-upload-area"},nn={class:"modal-buttons"};function an(i,t,a,e,c,f){return a.show?(l(),d("div",{key:0,class:"modal",onClick:t[3]||(t[3]=s=>i.$emit("close"))},[o("div",{class:"modal-content",onClick:t[2]||(t[2]=oe(()=>{},["stop"]))},[t[5]||(t[5]=o("h2",null,"ðŸ“„ Import from TXT File",-1)),t[6]||(t[6]=o("p",null,"WÃ¤hlen Sie eine .txt Datei mit einer Liste von Titeln aus, um zu prÃ¼fen, welche Items in der aktuellen Kategorie fehlen.",-1)),o("div",sn,[o("input",{type:"file",id:"txtFileInput",accept:".txt",onChange:t[0]||(t[0]=(...s)=>f.handleFileUpload&&f.handleFileUpload(...s)),style:{display:"none"}},null,32),t[4]||(t[4]=o("label",{for:"txtFileInput",class:"file-upload-label"},[o("span",{class:"upload-icon"},"ðŸ“"),o("span",{class:"upload-text"},"TXT-Datei auswÃ¤hlen"),o("span",{class:"upload-hint"},"Eine .txt Datei mit einer Liste von Titeln")],-1))]),o("div",nn,[o("button",{type:"button",onClick:t[1]||(t[1]=s=>i.$emit("close"))}," Cancel ")])])])):g("",!0)}const rn=Z(on,[["render",an],["__scopeId","data-v-d761bd17"]]),ln={name:"TxtImportResultsModal",props:{show:{type:Boolean,default:!1},results:{type:Object,default:null}},emits:["close"]},dn={class:"results-summary"},cn={class:"summary-item"},mn={class:"summary-value"},un={class:"summary-item"},gn={class:"summary-value"},fn={class:"summary-item"},vn={class:"summary-value existing"},pn={class:"summary-item"},yn={class:"summary-value missing"},hn={key:0,class:"missing-items"},wn={class:"items-list"},bn={key:1,class:"existing-items"},Sn={class:"items-list"},In={class:"modal-buttons"};function Cn(i,t,a,e,c,f){return a.show&&a.results?(l(),d("div",{key:0,class:"modal",onClick:t[2]||(t[2]=s=>i.$emit("close"))},[o("div",{class:"modal-content results-modal",onClick:t[1]||(t[1]=oe(()=>{},["stop"]))},[t[7]||(t[7]=o("h2",null,"ðŸ“Š TXT Import Ergebnisse",-1)),o("div",dn,[o("div",cn,[t[3]||(t[3]=o("span",{class:"summary-label"},"Kategorie:",-1)),o("span",mn,u(a.results.categoryName),1)]),o("div",un,[t[4]||(t[4]=o("span",{class:"summary-label"},"Titel in Datei:",-1)),o("span",gn,u(a.results.totalInFile),1)]),o("div",fn,[t[5]||(t[5]=o("span",{class:"summary-label"},"Bereits vorhanden:",-1)),o("span",vn,u(a.results.existingItems.length),1)]),o("div",pn,[t[6]||(t[6]=o("span",{class:"summary-label"},"Fehlende Titel:",-1)),o("span",yn,u(a.results.missingItems.length),1)])]),a.results.missingItems.length>0?(l(),d("div",hn,[o("h3",null,"âŒ Fehlende Titel ("+u(a.results.missingItems.length)+"):",1),o("div",wn,[(l(!0),d(ae,null,ie(a.results.missingItems,(s,w)=>(l(),d("div",{key:w,class:"missing-item"},u(s),1))),128))])])):g("",!0),a.results.existingItems.length>0?(l(),d("div",bn,[o("h3",null,"âœ… Bereits vorhanden ("+u(a.results.existingItems.length)+"):",1),o("div",Sn,[(l(!0),d(ae,null,ie(a.results.existingItems,(s,w)=>(l(),d("div",{key:w,class:"existing-item"},u(s),1))),128))])])):g("",!0),o("div",In,[o("button",{type:"button",onClick:t[0]||(t[0]=s=>i.$emit("close"))}," SchlieÃŸen ")])])])):g("",!0)}const kn=Z(ln,[["render",Cn],["__scopeId","data-v-ec385b83"]]),Tn={name:"SimpleAddItem",setup(){const i=p(!1),t=p(null),a=Ze({title:"Test Game",category:"game",release:"2003-01-01",count:1});return{form:a,loading:i,result:t,addItem:async()=>{i.value=!0,t.value=null;try{const c="https://teabubble.attrebi.ch",f=await fetch(`${c}/api/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:"admin@teabubble.attrebi.ch",password:"admin123"})});if(!f.ok)throw new Error("Login failed");const w=(await f.json()).token,k=await(await fetch(`${c}/api/media`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${w}`},body:JSON.stringify(a)})).json();k.success?t.value={success:!0,message:`Success! Item added with ID: ${k.data.id}`}:t.value={success:!1,message:`Error: ${JSON.stringify(k)}`}}catch(c){t.value={success:!1,message:`Error: ${c.message}`}}finally{i.value=!1}}}}},_n={class:"simple-add-item"},An=["disabled"];function xn(i,t,a,e,c,f){return l(),d("div",_n,[t[10]||(t[10]=o("h3",null,"Simple Add Item Test",-1)),o("form",{onSubmit:t[4]||(t[4]=oe((...s)=>e.addItem&&e.addItem(...s),["prevent"]))},[o("div",null,[t[5]||(t[5]=o("label",null,"Title:",-1)),U(o("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>e.form.title=s),type:"text",required:""},null,512),[[B,e.form.title]])]),o("div",null,[t[7]||(t[7]=o("label",null,"Category:",-1)),U(o("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>e.form.category=s)},[...t[6]||(t[6]=[o("option",{value:"game"},"Game",-1),o("option",{value:"movie"},"Movie",-1),o("option",{value:"series"},"Series",-1)])],512),[[pe,e.form.category]])]),o("div",null,[t[8]||(t[8]=o("label",null,"Release:",-1)),U(o("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>e.form.release=s),type:"date"},null,512),[[B,e.form.release]])]),o("div",null,[t[9]||(t[9]=o("label",null,"Count:",-1)),U(o("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>e.form.count=s),type:"number",min:"0"},null,512),[[B,e.form.count]])]),o("button",{type:"submit",disabled:e.loading},u(e.loading?"Adding...":"Add Item"),9,An)],32),e.result?(l(),d("div",{key:0,class:Y(["result",e.result.success?"success":"error"])},u(e.result.message),3)):g("",!0)])}const Mn=Z(Tn,[["render",xn],["__scopeId","data-v-ac355bf2"]]),Dn={name:"MessageBox",props:{show:{type:Boolean,default:!1},type:{type:String,default:"info",validator:i=>["success","error","warning","info"].includes(i)},title:{type:String,default:""},message:{type:String,required:!0},details:{type:String,default:""}},emits:["close"],setup(i,{emit:t}){const a=()=>{t("close")},e=P(()=>{switch(i.type){case"success":return"âœ…";case"error":return"âŒ";case"warning":return"âš ï¸";case"info":return"â„¹ï¸";default:return"â„¹ï¸"}}),c=P(()=>`message-${i.type}`);return{closeMessage:a,icon:e,messageType:c}}},Un={class:"message-header"},Rn={class:"message-icon"},En={class:"message-title"},Fn={class:"message-body"},Pn={key:0,class:"message-details"},Ln={class:"message-footer"};function Bn(i,t,a,e,c,f){return a.show?(l(),d("div",{key:0,class:"message-overlay",onClick:t[3]||(t[3]=(...s)=>e.closeMessage&&e.closeMessage(...s))},[o("div",{class:Y(["message-box",e.messageType]),onClick:t[2]||(t[2]=oe(()=>{},["stop"]))},[o("div",Un,[o("span",Rn,u(e.icon),1),o("h3",En,u(a.title),1),o("button",{class:"close-btn",onClick:t[0]||(t[0]=(...s)=>e.closeMessage&&e.closeMessage(...s))},"âœ•")]),o("div",Fn,[o("p",null,u(a.message),1),a.details?(l(),d("div",Pn,[o("pre",null,u(a.details),1)])):g("",!0)]),o("div",Ln,[o("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=(...s)=>e.closeMessage&&e.closeMessage(...s))},"OK")])],2)])):g("",!0)}const Nn=Z(Dn,[["render",Bn],["__scopeId","data-v-df4d55b5"]]),Vn={name:"ConfirmDialog",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm Action"},message:{type:String,required:!0}},emits:["confirm","close"],setup(i,{emit:t}){const a=()=>{t("close")};return{closeDialog:a,confirmAction:()=>{t("confirm"),a()}}}},Gn={class:"confirm-header"},zn={class:"confirm-title"},Wn={class:"confirm-body"},jn={class:"confirm-footer"};function On(i,t,a,e,c,f){return a.show?(l(),d("div",{key:0,class:"confirm-overlay",onClick:t[4]||(t[4]=(...s)=>e.closeDialog&&e.closeDialog(...s))},[o("div",{class:"confirm-dialog",onClick:t[3]||(t[3]=oe(()=>{},["stop"]))},[o("div",Gn,[o("h3",zn,u(a.title),1),o("button",{class:"close-btn",onClick:t[0]||(t[0]=(...s)=>e.closeDialog&&e.closeDialog(...s))},"âœ•")]),o("div",Wn,[o("p",null,u(a.message),1)]),o("div",jn,[o("button",{class:"btn btn-secondary",onClick:t[1]||(t[1]=(...s)=>e.closeDialog&&e.closeDialog(...s))},"Cancel"),o("button",{class:"btn btn-danger",onClick:t[2]||(t[2]=(...s)=>e.confirmAction&&e.confirmAction(...s))},"Confirm")])])])):g("",!0)}const qn=Z(Vn,[["render",On],["__scopeId","data-v-40b080f9"]]),Hn={name:"InputDialog",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Input Required"},message:{type:String,required:!0},placeholder:{type:String,default:""},inputType:{type:String,default:"text"},defaultValue:{type:String,default:""}},emits:["confirm","close"],setup(i,{emit:t}){const a=p(""),e=p(null),c=()=>{t("close")},f=()=>{t("confirm",a.value),c()};return Se(()=>i.show,async s=>{s&&(a.value=i.defaultValue,await at(),e.value&&(e.value.focus(),e.value.select()))}),{inputValue:a,inputRef:e,closeDialog:c,confirmAction:f}}},Qn={class:"input-header"},Kn={class:"input-title"},Jn={class:"input-body"},Xn={class:"input-message"},Yn=["type","placeholder"],Zn={class:"input-footer"};function $n(i,t,a,e,c,f){return a.show?(l(),d("div",{key:0,class:"input-overlay",onClick:t[6]||(t[6]=(...s)=>e.closeDialog&&e.closeDialog(...s))},[o("div",{class:"input-dialog",onClick:t[5]||(t[5]=oe(()=>{},["stop"]))},[o("div",Qn,[o("h3",Kn,u(a.title),1),o("button",{class:"close-btn",onClick:t[0]||(t[0]=(...s)=>e.closeDialog&&e.closeDialog(...s))},"âœ•")]),o("div",Jn,[o("p",Xn,u(a.message),1),U(o("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>e.inputValue=s),type:a.inputType,placeholder:a.placeholder,class:"input-field",onKeyup:t[2]||(t[2]=nt((...s)=>e.confirmAction&&e.confirmAction(...s),["enter"])),ref:"inputRef"},null,40,Yn),[[st,e.inputValue]])]),o("div",Zn,[o("button",{class:"btn btn-secondary",onClick:t[3]||(t[3]=(...s)=>e.closeDialog&&e.closeDialog(...s))},"Cancel"),o("button",{class:"btn btn-primary",onClick:t[4]||(t[4]=(...s)=>e.confirmAction&&e.confirmAction(...s))},"OK")])])])):g("",!0)}const ea=Z(Hn,[["render",$n],["__scopeId","data-v-76cd91e2"]]),ta={name:"MediaLibrary",components:{MediaItem:Et,Sidebar:lt,MainHeader:dt,FloatingActionButton:Vt,LoginModal:mt,RegisterModal:ct,EditModal:Yo,BulkAddModal:tn,TxtImportModal:rn,TxtImportResultsModal:kn,SimpleAddItem:Mn,LoadingSpinner:ut,MessageBox:Nn,ConfirmDialog:qn,InputDialog:ea},setup(){const i=Ie(),t=$e(),a=et(),e=tt(),c=Ye(),f=p(!1),s=p(null),{sidebarCollapsed:w,mobileSidebarOpen:r,showLoginModal:k,showRegisterModal:_,showEditModal:E,showFloatingMenu:z,showBulkAddModal:W,showTxtImportModal:N,showTxtImportResults:M,editingItem:Q,gridColumns:$,sortBy:K,categories:q,txtImportResults:b,isLoggedIn:G,isAdmin:H,userName:se,currentCategory:ee,searchQuery:j,categoryCounts:D,loading:A,error:C,paginatedMedia:L,platforms:re,genres:n,toggleSidebar:v,toggleMobileSidebar:F,closeMobileSidebar:S,setCategory:x,clearSearch:J,togglePlatformFilter:X,toggleGenreFilter:Ce,toggleAiringFilter:ke,editItem:Te,closeEditModal:_e,closeBulkAddModal:Ae,handleBulkAddItems:ye,handleSaveItem:xe,handleDeleteItem:Me,logout:De,loadMedia:ne,toggleFloatingMenu:Ue,addNewItem:le,bulkAddItems:Re,importFromTxt:Ee,importFromAPI:Fe,createCollection:Pe,exportMediaCollection:Le,exportAsCSV:Be,exportAsJSON:de,downloadFile:Ne,deleteAllInCategory:Ve,getCategoryDisplayName:ce,navigateToStatistics:he,navigateToCalendar:we,navigateToFeatures:be,navigateToProfile:me,processTxtContent:Oe,closeTxtImportResults:qe,cleanup:He,router:Ge}=gt(),Qe=P(()=>{try{return ce?ce(ee.value):ee.value}catch(h){return console.error("Error getting category display name:",h),ee.value||"Unknown"}}),Ke=h=>{x(h),le()},m=()=>{k.value=!1,_.value=!0},y=()=>{k.value=!0},R=h=>{k.value=!1,ne()},I=()=>{_.value=!1,ne()},T=async()=>{f.value=!0,s.value=null;try{console.log("ðŸ”§ Starting admin setup...");const h=await c.adminSetup();h.success?(console.log("âœ… Admin setup successful:",h),s.value={type:"success",text:`âœ… Admin created and logged in! User: ${h.user.name} (${h.user.email})`},await ne(),setTimeout(()=>{s.value=null},5e3)):(console.log("â„¹ï¸ Admin already exists:",h),s.value={type:"info",text:`â„¹ï¸ ${h.message} (${h.admin_count} admin(s) exist)`},setTimeout(()=>{s.value=null},3e3))}catch(h){console.error("âŒ Admin setup failed:",h),s.value={type:"error",text:`âŒ Admin setup failed: ${h.message||"Unknown error"}`},setTimeout(()=>{s.value=null},5e3)}finally{f.value=!1}},V=()=>{console.log("ðŸ”¥ DEBUG: Direct admin navigation called!"),console.log("ðŸ”¥ DEBUG: Router object:",Ge);try{Ge.push("/admin"),console.log("ðŸ”¥ DEBUG: Successfully navigated to /admin!")}catch(h){console.error("ðŸ”¥ DEBUG: Error navigating to admin:",h)}};return it(async()=>{try{if(await ne(),G.value)try{i.initializeRealtimeUpdates()}catch(h){console.error("Error initializing realtime updates:",h)}}catch(h){console.error("Error during initialization:",h)}}),rt(()=>{if(G.value)try{i.cleanupRealtimeUpdates()}catch(h){console.error("Error cleaning up realtime updates:",h)}He()}),{sidebarCollapsed:w,mobileSidebarOpen:r,showLoginModal:k,showRegisterModal:_,showEditModal:E,showFloatingMenu:z,showBulkAddModal:W,showTxtImportModal:N,showTxtImportResults:M,editingItem:Q,gridColumns:$,sortBy:K,categories:q,txtImportResults:b,adminSetupLoading:f,adminSetupMessage:s,isLoggedIn:G,isAdmin:H,userName:se,currentCategory:ee,currentCategoryDisplayName:Qe,searchQuery:j,categoryCounts:D,loading:A,error:C,paginatedMedia:L,platforms:re,genres:n,toggleSidebar:v,toggleMobileSidebar:F,closeMobileSidebar:S,setCategory:x,clearSearch:J,navigateToStatistics:he,navigateToCalendar:we,navigateToFeatures:be,navigateToProfile:me,addItemFromSidebar:Ke,togglePlatformFilter:X,toggleGenreFilter:Ce,toggleAiringFilter:ke,editItem:Te,switchToRegister:m,showAdminLogin:y,handleLoginSuccess:R,handleRegisterSuccess:I,handleAdminSetup:T,debugNavigateToAdmin:V,closeEditModal:_e,closeBulkAddModal:Ae,handleBulkAddItems:ye,handleSaveItem:xe,handleDeleteItem:Me,logout:De,loadMedia:ne,toggleFloatingMenu:Ue,addNewItem:le,bulkAddItems:Re,importFromTxt:Ee,importFromAPI:Fe,createCollection:Pe,exportMediaCollection:Le,exportAsCSV:Be,exportAsJSON:de,downloadFile:Ne,deleteAllInCategory:Ve,getCategoryDisplayName:ce,processTxtContent:Oe,closeTxtImportResults:qe,messageStore:t,confirmStore:a,inputStore:e}}},oa={class:"vue-app"},sa={class:"main-content"},na={class:"content-area"},aa={key:1,class:"error"},ia={key:2},ra={key:0,class:"admin-setup-container"},la=["disabled"],da={key:0},ca={key:1};function ma(i,t,a,e,c,f){const s=O("Sidebar"),w=O("MainHeader"),r=O("LoadingSpinner"),k=O("MediaItem"),_=O("LoginModal"),E=O("RegisterModal"),z=O("EditModal"),W=O("BulkAddModal"),N=O("TxtImportModal"),M=O("TxtImportResultsModal"),Q=O("FloatingActionButton"),$=O("MessageBox"),K=O("ConfirmDialog"),q=O("InputDialog");return l(),d("div",oa,[o("div",{class:Y(["mobile-overlay",{show:e.mobileSidebarOpen}]),onClick:t[0]||(t[0]=(...b)=>e.closeMobileSidebar&&e.closeMobileSidebar(...b))},null,2),te(s,{collapsed:e.sidebarCollapsed,"mobile-open":e.mobileSidebarOpen,"is-logged-in":e.isLoggedIn,"is-admin":e.isAdmin,"user-name":e.userName,"current-category":e.currentCategory,"category-counts":e.categoryCounts,platforms:e.platforms,genres:e.genres,categories:e.categories,onToggle:e.toggleSidebar,onSetCategory:e.setCategory,onNavigateToStatistics:e.navigateToStatistics,onNavigateToCalendar:e.navigateToCalendar,onNavigateToFeatures:e.navigateToFeatures,onNavigateToProfile:e.navigateToProfile,onNavigateToAdmin:e.debugNavigateToAdmin,onTogglePlatformFilter:e.togglePlatformFilter,onToggleGenreFilter:e.toggleGenreFilter,onToggleAiringFilter:e.toggleAiringFilter,onAddItem:e.addItemFromSidebar,onShowLogin:t[1]||(t[1]=b=>e.showLoginModal=!0),onShowRegister:t[2]||(t[2]=b=>e.showRegisterModal=!0),onShowAdminLogin:e.showAdminLogin,onLogout:e.logout},null,8,["collapsed","mobile-open","is-logged-in","is-admin","user-name","current-category","category-counts","platforms","genres","categories","onToggle","onSetCategory","onNavigateToStatistics","onNavigateToCalendar","onNavigateToFeatures","onNavigateToProfile","onNavigateToAdmin","onTogglePlatformFilter","onToggleGenreFilter","onToggleAiringFilter","onAddItem","onShowAdminLogin","onLogout"]),o("div",sa,[te(w,{"search-query":e.searchQuery,"onUpdate:searchQuery":t[3]||(t[3]=b=>e.searchQuery=b),"grid-columns":e.gridColumns,"onUpdate:gridColumns":t[4]||(t[4]=b=>e.gridColumns=b),"sort-by":e.sortBy,"onUpdate:sortBy":t[5]||(t[5]=b=>e.sortBy=b),onToggleMobileSidebar:e.toggleMobileSidebar,onClearSearch:e.clearSearch},null,8,["search-query","grid-columns","sort-by","onToggleMobileSidebar","onClearSearch"]),o("main",na,[e.loading?(l(),fe(r,{key:0,message:"Loading media data..."})):e.error?(l(),d("div",aa,[o("p",null,u(e.error),1),o("button",{onClick:t[6]||(t[6]=(...b)=>e.loadMedia&&e.loadMedia(...b))},"Retry")])):(l(),d("div",ia,[o("div",{class:"grid",style:je({gridTemplateColumns:`repeat(${e.gridColumns}, 1fr)`})},[(l(!0),d(ae,null,ie(e.paginatedMedia,b=>(l(),fe(k,{key:b.id,item:b,onEdit:e.editItem},null,8,["item","onEdit"]))),128))],4)]))])]),e.isLoggedIn?g("",!0):(l(),d("div",ra,[o("button",{onClick:t[7]||(t[7]=(...b)=>e.handleAdminSetup&&e.handleAdminSetup(...b)),disabled:e.adminSetupLoading,class:"admin-setup-btn",title:"Setup Admin Account (Creates admin@teabubble.attrebi.ch / admin123)"},[e.adminSetupLoading?(l(),d("span",da,"ðŸ”§ Setting up...")):(l(),d("span",ca,"ðŸ”§ Admin Setup"))],8,la),e.adminSetupMessage?(l(),d("div",{key:0,class:Y(["admin-setup-message",e.adminSetupMessage.type])},u(e.adminSetupMessage.text),3)):g("",!0)])),e.showLoginModal?(l(),fe(_,{key:1,onClose:t[8]||(t[8]=b=>e.showLoginModal=!1),onSuccess:e.handleLoginSuccess,onSwitchToRegister:e.switchToRegister},null,8,["onSuccess","onSwitchToRegister"])):g("",!0),e.showRegisterModal?(l(),fe(E,{key:2,onClose:t[9]||(t[9]=b=>e.showRegisterModal=!1),onSuccess:e.handleRegisterSuccess},null,8,["onSuccess"])):g("",!0),e.showEditModal?(l(),fe(z,{key:3,item:e.editingItem,"current-category":e.currentCategory,onClose:e.closeEditModal,onSave:e.handleSaveItem,onDelete:e.handleDeleteItem},null,8,["item","current-category","onClose","onSave","onDelete"])):g("",!0),te(W,{show:e.showBulkAddModal,"current-category":e.currentCategory,onClose:e.closeBulkAddModal},null,8,["show","current-category","onClose"]),te(N,{show:e.showTxtImportModal,onClose:t[10]||(t[10]=b=>e.showTxtImportModal=!1),onFileProcessed:e.processTxtContent},null,8,["show","onFileProcessed"]),te(M,{show:e.showTxtImportResults,results:e.txtImportResults,onClose:e.closeTxtImportResults},null,8,["show","results","onClose"]),te(Q,{"show-menu":e.showFloatingMenu,"show-delete-all":e.isLoggedIn&&e.currentCategory!=="all"&&e.categoryCounts[e.currentCategory]>0,"category-name":e.currentCategoryDisplayName,"item-count":e.categoryCounts[e.currentCategory]||0,onToggleMenu:e.toggleFloatingMenu,onAddNewItem:e.addNewItem,onBulkAddItems:e.bulkAddItems,onImportFromTxt:e.importFromTxt,onImportFromApi:e.importFromAPI,onCreateCollection:e.createCollection,onDeleteAllInCategory:e.deleteAllInCategory},null,8,["show-menu","show-delete-all","category-name","item-count","onToggleMenu","onAddNewItem","onBulkAddItems","onImportFromTxt","onImportFromApi","onCreateCollection","onDeleteAllInCategory"]),te($,{show:e.messageStore.show,type:e.messageStore.type,title:e.messageStore.title,message:e.messageStore.message,details:e.messageStore.details,onClose:e.messageStore.closeMessage},null,8,["show","type","title","message","details","onClose"]),te(K,{show:e.confirmStore.show,title:e.confirmStore.title,message:e.confirmStore.message,onConfirm:e.confirmStore.confirm,onClose:e.confirmStore.cancel},null,8,["show","title","message","onConfirm","onClose"]),te(q,{show:e.inputStore.show,title:e.inputStore.title,message:e.inputStore.message,placeholder:e.inputStore.placeholder,"input-type":e.inputStore.inputType,"default-value":e.inputStore.defaultValue,onConfirm:e.inputStore.confirm,onClose:e.inputStore.cancel},null,8,["show","title","message","placeholder","input-type","default-value","onConfirm","onClose"])])}const ha=Z(ta,[["render",ma],["__scopeId","data-v-a562c674"]]);export{ha as default};
