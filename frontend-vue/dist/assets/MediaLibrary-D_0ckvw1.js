import{A as zt,d as Be,r as b,w as Ce,c as z,m as fe,u as jt,a as Oe,_ as ae,b as u,e as s,f as y,t as p,n as J,g as Ae,h as ue,i as Te,o as c,j as be,F as se,k as oe,l as ie,p as Ve,q as Me,s as U,v as N,x as lt,y as ke,z as dt,B as xe,C as Yt,D as qt,E as Ht,G as Qt}from"./index-B8_7HHTM.js";class Jt{constructor(){this.isConnected={value:!1},this.listeners=new Map,this.pollingInterval=null,this.lastUpdate=null,this.pollingIntervalMs=2e4}getApiBaseUrl(){return zt.BASE_URL}connect(){if(this.pollingInterval)return;const e=localStorage.getItem("authToken"),o=localStorage.getItem("currentUser");!e||!o||(this.isConnected.value=!0,this.lastUpdate=new Date,this.pollingInterval=setInterval(()=>{this.checkForUpdates()},this.pollingIntervalMs))}async checkForUpdates(){try{const e=localStorage.getItem("authToken"),o=localStorage.getItem("currentUser");if(!e||!o)return;const t=this.getApiBaseUrl(),a=await fetch(`${t}/api/media`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!a.ok){if(a.status===401){this.disconnect();return}throw new Error(`HTTP error! status: ${a.status}`)}const r=await a.json();r&&r.length>0&&this.listeners.forEach((i,l)=>{try{i({type:"media_updated",items:r,count:r.length,timestamp:new Date().toISOString()})}catch{}}),this.lastUpdate=new Date}catch{}}addListener(e,o){this.listeners.set(e,o)}removeListener(e){this.listeners.delete(e)}disconnect(){this.pollingInterval&&(clearInterval(this.pollingInterval),this.pollingInterval=null),this.isConnected.value=!1}destroy(){this.disconnect(),this.listeners.clear()}}const Ze=new Jt,ze=Be("media",()=>{const n=()=>{try{return localStorage.getItem("currentCategory")||"game"}catch(h){return console.error("Failed to load current category from localStorage:",h),"game"}},e=h=>{try{localStorage.setItem("currentCategory",h)}catch(S){console.error("Failed to save current category to localStorage:",S)}},o=()=>{try{return localStorage.getItem("searchQuery")||""}catch(h){return console.error("Failed to load search query from localStorage:",h),""}},t=h=>{try{localStorage.setItem("searchQuery",h)}catch(S){console.error("Failed to save search query to localStorage:",S)}},a=b(T()),r=b(n()),i=b(o()),l=b(null),m=b([]),d=b(!1),M=b(null);Ce(r,h=>{e(h)},{immediate:!1}),Ce(i,h=>{t(h)},{immediate:!1});function T(){try{const h=localStorage.getItem("authToken"),S=localStorage.getItem("currentUser");if(!h||!S){const x=localStorage.getItem("mediaData");return x?JSON.parse(x):[]}return[]}catch(h){return console.error("Failed to load media from storage:",h),[]}}function C(){try{const h=localStorage.getItem("authToken"),S=localStorage.getItem("currentUser");(!h||!S)&&localStorage.setItem("mediaData",JSON.stringify(a.value))}catch(h){console.error("Failed to save media to storage:",h)}}const k=z(()=>a.value.length),K=z(()=>{const h={};return a.value.forEach(S=>{const x=S.category||"unknown";h[x]=(h[x]||0)+1}),h}),X=z(()=>{let h=[...a.value];if(r.value&&r.value!=="all"&&(h=h.filter(S=>r.value==="watchlist"?S.category==="watchlist"||S.isNew===!0:S.category===r.value)),m.value&&m.value.length>0&&(h=h.filter(S=>{if(!S.genre)return!1;const x=S.genre.split(",").map(A=>A.trim().toLowerCase());return m.value.some(A=>x.some(_=>_.includes(A.toLowerCase())))})),i.value){const S=i.value.toLowerCase();h=h.filter(x=>{var A,_,E,re;return((A=x.title)==null?void 0:A.toLowerCase().includes(S))||((_=x.description)==null?void 0:_.toLowerCase().includes(S))||((E=x.genre)==null?void 0:E.toLowerCase().includes(S))||((re=x.platforms)==null?void 0:re.toLowerCase().includes(S))})}return h});async function V(){var h,S;d.value=!0,M.value=null;try{const x=localStorage.getItem("authToken"),A=localStorage.getItem("currentUser");if(x&&A)try{const _=await fe.getMedia();a.value=_||[]}catch(_){console.warn("API load failed for logged in user:",_),a.value=[]}else{const _=T();if(_.length>0)a.value=_;else{const E=await fe.getMedia();a.value=E||[],C()}}}catch(x){M.value=((S=(h=x.response)==null?void 0:h.data)==null?void 0:S.message)||x.message||"Failed to load media data",console.error("Failed to load media:",x)}finally{d.value=!1}}function le(h){r.value=h}function pe(h){i.value=h}function me(h){l.value=h}function g(){l.value=null}function O(h){m.value=h}function de(){m.value=[]}async function ce(h,S=!1){var x,A,_;M.value=null;try{const E=localStorage.getItem("authToken"),re=localStorage.getItem("currentUser");if(E&&re)try{const ne=await fe.addMediaItem(h);if(!S)await V();else{const F={...ne,__order:a.value.length};a.value.push(F)}return ne}catch(ne){if(((x=ne.response)==null?void 0:x.status)===409&&((_=(A=ne.response)==null?void 0:A.data)!=null&&_.duplicate)){const F=new Error(ne.response.data.error||"Ein Eintrag mit diesem Titel und dieser Kategorie existiert bereits.");throw F.isDuplicate=!0,F}throw M.value=ne.message||"Failed to add media item",console.error("API save failed for logged in user:",ne),ne}else{const ne={id:Date.now(),...h,__order:a.value.length};return a.value.push(ne),C(),ne}}catch(E){throw E}}async function Se(h,S){M.value=null;try{const x=localStorage.getItem("authToken"),A=localStorage.getItem("currentUser");if(x&&A)try{const _=await fe.updateMediaItem(h,S);return await V(),_}catch(_){throw console.error("API update failed for logged in user:",_),_}else{const _=a.value.findIndex(E=>E.id===h);if(_!==-1)return a.value[_]={...a.value[_],...S},C(),a.value[_];throw new Error("Media item not found")}}catch(x){throw x.isDuplicate||(M.value=x.message||"Failed to update media item"),x}}async function ve(h){var S;try{const x=localStorage.getItem("authToken"),A=localStorage.getItem("currentUser");if(x&&A)try{return await fe.deleteMediaItem(h),await V(),!0}catch(_){if(((S=_.response)==null?void 0:S.status)===404||_.isNotFound)return await V(),!0;throw console.error("API delete failed for logged in user:",_),_}else{const _=a.value.findIndex(E=>E.id===h);if(_!==-1)return a.value.splice(_,1),C(),!0;throw new Error("Media item not found")}}catch(x){throw M.value=x.message||"Failed to delete media item",x}}async function Ie(h){try{const S=localStorage.getItem("authToken"),x=localStorage.getItem("currentUser");if(S&&x)try{const A=await fe.batchAddMediaItems(h);return await V(),A}catch(A){throw console.error("API batch add failed for logged in user:",A),A}else{const A=h.map((_,E)=>({id:Date.now()+E,..._,__order:a.value.length+E}));return a.value.push(...A),C(),{success:!0,stats:{created:A.length,failed:0,errors:[]}}}}catch(S){throw M.value=S.message||"Failed to add media items",S}}async function _e(h){try{const S=localStorage.getItem("authToken"),x=localStorage.getItem("currentUser");if(S&&x)try{return await fe.batchDeleteMediaItems(h),await V(),!0}catch(A){if(A.silent)return console.log("Silent batch delete error (some items may not exist):",A.message),await V(),!0;throw console.error("API batch delete failed for logged in user:",A),A}else return a.value=a.value.filter(A=>!h.includes(A.id)),C(),!0}catch(S){throw S.silent||(M.value=S.message||"Failed to delete media items"),S}}async function $(){try{const h=localStorage.getItem("authToken"),S=localStorage.getItem("currentUser");h&&S?await fe.saveMedia(a.value):C()}catch(h){console.error("Failed to save media:",h)}}function j(){M.value=null}function v(h){if(console.log("Processing real-time update:",h),h.type==="media_updated"&&h.items)h.items.forEach(S=>{const x=a.value.findIndex(A=>A.id===S.id);x!==-1?a.value[x]={...a.value[x],...S}:a.value.push(S)});else if(h.action==="created"||h.action==="updated"){const S=h.item,x=a.value.findIndex(A=>A.id===S.id);x!==-1?a.value[x]={...a.value[x],...S}:a.value.push(S)}else if(h.action==="deleted"){const S=a.value.findIndex(x=>x.id===h.id);S!==-1&&a.value.splice(S,1)}C()}function I(){const h=localStorage.getItem("authToken"),S=localStorage.getItem("currentUser");if(!h||!S){console.log("Skipping realtime initialization - user not authenticated");return}try{Ze.addListener("media-store",v),Ze.connect()}catch(x){console.error("Failed to initialize realtime updates:",x)}}function Q(){Ze.removeListener("media-store")}return{mediaData:a,currentCategory:r,searchQuery:i,selectedGenre:l,selectedGenres:m,loading:d,error:M,totalItems:k,categoryCounts:K,filteredMedia:X,loadMedia:V,setCategory:le,setSearchQuery:pe,setGenre:me,clearGenre:g,setGenres:O,clearGenres:de,addMediaItem:ce,updateMediaItem:Se,deleteMediaItem:ve,batchAddMediaItems:Ie,batchDeleteMediaItems:_e,saveMedia:$,clearError:j,initializeRealtimeUpdates:I,cleanupRealtimeUpdates:Q,resetMediaState:()=>{r.value="game",i.value="",localStorage.removeItem("currentCategory"),localStorage.removeItem("searchQuery")}}}),ct=Be("message",()=>{const n=b(!1),e=b("info"),o=b(""),t=b(""),a=b("");function r(T){e.value=T.type||"info",o.value=T.title||"",t.value=T.message||"",a.value=T.details||"",n.value=!0}function i(T,C="Success",k=""){r({type:"success",title:C,message:T,details:k})}function l(T,C="Error",k=""){r({type:"error",title:C,message:T,details:k})}function m(T,C="Warning",k=""){r({type:"warning",title:C,message:T,details:k})}function d(T,C="Info",k=""){r({type:"info",title:C,message:T,details:k})}function M(){n.value=!1,setTimeout(()=>{e.value="info",o.value="",t.value="",a.value=""},300)}return{show:n,type:e,title:o,message:t,details:a,showMessage:r,showSuccess:i,showError:l,showWarning:m,showInfo:d,closeMessage:M}}),ut=Be("confirm",()=>{const n=b(!1),e=b("Confirm Action"),o=b(""),t=b(null);function a(l){return new Promise(m=>{e.value=l.title||"Confirm Action",o.value=l.message||"",n.value=!0,t.value=m})}function r(){t.value&&(t.value(!0),t.value=null),n.value=!1}function i(){t.value&&(t.value(!1),t.value=null),n.value=!1}return{show:n,title:e,message:o,showConfirm:a,confirm:r,cancel:i}}),mt=Be("input",()=>{const n=b(!1),e=b("Input Required"),o=b(""),t=b(""),a=b("text"),r=b(""),i=b(null);function l(M){return new Promise(T=>{e.value=M.title||"Input Required",o.value=M.message||"",t.value=M.placeholder||"",a.value=M.inputType||"text",r.value=M.defaultValue||"",n.value=!0,i.value=T})}function m(M){i.value&&(i.value(M),i.value=null),n.value=!1}function d(){i.value&&(i.value(null),i.value=null),n.value=!1}return{show:n,title:e,message:o,placeholder:t,inputType:a,defaultValue:r,showInput:l,confirm:m,cancel:d}}),gt=Be("sidebar",()=>{const n=()=>{try{const k=localStorage.getItem("sidebarState");if(k)return{collapsed:JSON.parse(k).collapsed||!1,mobileOpen:!1}}catch(k){console.error("Failed to load sidebar state from localStorage:",k)}return{collapsed:!1,mobileOpen:!1}},e=k=>{try{localStorage.setItem("sidebarState",JSON.stringify({collapsed:k.collapsed}))}catch(K){console.error("Failed to save sidebar state to localStorage:",K)}},o=n(),t=b(o.collapsed),a=b(o.mobileOpen);Ce(t,k=>{e({collapsed:k,mobileOpen:a.value})},{immediate:!1});const r=()=>{t.value=!t.value},i=()=>{a.value=!a.value},l=()=>{a.value=!1},m=k=>{t.value=k},d=k=>{a.value=k},M=()=>{t.value=!1,a.value=!1,localStorage.removeItem("sidebarState")},T=z(()=>t.value),C=z(()=>a.value);return{collapsed:t,mobileOpen:a,toggleSidebar:r,toggleMobileSidebar:i,closeMobileSidebar:l,setCollapsed:m,setMobileOpen:d,resetSidebarState:M,isCollapsed:T,isMobileOpen:C}});function Kt(){const n=jt(),e=Oe(),o=ze(),t=ct(),a=ut(),r=mt(),i=b(!1),l=b(!1),m=b(!1),d=b(!1),M=b(!1),T=b(!1),C=b(!1),k=b(null),K=()=>typeof window<"u"?window.innerWidth>768?8:3:8,X=b(K()),V=b("order_asc"),le=b(null),pe=()=>{X.value=K()};typeof window<"u"&&window.addEventListener("resize",pe);const me=[{key:"game",name:"Games",icon:"🎮"},{key:"series",name:"Series",icon:"📺"},{key:"movie",name:"Movies",icon:"🎬"},{key:"buecher",name:"Bücher",icon:"📚"},{key:"watchlist",name:"Watchlist",icon:"❤️"}],g=z(()=>{try{return e.isLoggedIn}catch(D){return console.error("Error accessing authStore.isLoggedIn:",D),!1}}),O=z(()=>{try{return e.userName}catch(D){return console.error("Error accessing authStore.userName:",D),""}}),de=z(()=>{try{return e.isAdmin}catch(D){return console.error("Error accessing authStore.isAdmin:",D),!1}}),ce=z(()=>{try{return o.currentCategory}catch(D){return console.error("Error accessing mediaStore.currentCategory:",D),"game"}}),Se=z({get:()=>{try{return o.searchQuery}catch(D){return console.error("Error accessing mediaStore.searchQuery:",D),""}},set:D=>{try{o.setSearchQuery(D)}catch(B){console.error("Error setting mediaStore.searchQuery:",B)}}}),ve=z(()=>{try{return o.categoryCounts}catch(D){return console.error("Error accessing mediaStore.categoryCounts:",D),{}}}),Ie=z(()=>{try{return o.loading}catch(D){return console.error("Error accessing mediaStore.loading:",D),!1}}),_e=z(()=>{try{return o.error}catch(D){return console.error("Error accessing mediaStore.error:",D),null}}),$=z(()=>{try{const D=[...o.filteredMedia||[]],[B,Z]=V.value.split("_");return D.sort((G,W)=>{let ee=G[B],Y=W[B];return B==="order"?(ee=G.__order||0,Y=W.__order||0):B==="airing"?(ee=G.isAiring?1:0,Y=W.isAiring?1:0):B==="api_rating"?(ee=G.api_rating||G.rating||0,Y=W.api_rating||W.rating||0):B==="personal_rating"&&(ee=G.personal_rating||0,Y=W.personal_rating||0),typeof ee=="string"&&(ee=ee.toLowerCase(),Y=Y.toLowerCase()),Z==="asc"?ee>Y?1:-1:ee<Y?1:-1})}catch(D){return console.error("Error in sortedMedia computed:",D),[]}}),j=z(()=>$.value),v=D=>{o.setCategory(D),gt().closeMobileSidebar()},I=()=>{o.setSearchQuery("")},Q=D=>{k.value=D,m.value=!0},f=()=>{m.value=!1,k.value=null},h=()=>{M.value=!1},S=async D=>{console.log("handleBulkAddItems called but not used in new workflow")},x=async D=>{k.value?await o.updateMediaItem(k.value.id,D):await o.addMediaItem(D),f()},A=async D=>{var B;try{await o.deleteMediaItem(D.id)}catch(Z){((B=Z.response)==null?void 0:B.status)!==404&&!Z.silent&&(console.error("Delete failed:",Z),t.showError("Failed to delete item: "+(Z.message||"Unknown error"),"Delete Failed"))}},_=async()=>{await e.logout(),await E()},E=async()=>{try{await o.loadMedia()}catch(D){console.error("Error loading media:",D)}},re=()=>{d.value=!d.value},ne=()=>{if(d.value=!1,!g.value){t.showWarning("Bitte loggen Sie sich ein, um neue Items hinzuzufügen.","Login erforderlich");return}k.value=null,m.value=!0},F=()=>{if(d.value=!1,!g.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}M.value=!0},ge=()=>{if(d.value=!1,!g.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}T.value=!0},je=()=>{if(d.value=!1,!g.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}t.showInfo("API Import feature coming soon!","Feature in Entwicklung")},Pe=()=>{if(d.value=!1,!g.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}Ee()},Ue=D=>{if(!D)return"Unknown";const B=me.find(Z=>Z.key===D);return B?B.name:D},Ye=async()=>{const D=Ue(ce.value),B=ve.value[ce.value]||0;if(B===0){t.showInfo("No items to delete in this category.","Nothing to Delete");return}const Z=`Are you sure you want to delete ALL ${B} items in "${D}"?

This action cannot be undone!`;if(await a.showConfirm({title:"Delete All Items",message:Z}))try{const ee=((o==null?void 0:o.mediaData)||[]).filter(Y=>ce.value==="watchlist"?Y.category==="watchlist"||Y.isNew===!0:Y.category===ce.value).map(Y=>Y.id);await o.batchDeleteMediaItems(ee),await E(),t.showSuccess(`Successfully deleted ${B} items from "${D}"`,"Items Deleted")}catch(W){console.error("Error deleting items:",W),W.silent?t.showSuccess(`Items deleted from "${D}" (some items may not have existed)`,"Items Deleted"):W.isNotFound?t.showWarning("Some items were not found and could not be deleted, but the operation completed.","Partial Success"):t.showError("Error occurred while deleting items. Please try again.","Delete Failed")}},qe=D=>{const B=D.split(`
`).map(Y=>Y.trim()).filter(Y=>Y.length>0);if(B.length===0){t.showWarning("Die TXT-Datei ist leer oder enthält keine gültigen Einträge.","Leere Datei");return}const G=o.filteredMedia.map(Y=>Y.title.toLowerCase().trim()),W=B.filter(Y=>{const De=Y.toLowerCase().trim();return!G.some(he=>he.includes(De)||De.includes(he))}),ee=B.filter(Y=>{const De=Y.toLowerCase().trim();return G.some(he=>he.includes(De)||De.includes(he))});le.value={totalInFile:B.length,missingItems:W,existingItems:ee,currentCategory:ce.value,categoryName:Ue(ce.value)},T.value=!1,C.value=!0},He=()=>{le.value=null,C.value=!1},Ee=async()=>{const D=(o==null?void 0:o.mediaData)||[];if(D.length===0){t.showInfo("Keine Media Items zum Exportieren gefunden.","Nichts zu exportieren");return}const B=await r.showInput({title:"Export Format wählen",message:`1 = CSV
2 = JSON
3 = Beide

Geben Sie die Nummer ein:`,placeholder:"1",defaultValue:"1"});if(!B||!["1","2","3"].includes(B))return;const Z=new Date().toISOString().split("T")[0];(B==="1"||B==="3")&&Fe(D,Z),(B==="2"||B==="3")&&Le(D,Z),t.showSuccess(`Collection mit ${D.length} Items wurde erfolgreich exportiert!`,"Export erfolgreich")},Fe=(D,B)=>{const G=[["Titel","Kategorie","Release","Rating","Platforms","Genre","Spielzeit","Status","Beschreibung"].join(","),...D.map(W=>[`"${(W.title||"").replace(/"/g,'""')}"`,`"${(W.category||W.category_name||"Unbekannt").replace(/"/g,'""')}"`,`"${W.release||""}"`,`"${W.rating||""}"`,`"${(W.platforms||"").replace(/"/g,'""')}"`,`"${(W.genre||"").replace(/"/g,'""')}"`,`"${W.spielzeit||""}"`,`"${W.isAiring?"Airing":"Abgeschlossen"}"`,`"${(W.description||"").replace(/"/g,'""')}"`].join(","))].join(`
`);Re(G,`media_collection_${B}.csv`,"text/csv;charset=utf-8;")},Le=(D,B)=>{const Z={exportDate:new Date().toISOString(),totalItems:D.length,categories:[...new Set(D.map(G=>G.category||G.category_name||"Unbekannt"))],items:D.map(G=>({id:G.id,title:G.title||"",category:G.category||G.category_name||"Unbekannt",release:G.release||"",rating:G.rating||null,platforms:G.platforms||"",genre:G.genre||"",spielzeit:G.spielzeit||null,status:G.isAiring?"Airing":"Abgeschlossen",description:G.description||"",isNew:G.isNew||!1,nextSeason:G.nextSeason||null,discovered:G.discovered||null}))};Re(JSON.stringify(Z,null,2),`media_collection_${B}.json`,"application/json;charset=utf-8;")},Re=(D,B,Z)=>{const G=new Blob([D],{type:Z}),W=document.createElement("a"),ee=URL.createObjectURL(G);W.setAttribute("href",ee),W.setAttribute("download",B),W.style.visibility="hidden",document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL(ee)};return{showLoginModal:i,showRegisterModal:l,showEditModal:m,showFloatingMenu:d,showBulkAddModal:M,showTxtImportModal:T,showTxtImportResults:C,editingItem:k,gridColumns:X,sortBy:V,categories:me,txtImportResults:le,isLoggedIn:g,isAdmin:de,userName:O,currentCategory:ce,searchQuery:Se,categoryCounts:ve,loading:Ie,error:_e,paginatedMedia:j,setCategory:v,clearSearch:I,editItem:Q,closeEditModal:f,closeBulkAddModal:h,handleBulkAddItems:S,handleSaveItem:x,handleDeleteItem:A,logout:_,loadMedia:E,toggleFloatingMenu:re,addNewItem:ne,bulkAddItems:F,importFromTxt:ge,importFromAPI:je,createCollection:Pe,exportMediaCollection:Ee,exportAsCSV:Fe,exportAsJSON:Le,downloadFile:Re,deleteAllInCategory:Ye,getCategoryDisplayName:Ue,navigateToCalendar:()=>{v("calendar")},navigateToProfile:()=>{v("profile")},navigateToAdmin:()=>{console.log("🔥 navigateToAdmin function called!"),console.log("🔥 Router object:",n),console.log("🔥 Pushing to /admin...");try{n.push("/admin"),console.log("🔥 Successfully navigated to /admin!")}catch(D){console.error("🔥 Error navigating to admin:",D)}},processTxtContent:qe,closeTxtImportResults:He,cleanup:()=>{typeof window<"u"&&window.removeEventListener("resize",pe)},router:n}}const Zt={name:"MediaItem",props:{item:{type:Object,required:!0}},emits:["edit"],computed:{showWatchlistTag(){return this.item.category==="watchlist"||this.item.isNew===!0},isWatchlistItem(){return this.item.category==="watchlist"||this.item.isNew===!0},isSeries(){return this.item.category==="series"||this.item.watchlist_type==="series"}},methods:{getImageUrl(n){return n?n.startsWith("http")?n.startsWith("http://")?n.replace("http://","https://"):n:n.startsWith("/")?n:n.startsWith("storage/")?`/${n}`:`/storage/${n}`:""},handleImageError(n){var e;n.target.style.display="none",(e=n.target.nextElementSibling)==null||e.classList.add("show")},formatDate(n){return n?new Date(n).toLocaleDateString():""},editItem(){this.$emit("edit",this.item)},openExtraLink(){this.item.extra_link&&window.open(this.item.extra_link,"_blank","noopener,noreferrer")},getWatchlistReleaseStatus(){if(!this.item.release)return"";const n=new Date(this.item.release),e=new Date;e.setHours(0,0,0,0),n.setHours(0,0,0,0);const o=n.getTime()-e.getTime(),t=Math.ceil(o/(1e3*3600*24));if(t>0)return t===1?"Tomorrow!":t<=7?`${t} days left`:t<=30?`${t} days left`:`${Math.ceil(t/30)} months left`;if(t===0)return"Released today!";{const a=this.getTypeTagText().toLowerCase();return a==="game"?"Unplayed yet":a==="series"||a==="movie"?"Unwatched yet":a==="buecher"?"Unread yet":"Unconsumed yet"}},getWatchlistReleaseStatusClass(){if(!this.item.release)return"";const n=new Date(this.item.release),e=new Date;e.setHours(0,0,0,0),n.setHours(0,0,0,0);const o=n.getTime()-e.getTime(),t=Math.ceil(o/(1e3*3600*24));return t>0?"countdown":t===0?"released-today":"unconsumed"},getTypeTagText(){var e,o,t;const n=this.item.watchlistType||this.item.watchlist_type;if(n)return n.charAt(0).toUpperCase()+n.slice(1);if(this.item.genre){const a=this.item.genre.toLowerCase();if(a.includes("game")||a.includes("gaming")||(e=this.item.platforms)!=null&&e.toLowerCase().includes("steam")||(o=this.item.platforms)!=null&&o.toLowerCase().includes("ps")||(t=this.item.platforms)!=null&&t.toLowerCase().includes("xbox"))return"Game";if(a.includes("series")||a.includes("tv")||a.includes("episode")||this.item.isAiring)return"Series";if(a.includes("movie")||a.includes("film")||a.includes("cinema"))return"Movie";if(a.includes("book")||a.includes("literature")||a.includes("novel")||a.includes("author"))return"Bücher"}if(this.item.platforms){const a=this.item.platforms.toLowerCase();if(a.includes("steam")||a.includes("ps")||a.includes("xbox")||a.includes("nintendo")||a.includes("pc"))return"Game";if(a.includes("netflix")||a.includes("hulu")||a.includes("disney")||a.includes("hbo"))return"Series";if(a.includes("cinema")||a.includes("theater"))return"Movie";if(a.includes("book")||a.includes("kindle")||a.includes("audible")||a.includes("author"))return"Bücher"}return"Media"},getTypeTagClass(){return`type-${this.getTypeTagText().toLowerCase()}`},getNextSeasonCountdown(){if(!this.item.nextSeasonRelease)return"";const n=new Date(this.item.nextSeasonRelease),e=new Date;e.setHours(0,0,0,0),n.setHours(0,0,0,0);const o=n.getTime()-e.getTime(),t=Math.ceil(o/(1e3*3600*24));return t>0?t===1?"Tomorrow!":t<=7?`${t} days`:t<=30?`${t} days`:`${Math.ceil(t/30)} months`:t===0?"Today!":"Released"},getCategoryClass(){var e,o;const n=((e=this.item.category)==null?void 0:e.toLowerCase())||((o=this.item.category_name)==null?void 0:o.toLowerCase());return n==="movies"||n==="movie"?"category-movies":n==="books"||n==="buecher"||n==="book"?"category-books":n==="series"||n==="tv"||n==="serie"?"category-series":n==="games"||n==="game"||n==="spiele"?"category-games":n==="watchlist"?"category-watchlist":"category-default"},getCategoryIcon(){var e;const n=(e=this.item.category)==null?void 0:e.toLowerCase();return n==="movies"||n==="movie"?"🎬":n==="books"||n==="buecher"?"📚":n==="series"||n==="tv"?"📺":n==="games"||n==="game"?"🎮":"📁"},getCategoryStyle(){var e;const n=(e=this.item.category)==null?void 0:e.toLowerCase();if(n==="games"||n==="game"){const o=this.item.rating||0;return this.getGameStyleByRating(o)}return{}},getGameStyleByRating(n){return n>=4.5?{"--game-primary":"#ffd700","--game-secondary":"#ffed4e","--game-accent":"#ff6b35","--game-glow":"0 0 20px rgba(255, 215, 0, 0.6)","--game-border":"3px solid #ffd700"}:n>=4?{"--game-primary":"#00d4ff","--game-secondary":"#e8f4fd","--game-accent":"#00ff88","--game-glow":"0 0 15px rgba(0, 212, 255, 0.5)","--game-border":"3px solid #00d4ff"}:n>=3.5?{"--game-primary":"#00ff88","--game-secondary":"#4caf50","--game-accent":"#8bc34a","--game-glow":"0 0 12px rgba(0, 255, 136, 0.4)","--game-border":"3px solid #00ff88"}:n>=3?{"--game-primary":"#ff9800","--game-secondary":"#ffc107","--game-accent":"#ff5722","--game-glow":"0 0 10px rgba(255, 152, 0, 0.3)","--game-border":"3px solid #ff9800"}:n>=2?{"--game-primary":"#ff5722","--game-secondary":"#f44336","--game-accent":"#d32f2f","--game-glow":"0 0 8px rgba(255, 87, 34, 0.3)","--game-border":"3px solid #ff5722"}:{"--game-primary":"#9e9e9e","--game-secondary":"#757575","--game-accent":"#616161","--game-glow":"0 0 5px rgba(158, 158, 158, 0.2)","--game-border":"3px solid #9e9e9e"}}}},Xt={class:"media-image"},$t=["src","alt"],es={key:1,class:"no-image"},ts={class:"no-image-icon"},ss={class:"media-info"},os={class:"media-title"},as={class:"media-meta"},ns={key:0,class:"media-release"},is={key:1},rs={key:1,class:"media-rating"},ls={key:0,class:"media-platforms"},ds={key:1,class:"media-genre"},cs={key:2,class:"media-description"},us={key:3,class:"media-airing"},ms={key:0,class:"next-season"},gs={key:1,class:"countdown"},fs={key:4,class:"watchlist-type-tag"};function ps(n,e,o,t,a,r){return c(),u("div",{class:J(["media-item",r.getCategoryClass()]),style:Te(r.getCategoryStyle()),onClick:e[2]||(e[2]=(...i)=>r.editItem&&r.editItem(...i))},[s("div",Xt,[o.item.image_url||o.item.path?(c(),u("img",{key:0,src:r.getImageUrl(o.item.image_url||o.item.path),alt:o.item.title,onError:e[0]||(e[0]=(...i)=>r.handleImageError&&r.handleImageError(...i))},null,40,$t)):(c(),u("div",es,[s("span",ts,p(r.getCategoryIcon()),1)]))]),s("div",ss,[s("h3",os,p(o.item.title),1),s("div",as,[o.item.release?(c(),u("span",ns,[r.isWatchlistItem&&o.item.release?(c(),u("span",{key:0,class:J(r.getWatchlistReleaseStatusClass())},p(r.getWatchlistReleaseStatus()),3)):(c(),u("span",is,p(r.formatDate(o.item.release)),1))])):y("",!0),o.item.rating?(c(),u("span",rs,p("★".repeat(Math.max(0,Math.min(5,Math.floor(o.item.rating)))))+p("☆".repeat(Math.max(0,5-Math.max(0,Math.min(5,Math.floor(o.item.rating)))))),1)):y("",!0)]),o.item.platforms?(c(),u("div",ls,p(o.item.platforms),1)):y("",!0),o.item.genre?(c(),u("div",ds,p(o.item.genre),1)):y("",!0),o.item.description?(c(),u("div",cs,p(o.item.description),1)):y("",!0),o.item.isAiring?(c(),u("div",us,[e[3]||(e[3]=s("span",{class:"airing-badge"},[s("span",{class:"airing-dot"}),Ae(" Airing ")],-1)),o.item.nextSeason?(c(),u("span",ms,"S"+p(o.item.nextSeason),1)):y("",!0),o.item.nextSeasonRelease?(c(),u("span",gs,p(r.getNextSeasonCountdown()),1)):y("",!0)])):y("",!0),r.showWatchlistTag?(c(),u("div",fs,[s("span",{class:J(["type-tag",r.getTypeTagClass()])},p(r.getTypeTagText()),3)])):y("",!0)]),r.isSeries&&o.item.extra_link?(c(),u("div",{key:0,class:"series-extra-button",onClick:e[1]||(e[1]=ue((...i)=>r.openExtraLink&&r.openExtraLink(...i),["stop"]))},[...e[4]||(e[4]=[s("span",{class:"extra-link-icon"},"🔗",-1),s("span",{class:"extra-link-text"},"Extra Link",-1)])])):y("",!0),e[5]||(e[5]=s("div",{class:"edit-indicator"},[s("span",{class:"edit-icon"},"✏️")],-1))],6)}const vs=ae(Zt,[["render",ps],["__scopeId","data-v-35cdd815"]]),hs={name:"VersionInfo",data(){return{version:"1.0.0"}}},ys={class:"version-info"},bs={class:"version-label"};function ks(n,e,o,t,a,r){return c(),u("div",ys,[s("span",bs,"Build #"+p(a.version),1)])}const ws=ae(hs,[["render",ks],["__scopeId","data-v-2d54e3c7"]]),Ss={name:"Sidebar",components:{VersionInfo:ws},props:{collapsed:{type:Boolean,default:!1},mobileOpen:{type:Boolean,default:!1},isLoggedIn:{type:Boolean,default:!1},userName:{type:String,default:""},currentCategory:{type:String,default:"watchlist"},categoryCounts:{type:Object,default:()=>({})},categories:{type:Array,default:()=>[{key:"game",name:"Games",icon:"🎮"},{key:"series",name:"Series",icon:"📺"},{key:"movie",name:"Movies",icon:"🎬"},{key:"buecher",name:"Bücher",icon:"📚"},{key:"watchlist",name:"Watchlist",icon:"❤️"}]},selectedGenres:{type:Array,default:()=>[]},genres:{type:Array,default:()=>[]},genreLoading:{type:Boolean,default:!1},genreError:{type:String,default:null}},emits:["toggle","setCategory","addItem","navigateToCalendar","navigateToProfile","showLogin","showRegister","logout","genres-updated","genres-cleared","load-genres"],computed:{showGenreSection(){return this.currentCategory&&this.currentCategory!=="statistics"&&this.currentCategory!=="calendar"&&this.currentCategory!=="profile"}},methods:{toggleGenre(n){const e=[...this.selectedGenres],o=e.indexOf(n);o>-1?e.splice(o,1):e.push(n),this.$emit("genres-updated",e)},clearGenreFilter(){this.$emit("genres-cleared")},loadGenres(){this.$emit("load-genres")}}},Is={class:"sidebar-content"},_s={class:"sidebar-section"},Cs={class:"sidebar-nav"},Ds=["onClick"],xs={class:"nav-icon"},As={class:"nav-text"},Ts={class:"nav-count"},Ms=["onClick","title"],Us={key:0,class:"sidebar-section"},Rs={key:0,class:"genre-loading"},Bs={key:1,class:"genre-error"},Ps={key:2,class:"genre-empty"},Es={key:3,class:"genre-list"},Fs=["title"],Ls={class:"genre-checkbox-label"},Gs=["value","checked","onChange"],Ns={class:"genre-checkbox-text"},Ws={class:"genre-name"},Vs={class:"genre-count"},Os={class:"sidebar-section"},zs={key:0,class:"auth-buttons"},js={key:1,class:"user-info"},Ys={class:"user-profile"},qs={class:"profile-details"},Hs={class:"user-name"};function Qs(n,e,o,t,a,r){const i=ie("VersionInfo");return c(),u("aside",{id:"sidebar",class:J(["sidebar",{collapsed:o.collapsed,open:o.mobileOpen}])},[s("div",{class:"sidebar-header",onClick:e[0]||(e[0]=l=>n.$emit("toggle"))},[...e[10]||(e[10]=[s("h2",null,"Media Library",-1),s("button",{class:"sidebar-toggle"},"☰",-1)])]),s("div",Is,[s("div",_s,[e[15]||(e[15]=s("h3",null,"Browse",-1)),s("nav",Cs,[(c(!0),u(se,null,oe(o.categories,l=>(c(),u("div",{key:l.key,class:"nav-item"},[s("button",{class:J(["nav-btn",{active:o.currentCategory===l.key}]),onClick:m=>n.$emit("setCategory",l.key)},[s("span",xs,p(l.icon),1),s("span",As,p(l.name),1),s("span",Ts,p(o.categoryCounts[l.key]||0),1)],10,Ds),s("button",{class:"add-btn",onClick:m=>n.$emit("addItem",l.key),title:`Add ${l.name}`},[...e[11]||(e[11]=[s("span",{class:"add-icon"},"+",-1)])],8,Ms)]))),128)),s("button",{class:J(["nav-btn",{active:o.currentCategory==="statistics"}]),onClick:e[1]||(e[1]=l=>n.$emit("setCategory","statistics"))},[...e[12]||(e[12]=[s("span",{class:"nav-icon"},"📊",-1),s("span",{class:"nav-text"},"Statistics",-1)])],2),s("button",{class:J(["nav-btn",{active:o.currentCategory==="calendar"}]),onClick:e[2]||(e[2]=l=>n.$emit("setCategory","calendar"))},[...e[13]||(e[13]=[s("span",{class:"nav-icon"},"📅",-1),s("span",{class:"nav-text"},"Calendar",-1)])],2),s("button",{class:J(["nav-btn",{active:o.currentCategory==="profile"}]),onClick:e[3]||(e[3]=l=>n.$emit("setCategory","profile"))},[...e[14]||(e[14]=[s("span",{class:"nav-icon"},"👤",-1),s("span",{class:"nav-text"},"Profile",-1)])],2)])]),r.showGenreSection?(c(),u("div",Us,[e[19]||(e[19]=s("h3",null,"Genres",-1)),o.genreLoading?(c(),u("div",Rs,[...e[16]||(e[16]=[s("div",{class:"loading-spinner"},null,-1),s("span",null,"Loading genres...",-1)])])):o.genreError?(c(),u("div",Bs,[e[17]||(e[17]=s("span",null,"Failed to load genres",-1)),s("button",{onClick:e[4]||(e[4]=(...l)=>r.loadGenres&&r.loadGenres(...l)),class:"retry-btn"},"Retry")])):o.genres.length===0?(c(),u("div",Ps,[...e[18]||(e[18]=[s("span",null,"No genres available",-1)])])):(c(),u("div",Es,[(c(!0),u(se,null,oe(o.genres,l=>(c(),u("div",{key:l.name,class:"genre-checkbox-item",title:`${l.name} (${l.count} items)`},[s("label",Ls,[s("input",{type:"checkbox",value:l.name,checked:o.selectedGenres.includes(l.name),onChange:m=>r.toggleGenre(l.name),class:"genre-checkbox"},null,40,Gs),s("span",Ns,[s("span",Ws,p(l.name),1),s("span",Vs,p(l.count),1)])])],8,Fs))),128)),o.selectedGenres.length>0?(c(),u("button",{key:0,class:"clear-genre-btn",onClick:e[5]||(e[5]=(...l)=>r.clearGenreFilter&&r.clearGenreFilter(...l)),title:"Clear all genre filters"}," Clear All Filters ("+p(o.selectedGenres.length)+") ",1)):y("",!0)]))])):y("",!0),s("div",Os,[e[21]||(e[21]=s("h3",null,"Account",-1)),o.isLoggedIn?(c(),u("div",js,[s("div",Ys,[e[20]||(e[20]=s("div",{class:"profile-avatar"},[s("span",{class:"avatar-text"},"👤")],-1)),s("div",qs,[s("span",Hs,p(o.userName),1)]),s("button",{class:"account-btn",onClick:e[8]||(e[8]=l=>n.$emit("navigateToProfile"))},"⚙️")]),s("button",{class:"auth-btn",onClick:e[9]||(e[9]=l=>n.$emit("logout"))},"Logout")])):(c(),u("div",zs,[s("button",{class:"auth-btn",onClick:e[6]||(e[6]=l=>n.$emit("showLogin"))},"Login"),s("button",{class:"auth-btn",onClick:e[7]||(e[7]=l=>n.$emit("showRegister"))},"Register")]))])]),be(i)],2)}const Js=ae(Ss,[["render",Qs],["__scopeId","data-v-23b04853"]]),Ks={name:"MainHeader",props:{searchQuery:{type:String,default:""},sortBy:{type:String,default:"order_asc"}},emits:["update:searchQuery","update:sortBy","toggleMobileSidebar","clearSearch"]},Zs={class:"main-header"},Xs={class:"header-left"},$s={class:"header-center"},eo={class:"search-container"},to=["value"],so={class:"header-right"},oo={class:"sort-container"},ao=["value"];function no(n,e,o,t,a,r){return c(),u("header",Zs,[s("div",Xs,[s("button",{class:"mobile-sidebar-toggle",onClick:e[0]||(e[0]=i=>n.$emit("toggleMobileSidebar"))},"☰")]),s("div",$s,[s("div",eo,[s("input",{type:"text",value:o.searchQuery,onInput:e[1]||(e[1]=i=>n.$emit("update:searchQuery",i.target.value)),placeholder:"Search..."},null,40,to),s("button",{class:"search-clear",onClick:e[2]||(e[2]=i=>n.$emit("clearSearch"))},"×")])]),s("div",so,[s("div",oo,[s("select",{value:o.sortBy,onChange:e[3]||(e[3]=i=>n.$emit("update:sortBy",i.target.value))},[...e[4]||(e[4]=[Ve('<option value="order_asc" data-v-8aca1f2e>Original order ↑</option><option value="order_desc" data-v-8aca1f2e>Original order ↓</option><option value="title_asc" data-v-8aca1f2e>Title A-Z</option><option value="title_desc" data-v-8aca1f2e>Title Z-A</option><option value="release_asc" data-v-8aca1f2e>Release ↑</option><option value="release_desc" data-v-8aca1f2e>Release ↓</option><option value="api_rating_asc" data-v-8aca1f2e>API Rating ↑</option><option value="api_rating_desc" data-v-8aca1f2e>API Rating ↓</option><option value="personal_rating_asc" data-v-8aca1f2e>Personal Rating ↑</option><option value="personal_rating_desc" data-v-8aca1f2e>Personal Rating ↓</option><option value="airing_desc" data-v-8aca1f2e>Airing first</option><option value="airing_asc" data-v-8aca1f2e>Finished first</option>',12)])],40,ao)])])])}const io=ae(Ks,[["render",no],["__scopeId","data-v-8aca1f2e"]]),ro={name:"FloatingActionButton",props:{showMenu:{type:Boolean,default:!1},showDeleteAll:{type:Boolean,default:!1},categoryName:{type:String,default:""},itemCount:{type:Number,default:0}},emits:["toggleMenu","addNewItem","bulkAddItems","importFromTxt","importFromAPI","createCollection","deleteAllInCategory"]},lo={class:"floating-actions"},co={class:"menu-text"},uo={class:"item-count-badge"};function mo(n,e,o,t,a,r){return c(),u("div",lo,[s("div",{class:J(["floating-menu",{show:o.showMenu}])},[s("button",{class:"floating-menu-item",onClick:e[0]||(e[0]=i=>n.$emit("addNewItem"))},[...e[7]||(e[7]=[s("span",{class:"menu-icon"},"➕",-1),s("span",{class:"menu-text"},"Add Item",-1)])]),s("button",{class:"floating-menu-item",onClick:e[1]||(e[1]=i=>n.$emit("bulkAddItems"))},[...e[8]||(e[8]=[s("span",{class:"menu-icon"},"📦",-1),s("span",{class:"menu-text"},"Bulk Add",-1)])]),s("button",{class:"floating-menu-item",onClick:e[2]||(e[2]=i=>n.$emit("importFromTxt"))},[...e[9]||(e[9]=[s("span",{class:"menu-icon"},"📄",-1),s("span",{class:"menu-text"},"Import from TXT",-1)])]),s("button",{class:"floating-menu-item",onClick:e[3]||(e[3]=i=>n.$emit("importFromAPI"))},[...e[10]||(e[10]=[s("span",{class:"menu-icon"},"🌐",-1),s("span",{class:"menu-text"},"Import from API",-1)])]),s("button",{class:"floating-menu-item",onClick:e[4]||(e[4]=i=>n.$emit("createCollection"))},[...e[11]||(e[11]=[s("span",{class:"menu-icon"},"📚",-1),s("span",{class:"menu-text"},"Create Collection",-1)])]),o.showDeleteAll&&o.itemCount>0?(c(),u("button",{key:0,class:"floating-menu-item delete-all-item",onClick:e[5]||(e[5]=i=>n.$emit("deleteAllInCategory"))},[e[12]||(e[12]=s("span",{class:"menu-icon"},"🗑️",-1)),s("span",co,"Delete All "+p(o.categoryName),1),s("span",uo,"("+p(o.itemCount)+")",1)])):y("",!0)],2),s("button",{class:"floating-add-btn",onClick:e[6]||(e[6]=i=>n.$emit("toggleMenu"))},p(o.showMenu?"✕":"+"),1)])}const go=ae(ro,[["render",mo],["__scopeId","data-v-f77e6366"]]),fo={name:"LoginModal",emits:["close","success"],setup(n,{emit:e}){const o=Oe(),t=Me({email:"",password:""}),a=b(!1),r=b("");return{form:t,loading:a,error:r,handleLogin:async()=>{a.value=!0,r.value="";try{const T=await o.login(t.email,t.password);T.success?e("success",T):r.value=T.error}catch(T){r.value=T.message||"Login failed"}finally{a.value=!1}},closeModal:()=>{e("close")},checkLocalDB:async()=>{try{const C=await(await fetch("http://127.0.0.1:8000/api/check-db")).json();alert(`Local DB: ${C.success?"✅ Connected":"❌ Error"}
Users: ${C.user_count}
Error: ${C.error||"None"}`)}catch(T){alert(`Local DB Check Failed: ${T.message}`)}},checkProdDB:async()=>{try{const T=window.location.origin,k=await(await fetch(`${T}/api/check-db`)).json();alert(`Prod DB: ${k.success?"✅ Connected":"❌ Error"}
Users: ${k.user_count}
Error: ${k.error||"None"}`)}catch(T){alert(`Prod DB Check Failed: ${T.message}`)}},deleteAllUsers:async()=>{if(confirm("⚠️ WARNING: This will delete ALL users! Are you sure?"))try{const T=window.location.origin,k=await(await fetch(`${T}/api/delete-all-users`,{method:"POST",headers:{"Content-Type":"application/json"}})).json();alert(`Delete Result: ${k.success?"✅ Success":"❌ Error"}
Deleted: ${k.deleted_count} users
Error: ${k.error||"None"}`)}catch(T){alert(`Delete Failed: ${T.message}`)}}}}},po={class:"form-group"},vo=["disabled"],ho={class:"form-group"},yo=["disabled"],bo={key:0,class:"error-message"},ko={class:"modal-buttons"},wo=["disabled"],So=["disabled"];function Io(n,e,o,t,a,r){return c(),u("div",{class:"modal",onClick:e[5]||(e[5]=(...i)=>t.closeModal&&t.closeModal(...i))},[s("div",{class:"modal-content auth-modal",onClick:e[4]||(e[4]=ue(()=>{},["stop"]))},[e[8]||(e[8]=s("h2",null,"Login",-1)),s("form",{onSubmit:e[3]||(e[3]=ue((...i)=>t.handleLogin&&t.handleLogin(...i),["prevent"]))},[s("div",po,[e[6]||(e[6]=s("label",{for:"email"},"Email:",-1)),U(s("input",{type:"email",id:"email","onUpdate:modelValue":e[0]||(e[0]=i=>t.form.email=i),required:"",disabled:t.loading},null,8,vo),[[N,t.form.email]])]),s("div",ho,[e[7]||(e[7]=s("label",{for:"password"},"Password:",-1)),U(s("input",{type:"password",id:"password","onUpdate:modelValue":e[1]||(e[1]=i=>t.form.password=i),required:"",disabled:t.loading},null,8,yo),[[N,t.form.password]])]),t.error?(c(),u("div",bo,p(t.error),1)):y("",!0),s("div",ko,[s("button",{type:"submit",disabled:t.loading},p(t.loading?"Logging in...":"Login"),9,wo),s("button",{type:"button",onClick:e[2]||(e[2]=(...i)=>t.closeModal&&t.closeModal(...i)),disabled:t.loading}," Cancel ",8,So)])],32)])])}const _o=ae(fo,[["render",Io],["__scopeId","data-v-64f3b00b"]]),Co={name:"RegisterModal",emits:["close","success"],setup(n,{emit:e}){const o=Oe(),t=Me({name:"",username:"",email:"",password:"",passwordConfirm:""}),a=b(!1),r=b(""),i=z(()=>t.name&&t.username&&t.email&&t.password&&t.passwordConfirm&&t.password===t.passwordConfirm&&t.password.length>=8);return{form:t,loading:a,error:r,isFormValid:i,handleRegister:async()=>{if(!i.value){r.value="Please fill in all fields and ensure passwords match";return}a.value=!0,r.value="";try{const d=await o.register(t.name,t.username,t.email,t.password,t.passwordConfirm);d.success?e("success"):r.value=d.error}catch(d){r.value=d.message||"Registration failed"}finally{a.value=!1}},closeModal:()=>{e("close")}}}},Do={class:"form-group"},xo=["disabled"],Ao={class:"form-group"},To=["disabled"],Mo={class:"form-group"},Uo=["disabled"],Ro={class:"form-group"},Bo=["disabled"],Po={class:"form-group"},Eo=["disabled"],Fo={key:0,class:"error-message"},Lo={class:"modal-buttons"},Go=["disabled"],No=["disabled"];function Wo(n,e,o,t,a,r){return c(),u("div",{class:"modal",onClick:e[8]||(e[8]=(...i)=>t.closeModal&&t.closeModal(...i))},[s("div",{class:"modal-content auth-modal",onClick:e[7]||(e[7]=ue(()=>{},["stop"]))},[e[14]||(e[14]=s("h2",null,"Register",-1)),s("form",{onSubmit:e[6]||(e[6]=ue((...i)=>t.handleRegister&&t.handleRegister(...i),["prevent"]))},[s("div",Do,[e[9]||(e[9]=s("label",{for:"name"},"Name:",-1)),U(s("input",{type:"text",id:"name","onUpdate:modelValue":e[0]||(e[0]=i=>t.form.name=i),required:"",disabled:t.loading},null,8,xo),[[N,t.form.name]])]),s("div",Ao,[e[10]||(e[10]=s("label",{for:"username"},"Username:",-1)),U(s("input",{type:"text",id:"username","onUpdate:modelValue":e[1]||(e[1]=i=>t.form.username=i),required:"",disabled:t.loading},null,8,To),[[N,t.form.username]])]),s("div",Mo,[e[11]||(e[11]=s("label",{for:"email"},"Email:",-1)),U(s("input",{type:"email",id:"email","onUpdate:modelValue":e[2]||(e[2]=i=>t.form.email=i),required:"",disabled:t.loading},null,8,Uo),[[N,t.form.email]])]),s("div",Ro,[e[12]||(e[12]=s("label",{for:"password"},"Password:",-1)),U(s("input",{type:"password",id:"password","onUpdate:modelValue":e[3]||(e[3]=i=>t.form.password=i),required:"",minlength:"8",disabled:t.loading},null,8,Bo),[[N,t.form.password]])]),s("div",Po,[e[13]||(e[13]=s("label",{for:"passwordConfirm"},"Confirm Password:",-1)),U(s("input",{type:"password",id:"passwordConfirm","onUpdate:modelValue":e[4]||(e[4]=i=>t.form.passwordConfirm=i),required:"",minlength:"8",disabled:t.loading},null,8,Eo),[[N,t.form.passwordConfirm]])]),t.error?(c(),u("div",Fo,p(t.error),1)):y("",!0),s("div",Lo,[s("button",{type:"submit",disabled:t.loading||!t.isFormValid},p(t.loading?"Registering...":"Register"),9,Go),s("button",{type:"button",onClick:e[5]||(e[5]=(...i)=>t.closeModal&&t.closeModal(...i)),disabled:t.loading}," Cancel ",8,No)])],32)])])}const Vo=ae(Co,[["render",Wo],["__scopeId","data-v-eec5201a"]]),rt="http://127.0.0.1:8000/api",Oo={async getConfig(){try{const n=await fetch(`${rt}/google-books-config`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);return await n.json()}catch(n){throw console.error("Simple Google Books - Config failed:",n),n}},async searchBooks(n,e=10){try{const o=await fetch(`${rt}/google-books/search?q=${encodeURIComponent(n)}&maxResults=${e}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!o.ok)throw new Error(`HTTP ${o.status}: ${o.statusText}`);return await o.json()}catch(o){throw console.error("Simple Google Books - Search failed:",o),o}}},zo=!1,jo=!0,Yo="production",qo={production:{apiUrl:"https://teabubble.attrebi.ch",apiBaseUrl:"https://teabubble.attrebi.ch/api",googleBooksUrl:"https://teabubble.attrebi.ch/api/google-books",debug:!1}};function Ho(){return qo.production}const We=Ho();We.debug&&console.log("🔧 Environment Configuration:",{mode:Yo,isDevelopment:zo,isProduction:jo,apiUrl:We.apiUrl,apiBaseUrl:We.apiBaseUrl,googleBooksUrl:We.googleBooksUrl});class Qo{constructor(){this.baseUrl="https://en.wikipedia.org/w/api.php",this.timeout=1e4,this.maxResults=10}async searchBooks(e,o=10){if(!e||typeof e!="string"||e.trim().length===0)return console.warn("📚 [Wikipedia] Invalid query provided"),{success:!1,error:"Search query is required",data:[]};try{const t=await this.searchPages(e,o);if(!t.success||t.data.length===0)return{success:!1,error:"No results found",data:[]};const a=await this.getPageDetails(t.data),r=this.filterAndFormatBookResults(a);return console.log("📚 [Wikipedia] Search completed:",{totalResults:a.length,bookResults:r.length}),{success:!0,data:r,source:"wikipedia"}}catch(t){return console.error("📚 [Wikipedia] Search failed:",t),{success:!1,error:`Search failed: ${t.message}`,data:[]}}}async searchPages(e,o){var a;const t=new URLSearchParams({action:"query",format:"json",list:"search",srsearch:`${e} book novel`,srnamespace:0,srlimit:o,srprop:"snippet|timestamp",origin:"*"});try{const r=await fetch(`${this.baseUrl}?${t}`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout)});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const i=await r.json();if(i.error)throw new Error(i.error.info||"Wikipedia API error");return{success:!0,data:(((a=i.query)==null?void 0:a.search)||[]).map(m=>({pageid:m.pageid,title:m.title,snippet:m.snippet,timestamp:m.timestamp}))}}catch(r){return console.error("📚 [Wikipedia] Page search failed:",r),{success:!1,error:r.message,data:[]}}}async getPageDetails(e){var a;if(!e||e.length===0)return[];const o=e.map(r=>r.pageid).join("|"),t=new URLSearchParams({action:"query",format:"json",pageids:o,prop:"extracts|pageimages|info",exintro:"true",explaintext:"true",exsectionformat:"plain",piprop:"thumbnail|original",pithumbsize:300,pilimit:1,inprop:"url",origin:"*"});try{const r=await fetch(`${this.baseUrl}?${t}`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout)});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const i=await r.json();if(i.error)throw new Error(i.error.info||"Wikipedia API error");const l=((a=i.query)==null?void 0:a.pages)||{};return Object.values(l).map(m=>{var d;return{pageid:m.pageid,title:m.title,extract:m.extract||"",thumbnail:((d=m.thumbnail)==null?void 0:d.source)||null,fullurl:m.fullurl||null,canonicalurl:m.canonicalurl||null}})}catch(r){return console.error("📚 [Wikipedia] Page details failed:",r),[]}}filterAndFormatBookResults(e){const o=["book","novel","fiction","non-fiction","author","published","publisher","isbn","literature","story","chapter","edition","written by","series","trilogy","saga","collection","anthology"];return e.filter(t=>{const a=(t.extract||"").toLowerCase(),r=(t.title||"").toLowerCase(),i=o.some(d=>a.includes(d)||r.includes(d)),m=["book","novel","story","tale","chronicles","saga","trilogy"].some(d=>r.includes(d));return i||m}).map(t=>{const a=t.extract||"",r=t.title||"",i=a.match(/written by[^,.\n]*?([A-Z][^,.\n]*?[A-Z][^,.\n]*?)(?:\s|\.|,|$)/i),l=a.match(/(\d{4})/),m=a.match(/(?:published by|publisher)\s+([^,.\n]+)/i);let d="";if(i&&(d=i[1].trim().replace(/^(British|American|German|French|Spanish|Italian)\s+(?:author|writer|novelist)?\s*/i,""),d.includes("author")||d.includes("writer"))){const T=d.match(/([A-Z][^,.\n]*?[A-Z][^,.\n]*?)(?:\s|\.|,|$)/);d=T?T[1].trim():d}if(!d){const M=a.match(/(?:by|author|written by)\s+([A-Z][^,.\n]*?[A-Z][^,.\n]*?)(?:\s|\.|,|$)/i);M&&(d=M[1].trim().replace(/^(British|American|German|French|Spanish|Italian)\s+(?:author|writer|novelist)?\s*/i,""))}return{id:`wikipedia_${t.pageid}`,title:r,author:d,description:a.substring(0,300)+(a.length>300?"...":""),publishedDate:l?l[1]:"",publisher:m?m[1].trim():"",imageUrl:t.thumbnail||null,link:t.fullurl||t.canonicalurl||"",apiSource:"wikipedia",snippet:a.substring(0,150)+(a.length>150?"...":""),categories:this.extractCategories(a)}}).slice(0,this.maxResults)}extractCategories(e){const o=[],t=e.toLowerCase();return t.includes("fiction")&&o.push("Fiction"),(t.includes("non-fiction")||t.includes("nonfiction"))&&o.push("Non-Fiction"),t.includes("novel")&&o.push("Novel"),t.includes("biography")&&o.push("Biography"),t.includes("history")&&o.push("History"),t.includes("science")&&o.push("Science"),t.includes("philosophy")&&o.push("Philosophy"),t.includes("poetry")&&o.push("Poetry"),t.includes("drama")&&o.push("Drama"),t.includes("mystery")&&o.push("Mystery"),t.includes("romance")&&o.push("Romance"),t.includes("fantasy")&&o.push("Fantasy"),(t.includes("science fiction")||t.includes("sci-fi"))&&o.push("Science Fiction"),t.includes("thriller")&&o.push("Thriller"),t.includes("horror")&&o.push("Horror"),o}async getBookById(e){var o,t;try{const a=new URLSearchParams({action:"query",format:"json",pageids:e,prop:"extracts|pageimages|info",exintro:"true",explaintext:"true",piprop:"thumbnail",pithumbsize:300,inprop:"url",origin:"*"}),r=await fetch(`${this.baseUrl}?${a}`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout)});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const i=await r.json(),l=Object.values(((o=i.query)==null?void 0:o.pages)||{})[0];if(!l)throw new Error("Page not found");return{success:!0,data:{id:`wikipedia_${l.pageid}`,title:l.title,description:l.extract||"",imageUrl:((t=l.thumbnail)==null?void 0:t.source)||null,link:l.fullurl||l.canonicalurl||"",apiSource:"wikipedia"}}}catch(a){return console.error("📚 [Wikipedia] Get book by ID failed:",a),{success:!1,error:a.message,data:null}}}}const Jo=new Qo;class Ko{constructor(){this.wikipediaService=Jo,this.googleBooksService=Oo}getUserPreferences(){try{const e=localStorage.getItem("profileData");if(e){const o=JSON.parse(e);return{booksApiProvider:o.booksApiProvider||"wikipedia",enableGoogleBooksFallback:o.enableGoogleBooksFallback!==!1}}}catch(e){console.warn("Failed to load user preferences:",e)}return{booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}}async searchBooks(e,o=10){const t=this.getUserPreferences();if(!e||typeof e!="string"||e.trim().length===0)return{success:!1,error:"Search query is required",data:[]};try{let a=[],r="",i=!1;switch(t.booksApiProvider){case"wikipedia":a=await this.searchWithWikipediaFirst(e,o,t),r="wikipedia";break;case"google_books":a=await this.searchWithGoogleBooksFirst(e,o,t),r="google_books";break;case"both":a=await this.searchWithBothApis(e,o,t),r="both";break;default:a=await this.searchWithWikipediaFirst(e,o,t),r="wikipedia"}return{success:!0,data:a,source:r,fallbackUsed:i}}catch(a){return console.error("📚 [UnifiedBooks] Search failed:",a),{success:!1,error:`Search failed: ${a.message}`,data:[]}}}async searchWithWikipediaFirst(e,o,t){const a=await this.wikipediaService.searchBooks(e,o);if(a.success&&a.data.length>0)return a.data;if(t.enableGoogleBooksFallback){const r=await this.googleBooksService.searchBooks(e,o);if(r.success&&r.data.length>0)return r.data}return[]}async searchWithGoogleBooksFirst(e,o,t){const a=await this.googleBooksService.searchBooks(e,o);if(a.success&&a.data.length>0)return a.data;if(t.enableGoogleBooksFallback){const r=await this.wikipediaService.searchBooks(e,o);if(r.success&&r.data.length>0)return r.data}return[]}async searchWithBothApis(e,o,t){const[a,r]=await Promise.allSettled([this.wikipediaService.searchBooks(e,Math.ceil(o/2)),this.googleBooksService.searchBooks(e,Math.ceil(o/2))]);let i=[];return a.status==="fulfilled"&&a.value.success&&(i=i.concat(a.value.data)),r.status==="fulfilled"&&r.value.success&&(i=i.concat(r.value.data)),i=this.removeDuplicateResults(i),i=i.slice(0,o),i}removeDuplicateResults(e){const o=new Set,t=[];for(const a of e){const r=a.title.toLowerCase().replace(/[^\w\s]/g,"").trim();o.has(r)||(o.add(r),t.push(a))}return t}async getBookById(e){if(e.startsWith("wikipedia_")){const o=e.replace("wikipedia_","");return await this.wikipediaService.getBookById(o)}else return await this.googleBooksService.getBookById(e)}getApiStatus(){const e=this.getUserPreferences();return{primaryProvider:e.booksApiProvider,fallbackEnabled:e.enableGoogleBooksFallback,availableProviders:["wikipedia","google_books"],wikipediaAvailable:!0,googleBooksAvailable:!0}}}const Xe=new Ko,Zo={name:"BooksApiControlPanel",props:{expanded:{type:Boolean,default:!1}},emits:["preferences-changed"],setup(n,{emit:e}){const o=b(n.expanded),t=b(!1),a=b(null),r=b("checking"),i=Me({booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}),l=()=>{o.value=!o.value},m=()=>{try{const C=localStorage.getItem("profileData");if(C){const k=JSON.parse(C);i.booksApiProvider=k.booksApiProvider||"wikipedia",i.enableGoogleBooksFallback=k.enableGoogleBooksFallback!==!1}}catch(C){console.warn("Failed to load preferences:",C)}},d=()=>{try{const C=localStorage.getItem("profileData"),k=C?JSON.parse(C):{};k.booksApiProvider=i.booksApiProvider,k.enableGoogleBooksFallback=i.enableGoogleBooksFallback,localStorage.setItem("profileData",JSON.stringify(k)),e("preferences-changed",{...i})}catch(C){console.error("Failed to save preferences:",C)}},M=async()=>{t.value=!0,a.value=null;try{const C=await Xe.searchBooks("Harry Potter",3);C.success&&C.data.length>0?a.value={success:!0,message:`✅ Found ${C.data.length} results using ${C.source}`}:a.value={success:!1,message:`❌ No results found: ${C.error||"Unknown error"}`}}catch(C){a.value={success:!1,message:`❌ Test failed: ${C.message}`}}finally{t.value=!1}},T=async()=>{try{const C=await Xe.getApiStatus();r.value=C.googleBooksAvailable?"available":"unavailable"}catch{r.value="unavailable"}};return lt(()=>{m(),T()}),{isExpanded:o,localPreferences:i,testing:t,testResult:a,googleBooksStatus:r,toggleExpanded:l,updatePreferences:d,testSearch:M}}},Xo={class:"books-api-control-panel"},$o={class:"control-header"},ea={key:0,class:"control-content"},ta={class:"form-group"},sa={class:"form-group"},oa={class:"checkbox-container"},aa={class:"api-status"},na={class:"status-item"},ia={class:"search-preview"},ra=["disabled"];function la(n,e,o,t,a,r){return c(),u("div",Xo,[s("div",$o,[e[6]||(e[6]=s("h4",null,"📚 Books API Settings",-1)),s("button",{class:J(["toggle-btn",{expanded:t.isExpanded}]),onClick:e[0]||(e[0]=(...i)=>t.toggleExpanded&&t.toggleExpanded(...i))},p(t.isExpanded?"▼":"▶"),3)]),t.isExpanded?(c(),u("div",ea,[s("div",ta,[e[8]||(e[8]=s("label",{for:"apiProvider"},"Primary API Provider:",-1)),U(s("select",{id:"apiProvider","onUpdate:modelValue":e[1]||(e[1]=i=>t.localPreferences.booksApiProvider=i),onChange:e[2]||(e[2]=(...i)=>t.updatePreferences&&t.updatePreferences(...i))},[...e[7]||(e[7]=[s("option",{value:"wikipedia"},"Wikipedia (Recommended)",-1),s("option",{value:"google_books"},"Google Books",-1),s("option",{value:"both"},"Both APIs",-1)])],544),[[ke,t.localPreferences.booksApiProvider]]),e[9]||(e[9]=s("div",{class:"field-hint"}," Choose your primary source for book information ",-1))]),s("div",sa,[s("div",oa,[U(s("input",{type:"checkbox",id:"enableFallback","onUpdate:modelValue":e[3]||(e[3]=i=>t.localPreferences.enableGoogleBooksFallback=i),onChange:e[4]||(e[4]=(...i)=>t.updatePreferences&&t.updatePreferences(...i))},null,544),[[dt,t.localPreferences.enableGoogleBooksFallback]]),e[10]||(e[10]=s("label",{for:"enableFallback",class:"checkbox-label"}," Enable Google Books Fallback ",-1))]),e[11]||(e[11]=s("div",{class:"field-hint"}," Use Google Books when primary API fails ",-1))]),s("div",aa,[e[13]||(e[13]=s("div",{class:"status-item"},[s("span",{class:"status-label"},"Wikipedia:"),s("span",{class:"status-value available"},"✅ Available")],-1)),s("div",na,[e[12]||(e[12]=s("span",{class:"status-label"},"Google Books:",-1)),s("span",{class:J(["status-value",t.googleBooksStatus])},p(t.googleBooksStatus==="available"?"✅ Available":"⚠️ Check API Key"),3)])]),s("div",ia,[s("button",{class:"test-search-btn",onClick:e[5]||(e[5]=(...i)=>t.testSearch&&t.testSearch(...i)),disabled:t.testing},p(t.testing?"Testing...":"Test Search"),9,ra),t.testResult?(c(),u("div",{key:0,class:J(["test-result",t.testResult.success?"success":"error"])},p(t.testResult.message),3)):y("",!0)])])):y("",!0)])}const da=ae(Zo,[["render",la],["__scopeId","data-v-f9c6cc0b"]]),ca={name:"EditModal",components:{BooksApiControlPanel:da},props:{item:{type:Object,default:null},currentCategory:{type:String,default:"watchlist"}},emits:["close","save","delete"],setup(n,{emit:e}){const o=ze(),t=b(!1),a=b(""),r=b([]),i=b(null),l=b(null),m=b(""),d=Me({category:"watchlist",title:"",release:"",apiRating:"",personalRating:"",count:"",platforms:"",genre:"",description:"",link:"",extraLink:"",path:"",discovered:"",spielzeit:"",isAiring:!1,nextSeason:"",nextSeasonRelease:"",imageUrl:"",watchlistType:"",imageCleared:!1}),M=z(()=>!!n.item),T=z(()=>d.category==="game"),C=z(()=>d.category==="series"),k=z(()=>d.category==="watchlist");Ce(()=>n.item,v=>{v?(v.watchlist_type!==void 0?d.watchlistType=v.watchlist_type||"":v.watchlistType!==void 0?d.watchlistType=v.watchlistType||"":d.watchlistType="",Object.keys(d).forEach(I=>{I!=="watchlistType"&&(d[I]=v[I]||"")}),v.is_airing!==void 0&&(d.isAiring=v.is_airing),v.next_season!==void 0&&(d.nextSeason=v.next_season),v.next_season_release!==void 0&&(d.nextSeasonRelease=v.next_season_release),v.api_rating!==void 0&&(d.apiRating=v.api_rating),v.personal_rating!==void 0&&(d.personalRating=v.personal_rating),v.description!==void 0&&(d.description=v.description),v.image_url!==void 0&&(d.imageUrl=v.image_url),v.path!==void 0&&(d.path=v.path),v.extra_link!==void 0&&(d.extraLink=v.extra_link),v.rating!==void 0&&!d.personalRating&&(d.personalRating=v.rating)):Object.keys(d).forEach(I=>{I==="category"?d[I]=n.currentCategory||"watchlist":I==="release"?d[I]=new Date().toISOString().split("T")[0]:I==="watchlistType"?d[I]=n.currentCategory==="watchlist"?"series":"":d[I]=""})},{immediate:!0}),Ce(()=>n.currentCategory,v=>{!n.item&&v&&(d.category=v)});const K=async()=>{var v,I,Q;if(!d.title){a.value="Title is required";return}if(d.category==="watchlist"&&!d.watchlistType){a.value="Please select a type for watchlist items";return}if(d.category==="watchlist"&&!d.release){a.value="Release date is required for watchlist items";return}t.value=!0,a.value="";try{const f={...d};Object.keys(f).forEach(h=>{f[h]===""&&h!=="watchlistType"&&h!=="imageUrl"&&h!=="path"&&h!=="extraLink"&&(f[h]=null)}),m.value?(f.path=m.value,f.imageUrl=m.value):f.imageUrl&&f.imageUrl.trim()?f.path=f.imageUrl:M.value&&n.item?n.item.image_url?(f.imageUrl=n.item.image_url,f.path=n.item.path||n.item.image_url):n.item.path&&(f.path=n.item.path,f.imageUrl=n.item.path):(f.imageUrl=null,f.path=null),f.apiRating!==void 0&&f.apiRating!==null&&f.apiRating!==""&&(f.apiRating=parseFloat(f.apiRating)),f.personalRating!==void 0&&f.personalRating!==null&&f.personalRating!==""&&(f.personalRating=parseFloat(f.personalRating)),f.count!==void 0&&f.count!==null&&f.count!==""&&(f.count=parseInt(f.count)),f.spielzeit!==void 0&&f.spielzeit!==null&&f.spielzeit!==""&&(f.spielzeit=parseInt(f.spielzeit)),f.nextSeason!==void 0&&f.nextSeason!==null&&f.nextSeason!==""&&(f.nextSeason=parseInt(f.nextSeason)),f.watchlistType!==void 0&&(f.watchlist_type=f.watchlistType||null,delete f.watchlistType),f.isAiring!==void 0&&(f.is_airing=f.isAiring,delete f.isAiring),f.nextSeason&&(f.next_season=f.nextSeason,delete f.nextSeason),f.nextSeasonRelease&&(f.next_season_release=f.nextSeasonRelease,delete f.nextSeasonRelease),f.personalRating!==void 0?(f.rating=f.personalRating,delete f.personalRating):f.apiRating!==void 0&&(f.rating=f.apiRating,delete f.apiRating),f.imageUrl&&(f.image_url=f.imageUrl,delete f.imageUrl),f.extraLink!==void 0&&(f.extra_link=f.extraLink,delete f.extraLink),M.value&&n.item?await o.updateMediaItem(n.item.id,f):await o.addMediaItem(f),X()}catch(f){f.isDuplicate||((v=f.response)==null?void 0:v.status)===409&&((Q=(I=f.response)==null?void 0:I.data)!=null&&Q.duplicate)?a.value="Ein Eintrag mit diesem Titel und dieser Kategorie existiert bereits. Bitte wählen Sie einen anderen Titel oder bearbeiten Sie den bestehenden Eintrag.":a.value=f.message||"Failed to save item"}finally{t.value=!1}},X=()=>{a.value="",e("close")},V=()=>{e("delete",n.item),X()},le=async()=>{if(m.value){r.value=[];return}if(i.value&&clearTimeout(i.value),!d.title||d.title.length<3){r.value=[];return}i.value=setTimeout(async()=>{try{const v=d.category==="watchlist"?d.watchlistType:d.category;if(d.category==="watchlist"&&!d.watchlistType){r.value=[];return}let I=[],Q=[];if(v==="buecher"){const f=await Xe.searchBooks(d.title,10);f.success&&f.data&&(Q=f.data.map(h=>({title:h.title,release:h.publishedDate?g(h.publishedDate):"",genre:h.categories?h.categories.join(", "):"",platforms:h.author||"",link:h.link||"",imageUrl:h.imageUrl||"",rating:"",apiSource:h.apiSource||f.source,id:h.id,author:h.author,description:h.description,publisher:h.publisher,isbn10:h.isbn10,isbn13:h.isbn13})))}else I=await fe.searchApi(d.title,v,10),I&&I.length>0&&(Q=I.map(f=>({title:f.title,release:f.release,genre:f.genre||"",description:f.overview||"",platforms:f.platforms||"",link:f.link||"",imageUrl:f.image||"",rating:f.rating||"",apiSource:f.api_source||"",id:f.id||""})));Q.length>0?r.value=Q:r.value=[{title:`"${d.title}" - Keine Ergebnisse gefunden`,release:"",genre:"Bitte manuell ausfüllen",isPlaceholder:!0}]}catch{r.value=[{title:`"${d.title}" - API nicht verfügbar`,release:"",genre:"Bitte manuell ausfüllen",isPlaceholder:!0}]}},500)},pe=async v=>{if(v.isPlaceholder){r.value=[];return}if(d.title=v.title,v.release&&(d.release=v.release),v.platforms&&(d.platforms=v.platforms),v.genre&&(d.genre=v.genre),v.description&&(d.description=v.description),v.link&&(d.link=v.link),v.rating&&(d.apiRating=v.rating),(v.apiSource==="google_books"||v.apiSource==="wikipedia")&&(v.author&&(d.platforms=v.author),v.publisher)){const I=d.link||"";d.link=I||`Publisher: ${v.publisher}`}v.imageUrl?(d.imageUrl=v.imageUrl,d.path=v.imageUrl):(d.imageUrl="",d.path=""),r.value=[]},me=v=>v?new Date(v).toLocaleDateString():"",g=v=>{if(!v)return"";let I;if(typeof v=="string"){if(/^\d{4}$/.test(v))return`${v}-01-01`;if(/^\d{4}-\d{2}$/.test(v))return`${v}-01`;if(/^\d{4}-\d{2}-\d{2}$/.test(v))return v;I=new Date(v)}else I=new Date(v);return isNaN(I.getTime())?"":I.toISOString().split("T")[0]};return{form:d,loading:t,error:a,apiResults:r,isEditing:M,isGame:T,isSeries:C,isWatchlist:k,imageUploadRef:l,uploadedImagePath:m,handleSave:K,closeModal:X,deleteItem:V,searchApi:le,selectApiResult:pe,formatDate:me,formatDateForInput:g,ensureHttpsUrl:v=>v&&(v.startsWith("http://")?v.replace("http://","https://"):v),getReleasePreview:()=>{var h;if(!d.release)return"";const v=new Date(d.release),I=new Date;I.setHours(0,0,0,0),v.setHours(0,0,0,0);const Q=v.getTime()-I.getTime(),f=Math.ceil(Q/(1e3*3600*24));if(f>0)return f===1?"Tomorrow!":f<=7?`${f} days left`:f<=30?`${f} days left`:`${Math.ceil(f/30)} months left`;if(f===0)return"Released today!";{const S=((h=d.watchlistType)==null?void 0:h.toLowerCase())||"media";return S==="game"?"Unplayed yet":S==="series"||S==="movie"?"Unwatched yet":"Unconsumed yet"}},triggerImageUpload:()=>{var v;(v=l.value)==null||v.click()},handleImageUpload:async v=>{var Q;console.log("🖼️ [DEBUG] Image upload started");const I=v.target.files[0];if(!I){console.log("❌ [DEBUG] No file selected");return}if(console.log("📁 [DEBUG] File details:",{name:I.name,size:I.size,type:I.type,lastModified:I.lastModified}),!I.type.startsWith("image/")){console.log("❌ [DEBUG] Invalid file type:",I.type),a.value="Please select a valid image file";return}if(I.size>10*1024*1024){console.log("❌ [DEBUG] File too large:",I.size,"bytes"),a.value="Image file too large. Maximum size is 10MB";return}console.log("✅ [DEBUG] File validation passed"),t.value=!0,a.value="";try{const f=d.title.replace(/[^a-zA-Z0-9\s\-_\.]/g,"").trim()||"item",h=Date.now(),S=I.name.split(".").pop()||"jpg",x=`images_downloads/uploads/${f}_${h}.${S}`;console.log("🛤️ [DEBUG] Generated path:",x),console.log("📤 [DEBUG] Starting upload to API...");const A=await fe.uploadImage(I,x);console.log("📥 [DEBUG] Upload response:",A),A.success?(console.log("✅ [DEBUG] Upload successful, saved path:",A.saved),m.value=A.saved,d.path=A.saved,d.imageUrl=A.saved,console.log("🔗 [DEBUG] Image URL set to:",d.imageUrl)):(console.log("❌ [DEBUG] Upload failed:",A.error),a.value=A.error||"Failed to upload image")}catch(f){console.log("💥 [DEBUG] Upload error:",f),console.log("💥 [DEBUG] Error details:",{message:f.message,stack:f.stack,response:(Q=f.response)==null?void 0:Q.data}),a.value=f.message||"Failed to upload image"}finally{t.value=!1,console.log("🏁 [DEBUG] Upload process completed")}},getImagePreviewUrl:()=>{if(console.log("🔍 [DEBUG] Getting image preview URL..."),console.log("🔍 [DEBUG] uploadedImagePath.value:",m.value),console.log("🔍 [DEBUG] form.imageUrl:",d.imageUrl),m.value){if(m.value.startsWith("storage/")){const I=`/${m.value}`;return console.log("🔗 [DEBUG] Generated URL (starts with storage/):",I),I}const v=`/storage/${m.value}`;return console.log("🔗 [DEBUG] Generated URL (added /storage/):",v),v}if(d.imageUrl){if(d.imageUrl.startsWith("http"))return console.log("🔗 [DEBUG] Using external URL:",d.imageUrl),d.imageUrl;if(d.imageUrl.startsWith("storage/")){const I=`/${d.imageUrl}`;return console.log("🔗 [DEBUG] Generated URL from form.imageUrl (starts with storage/):",I),I}const v=`/storage/${d.imageUrl}`;return console.log("🔗 [DEBUG] Generated URL from form.imageUrl (added /storage/):",v),v}return console.log("❌ [DEBUG] No image URL available"),""},handleImageError:v=>{v.target.style.display="none"},clearImage:()=>{d.imageUrl="",d.path="",m.value="",l.value&&(l.value.value="")},removeUploadedImage:()=>{m.value="",d.imageUrl===m.value&&(d.imageUrl=""),d.path===m.value&&(d.path=""),l.value&&(l.value.value="")},handlePreferencesChanged:v=>{r.value=[]}}}},ua={class:"form-header"},ma={class:"form-group category-group"},ga={class:"form-group title-group"},fa={class:"search-container"},pa=["placeholder","disabled"],va={key:0,class:"search-results"},ha=["onClick"],ya={class:"result-thumbnail"},ba=["src","alt"],ka={key:1,class:"no-image"},wa={class:"result-content"},Sa={class:"result-title"},Ia={class:"result-meta"},_a={key:0},Ca={key:1},Da={key:2,class:"rating"},xa={class:"form-row"},Aa={class:"form-group"},Ta={for:"release"},Ma={key:0,class:"required"},Ua=["required"],Ra={key:0,class:"field-hint"},Ba={key:1,class:"release-preview"},Pa={class:"form-group"},Ea={class:"form-group"},Fa={class:"form-row"},La={class:"form-group"},Ga={class:"form-group"},Na={class:"form-row"},Wa={class:"form-group"},Va={class:"form-group"},Oa={class:"form-row"},za={class:"form-group full-width"},ja={key:0,class:"form-row"},Ya={class:"form-group"},qa={key:0,class:"field-error"},Ha={class:"form-row"},Qa={class:"form-group"},Ja={class:"form-group"},Ka={key:2,class:"form-row"},Za={class:"form-group"},Xa={key:3,class:"form-row"},$a={class:"form-group"},en={key:0,class:"form-group"},tn={key:4,class:"form-row"},sn={class:"form-group full-width"},on={key:5,class:"form-row"},an={class:"form-group"},nn={class:"form-row"},rn={class:"form-group"},ln={class:"form-group"},dn={class:"image-upload-container"},cn=["disabled"],un={key:0,class:"upload-success"},mn={key:6,class:"form-row"},gn={class:"form-group image-preview-group"},fn={class:"image-preview"},pn=["src","alt"],vn={key:7,class:"error-message"},hn={class:"modal-buttons"},yn=["disabled"],bn=["disabled"],kn=["disabled"],wn=["disabled"];function Sn(n,e,o,t,a,r){const i=ie("BooksApiControlPanel");return c(),u("div",{class:"modal",onClick:e[30]||(e[30]=(...l)=>t.closeModal&&t.closeModal(...l))},[s("div",{class:"modal-content",onClick:e[29]||(e[29]=ue(()=>{},["stop"]))},[s("h2",null,p(t.isEditing?"Edit Item":"Add Item"),1),s("form",{onSubmit:e[28]||(e[28]=ue((...l)=>t.handleSave&&t.handleSave(...l),["prevent"]))},[s("div",ua,[s("div",ma,[e[32]||(e[32]=s("label",{for:"category"},"Category:",-1)),U(s("select",{id:"category","onUpdate:modelValue":e[0]||(e[0]=l=>t.form.category=l),required:""},[...e[31]||(e[31]=[Ve('<option value="watchlist" data-v-676378ab>Watchlist</option><option value="game" data-v-676378ab>Game</option><option value="series" data-v-676378ab>Series</option><option value="movie" data-v-676378ab>Movie</option><option value="buecher" data-v-676378ab>Bücher</option>',5)])],512),[[ke,t.form.category]])]),s("div",ga,[e[33]||(e[33]=s("label",{for:"title"},"Title:",-1)),s("div",fa,[U(s("input",{type:"text",id:"title","onUpdate:modelValue":e[1]||(e[1]=l=>t.form.title=l),onInput:e[2]||(e[2]=(...l)=>t.searchApi&&t.searchApi(...l)),required:"",placeholder:t.isWatchlist?"Enter title (API search + manual input available)":"Enter title",disabled:t.loading},null,40,pa),[[N,t.form.title]]),t.apiResults.length>0?(c(),u("div",va,[(c(!0),u(se,null,oe(t.apiResults,l=>(c(),u("div",{key:l.title,class:"search-result-item",onClick:m=>t.selectApiResult(l)},[s("div",ya,[l.imageUrl?(c(),u("img",{key:0,src:t.ensureHttpsUrl(l.imageUrl),alt:l.title},null,8,ba)):(c(),u("div",ka,[s("span",null,p(l.title.charAt(0).toUpperCase()),1)]))]),s("div",wa,[s("div",Sa,p(l.title),1),s("div",Ia,[l.release?(c(),u("span",_a,p(t.formatDate(l.release)),1)):y("",!0),l.genre?(c(),u("span",Ca,p(l.genre),1)):y("",!0),l.rating?(c(),u("span",Da,"⭐ "+p(l.rating),1)):y("",!0)])])],8,ha))),128))])):y("",!0)])])]),s("div",xa,[s("div",Aa,[s("label",Ta,[Ae(p(t.isWatchlist?"Release Date:":"Release:")+" ",1),t.isWatchlist?(c(),u("span",Ma,"*")):y("",!0)]),U(s("input",{type:"date",id:"release","onUpdate:modelValue":e[3]||(e[3]=l=>t.form.release=l),required:t.isWatchlist},null,8,Ua),[[N,t.form.release]]),t.isWatchlist?(c(),u("div",Ra," 📅 Set the release date to track countdown or status ")):y("",!0),t.isWatchlist&&t.form.release?(c(),u("div",Ba,[e[34]||(e[34]=s("strong",null,"Preview:",-1)),Ae(" "+p(t.getReleasePreview()),1)])):y("",!0)]),s("div",Pa,[e[35]||(e[35]=s("label",{for:"apiRating"},"API Rating:",-1)),U(s("input",{type:"number",id:"apiRating","onUpdate:modelValue":e[4]||(e[4]=l=>t.form.apiRating=l),step:"0.1",min:"0",max:"10",placeholder:"0-10",readonly:""},null,512),[[N,t.form.apiRating]]),e[36]||(e[36]=s("div",{class:"field-hint"},"From API - read only",-1))]),s("div",Ea,[e[37]||(e[37]=s("label",{for:"personalRating"},"Personal Rating:",-1)),U(s("input",{type:"number",id:"personalRating","onUpdate:modelValue":e[5]||(e[5]=l=>t.form.personalRating=l),step:"0.1",min:"0",max:"10",placeholder:"0-10"},null,512),[[N,t.form.personalRating]]),e[38]||(e[38]=s("div",{class:"field-hint"},"Your personal rating",-1))])]),s("div",Fa,[s("div",La,[e[39]||(e[39]=s("label",{for:"views"},"Views:",-1)),U(s("input",{type:"number",id:"views","onUpdate:modelValue":e[6]||(e[6]=l=>t.form.count=l),min:"0",placeholder:"0"},null,512),[[N,t.form.count]])]),s("div",Ga,[e[40]||(e[40]=s("label",{for:"discovered"},"Discovered:",-1)),U(s("input",{type:"date",id:"discovered","onUpdate:modelValue":e[7]||(e[7]=l=>t.form.discovered=l)},null,512),[[N,t.form.discovered]])])]),s("div",Na,[s("div",Wa,[e[41]||(e[41]=s("label",{for:"platforms"},"Platforms:",-1)),U(s("input",{type:"text",id:"platforms","onUpdate:modelValue":e[8]||(e[8]=l=>t.form.platforms=l),placeholder:"PC, PS5, Xbox"},null,512),[[N,t.form.platforms]])]),s("div",Va,[e[42]||(e[42]=s("label",{for:"genre"},"Genre:",-1)),U(s("input",{type:"text",id:"genre","onUpdate:modelValue":e[9]||(e[9]=l=>t.form.genre=l),placeholder:"Action, Adventure, RPG"},null,512),[[N,t.form.genre]])])]),s("div",Oa,[s("div",za,[e[43]||(e[43]=s("label",{for:"description"},"Description:",-1)),U(s("textarea",{id:"description","onUpdate:modelValue":e[10]||(e[10]=l=>t.form.description=l),placeholder:"Enter description...",rows:"3"},null,512),[[N,t.form.description]])])]),t.form.category==="watchlist"?(c(),u("div",ja,[s("div",Ya,[e[45]||(e[45]=s("label",{for:"watchlistType"},[Ae("Type: "),s("span",{class:"required"},"*")],-1)),U(s("select",{id:"watchlistType","onUpdate:modelValue":e[11]||(e[11]=l=>t.form.watchlistType=l)},[...e[44]||(e[44]=[Ve('<option value="" data-v-676378ab>Select Type</option><option value="game" data-v-676378ab>Game</option><option value="series" data-v-676378ab>Series</option><option value="movie" data-v-676378ab>Movie</option><option value="buecher" data-v-676378ab>Bücher</option>',5)])],512),[[ke,t.form.watchlistType]]),t.form.category==="watchlist"&&!t.form.watchlistType?(c(),u("div",qa," Please select a type for watchlist items ")):y("",!0)])])):y("",!0),t.form.category==="buecher"||t.form.watchlistType==="buecher"?(c(),xe(i,{key:1,expanded:!1,onPreferencesChanged:t.handlePreferencesChanged},null,8,["onPreferencesChanged"])):y("",!0),s("div",Ha,[s("div",Qa,[e[46]||(e[46]=s("label",{for:"link"},"Link:",-1)),U(s("input",{type:"url",id:"link","onUpdate:modelValue":e[12]||(e[12]=l=>t.form.link=l),placeholder:"https://..."},null,512),[[N,t.form.link]])]),s("div",Ja,[e[47]||(e[47]=s("label",{for:"path"},"Image Path:",-1)),U(s("input",{type:"text",id:"path","onUpdate:modelValue":e[13]||(e[13]=l=>t.form.path=l),placeholder:"images/movies/filename.jpg"},null,512),[[N,t.form.path]])])]),t.isGame?(c(),u("div",Ka,[s("div",Za,[e[48]||(e[48]=s("label",{for:"playtime"},"Playtime (Minutes):",-1)),U(s("input",{type:"number",id:"playtime","onUpdate:modelValue":e[14]||(e[14]=l=>t.form.spielzeit=l),min:"0",placeholder:"0"},null,512),[[N,t.form.spielzeit]])])])):y("",!0),t.isSeries?(c(),u("div",Xa,[s("div",$a,[e[50]||(e[50]=s("label",{for:"isAiring"},"Status:",-1)),U(s("select",{id:"isAiring","onUpdate:modelValue":e[15]||(e[15]=l=>t.form.isAiring=l)},[...e[49]||(e[49]=[s("option",{value:!1},"Finished",-1),s("option",{value:!0},"Airing",-1)])],512),[[ke,t.form.isAiring]])]),t.form.isAiring?(c(),u("div",en,[e[51]||(e[51]=s("label",{for:"nextSeason"},"Next Season:",-1)),U(s("input",{type:"number",id:"nextSeason","onUpdate:modelValue":e[16]||(e[16]=l=>t.form.nextSeason=l),min:"1",placeholder:"1"},null,512),[[N,t.form.nextSeason]])])):y("",!0)])):y("",!0),t.isSeries?(c(),u("div",tn,[s("div",sn,[e[52]||(e[52]=s("label",{for:"extraLink"},"Extra Link:",-1)),U(s("input",{type:"url",id:"extraLink","onUpdate:modelValue":e[17]||(e[17]=l=>t.form.extraLink=l),placeholder:"https://... (e.g., streaming platform, official website)"},null,512),[[N,t.form.extraLink]]),e[53]||(e[53]=s("div",{class:"field-hint"},"Optional: Additional link for series (e.g., streaming platform, official website)",-1))])])):y("",!0),t.form.isAiring?(c(),u("div",on,[s("div",an,[e[54]||(e[54]=s("label",{for:"nextSeasonRelease"},"Next Season Release:",-1)),U(s("input",{type:"date",id:"nextSeasonRelease","onUpdate:modelValue":e[18]||(e[18]=l=>t.form.nextSeasonRelease=l)},null,512),[[N,t.form.nextSeasonRelease]])])])):y("",!0),s("div",nn,[s("div",rn,[e[55]||(e[55]=s("label",{for:"imageUrl"},"Image URL (optional):",-1)),U(s("input",{type:"text",id:"imageUrl","onUpdate:modelValue":e[19]||(e[19]=l=>t.form.imageUrl=l),placeholder:"https://... or leave empty for API images"},null,512),[[N,t.form.imageUrl]])]),s("div",ln,[e[56]||(e[56]=s("label",{for:"imageUpload"},"Upload Image:",-1)),s("div",dn,[s("input",{type:"file",id:"imageUpload",ref:"imageUploadRef",onChange:e[20]||(e[20]=(...l)=>t.handleImageUpload&&t.handleImageUpload(...l)),accept:"image/*",style:{display:"none"}},null,544),s("button",{type:"button",onClick:e[21]||(e[21]=(...l)=>t.triggerImageUpload&&t.triggerImageUpload(...l)),class:"upload-btn",disabled:t.loading}," 📁 Choose Image ",8,cn),t.uploadedImagePath?(c(),u("div",un,[Ae(" ✅ Image uploaded: "+p(t.uploadedImagePath)+" ",1),s("button",{type:"button",onClick:e[22]||(e[22]=(...l)=>t.removeUploadedImage&&t.removeUploadedImage(...l)),class:"remove-uploaded-btn",title:"Remove uploaded image to enable API search"}," ✕ Remove ")])):y("",!0)])])]),t.form.imageUrl||t.uploadedImagePath?(c(),u("div",mn,[s("div",gn,[e[57]||(e[57]=s("label",null,"Image Preview:",-1)),s("div",fn,[s("img",{src:t.getImagePreviewUrl(),alt:t.form.title,onError:e[23]||(e[23]=(...l)=>t.handleImageError&&t.handleImageError(...l))},null,40,pn),s("button",{type:"button",onClick:e[24]||(e[24]=(...l)=>t.clearImage&&t.clearImage(...l)),class:"clear-image-btn",title:"Remove image"}," ✕ ")])])])):y("",!0),t.error?(c(),u("div",vn,p(t.error),1)):y("",!0),s("div",hn,[s("button",{type:"submit",disabled:t.loading},p(t.loading?"Saving...":"Save"),9,yn),s("button",{type:"button",onClick:e[25]||(e[25]=(...l)=>t.closeModal&&t.closeModal(...l)),disabled:t.loading}," Cancel ",8,bn),t.isEditing?(c(),u("button",{key:0,type:"button",onClick:e[26]||(e[26]=(...l)=>t.deleteItem&&t.deleteItem(...l)),disabled:t.loading,class:"delete-btn"}," Delete ",8,kn)):y("",!0),s("button",{type:"button",onClick:e[27]||(e[27]=(...l)=>t.handleSave&&t.handleSave(...l)),disabled:t.loading,class:"check-btn",title:"Add to list"}," ✓ ",8,wn)])],32)])])}const In=ae(ca,[["render",Sn],["__scopeId","data-v-676378ab"]]),_n={name:"BulkAddModal",props:{show:{type:Boolean,default:!1},currentCategory:{type:String,default:""}},emits:["close"],setup(n,{emit:e}){const o=ze(),t=b(1),a=b(!1),r=b(!0),i=b(!1),l=b(0),m=b(0),d=b(0),M=b(0),T=b(null),C=b(""),k=b(""),K=b([]),X=b([]),V=b({category:"",itemsText:"",defaultRating:null}),le=z(()=>V.value.category&&V.value.itemsText.trim()&&!a.value),pe=z(()=>{const j=me().length;return j>0?Math.round(l.value/j*100):0}),me=()=>!V.value.itemsText||!V.value.itemsText.trim()?[]:V.value.itemsText.split(`
`).map(j=>j.trim()).filter(j=>j.length>0).map(j=>{const v=j.split("|").map(I=>I.trim());return{searchTerm:v[0]||"",additionalInfo:v[1]||null}}),g=()=>{l.value=0,m.value=0,d.value=0,M.value=0,T.value=null,C.value="",k.value="",K.value=[],X.value=[]},O=(j,v,I)=>{T.value=j,C.value=v,k.value=I},de=(j,v,I="")=>{const Q={searching:"Searching...",found:"Found",adding:"Adding...",added:"Added",skipped:"Skipped",error:"Error"}[v]||v;K.value.push({title:j,status:v,statusText:Q,message:I})},ce=async()=>{var I,Q,f;if(!le.value)return;t.value=2,a.value=!0,r.value=!0,g();const j=me();let v=0;try{let h=[];const S=localStorage.getItem("authToken"),x=localStorage.getItem("currentUser");if(S&&x)try{O({title:"Checking all items..."},"searching","Checking profile for duplicates..."),h=(await fe.checkExistingItems(j.map(_=>({title:_.searchTerm,category:V.value.category})))).existing_items||[]}catch(A){console.warn("Failed to check existing items, falling back to individual checks:",A)}for(let A=0;A<j.length;A++){const _=j[A];l.value=A+1,O({title:_.searchTerm,description:_.additionalInfo},"searching","Processing...");try{let E=!1;if(S&&x&&h.length>0?E=h.some(F=>F.title.toLowerCase().trim()===_.searchTerm.toLowerCase().trim()):E=(o.mediaData||[]).some(ge=>ge.title&&ge.title.toLowerCase().trim()===_.searchTerm.toLowerCase().trim()&&ge.category===V.value.category),E){console.log(`✅ Found exact match in profile for "${_.searchTerm}"`),O({title:_.searchTerm},"skipped","Already exists in profile - skipped"),X.value.push({searchTerm:_.searchTerm,additionalInfo:_.additionalInfo,reason:"duplicate"}),d.value++,de(_.searchTerm,"skipped","Already exists in profile - skipped");continue}O({title:_.searchTerm,description:_.additionalInfo},"searching","Searching API..."),de(_.searchTerm,"searching","Searching API...");const re=await fe.searchApi(_.searchTerm,V.value.category,1);if(re&&re.length>0&&re[0]&&re[0].api_source&&re[0].image){const F=re[0];console.log(`✅ Found real API data for "${_.searchTerm}":`,{title:F.title,api_source:F.api_source,has_image:!!F.image,has_genre:!!F.genre,has_release:!!F.release}),O({title:F.title,description:`Found: ${F.genre||"Unknown genre"} • ${F.release||"Unknown year"} • ${F.api_source}`},"found","Found in API with data"),de(_.searchTerm,"found",`Found: ${F.title} (${F.api_source})`),O({title:F.title},"adding","Adding to library...");const ge={title:F.title,category:V.value.category,release:F.release||null,rating:F.rating?Math.round(F.rating):V.value.defaultRating||null,platforms:F.platforms||null,genre:F.genre||null,link:F.link||null,path:F.image||null,external_id:F.id||null,count:1,is_airing:!1,spielzeit:0,description:F.overview||_.additionalInfo||null};await o.addMediaItem(ge,!0),m.value++,O({title:F.title},"added","Successfully added with API data"),de(_.searchTerm,"added",`Added: ${F.title} with API data`)}else console.log(`❌ No real API data found for "${_.searchTerm}"`),O({title:_.searchTerm},"skipped","No API data found - will retry"),X.value.push({searchTerm:_.searchTerm,additionalInfo:_.additionalInfo,reason:"no_api_data"}),d.value++,de(_.searchTerm,"skipped","No API data found - ready for retry")}catch(E){console.error(`Error processing "${_.searchTerm}":`,E),E.isDuplicate||((I=E.response)==null?void 0:I.status)===409&&((f=(Q=E.response)==null?void 0:Q.data)!=null&&f.duplicate)?(O({title:_.searchTerm},"skipped","Already exists - skipped"),d.value++,de(_.searchTerm,"skipped","Item already exists in library")):(O({title:_.searchTerm},"error","Error occurred"),M.value++,de(_.searchTerm,"error",E.message||"Unknown error"))}if(v++,v>=5){console.log("🔄 Reloading media data after 5 items...");try{await o.loadMedia(),v=0}catch(E){console.warn("Failed to reload media data:",E)}}if(!a.value)break;for(;i.value&&a.value;)await new Promise(E=>setTimeout(E,100));await new Promise(E=>setTimeout(E,1e3))}console.log("🔄 Final media data reload...");try{await o.loadMedia()}catch(A){console.warn("Failed to reload media data at end:",A)}t.value=3,O(null,"","")}catch(h){console.error("Bulk processing error:",h),M.value++}finally{a.value=!1,r.value=!1}},Se=()=>{a.value=!1,r.value=!1,i.value=!1,t.value=1,g()},ve=()=>{i.value=!0},Ie=()=>{i.value=!1},_e=()=>{const j=X.value.filter(I=>I.reason!=="duplicate");if(j.length===0){$();return}const v=j.map(I=>I.additionalInfo?`${I.searchTerm} | ${I.additionalInfo}`:I.searchTerm).join(`
`);V.value.itemsText=v,l.value=0,m.value=0,M.value=0,T.value=null,C.value="",k.value="",K.value=[],t.value=1},$=()=>{t.value=1,a.value=!1,r.value=!0,g(),V.value={category:"",itemsText:"",defaultRating:null},e("close")};return Ce(()=>n.show,j=>{j&&n.currentCategory?V.value.category=n.currentCategory:j||$()}),{currentStep:t,isProcessing:a,canCancel:r,isPaused:i,processedCount:l,addedCount:m,skippedCount:d,errorCount:M,currentItem:T,currentItemStatus:C,currentItemStatusText:k,processingResults:K,skippedItems:X,bulkData:V,canStart:le,progressPercentage:pe,startProcessing:ce,cancelProcessing:Se,pauseProcessing:ve,resumeProcessing:Ie,retrySkippedItems:_e,closeModal:$}}},Cn={class:"modal-header"},Dn={class:"modal-body"},xn={key:0,class:"step-container"},An={class:"bulk-add-form"},Tn={class:"form-group"},Mn={class:"form-group"},Un={class:"form-group"},Rn={key:1,class:"step-container"},Bn={class:"processing-container"},Pn={class:"progress-overview"},En={class:"progress-stats"},Fn={class:"stat"},Ln={class:"stat-number"},Gn={class:"stat"},Nn={class:"stat-number"},Wn={class:"stat"},Vn={class:"stat-number"},On={class:"stat"},zn={class:"stat-number"},jn={class:"progress-bar"},Yn={class:"progress-text"},qn={class:"current-item"},Hn={class:"current-item-header"},Qn={class:"current-item-title"},Jn={key:0,class:"paused-indicator"},Kn={key:0,class:"current-item-description"},Zn={key:1,class:"api-data-indicator"},Xn={key:2,class:"no-api-indicator"},$n={class:"results-list"},ei={class:"result-header"},ti={class:"result-title"},si={class:"result-status"},oi={key:0,class:"result-message"},ai={key:2,class:"step-container"},ni={class:"results-summary"},ii={class:"summary-stats"},ri={class:"summary-stat success"},li={class:"stat-number"},di={class:"summary-stat warning"},ci={class:"stat-number"},ui={class:"summary-stat info"},mi={class:"stat-number"},gi={class:"summary-stat error"},fi={class:"stat-number"},pi={key:0,class:"retry-section"},vi={class:"retry-list"},hi=["onUpdate:modelValue","disabled"],yi={key:0,class:"retry-additional"},bi={key:1,class:"duplicate-badge"},ki={key:2,class:"retry-badge"},wi={key:1,class:"detailed-results"},Si={class:"results-list"},Ii={class:"result-header"},_i={class:"result-title"},Ci={class:"result-status"},Di={key:0,class:"result-message"},xi={class:"modal-footer"},Ai=["disabled"],Ti={key:2,class:"processing-controls"},Mi=["disabled"],Ui=["disabled"],Ri={key:3,class:"footer-buttons"};function Bi(n,e,o,t,a,r){var i,l;return o.show?(c(),u("div",{key:0,class:"modal-overlay",onClick:e[12]||(e[12]=(...m)=>t.closeModal&&t.closeModal(...m))},[s("div",{class:"modal-content",onClick:e[11]||(e[11]=ue(()=>{},["stop"]))},[s("div",Cn,[e[13]||(e[13]=s("h2",null,"Bulk Add Items",-1)),s("button",{class:"close-btn",onClick:e[0]||(e[0]=(...m)=>t.closeModal&&t.closeModal(...m))},"✕")]),s("div",Dn,[t.currentStep===1?(c(),u("div",xn,[e[19]||(e[19]=s("div",{class:"step-header"},[s("div",{class:"step-number"},"1"),s("h3",null,"Enter Your List")],-1)),s("div",An,[s("div",Tn,[e[15]||(e[15]=s("label",{for:"category"},"Category *",-1)),U(s("select",{id:"category","onUpdate:modelValue":e[1]||(e[1]=m=>t.bulkData.category=m),required:""},[...e[14]||(e[14]=[Ve('<option value="" data-v-cfe7bded>Select Category</option><option value="game" data-v-cfe7bded>Game</option><option value="series" data-v-cfe7bded>Series</option><option value="movie" data-v-cfe7bded>Movie</option><option value="buecher" data-v-cfe7bded>Bücher</option><option value="watchlist" data-v-cfe7bded>Watchlist</option>',6)])],512),[[ke,t.bulkData.category]])]),s("div",Mn,[e[16]||(e[16]=s("label",{for:"items-text"},"Items (one per line) *",-1)),U(s("textarea",{id:"items-text","onUpdate:modelValue":e[2]||(e[2]=m=>t.bulkData.itemsText=m),placeholder:`Enter items one per line, for example:
The Witcher 3
Cyberpunk 2077
Red Dead Redemption 2`,rows:"10",required:""},null,512),[[N,t.bulkData.itemsText]]),e[17]||(e[17]=s("small",{class:"help-text"},"Enter one item per line. The system will automatically search and add each item individually.",-1))]),s("div",Un,[e[18]||(e[18]=s("label",{for:"default-rating"},"Default Rating",-1)),U(s("input",{id:"default-rating","onUpdate:modelValue":e[3]||(e[3]=m=>t.bulkData.defaultRating=m),type:"number",min:"0",max:"10",step:"0.1",placeholder:"Optional rating for all items"},null,512),[[N,t.bulkData.defaultRating,void 0,{number:!0}]])])])])):y("",!0),t.currentStep===2?(c(),u("div",Rn,[e[24]||(e[24]=s("div",{class:"step-header"},[s("div",{class:"step-number"},"2"),s("h3",null,"Processing Items")],-1)),s("div",Bn,[s("div",Pn,[s("div",En,[s("span",Fn,[s("span",Ln,p(t.processedCount),1),e[20]||(e[20]=s("span",{class:"stat-label"},"Processed",-1))]),s("span",Gn,[s("span",Nn,p(t.addedCount),1),e[21]||(e[21]=s("span",{class:"stat-label"},"Added",-1))]),s("span",Wn,[s("span",Vn,p(t.skippedCount),1),e[22]||(e[22]=s("span",{class:"stat-label"},"Skipped",-1))]),s("span",On,[s("span",zn,p(t.errorCount),1),e[23]||(e[23]=s("span",{class:"stat-label"},"Errors",-1))])]),s("div",jn,[s("div",{class:"progress-fill",style:Te({width:t.progressPercentage+"%"})},null,4)]),s("div",Yn,p(t.progressPercentage)+"% Complete",1)]),s("div",qn,[s("div",Hn,[s("span",Qn,"Processing: "+p(((i=t.currentItem)==null?void 0:i.title)||"..."),1),s("span",{class:J(["current-item-status",t.currentItemStatus])},[t.isPaused?(c(),u("span",Jn,"⏸️ PAUSED - ")):y("",!0),Ae(p(t.currentItemStatusText),1)],2)]),(l=t.currentItem)!=null&&l.description?(c(),u("div",Kn,p(t.currentItem.description),1)):y("",!0),t.currentItemStatus==="found"?(c(),u("div",Zn," ✅ Real API data found with image and metadata ")):y("",!0),t.currentItemStatus==="skipped"?(c(),u("div",Xn," ❌ No API data found - will be retried ")):y("",!0)]),s("div",$n,[(c(!0),u(se,null,oe(t.processingResults,(m,d)=>(c(),u("div",{key:d,class:J(["result-item",m.status])},[s("div",ei,[s("span",ti,p(m.title),1),s("span",si,p(m.statusText),1)]),m.message?(c(),u("div",oi,p(m.message),1)):y("",!0)],2))),128))])])])):y("",!0),t.currentStep===3?(c(),u("div",ai,[e[32]||(e[32]=s("div",{class:"step-header"},[s("div",{class:"step-number"},"3"),s("h3",null,"Results")],-1)),s("div",ni,[s("div",ii,[s("div",ri,[s("span",li,p(t.addedCount),1),e[25]||(e[25]=s("span",{class:"stat-label"},"Successfully Added",-1))]),s("div",di,[s("span",ci,p(t.skippedItems.filter(m=>m.reason!=="duplicate").length),1),e[26]||(e[26]=s("span",{class:"stat-label"},"Not Found (Ready for Retry)",-1))]),s("div",ui,[s("span",mi,p(t.skippedItems.filter(m=>m.reason==="duplicate").length),1),e[27]||(e[27]=s("span",{class:"stat-label"},"Already in Profile",-1))]),s("div",gi,[s("span",fi,p(t.errorCount),1),e[28]||(e[28]=s("span",{class:"stat-label"},"Errors",-1))])]),t.skippedItems.length>0?(c(),u("div",pi,[e[29]||(e[29]=s("h4",null,"Items Ready for Retry",-1)),e[30]||(e[30]=s("p",{class:"retry-description"}," The following items can be edited and tried again: ",-1)),s("div",vi,[(c(!0),u(se,null,oe(t.skippedItems,(m,d)=>(c(),u("div",{key:d,class:J(["retry-item",{"duplicate-item":m.reason==="duplicate"}])},[U(s("input",{"onUpdate:modelValue":M=>m.searchTerm=M,class:"retry-input",placeholder:"Edit search term...",disabled:m.reason==="duplicate"},null,8,hi),[[N,m.searchTerm]]),m.additionalInfo?(c(),u("span",yi," | "+p(m.additionalInfo),1)):y("",!0),m.reason==="duplicate"?(c(),u("span",bi," Already in profile ")):(c(),u("span",ki," No API data "))],2))),128))])])):y("",!0),t.processingResults.length>0?(c(),u("div",wi,[e[31]||(e[31]=s("h4",null,"Detailed Results",-1)),s("div",Si,[(c(!0),u(se,null,oe(t.processingResults,(m,d)=>(c(),u("div",{key:d,class:J(["result-item",m.status])},[s("div",Ii,[s("span",_i,p(m.title),1),s("span",Ci,p(m.statusText),1)]),m.message?(c(),u("div",Di,p(m.message),1)):y("",!0)],2))),128))])])):y("",!0)])])):y("",!0)]),s("div",xi,[t.currentStep===1?(c(),u("button",{key:0,class:"btn btn-secondary",onClick:e[4]||(e[4]=(...m)=>t.closeModal&&t.closeModal(...m))}," Cancel ")):y("",!0),t.currentStep===1?(c(),u("button",{key:1,class:"btn btn-primary",onClick:e[5]||(e[5]=(...m)=>t.startProcessing&&t.startProcessing(...m)),disabled:!t.canStart}," Check All and Add ",8,Ai)):y("",!0),t.currentStep===2?(c(),u("div",Ti,[s("button",{class:"btn btn-secondary",onClick:e[6]||(e[6]=(...m)=>t.cancelProcessing&&t.cancelProcessing(...m)),disabled:!t.canCancel}," Cancel ",8,Mi),t.isPaused?y("",!0):(c(),u("button",{key:0,class:"btn btn-warning",onClick:e[7]||(e[7]=(...m)=>t.pauseProcessing&&t.pauseProcessing(...m)),disabled:!t.isProcessing}," Pause ",8,Ui)),t.isPaused?(c(),u("button",{key:1,class:"btn btn-primary",onClick:e[8]||(e[8]=(...m)=>t.resumeProcessing&&t.resumeProcessing(...m))}," Resume ")):y("",!0)])):y("",!0),t.currentStep===3?(c(),u("div",Ri,[t.skippedItems.filter(m=>m.reason!=="duplicate").length>0?(c(),u("button",{key:0,class:"btn btn-warning",onClick:e[9]||(e[9]=(...m)=>t.retrySkippedItems&&t.retrySkippedItems(...m))}," Retry "+p(t.skippedItems.filter(m=>m.reason!=="duplicate").length)+" Items ",1)):y("",!0),s("button",{class:"btn btn-primary",onClick:e[10]||(e[10]=(...m)=>t.closeModal&&t.closeModal(...m))}," Done ")])):y("",!0)])])])):y("",!0)}const Pi=ae(_n,[["render",Bi],["__scopeId","data-v-cfe7bded"]]),Ei={name:"TxtImportModal",props:{show:{type:Boolean,default:!1}},emits:["close","fileProcessed"],methods:{handleFileUpload(n){const e=n.target.files[0];if(!e)return;if(!e.name.toLowerCase().endsWith(".txt")){alert("Bitte wählen Sie eine .txt Datei aus.");return}const o=new FileReader;o.onload=t=>{const a=t.target.result;this.$emit("fileProcessed",a)},o.readAsText(e,"UTF-8")}}},Fi={class:"file-upload-area"},Li={class:"modal-buttons"};function Gi(n,e,o,t,a,r){return o.show?(c(),u("div",{key:0,class:"modal",onClick:e[3]||(e[3]=i=>n.$emit("close"))},[s("div",{class:"modal-content",onClick:e[2]||(e[2]=ue(()=>{},["stop"]))},[e[5]||(e[5]=s("h2",null,"📄 Import from TXT File",-1)),e[6]||(e[6]=s("p",null,"Wählen Sie eine .txt Datei mit einer Liste von Titeln aus, um zu prüfen, welche Items in der aktuellen Kategorie fehlen.",-1)),s("div",Fi,[s("input",{type:"file",id:"txtFileInput",accept:".txt",onChange:e[0]||(e[0]=(...i)=>r.handleFileUpload&&r.handleFileUpload(...i)),style:{display:"none"}},null,32),e[4]||(e[4]=s("label",{for:"txtFileInput",class:"file-upload-label"},[s("span",{class:"upload-icon"},"📁"),s("span",{class:"upload-text"},"TXT-Datei auswählen"),s("span",{class:"upload-hint"},"Eine .txt Datei mit einer Liste von Titeln")],-1))]),s("div",Li,[s("button",{type:"button",onClick:e[1]||(e[1]=i=>n.$emit("close"))}," Cancel ")])])])):y("",!0)}const Ni=ae(Ei,[["render",Gi],["__scopeId","data-v-e20860d6"]]),Wi={name:"TxtImportResultsModal",props:{show:{type:Boolean,default:!1},results:{type:Object,default:null}},emits:["close"]},Vi={class:"results-summary"},Oi={class:"summary-item"},zi={class:"summary-value"},ji={class:"summary-item"},Yi={class:"summary-value"},qi={class:"summary-item"},Hi={class:"summary-value existing"},Qi={class:"summary-item"},Ji={class:"summary-value missing"},Ki={key:0,class:"missing-items"},Zi={class:"items-list"},Xi={key:1,class:"existing-items"},$i={class:"items-list"},er={class:"modal-buttons"};function tr(n,e,o,t,a,r){return o.show&&o.results?(c(),u("div",{key:0,class:"modal",onClick:e[2]||(e[2]=i=>n.$emit("close"))},[s("div",{class:"modal-content results-modal",onClick:e[1]||(e[1]=ue(()=>{},["stop"]))},[e[7]||(e[7]=s("h2",null,"📊 TXT Import Ergebnisse",-1)),s("div",Vi,[s("div",Oi,[e[3]||(e[3]=s("span",{class:"summary-label"},"Kategorie:",-1)),s("span",zi,p(o.results.categoryName),1)]),s("div",ji,[e[4]||(e[4]=s("span",{class:"summary-label"},"Titel in Datei:",-1)),s("span",Yi,p(o.results.totalInFile),1)]),s("div",qi,[e[5]||(e[5]=s("span",{class:"summary-label"},"Bereits vorhanden:",-1)),s("span",Hi,p(o.results.existingItems.length),1)]),s("div",Qi,[e[6]||(e[6]=s("span",{class:"summary-label"},"Fehlende Titel:",-1)),s("span",Ji,p(o.results.missingItems.length),1)])]),o.results.missingItems.length>0?(c(),u("div",Ki,[s("h3",null,"❌ Fehlende Titel ("+p(o.results.missingItems.length)+"):",1),s("div",Zi,[(c(!0),u(se,null,oe(o.results.missingItems,(i,l)=>(c(),u("div",{key:l,class:"missing-item"},p(i),1))),128))])])):y("",!0),o.results.existingItems.length>0?(c(),u("div",Xi,[s("h3",null,"✅ Bereits vorhanden ("+p(o.results.existingItems.length)+"):",1),s("div",$i,[(c(!0),u(se,null,oe(o.results.existingItems,(i,l)=>(c(),u("div",{key:l,class:"existing-item"},p(i),1))),128))])])):y("",!0),s("div",er,[s("button",{type:"button",onClick:e[0]||(e[0]=i=>n.$emit("close"))}," Schließen ")])])])):y("",!0)}const sr=ae(Wi,[["render",tr],["__scopeId","data-v-ec385b83"]]),or={name:"SimpleAddItem",setup(){const n=b(!1),e=b(null),o=Me({title:"Test Game",category:"game",release:"2003-01-01",count:1});return{form:o,loading:n,result:e,addItem:async()=>{n.value=!0,e.value=null;try{const a=window.location.origin,r=await fetch(`${a}/api/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:"admin@example.com",password:"admin123"})});if(!r.ok)throw new Error("Login failed");const l=(await r.json()).token,d=await(await fetch(`${a}/api/media`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify(o)})).json();d.success?e.value={success:!0,message:`Success! Item added with ID: ${d.data.id}`}:e.value={success:!1,message:`Error: ${JSON.stringify(d)}`}}catch(a){e.value={success:!1,message:`Error: ${a.message}`}}finally{n.value=!1}}}}},ar={class:"simple-add-item"},nr=["disabled"];function ir(n,e,o,t,a,r){return c(),u("div",ar,[e[10]||(e[10]=s("h3",null,"Simple Add Item Test",-1)),s("form",{onSubmit:e[4]||(e[4]=ue((...i)=>t.addItem&&t.addItem(...i),["prevent"]))},[s("div",null,[e[5]||(e[5]=s("label",null,"Title:",-1)),U(s("input",{"onUpdate:modelValue":e[0]||(e[0]=i=>t.form.title=i),type:"text",required:""},null,512),[[N,t.form.title]])]),s("div",null,[e[7]||(e[7]=s("label",null,"Category:",-1)),U(s("select",{"onUpdate:modelValue":e[1]||(e[1]=i=>t.form.category=i)},[...e[6]||(e[6]=[s("option",{value:"game"},"Game",-1),s("option",{value:"movie"},"Movie",-1),s("option",{value:"series"},"Series",-1)])],512),[[ke,t.form.category]])]),s("div",null,[e[8]||(e[8]=s("label",null,"Release:",-1)),U(s("input",{"onUpdate:modelValue":e[2]||(e[2]=i=>t.form.release=i),type:"date"},null,512),[[N,t.form.release]])]),s("div",null,[e[9]||(e[9]=s("label",null,"Count:",-1)),U(s("input",{"onUpdate:modelValue":e[3]||(e[3]=i=>t.form.count=i),type:"number",min:"0"},null,512),[[N,t.form.count]])]),s("button",{type:"submit",disabled:t.loading},p(t.loading?"Adding...":"Add Item"),9,nr)],32),t.result?(c(),u("div",{key:0,class:J(["result",t.result.success?"success":"error"])},p(t.result.message),3)):y("",!0)])}const rr=ae(or,[["render",ir],["__scopeId","data-v-4298065b"]]),lr={name:"LoadingSpinner",props:{loading:{type:Boolean,default:!0},message:{type:String,default:"Loading..."}}},dr={key:0,class:"loading-spinner"},cr={key:0};function ur(n,e,o,t,a,r){return o.loading?(c(),u("div",dr,[e[0]||(e[0]=s("div",{class:"spinner"},null,-1)),o.message?(c(),u("p",cr,p(o.message),1)):y("",!0)])):y("",!0)}const mr=ae(lr,[["render",ur],["__scopeId","data-v-0e82c46a"]]),gr={name:"MessageBox",props:{show:{type:Boolean,default:!1},type:{type:String,default:"info",validator:n=>["success","error","warning","info"].includes(n)},title:{type:String,default:""},message:{type:String,required:!0},details:{type:String,default:""}},emits:["close"],setup(n,{emit:e}){const o=()=>{e("close")},t=z(()=>{switch(n.type){case"success":return"✅";case"error":return"❌";case"warning":return"⚠️";case"info":return"ℹ️";default:return"ℹ️"}}),a=z(()=>`message-${n.type}`);return{closeMessage:o,icon:t,messageType:a}}},fr={class:"message-header"},pr={class:"message-icon"},vr={class:"message-title"},hr={class:"message-body"},yr={key:0,class:"message-details"},br={class:"message-footer"};function kr(n,e,o,t,a,r){return o.show?(c(),u("div",{key:0,class:"message-overlay",onClick:e[3]||(e[3]=(...i)=>t.closeMessage&&t.closeMessage(...i))},[s("div",{class:J(["message-box",t.messageType]),onClick:e[2]||(e[2]=ue(()=>{},["stop"]))},[s("div",fr,[s("span",pr,p(t.icon),1),s("h3",vr,p(o.title),1),s("button",{class:"close-btn",onClick:e[0]||(e[0]=(...i)=>t.closeMessage&&t.closeMessage(...i))},"✕")]),s("div",hr,[s("p",null,p(o.message),1),o.details?(c(),u("div",yr,[s("pre",null,p(o.details),1)])):y("",!0)]),s("div",br,[s("button",{class:"btn btn-primary",onClick:e[1]||(e[1]=(...i)=>t.closeMessage&&t.closeMessage(...i))},"OK")])],2)])):y("",!0)}const wr=ae(gr,[["render",kr],["__scopeId","data-v-198ec3cc"]]),Sr={name:"ConfirmDialog",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm Action"},message:{type:String,required:!0}},emits:["confirm","close"],setup(n,{emit:e}){const o=()=>{e("close")};return{closeDialog:o,confirmAction:()=>{e("confirm"),o()}}}},Ir={class:"confirm-header"},_r={class:"confirm-title"},Cr={class:"confirm-body"},Dr={class:"confirm-footer"};function xr(n,e,o,t,a,r){return o.show?(c(),u("div",{key:0,class:"confirm-overlay",onClick:e[4]||(e[4]=(...i)=>t.closeDialog&&t.closeDialog(...i))},[s("div",{class:"confirm-dialog",onClick:e[3]||(e[3]=ue(()=>{},["stop"]))},[s("div",Ir,[s("h3",_r,p(o.title),1),s("button",{class:"close-btn",onClick:e[0]||(e[0]=(...i)=>t.closeDialog&&t.closeDialog(...i))},"✕")]),s("div",Cr,[s("p",null,p(o.message),1)]),s("div",Dr,[s("button",{class:"btn btn-secondary",onClick:e[1]||(e[1]=(...i)=>t.closeDialog&&t.closeDialog(...i))},"Cancel"),s("button",{class:"btn btn-danger",onClick:e[2]||(e[2]=(...i)=>t.confirmAction&&t.confirmAction(...i))},"Confirm")])])])):y("",!0)}const Ar=ae(Sr,[["render",xr],["__scopeId","data-v-fd570f57"]]),Tr={name:"InputDialog",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Input Required"},message:{type:String,required:!0},placeholder:{type:String,default:""},inputType:{type:String,default:"text"},defaultValue:{type:String,default:""}},emits:["confirm","close"],setup(n,{emit:e}){const o=b(""),t=b(null),a=()=>{e("close")},r=()=>{e("confirm",o.value),a()};return Ce(()=>n.show,async i=>{i&&(o.value=n.defaultValue,await Ht(),t.value&&(t.value.focus(),t.value.select()))}),{inputValue:o,inputRef:t,closeDialog:a,confirmAction:r}}},Mr={class:"input-header"},Ur={class:"input-title"},Rr={class:"input-body"},Br={class:"input-message"},Pr=["type","placeholder"],Er={class:"input-footer"};function Fr(n,e,o,t,a,r){return o.show?(c(),u("div",{key:0,class:"input-overlay",onClick:e[6]||(e[6]=(...i)=>t.closeDialog&&t.closeDialog(...i))},[s("div",{class:"input-dialog",onClick:e[5]||(e[5]=ue(()=>{},["stop"]))},[s("div",Mr,[s("h3",Ur,p(o.title),1),s("button",{class:"close-btn",onClick:e[0]||(e[0]=(...i)=>t.closeDialog&&t.closeDialog(...i))},"✕")]),s("div",Rr,[s("p",Br,p(o.message),1),U(s("input",{"onUpdate:modelValue":e[1]||(e[1]=i=>t.inputValue=i),type:o.inputType,placeholder:o.placeholder,class:"input-field",onKeyup:e[2]||(e[2]=qt((...i)=>t.confirmAction&&t.confirmAction(...i),["enter"])),ref:"inputRef"},null,40,Pr),[[Yt,t.inputValue]])]),s("div",Er,[s("button",{class:"btn btn-secondary",onClick:e[3]||(e[3]=(...i)=>t.closeDialog&&t.closeDialog(...i))},"Cancel"),s("button",{class:"btn btn-primary",onClick:e[4]||(e[4]=(...i)=>t.confirmAction&&t.confirmAction(...i))},"OK")])])])):y("",!0)}const Lr=ae(Tr,[["render",Fr],["__scopeId","data-v-0ee78a4d"]]),Gr={name:"MediaLibrary",components:{MediaItem:vs,Sidebar:Js,MainHeader:io,FloatingActionButton:go,LoginModal:_o,RegisterModal:Vo,EditModal:In,BulkAddModal:Pi,TxtImportModal:Ni,TxtImportResultsModal:sr,SimpleAddItem:rr,LoadingSpinner:mr,MessageBox:wr,ConfirmDialog:Ar,InputDialog:Lr},setup(){const n=ze(),e=ct(),o=ut(),t=mt(),a=Oe(),r=gt(),i=z(()=>!r||typeof r!="object"?(console.warn("SidebarStore not properly initialized, using fallback values"),{collapsed:!1,mobileOpen:!1,toggleSidebar:()=>{},toggleMobileSidebar:()=>{},closeMobileSidebar:()=>{}}):r),l=b(!1),m=b(null),d=b(new Date),M=b(null),T=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],C=b(null),k=Me({firstName:"",lastName:"",displayName:"",email:"",bio:"",avatar:"",language:"en",timezone:"UTC",dateFormat:"MM/DD/YYYY",booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}),{showLoginModal:K,showRegisterModal:X,showEditModal:V,showFloatingMenu:le,showBulkAddModal:pe,showTxtImportModal:me,showTxtImportResults:g,editingItem:O,sortBy:de,categories:ce,txtImportResults:Se,isLoggedIn:ve,isAdmin:Ie,userName:_e,currentCategory:$,searchQuery:j,categoryCounts:v,loading:I,error:Q,paginatedMedia:f,setCategory:h,clearSearch:S,editItem:x,closeEditModal:A,closeBulkAddModal:_,handleBulkAddItems:E,handleSaveItem:re,handleDeleteItem:ne,logout:F,loadMedia:ge,toggleFloatingMenu:je,addNewItem:Pe,bulkAddItems:Ue,importFromTxt:Ye,importFromAPI:qe,createCollection:He,exportMediaCollection:Ee,exportAsCSV:Fe,exportAsJSON:Le,downloadFile:Re,deleteAllInCategory:$e,getCategoryDisplayName:Ge,navigateToCalendar:et,navigateToProfile:tt,processTxtContent:D,closeTxtImportResults:B,cleanup:Z,router:G}=Kt(),W=z(()=>{try{return Ge?Ge($.value):$.value}catch(w){return console.error("Error getting category display name:",w),$.value||"Unknown"}}),ee=z(()=>d.value.getFullYear()),Y=z(()=>d.value.getMonth()),De=z(()=>d.value.toLocaleDateString("en-US",{month:"long"})),he=b([]),Qe=b(!1),Je=b(null),st=z(()=>{const w=ee.value,R=Y.value,L=new Date(w,R,1),q=new Date(L),P=L.getDay(),H=P===0?6:P-1;q.setDate(q.getDate()-H);const we=[],te=new Date;for(let Ke=0;Ke<42;Ke++){const ye=new Date(q);ye.setDate(q.getDate()+Ke);const Wt=ye.getMonth()===R,Vt=ye.toDateString()===te.toDateString(),Ot=ye.getDay()===0||ye.getDay()===6;we.push({date:ye.getDate(),month:ye.getMonth(),year:ye.getFullYear(),fullDate:new Date(ye),isCurrentMonth:Wt,isToday:Vt,isWeekend:Ot,hasEvents:ot(ye),events:at(ye)})}return we}),ft=z(()=>{const w=n.mediaData||[],R={totalItems:w.length,totalCollections:0,totalPlaytime:0,avgRating:0,categoryDistribution:{},ratingDistribution:{},platformDistribution:{},genreDistribution:{},recentActivity:[],airingSeries:[]};let L=0,q=0;return w.forEach(P=>{const H=P.category||"unknown";if(R.categoryDistribution[H]=(R.categoryDistribution[H]||0)+1,P.rating&&P.rating>0){const we=Math.floor(P.rating);R.ratingDistribution[we]=(R.ratingDistribution[we]||0)+1,L+=P.rating,q++}if(P.platforms&&P.category==="game"&&P.platforms.split(",").map(te=>te.trim()).filter(te=>te).forEach(te=>{R.platformDistribution[te]=(R.platformDistribution[te]||0)+1}),P.genre&&(P.category==="series"||P.category==="movie")&&P.genre.split(",").map(te=>te.trim()).filter(te=>te).forEach(te=>{R.genreDistribution[te]=(R.genreDistribution[te]||0)+1}),P.spielzeit&&P.spielzeit>0&&(R.totalPlaytime+=P.spielzeit),P.category==="series"&&P.isAiring===!0&&R.airingSeries.push({title:P.title,nextSeason:P.nextSeason,nextSeasonRelease:P.nextSeasonRelease}),P.discovered){const we=new Date(P.discovered),te=new Date;te.setDate(te.getDate()-30),we>=te&&R.recentActivity.push({title:P.title,category:P.category,discovered:P.discovered})}}),q>0&&(R.avgRating=(L/q).toFixed(1)),R.totalPlaytime=Math.round(R.totalPlaytime/60),R.recentActivity.sort((P,H)=>new Date(H.discovered)-new Date(P.discovered)),R}),pt=w=>w?new Date(w).toLocaleDateString():"",vt=w=>{const R=Math.max(0,Math.min(5,parseInt(w)||0)),L="★".repeat(R),q="☆".repeat(5-R);return L+q},ht=w=>{h(w),Pe()},yt=()=>{K.value=!1,X.value=!0},bt=()=>{K.value=!0},kt=w=>{K.value=!1,ge()},wt=()=>{X.value=!1,ge()},St=async()=>{l.value=!0,m.value=null;try{const w=await a.adminSetup();w.success?(console.log("✅ Admin setup successful:",w),m.value={type:"success",text:`✅ Admin created and logged in! User: ${w.user.name} (${w.user.email})`},await ge(),setTimeout(()=>{m.value=null},5e3)):(console.log("ℹ️ Admin already exists:",w),m.value={type:"info",text:`ℹ️ ${w.message} (${w.admin_count} admin(s) exist)`},setTimeout(()=>{m.value=null},3e3))}catch(w){console.error("❌ Admin setup failed:",w),m.value={type:"error",text:`❌ Admin setup failed: ${w.message||"Unknown error"}`},setTimeout(()=>{m.value=null},5e3)}finally{l.value=!1}},It=()=>{console.log("🔥 DEBUG: Direct admin navigation called!"),console.log("🔥 DEBUG: Router object:",G);try{G.push("/admin"),console.log("🔥 DEBUG: Successfully navigated to /admin!")}catch(w){console.error("🔥 DEBUG: Error navigating to admin:",w)}},_t=()=>{d.value=new Date(d.value.getFullYear(),d.value.getMonth()-1,1),M.value=null},Ct=()=>{d.value=new Date(d.value.getFullYear(),d.value.getMonth()+1,1),M.value=null},Dt=w=>{w.isCurrentMonth&&(M.value=w)},xt=w=>w.fullDate.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),ot=w=>nt(w).length>0,at=w=>nt(w).map(L=>({id:L.id,title:L.title,time:"Release",type:L.watchlistType||L.watchlist_type||"unknown",item:L})),nt=w=>n.mediaData.filter(L=>L.category==="watchlist"&&L.release).filter(L=>{if(!L.release)return!1;const q=new Date(L.release),P=new Date(w);return q.getFullYear()===P.getFullYear()&&q.getMonth()===P.getMonth()&&q.getDate()===P.getDate()}),At=()=>{var L,q;const w=((L=k.firstName)==null?void 0:L.charAt(0))||"U",R=((q=k.lastName)==null?void 0:q.charAt(0))||"S";return(w+R).toUpperCase()},Tt=()=>{var w;(w=C.value)==null||w.click()},Mt=w=>{const R=w.target.files[0];if(R){const L=new FileReader;L.onload=q=>{k.avatar=q.target.result},L.readAsDataURL(R)}},it=async()=>{if(!$.value||$.value==="statistics"||$.value==="calendar"||$.value==="profile"){he.value=[];return}Qe.value=!0,Je.value=null;try{const w=await fe.getGenres($.value);if(w.success)he.value=w.genres||[];else throw new Error(w.error||"Failed to load genres")}catch(w){console.error("Failed to load genres:",w),Je.value=w.message||"Failed to load genres",he.value=[]}finally{Qe.value=!1}},Ut=w=>{n.setGenres(w)},Rt=()=>{n.clearGenres()};Ce($,w=>{w&&w!=="statistics"&&w!=="calendar"&&w!=="profile"?(it(),n.clearGenres()):(he.value=[],n.clearGenres())},{immediate:!0});const Bt=()=>{const w={profile:k,media:n.mediaData,settings:{language:k.language,timezone:k.timezone,dateFormat:k.dateFormat},exportDate:new Date().toISOString()},R=new Blob([JSON.stringify(w,null,2)],{type:"application/json"}),L=URL.createObjectURL(R),q=document.createElement("a");q.href=L,q.download=`media-library-backup-${new Date().toISOString().split("T")[0]}.json`,q.click(),URL.revokeObjectURL(L)},Pt=()=>{const w=document.createElement("input");w.type="file",w.accept=".json",w.onchange=R=>{const L=R.target.files[0];if(L){const q=new FileReader;q.onload=P=>{try{const H=JSON.parse(P.target.result);H.profile&&Object.assign(k,H.profile),H.media&&(n.mediaData=H.media,n.saveMedia()),H.settings&&Object.assign(k,H.settings),Ne()}catch(H){console.error("Failed to import data:",H)}},q.readAsText(L)}},w.click()},Et=()=>{const w={profile:k,media:n.mediaData,settings:{language:k.language,timezone:k.timezone,dateFormat:k.dateFormat},backupDate:new Date().toISOString()},R=`backup_${Date.now()}`;localStorage.setItem(R,JSON.stringify(w)),alert("Backup created successfully!")},Ft=()=>{alert("Cache cleared successfully!")},Lt=()=>{confirm("Are you sure you want to reset all settings?")&&(Object.assign(k,{firstName:"",lastName:"",displayName:"",email:"",bio:"",avatar:"",language:"en",timezone:"UTC",dateFormat:"MM/DD/YYYY",booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}),Ne())},Gt=()=>{confirm("Are you sure you want to clear all data? This cannot be undone!")&&(localStorage.clear(),window.location.reload())},Ne=()=>{localStorage.setItem("profileData",JSON.stringify(k))},Nt=()=>{Ne(),alert("All changes saved successfully!")};return lt(async()=>{var w,R;try{await ge();const L=localStorage.getItem("profileData");if(L)try{const H=JSON.parse(L);Object.assign(k,H)}catch(H){console.error("Failed to load profile data:",H)}a.user&&(k.firstName=((w=a.user.name)==null?void 0:w.split(" ")[0])||"",k.lastName=((R=a.user.name)==null?void 0:R.split(" ").slice(1).join(" "))||"",k.email=a.user.email||"");const q=new Date,P=st.value.find(H=>H.isToday&&H.isCurrentMonth);if(P&&(M.value=P),ve.value)try{n.initializeRealtimeUpdates()}catch(H){console.error("Error initializing realtime updates:",H)}}catch(L){console.error("Error during initialization:",L)}}),Qt(()=>{if(ve.value)try{n.cleanupRealtimeUpdates()}catch(w){console.error("Error cleaning up realtime updates:",w)}Z()}),{showLoginModal:K,showRegisterModal:X,showEditModal:V,showFloatingMenu:le,showBulkAddModal:pe,showTxtImportModal:me,showTxtImportResults:g,editingItem:O,sortBy:de,categories:ce,txtImportResults:Se,adminSetupLoading:l,adminSetupMessage:m,currentDate:d,selectedDay:M,weekdays:T,avatarInput:C,profileData:k,isLoggedIn:ve,isAdmin:Ie,userName:_e,currentCategory:$,currentCategoryDisplayName:W,searchQuery:j,categoryCounts:v,loading:I,error:Q,paginatedMedia:f,selectedGenres:n.selectedGenres,genres:he,genreLoading:Qe,genreError:Je,currentYear:ee,currentMonth:Y,currentMonthName:De,calendarDays:st,setCategory:h,clearSearch:S,navigateToCalendar:et,navigateToProfile:tt,addItemFromSidebar:ht,editItem:x,switchToRegister:yt,showAdminLogin:bt,handleLoginSuccess:kt,handleRegisterSuccess:wt,handleAdminSetup:St,debugNavigateToAdmin:It,closeEditModal:A,closeBulkAddModal:_,handleBulkAddItems:E,handleSaveItem:re,handleDeleteItem:ne,logout:F,loadMedia:ge,toggleFloatingMenu:je,addNewItem:Pe,bulkAddItems:Ue,importFromTxt:Ye,importFromAPI:qe,createCollection:He,exportMediaCollection:Ee,exportAsCSV:Fe,exportAsJSON:Le,downloadFile:Re,deleteAllInCategory:$e,getCategoryDisplayName:Ge,processTxtContent:D,closeTxtImportResults:B,handleGenresUpdated:Ut,handleGenresCleared:Rt,loadGenres:it,previousMonth:_t,nextMonth:Ct,selectDay:Dt,formatSelectedDay:xt,hasEventsForDate:ot,getEventsForDate:at,getInitials:At,changeAvatar:Tt,handleAvatarChange:Mt,exportData:Bt,importData:Pt,createBackup:Et,clearCache:Ft,resetSettings:Lt,clearAllData:Gt,saveProfileData:Ne,saveAllChanges:Nt,messageStore:e,confirmStore:o,inputStore:t,statistics:ft,formatDate:pt,getRatingStars:vt,sidebarStore:r,safeSidebarStore:i}}},Nr={class:"vue-app"},Wr={class:"main-content"},Vr={class:"content-area"},Or={key:1,class:"error"},zr={key:2},jr={key:0,class:"calendar-view"},Yr={class:"calendar-header"},qr=["disabled"],Hr={class:"month-year-display"},Qr={class:"month-name"},Jr={class:"year"},Kr=["disabled"],Zr={class:"calendar-container"},Xr={class:"calendar-grid"},$r=["onClick"],el={class:"day-number"},tl={key:0,class:"event-indicator"},sl={key:0,class:"event-count"},ol={key:0,class:"selected-day-info"},al={class:"day-events"},nl={key:0,class:"no-events"},il={key:1,class:"events-list"},rl={class:"event-header"},ll={class:"event-time"},dl={class:"event-type-badge"},cl={class:"event-title"},ul={key:0,class:"event-platforms"},ml={key:1,class:"event-genre"},gl={key:1,class:"profile-container"},fl={class:"profile-header"},pl={class:"profile-avatar-section"},vl=["src"],hl={key:1,class:"avatar-initials"},yl={class:"profile-info-header"},bl={class:"profile-stats"},kl={class:"stat-item"},wl={class:"stat-number"},Sl={class:"stat-item"},Il={class:"stat-number"},_l={class:"settings-sections"},Cl={class:"settings-section"},Dl={class:"section-content"},xl={class:"form-row"},Al={class:"form-group"},Tl={class:"form-group"},Ml={class:"form-group"},Ul={class:"form-group"},Rl={class:"form-group"},Bl={class:"settings-section"},Pl={class:"section-content"},El={class:"form-row"},Fl={class:"form-group"},Ll={class:"form-group"},Gl={class:"form-row"},Nl={class:"form-group"},Wl={class:"form-group"},Vl={class:"form-row"},Ol={class:"form-group"},zl={class:"checkbox-container"},jl={class:"settings-section"},Yl={class:"section-content"},ql={class:"data-actions"},Hl={class:"settings-section danger-zone"},Ql={class:"section-content"},Jl={class:"danger-actions"},Kl={key:2,class:"statistics-container"},Zl={class:"statistics-header"},Xl={class:"refresh-controls"},$l={class:"statistics-content"},ed={class:"stats-summary"},td={class:"summary-card"},sd={class:"summary-number"},od={class:"summary-card"},ad={class:"summary-number"},nd={class:"summary-card"},id={class:"summary-number"},rd={class:"summary-card"},ld={class:"summary-number"},dd={class:"chart-container"},cd={class:"category-stats"},ud={class:"category-name"},md={class:"category-bar"},gd={class:"category-count"},fd={class:"chart-container"},pd={class:"rating-stats"},vd={class:"rating-stars"},hd={class:"rating-bar"},yd={class:"rating-count"},bd={class:"chart-container"},kd={class:"platform-stats"},wd={class:"platform-name"},Sd={class:"platform-bar"},Id={class:"platform-count"},_d={class:"chart-container"},Cd={class:"genre-stats"},Dd={class:"genre-name"},xd={class:"genre-bar"},Ad={class:"genre-count"},Td={class:"chart-container"},Md={class:"recent-activity"},Ud={class:"activity-title"},Rd={class:"activity-category"},Bd={class:"activity-date"},Pd={class:"chart-container"},Ed={class:"airing-series"},Fd={class:"airing-title"},Ld={class:"airing-next"},Gd={class:"airing-date"},Nd={key:3,class:"grid"},Wd={key:0,class:"admin-setup-container"},Vd=["disabled"],Od={key:0},zd={key:1};function jd(n,e,o,t,a,r){const i=ie("Sidebar"),l=ie("MainHeader"),m=ie("LoadingSpinner"),d=ie("MediaItem"),M=ie("LoginModal"),T=ie("RegisterModal"),C=ie("EditModal"),k=ie("BulkAddModal"),K=ie("TxtImportModal"),X=ie("TxtImportResultsModal"),V=ie("FloatingActionButton"),le=ie("MessageBox"),pe=ie("ConfirmDialog"),me=ie("InputDialog");return c(),u("div",Nr,[s("div",{class:J(["mobile-overlay",{show:t.safeSidebarStore.mobileOpen}]),onClick:e[0]||(e[0]=(...g)=>t.safeSidebarStore.closeMobileSidebar&&t.safeSidebarStore.closeMobileSidebar(...g))},null,2),be(i,{collapsed:t.safeSidebarStore.collapsed,"mobile-open":t.safeSidebarStore.mobileOpen,"is-logged-in":t.isLoggedIn,"is-admin":t.isAdmin,"user-name":t.userName,"current-category":t.currentCategory,"category-counts":t.categoryCounts,categories:t.categories,"selected-genres":t.selectedGenres,genres:t.genres,"genre-loading":t.genreLoading,"genre-error":t.genreError,onToggle:t.safeSidebarStore.toggleSidebar,onSetCategory:t.setCategory,onNavigateToCalendar:t.navigateToCalendar,onNavigateToProfile:t.navigateToProfile,onNavigateToAdmin:t.debugNavigateToAdmin,onAddItem:t.addItemFromSidebar,onShowLogin:e[1]||(e[1]=g=>t.showLoginModal=!0),onShowRegister:e[2]||(e[2]=g=>t.showRegisterModal=!0),onShowAdminLogin:t.showAdminLogin,onLogout:t.logout,onGenresUpdated:t.handleGenresUpdated,onGenresCleared:t.handleGenresCleared,onLoadGenres:t.loadGenres},null,8,["collapsed","mobile-open","is-logged-in","is-admin","user-name","current-category","category-counts","categories","selected-genres","genres","genre-loading","genre-error","onToggle","onSetCategory","onNavigateToCalendar","onNavigateToProfile","onNavigateToAdmin","onAddItem","onShowAdminLogin","onLogout","onGenresUpdated","onGenresCleared","onLoadGenres"]),s("div",Wr,[be(l,{"search-query":t.searchQuery,"onUpdate:searchQuery":e[3]||(e[3]=g=>t.searchQuery=g),"sort-by":t.sortBy,"onUpdate:sortBy":e[4]||(e[4]=g=>t.sortBy=g),onToggleMobileSidebar:t.safeSidebarStore.toggleMobileSidebar,onClearSearch:t.clearSearch},null,8,["search-query","sort-by","onToggleMobileSidebar","onClearSearch"]),s("main",Vr,[t.loading?(c(),xe(m,{key:0,message:"Loading media data..."})):t.error?(c(),u("div",Or,[s("p",null,p(t.error),1),s("button",{onClick:e[5]||(e[5]=(...g)=>t.loadMedia&&t.loadMedia(...g))},"Retry")])):(c(),u("div",zr,[t.currentCategory==="calendar"?(c(),u("div",jr,[s("div",Yr,[s("button",{class:"month-nav-btn",onClick:e[6]||(e[6]=(...g)=>t.previousMonth&&t.previousMonth(...g)),disabled:n.isLoading},[...e[31]||(e[31]=[s("span",{class:"nav-icon"},"‹",-1)])],8,qr),s("div",Hr,[s("h2",Qr,p(t.currentMonthName),1),s("span",Jr,p(t.currentYear),1)]),s("button",{class:"month-nav-btn",onClick:e[7]||(e[7]=(...g)=>t.nextMonth&&t.nextMonth(...g)),disabled:n.isLoading},[...e[32]||(e[32]=[s("span",{class:"nav-icon"},"›",-1)])],8,Kr)]),s("div",Zr,[s("div",Xr,[(c(!0),u(se,null,oe(t.weekdays,g=>(c(),u("div",{class:"weekday-header",key:g},p(g),1))),128)),(c(!0),u(se,null,oe(t.calendarDays,g=>(c(),u("div",{key:`${g.date}-${g.month}`,class:J(["calendar-day",{"other-month":!g.isCurrentMonth,today:g.isToday,weekend:g.isWeekend,"has-events":g.hasEvents}]),onClick:O=>t.selectDay(g)},[s("span",el,p(g.day),1),g.hasEvents?(c(),u("div",tl,[e[33]||(e[33]=s("div",{class:"event-dot"},null,-1)),g.events&&g.events.length>1?(c(),u("span",sl,p(g.events.length),1)):y("",!0)])):y("",!0)],10,$r))),128))])]),t.selectedDay?(c(),u("div",ol,[s("h3",null,p(t.formatSelectedDay(t.selectedDay)),1),s("div",al,[!t.selectedDay.events||t.selectedDay.events.length===0?(c(),u("p",nl," No watchlist releases scheduled for this day ")):(c(),u("div",il,[(c(!0),u(se,null,oe(t.selectedDay.events,g=>(c(),u("div",{key:g.id,class:J(["event-item",`event-${g.type}`])},[s("div",rl,[s("span",ll,p(g.time),1),s("span",dl,p(g.type),1)]),s("span",cl,p(g.title),1),g.item.platforms?(c(),u("div",ul,p(g.item.platforms),1)):y("",!0),g.item.genre?(c(),u("div",ml,p(g.item.genre),1)):y("",!0)],2))),128))]))])])):y("",!0)])):t.currentCategory==="profile"?(c(),u("div",gl,[s("div",fl,[s("div",pl,[s("div",{class:"profile-avatar-large",onClick:e[8]||(e[8]=(...g)=>t.changeAvatar&&t.changeAvatar(...g))},[t.profileData.avatar?(c(),u("img",{key:0,src:t.profileData.avatar,alt:"Profile Picture"},null,8,vl)):(c(),u("span",hl,p(t.getInitials()),1))]),s("input",{type:"file",ref:"avatarInput",accept:"image/*",onChange:e[9]||(e[9]=(...g)=>t.handleAvatarChange&&t.handleAvatarChange(...g)),style:{display:"none"}},null,544)]),s("div",yl,[s("h2",null,p(t.profileData.displayName||t.profileData.firstName+" "+t.profileData.lastName||"User"),1),s("p",null,p(t.profileData.email||"user@example.com"),1),s("div",bl,[s("div",kl,[s("span",wl,p(n.totalItems),1),e[34]||(e[34]=s("span",{class:"stat-label"},"Total Items",-1))]),s("div",Sl,[s("span",Il,p(new Date().getFullYear()),1),e[35]||(e[35]=s("span",{class:"stat-label"},"Member Since",-1))])])])]),s("div",_l,[s("div",Cl,[e[41]||(e[41]=s("div",{class:"section-header"},[s("h3",null,"Personal Information"),s("p",null,"Manage your personal details and account information")],-1)),s("div",Dl,[s("div",xl,[s("div",Al,[e[36]||(e[36]=s("label",{for:"firstName"},"First Name",-1)),U(s("input",{type:"text",id:"firstName","onUpdate:modelValue":e[10]||(e[10]=g=>t.profileData.firstName=g),placeholder:"Enter your first name"},null,512),[[N,t.profileData.firstName]])]),s("div",Tl,[e[37]||(e[37]=s("label",{for:"lastName"},"Last Name",-1)),U(s("input",{type:"text",id:"lastName","onUpdate:modelValue":e[11]||(e[11]=g=>t.profileData.lastName=g),placeholder:"Enter your last name"},null,512),[[N,t.profileData.lastName]])])]),s("div",Ml,[e[38]||(e[38]=s("label",{for:"displayName"},"Display Name",-1)),U(s("input",{type:"text",id:"displayName","onUpdate:modelValue":e[12]||(e[12]=g=>t.profileData.displayName=g),placeholder:"How others see your name"},null,512),[[N,t.profileData.displayName]])]),s("div",Ul,[e[39]||(e[39]=s("label",{for:"email"},"Email Address",-1)),U(s("input",{type:"email",id:"email","onUpdate:modelValue":e[13]||(e[13]=g=>t.profileData.email=g),placeholder:"your.email@example.com"},null,512),[[N,t.profileData.email]])]),s("div",Rl,[e[40]||(e[40]=s("label",{for:"bio"},"Bio",-1)),U(s("textarea",{id:"bio","onUpdate:modelValue":e[14]||(e[14]=g=>t.profileData.bio=g),placeholder:"Tell us about yourself...",rows:"4"},null,512),[[N,t.profileData.bio]])])])]),s("div",Bl,[e[53]||(e[53]=s("div",{class:"section-header"},[s("h3",null,"Preferences"),s("p",null,"Customize your application experience")],-1)),s("div",Pl,[s("div",El,[s("div",Fl,[e[43]||(e[43]=s("label",{for:"language"},"Language",-1)),U(s("select",{id:"language","onUpdate:modelValue":e[15]||(e[15]=g=>t.profileData.language=g)},[...e[42]||(e[42]=[s("option",{value:"en"},"English",-1),s("option",{value:"de"},"Deutsch",-1),s("option",{value:"fr"},"Français",-1),s("option",{value:"es"},"Español",-1)])],512),[[ke,t.profileData.language]])]),s("div",Ll,[e[45]||(e[45]=s("label",{for:"timezone"},"Timezone",-1)),U(s("select",{id:"timezone","onUpdate:modelValue":e[16]||(e[16]=g=>t.profileData.timezone=g)},[...e[44]||(e[44]=[s("option",{value:"UTC"},"UTC",-1),s("option",{value:"Europe/Berlin"},"Europe/Berlin",-1),s("option",{value:"America/New_York"},"America/New_York",-1),s("option",{value:"America/Los_Angeles"},"America/Los_Angeles",-1)])],512),[[ke,t.profileData.timezone]])])]),s("div",Gl,[s("div",Nl,[e[47]||(e[47]=s("label",{for:"dateFormat"},"Date Format",-1)),U(s("select",{id:"dateFormat","onUpdate:modelValue":e[17]||(e[17]=g=>t.profileData.dateFormat=g)},[...e[46]||(e[46]=[s("option",{value:"MM/DD/YYYY"},"MM/DD/YYYY",-1),s("option",{value:"DD/MM/YYYY"},"DD/MM/YYYY",-1),s("option",{value:"YYYY-MM-DD"},"YYYY-MM-DD",-1)])],512),[[ke,t.profileData.dateFormat]])]),s("div",Wl,[e[49]||(e[49]=s("label",{for:"booksApiProvider"},"Books API Provider",-1)),U(s("select",{id:"booksApiProvider","onUpdate:modelValue":e[18]||(e[18]=g=>t.profileData.booksApiProvider=g)},[...e[48]||(e[48]=[s("option",{value:"wikipedia"},"Wikipedia (Primary)",-1),s("option",{value:"google_books"},"Google Books (Fallback)",-1),s("option",{value:"both"},"Both (Wikipedia + Google Books)",-1)])],512),[[ke,t.profileData.booksApiProvider]])])]),s("div",Vl,[s("div",Ol,[e[51]||(e[51]=s("label",{for:"enableGoogleBooksFallback"},"Enable Google Books Fallback",-1)),s("div",zl,[U(s("input",{type:"checkbox",id:"enableGoogleBooksFallback","onUpdate:modelValue":e[19]||(e[19]=g=>t.profileData.enableGoogleBooksFallback=g)},null,512),[[dt,t.profileData.enableGoogleBooksFallback]]),e[50]||(e[50]=s("label",{for:"enableGoogleBooksFallback",class:"checkbox-label"}," Use Google Books as fallback when Wikipedia search fails ",-1))])]),e[52]||(e[52]=s("div",{class:"form-group"},null,-1))])])]),s("div",jl,[e[58]||(e[58]=s("div",{class:"section-header"},[s("h3",null,"Data Management"),s("p",null,"Manage your data and account")],-1)),s("div",Yl,[s("div",ql,[s("button",{class:"data-btn export-btn",onClick:e[20]||(e[20]=(...g)=>t.exportData&&t.exportData(...g))},[...e[54]||(e[54]=[s("span",{class:"btn-icon"},"📦",-1),s("span",{class:"btn-text"},"Export All Data",-1),s("span",{class:"btn-description"},"Download your complete media library",-1)])]),s("button",{class:"data-btn import-btn",onClick:e[21]||(e[21]=(...g)=>t.importData&&t.importData(...g))},[...e[55]||(e[55]=[s("span",{class:"btn-icon"},"📥",-1),s("span",{class:"btn-text"},"Import Data",-1),s("span",{class:"btn-description"},"Import data from a backup file",-1)])]),s("button",{class:"data-btn backup-btn",onClick:e[22]||(e[22]=(...g)=>t.createBackup&&t.createBackup(...g))},[...e[56]||(e[56]=[s("span",{class:"btn-icon"},"💾",-1),s("span",{class:"btn-text"},"Create Backup",-1),s("span",{class:"btn-description"},"Create a local backup of your data",-1)])]),s("button",{class:"data-btn cache-btn",onClick:e[23]||(e[23]=(...g)=>t.clearCache&&t.clearCache(...g))},[...e[57]||(e[57]=[s("span",{class:"btn-icon"},"🗑️",-1),s("span",{class:"btn-text"},"Clear Cache",-1),s("span",{class:"btn-description"},"Clear temporary files and cache",-1)])])])])]),s("div",Hl,[e[61]||(e[61]=s("div",{class:"section-header"},[s("h3",null,"Danger Zone"),s("p",null,"Irreversible and destructive actions")],-1)),s("div",Ql,[s("div",Jl,[s("button",{class:"danger-btn reset-btn",onClick:e[24]||(e[24]=(...g)=>t.resetSettings&&t.resetSettings(...g))},[...e[59]||(e[59]=[s("span",{class:"btn-icon"},"🔄",-1),s("span",{class:"btn-text"},"Reset All Settings",-1),s("span",{class:"btn-description"},"Reset all settings to default values",-1)])]),s("button",{class:"danger-btn clear-btn",onClick:e[25]||(e[25]=(...g)=>t.clearAllData&&t.clearAllData(...g))},[...e[60]||(e[60]=[s("span",{class:"btn-icon"},"🗑️",-1),s("span",{class:"btn-text"},"Clear All Data",-1),s("span",{class:"btn-description"},"Permanently delete all your data",-1)])])])])])])])):t.currentCategory==="statistics"?(c(),u("div",Kl,[s("div",Zl,[e[62]||(e[62]=s("h1",null,"📊 Media Library Statistics",-1)),e[63]||(e[63]=s("p",null,"Übersicht über deine Media Collection",-1)),s("div",Xl,[s("button",{class:"refresh-btn",onClick:e[26]||(e[26]=(...g)=>t.loadMedia&&t.loadMedia(...g))},"🔄 Refresh Statistics")])]),s("div",$l,[s("div",ed,[s("div",td,[s("div",sd,p(t.statistics.totalItems),1),e[64]||(e[64]=s("div",{class:"summary-label"},"Total Items",-1))]),s("div",od,[s("div",ad,p(t.statistics.totalCollections),1),e[65]||(e[65]=s("div",{class:"summary-label"},"Collections",-1))]),s("div",nd,[s("div",id,p(t.statistics.totalPlaytime)+"h",1),e[66]||(e[66]=s("div",{class:"summary-label"},"Total Playtime",-1))]),s("div",rd,[s("div",ld,p(t.statistics.avgRating),1),e[67]||(e[67]=s("div",{class:"summary-label"},"Avg Rating",-1))])]),s("div",dd,[e[68]||(e[68]=s("h3",{class:"chart-title"},"📈 Category Distribution",-1)),s("div",cd,[(c(!0),u(se,null,oe(t.statistics.categoryDistribution,(g,O)=>(c(),u("div",{key:O,class:"category-stat"},[s("div",ud,p(O),1),s("div",md,[s("div",{class:"category-fill",style:Te({width:`${g/t.statistics.totalItems*100}%`})},null,4)]),s("div",gd,p(g)+" ("+p((g/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",fd,[e[69]||(e[69]=s("h3",{class:"chart-title"},"⭐ Rating Distribution",-1)),s("div",pd,[(c(!0),u(se,null,oe(t.statistics.ratingDistribution,(g,O)=>(c(),u("div",{key:O,class:"rating-stat"},[s("div",vd,p(t.getRatingStars(O)),1),s("div",hd,[s("div",{class:"rating-fill",style:Te({width:`${g/t.statistics.totalItems*100}%`})},null,4)]),s("div",yd,p(g)+" ("+p((g/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",bd,[e[70]||(e[70]=s("h3",{class:"chart-title"},"🎮 Platform Distribution",-1)),s("div",kd,[(c(!0),u(se,null,oe(t.statistics.platformDistribution,(g,O)=>(c(),u("div",{key:O,class:"platform-stat"},[s("div",wd,p(O),1),s("div",Sd,[s("div",{class:"platform-fill",style:Te({width:`${g/t.statistics.totalItems*100}%`})},null,4)]),s("div",Id,p(g)+" ("+p((g/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",_d,[e[71]||(e[71]=s("h3",{class:"chart-title"},"🎭 Top Genres",-1)),s("div",Cd,[(c(!0),u(se,null,oe(t.statistics.genreDistribution,(g,O)=>(c(),u("div",{key:O,class:"genre-stat"},[s("div",Dd,p(O),1),s("div",xd,[s("div",{class:"genre-fill",style:Te({width:`${g/t.statistics.totalItems*100}%`})},null,4)]),s("div",Ad,p(g)+" ("+p((g/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",Td,[e[72]||(e[72]=s("h3",{class:"chart-title"},"📅 Recent Activity",-1)),s("div",Md,[(c(!0),u(se,null,oe(t.statistics.recentActivity,g=>(c(),u("div",{key:g.title,class:"activity-item"},[s("div",Ud,p(g.title),1),s("div",Rd,p(g.category),1),s("div",Bd,p(t.formatDate(g.discovered)),1)]))),128))])]),s("div",Pd,[e[73]||(e[73]=s("h3",{class:"chart-title"},"📺 Currently Airing Series",-1)),s("div",Ed,[(c(!0),u(se,null,oe(t.statistics.airingSeries,g=>(c(),u("div",{key:g.title,class:"airing-item"},[s("div",Fd,p(g.title),1),s("div",Ld,"Next: Season "+p(g.nextSeason),1),s("div",Gd,p(g.nextSeasonRelease?t.formatDate(g.nextSeasonRelease):"TBA"),1)]))),128))])])])])):(c(),u("div",Nd,[(c(!0),u(se,null,oe(t.paginatedMedia,g=>(c(),xe(d,{key:g.id,item:g,onEdit:t.editItem},null,8,["item","onEdit"]))),128))]))]))])]),t.isLoggedIn?y("",!0):(c(),u("div",Wd,[s("button",{onClick:e[27]||(e[27]=(...g)=>t.handleAdminSetup&&t.handleAdminSetup(...g)),disabled:t.adminSetupLoading,class:"admin-setup-btn",title:"Setup Admin Account (Creates admin account with default password)"},[t.adminSetupLoading?(c(),u("span",Od,"🔧 Setting up...")):(c(),u("span",zd,"🔧 Admin Setup"))],8,Vd),t.adminSetupMessage?(c(),u("div",{key:0,class:J(["admin-setup-message",t.adminSetupMessage.type])},p(t.adminSetupMessage.text),3)):y("",!0)])),t.showLoginModal?(c(),xe(M,{key:1,onClose:e[28]||(e[28]=g=>t.showLoginModal=!1),onSuccess:t.handleLoginSuccess,onSwitchToRegister:t.switchToRegister},null,8,["onSuccess","onSwitchToRegister"])):y("",!0),t.showRegisterModal?(c(),xe(T,{key:2,onClose:e[29]||(e[29]=g=>t.showRegisterModal=!1),onSuccess:t.handleRegisterSuccess},null,8,["onSuccess"])):y("",!0),t.showEditModal?(c(),xe(C,{key:3,item:t.editingItem,"current-category":t.currentCategory,onClose:t.closeEditModal,onSave:t.handleSaveItem,onDelete:t.handleDeleteItem},null,8,["item","current-category","onClose","onSave","onDelete"])):y("",!0),be(k,{show:t.showBulkAddModal,"current-category":t.currentCategory,onClose:t.closeBulkAddModal},null,8,["show","current-category","onClose"]),be(K,{show:t.showTxtImportModal,onClose:e[30]||(e[30]=g=>t.showTxtImportModal=!1),onFileProcessed:t.processTxtContent},null,8,["show","onFileProcessed"]),be(X,{show:t.showTxtImportResults,results:t.txtImportResults,onClose:t.closeTxtImportResults},null,8,["show","results","onClose"]),be(V,{"show-menu":t.showFloatingMenu,"show-delete-all":t.isLoggedIn&&t.currentCategory!=="all"&&t.categoryCounts[t.currentCategory]>0,"category-name":t.currentCategoryDisplayName,"item-count":t.categoryCounts[t.currentCategory]||0,onToggleMenu:t.toggleFloatingMenu,onAddNewItem:t.addNewItem,onBulkAddItems:t.bulkAddItems,onImportFromTxt:t.importFromTxt,onImportFromApi:t.importFromAPI,onCreateCollection:t.createCollection,onDeleteAllInCategory:t.deleteAllInCategory},null,8,["show-menu","show-delete-all","category-name","item-count","onToggleMenu","onAddNewItem","onBulkAddItems","onImportFromTxt","onImportFromApi","onCreateCollection","onDeleteAllInCategory"]),be(le,{show:t.messageStore.show,type:t.messageStore.type,title:t.messageStore.title,message:t.messageStore.message,details:t.messageStore.details,onClose:t.messageStore.closeMessage},null,8,["show","type","title","message","details","onClose"]),be(pe,{show:t.confirmStore.show,title:t.confirmStore.title,message:t.confirmStore.message,onConfirm:t.confirmStore.confirm,onClose:t.confirmStore.cancel},null,8,["show","title","message","onConfirm","onClose"]),be(me,{show:t.inputStore.show,title:t.inputStore.title,message:t.inputStore.message,placeholder:t.inputStore.placeholder,"input-type":t.inputStore.inputType,"default-value":t.inputStore.defaultValue,onConfirm:t.inputStore.confirm,onClose:t.inputStore.cancel},null,8,["show","title","message","placeholder","input-type","default-value","onConfirm","onClose"])])}const qd=ae(Gr,[["render",jd],["__scopeId","data-v-fe065bdb"]]);export{qd as default};
