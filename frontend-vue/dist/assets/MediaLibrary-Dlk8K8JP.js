import{A as Lt,d as Pe,r as S,w as Ce,c as O,m as me,u as Nt,a as Ve,_ as ee,b as m,e as o,f as k,t as v,n as Q,g as Ae,h as re,i as xe,o as u,j as he,F as oe,k as se,l as ae,p as Oe,q as Te,s as T,v as L,x as at,y as ye,z as it,B as De,C as Gt,D as Wt,E as Ot,G as Vt}from"./index-CHSJkJ2R.js";class zt{constructor(){this.isConnected={value:!1},this.listeners=new Map,this.pollingInterval=null,this.lastUpdate=null,this.pollingIntervalMs=2e4}getApiBaseUrl(){return Lt.BASE_URL}connect(){if(this.pollingInterval)return;const e=localStorage.getItem("authToken"),s=localStorage.getItem("currentUser");!e||!s||(this.isConnected.value=!0,this.lastUpdate=new Date,this.pollingInterval=setInterval(()=>{this.checkForUpdates()},this.pollingIntervalMs))}async checkForUpdates(){try{const e=localStorage.getItem("authToken"),s=localStorage.getItem("currentUser");if(!e||!s)return;const t=this.getApiBaseUrl(),a=await fetch(`${t}/api/media`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!a.ok){if(a.status===401){this.disconnect();return}throw new Error(`HTTP error! status: ${a.status}`)}const r=await a.json();r&&r.length>0&&this.listeners.forEach((n,c)=>{try{n({type:"media_updated",items:r,count:r.length,timestamp:new Date().toISOString()})}catch{}}),this.lastUpdate=new Date}catch{}}addListener(e,s){this.listeners.set(e,s)}removeListener(e){this.listeners.delete(e)}disconnect(){this.pollingInterval&&(clearInterval(this.pollingInterval),this.pollingInterval=null),this.isConnected.value=!1}destroy(){this.disconnect(),this.listeners.clear()}}const Je=new zt,ze=Pe("media",()=>{const i=()=>{try{return localStorage.getItem("currentCategory")||"game"}catch(b){return console.error("Failed to load current category from localStorage:",b),"game"}},e=b=>{try{localStorage.setItem("currentCategory",b)}catch(y){console.error("Failed to save current category to localStorage:",y)}},s=()=>{try{return localStorage.getItem("searchQuery")||""}catch(b){return console.error("Failed to load search query from localStorage:",b),""}},t=b=>{try{localStorage.setItem("searchQuery",b)}catch(y){console.error("Failed to save search query to localStorage:",y)}},a=S(d()),r=S(i()),n=S(s()),c=S(!1),f=S(null);Ce(r,b=>{e(b)},{immediate:!1}),Ce(n,b=>{t(b)},{immediate:!1});function d(){try{const b=localStorage.getItem("authToken"),y=localStorage.getItem("currentUser");if(!b||!y){const l=localStorage.getItem("mediaData");return l?JSON.parse(l):[]}return[]}catch(b){return console.error("Failed to load media from storage:",b),[]}}function x(){try{const b=localStorage.getItem("authToken"),y=localStorage.getItem("currentUser");(!b||!y)&&localStorage.setItem("mediaData",JSON.stringify(a.value))}catch(b){console.error("Failed to save media to storage:",b)}}const D=O(()=>a.value.length),A=O(()=>{const b={};return a.value.forEach(y=>{const l=y.category||"unknown";b[l]=(b[l]||0)+1}),b}),w=O(()=>{let b=[...a.value];if(r.value&&r.value!=="all"&&(b=b.filter(y=>r.value==="watchlist"?y.category==="watchlist"||y.isNew===!0:y.category===r.value)),n.value){const y=n.value.toLowerCase();b=b.filter(l=>{var h,I,g,M;return((h=l.title)==null?void 0:h.toLowerCase().includes(y))||((I=l.description)==null?void 0:I.toLowerCase().includes(y))||((g=l.genre)==null?void 0:g.toLowerCase().includes(y))||((M=l.platforms)==null?void 0:M.toLowerCase().includes(y))})}return b});async function V(){var b,y;c.value=!0,f.value=null;try{const l=localStorage.getItem("authToken"),h=localStorage.getItem("currentUser");if(l&&h)try{const I=await me.getMedia();console.log("🔍 LOAD DEBUG: API returned data:",I),console.log("🔍 LOAD DEBUG: Data length:",I==null?void 0:I.length),console.log("🔍 LOAD DEBUG: First item:",I==null?void 0:I[0]),a.value=I||[],console.log("🔍 LOAD DEBUG: mediaData.value set to:",a.value)}catch(I){console.warn("API load failed for logged in user:",I),a.value=[]}else{const I=d();if(I.length>0)a.value=I;else{const g=await me.getMedia();a.value=g||[],x()}}}catch(l){f.value=((y=(b=l.response)==null?void 0:b.data)==null?void 0:y.message)||l.message||"Failed to load media data",console.error("Failed to load media:",l)}finally{c.value=!1}}function Z(b){r.value=b}function Y(b){n.value=b}async function ne(b,y=!1){var l,h,I;f.value=null;try{const g=localStorage.getItem("authToken"),M=localStorage.getItem("currentUser");if(g&&M)try{const q=await me.addMediaItem(b);if(!y)await V();else{const te={...q,__order:a.value.length};a.value.push(te)}return q}catch(q){if(((l=q.response)==null?void 0:l.status)===409&&((I=(h=q.response)==null?void 0:h.data)!=null&&I.duplicate)){const te=new Error(q.response.data.error||"Ein Eintrag mit diesem Titel und dieser Kategorie existiert bereits.");throw te.isDuplicate=!0,te}throw f.value=q.message||"Failed to add media item",console.error("API save failed for logged in user:",q),q}else{const q={id:Date.now(),...b,__order:a.value.length};return a.value.push(q),x(),q}}catch(g){throw g}}async function ge(b,y){f.value=null;try{const l=localStorage.getItem("authToken"),h=localStorage.getItem("currentUser");if(l&&h)try{const I=await me.updateMediaItem(b,y);return await V(),I}catch(I){throw console.error("API update failed for logged in user:",I),I}else{const I=a.value.findIndex(g=>g.id===b);if(I!==-1)return a.value[I]={...a.value[I],...y},x(),a.value[I];throw new Error("Media item not found")}}catch(l){throw l.isDuplicate||(f.value=l.message||"Failed to update media item"),l}}async function de(b){var y;try{const l=localStorage.getItem("authToken"),h=localStorage.getItem("currentUser");if(l&&h)try{return await me.deleteMediaItem(b),await V(),!0}catch(I){if(((y=I.response)==null?void 0:y.status)===404||I.isNotFound)return await V(),!0;throw console.error("API delete failed for logged in user:",I),I}else{const I=a.value.findIndex(g=>g.id===b);if(I!==-1)return a.value.splice(I,1),x(),!0;throw new Error("Media item not found")}}catch(l){throw f.value=l.message||"Failed to delete media item",l}}async function p(b){try{const y=localStorage.getItem("authToken"),l=localStorage.getItem("currentUser");if(y&&l)try{const h=await me.batchAddMediaItems(b);return await V(),h}catch(h){throw console.error("API batch add failed for logged in user:",h),h}else{const h=b.map((I,g)=>({id:Date.now()+g,...I,__order:a.value.length+g}));return a.value.push(...h),x(),{success:!0,stats:{created:h.length,failed:0,errors:[]}}}}catch(y){throw f.value=y.message||"Failed to add media items",y}}async function G(b){try{const y=localStorage.getItem("authToken"),l=localStorage.getItem("currentUser");if(y&&l)try{return await me.batchDeleteMediaItems(b),await V(),!0}catch(h){if(h.silent)return console.log("Silent batch delete error (some items may not exist):",h.message),await V(),!0;throw console.error("API batch delete failed for logged in user:",h),h}else return a.value=a.value.filter(h=>!b.includes(h.id)),x(),!0}catch(y){throw y.silent||(f.value=y.message||"Failed to delete media items"),y}}async function le(){try{const b=localStorage.getItem("authToken"),y=localStorage.getItem("currentUser");b&&y?await me.saveMedia(a.value):x()}catch(b){console.error("Failed to save media:",b)}}function ie(){f.value=null}function ke(b){if(console.log("Processing real-time update:",b),b.type==="media_updated"&&b.items)b.items.forEach(y=>{const l=a.value.findIndex(h=>h.id===y.id);l!==-1?a.value[l]={...a.value[l],...y}:a.value.push(y)});else if(b.action==="created"||b.action==="updated"){const y=b.item,l=a.value.findIndex(h=>h.id===y.id);l!==-1?a.value[l]={...a.value[l],...y}:a.value.push(y)}else if(b.action==="deleted"){const y=a.value.findIndex(l=>l.id===b.id);y!==-1&&a.value.splice(y,1)}x()}function fe(){const b=localStorage.getItem("authToken"),y=localStorage.getItem("currentUser");if(!b||!y){console.log("Skipping realtime initialization - user not authenticated");return}try{Je.addListener("media-store",ke),Je.connect()}catch(l){console.error("Failed to initialize realtime updates:",l)}}function we(){Je.removeListener("media-store")}return{mediaData:a,currentCategory:r,searchQuery:n,loading:c,error:f,totalItems:D,categoryCounts:A,filteredMedia:w,loadMedia:V,setCategory:Z,setSearchQuery:Y,addMediaItem:ne,updateMediaItem:ge,deleteMediaItem:de,batchAddMediaItems:p,batchDeleteMediaItems:G,saveMedia:le,clearError:ie,initializeRealtimeUpdates:fe,cleanupRealtimeUpdates:we,resetMediaState:()=>{r.value="game",n.value="",localStorage.removeItem("currentCategory"),localStorage.removeItem("searchQuery")}}}),nt=Pe("message",()=>{const i=S(!1),e=S("info"),s=S(""),t=S(""),a=S("");function r(D){e.value=D.type||"info",s.value=D.title||"",t.value=D.message||"",a.value=D.details||"",i.value=!0}function n(D,A="Success",w=""){r({type:"success",title:A,message:D,details:w})}function c(D,A="Error",w=""){r({type:"error",title:A,message:D,details:w})}function f(D,A="Warning",w=""){r({type:"warning",title:A,message:D,details:w})}function d(D,A="Info",w=""){r({type:"info",title:A,message:D,details:w})}function x(){i.value=!1,setTimeout(()=>{e.value="info",s.value="",t.value="",a.value=""},300)}return{show:i,type:e,title:s,message:t,details:a,showMessage:r,showSuccess:n,showError:c,showWarning:f,showInfo:d,closeMessage:x}}),lt=Pe("confirm",()=>{const i=S(!1),e=S("Confirm Action"),s=S(""),t=S(null);function a(c){return new Promise(f=>{e.value=c.title||"Confirm Action",s.value=c.message||"",i.value=!0,t.value=f})}function r(){t.value&&(t.value(!0),t.value=null),i.value=!1}function n(){t.value&&(t.value(!1),t.value=null),i.value=!1}return{show:i,title:e,message:s,showConfirm:a,confirm:r,cancel:n}}),rt=Pe("input",()=>{const i=S(!1),e=S("Input Required"),s=S(""),t=S(""),a=S("text"),r=S(""),n=S(null);function c(x){return new Promise(D=>{e.value=x.title||"Input Required",s.value=x.message||"",t.value=x.placeholder||"",a.value=x.inputType||"text",r.value=x.defaultValue||"",i.value=!0,n.value=D})}function f(x){n.value&&(n.value(x),n.value=null),i.value=!1}function d(){n.value&&(n.value(null),n.value=null),i.value=!1}return{show:i,title:e,message:s,placeholder:t,inputType:a,defaultValue:r,showInput:c,confirm:f,cancel:d}}),dt=Pe("sidebar",()=>{const i=()=>{try{const w=localStorage.getItem("sidebarState");if(w)return{collapsed:JSON.parse(w).collapsed||!1,mobileOpen:!1}}catch(w){console.error("Failed to load sidebar state from localStorage:",w)}return{collapsed:!1,mobileOpen:!1}},e=w=>{try{localStorage.setItem("sidebarState",JSON.stringify({collapsed:w.collapsed}))}catch(V){console.error("Failed to save sidebar state to localStorage:",V)}},s=i(),t=S(s.collapsed),a=S(s.mobileOpen);Ce(t,w=>{e({collapsed:w,mobileOpen:a.value})},{immediate:!1});const r=()=>{t.value=!t.value},n=()=>{a.value=!a.value},c=()=>{a.value=!1},f=w=>{t.value=w},d=w=>{a.value=w},x=()=>{t.value=!1,a.value=!1,localStorage.removeItem("sidebarState")},D=O(()=>t.value),A=O(()=>a.value);return{collapsed:t,mobileOpen:a,toggleSidebar:r,toggleMobileSidebar:n,closeMobileSidebar:c,setCollapsed:f,setMobileOpen:d,resetSidebarState:x,isCollapsed:D,isMobileOpen:A}});function jt(){const i=Nt(),e=Ve(),s=ze(),t=nt(),a=lt(),r=rt(),n=S(!1),c=S(!1),f=S(!1),d=S(!1),x=S(!1),D=S(!1),A=S(!1),w=S(null),V=()=>typeof window<"u"?window.innerWidth>768?8:3:8,Z=S(V()),Y=S("order_asc"),ne=S(null),ge=()=>{Z.value=V()};typeof window<"u"&&window.addEventListener("resize",ge);const de=[{key:"game",name:"Games",icon:"🎮"},{key:"series",name:"Series",icon:"📺"},{key:"movie",name:"Movies",icon:"🎬"},{key:"buecher",name:"Bücher",icon:"📚"},{key:"watchlist",name:"Watchlist",icon:"❤️"}],p=O(()=>{try{return e.isLoggedIn}catch(_){return console.error("Error accessing authStore.isLoggedIn:",_),!1}}),G=O(()=>{try{return e.userName}catch(_){return console.error("Error accessing authStore.userName:",_),""}}),le=O(()=>{try{return e.isAdmin}catch(_){return console.error("Error accessing authStore.isAdmin:",_),!1}}),ie=O(()=>{try{return s.currentCategory}catch(_){return console.error("Error accessing mediaStore.currentCategory:",_),"game"}}),ke=O({get:()=>{try{return s.searchQuery}catch(_){return console.error("Error accessing mediaStore.searchQuery:",_),""}},set:_=>{try{s.setSearchQuery(_)}catch(P){console.error("Error setting mediaStore.searchQuery:",P)}}}),fe=O(()=>{try{return s.categoryCounts}catch(_){return console.error("Error accessing mediaStore.categoryCounts:",_),{}}}),we=O(()=>{try{return s.loading}catch(_){return console.error("Error accessing mediaStore.loading:",_),!1}}),Ie=O(()=>{try{return s.error}catch(_){return console.error("Error accessing mediaStore.error:",_),null}}),b=O(()=>{try{const _=[...s.filteredMedia||[]],[P,K]=Y.value.split("_");return _.sort((F,N)=>{let X=F[P],z=N[P];return P==="order"?(X=F.__order||0,z=N.__order||0):P==="airing"?(X=F.isAiring?1:0,z=N.isAiring?1:0):P==="api_rating"?(X=F.api_rating||F.rating||0,z=N.api_rating||N.rating||0):P==="personal_rating"&&(X=F.personal_rating||0,z=N.personal_rating||0),typeof X=="string"&&(X=X.toLowerCase(),z=z.toLowerCase()),K==="asc"?X>z?1:-1:X<z?1:-1})}catch(_){return console.error("Error in sortedMedia computed:",_),[]}}),y=O(()=>b.value),l=_=>{s.setCategory(_),dt().closeMobileSidebar()},h=()=>{s.setSearchQuery("")},I=_=>{w.value=_,f.value=!0},g=()=>{f.value=!1,w.value=null},M=()=>{x.value=!1},q=async _=>{console.log("handleBulkAddItems called but not used in new workflow")},te=async _=>{w.value?await s.updateMediaItem(w.value.id,_):await s.addMediaItem(_),g()},ce=async _=>{var P;try{await s.deleteMediaItem(_.id)}catch(K){((P=K.response)==null?void 0:P.status)!==404&&!K.silent&&(console.error("Delete failed:",K),t.showError("Failed to delete item: "+(K.message||"Unknown error"),"Delete Failed"))}},E=async()=>{await e.logout(),await J()},J=async()=>{try{await s.loadMedia()}catch(_){console.error("Error loading media:",_)}},pe=()=>{d.value=!d.value},Be=()=>{if(d.value=!1,!p.value){t.showWarning("Bitte loggen Sie sich ein, um neue Items hinzuzufügen.","Login erforderlich");return}w.value=null,f.value=!0},W=()=>{if(d.value=!1,!p.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}x.value=!0},ue=()=>{if(d.value=!1,!p.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}D.value=!0},je=()=>{if(d.value=!1,!p.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}t.showInfo("API Import feature coming soon!","Feature in Entwicklung")},Re=()=>{if(d.value=!1,!p.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}Ee()},Me=_=>{if(!_)return"Unknown";const P=de.find(K=>K.key===_);return P?P.name:_},Ye=async()=>{const _=Me(ie.value),P=fe.value[ie.value]||0;if(P===0){t.showInfo("No items to delete in this category.","Nothing to Delete");return}const K=`Are you sure you want to delete ALL ${P} items in "${_}"?

This action cannot be undone!`;if(await a.showConfirm({title:"Delete All Items",message:K}))try{const X=((s==null?void 0:s.mediaData)||[]).filter(z=>ie.value==="watchlist"?z.category==="watchlist"||z.isNew===!0:z.category===ie.value).map(z=>z.id);await s.batchDeleteMediaItems(X),await J(),t.showSuccess(`Successfully deleted ${P} items from "${_}"`,"Items Deleted")}catch(N){console.error("Error deleting items:",N),N.silent?t.showSuccess(`Items deleted from "${_}" (some items may not have existed)`,"Items Deleted"):N.isNotFound?t.showWarning("Some items were not found and could not be deleted, but the operation completed.","Partial Success"):t.showError("Error occurred while deleting items. Please try again.","Delete Failed")}},qe=_=>{const P=_.split(`
`).map(z=>z.trim()).filter(z=>z.length>0);if(P.length===0){t.showWarning("Die TXT-Datei ist leer oder enthält keine gültigen Einträge.","Leere Datei");return}const F=s.filteredMedia.map(z=>z.title.toLowerCase().trim()),N=P.filter(z=>{const _e=z.toLowerCase().trim();return!F.some(Se=>Se.includes(_e)||_e.includes(Se))}),X=P.filter(z=>{const _e=z.toLowerCase().trim();return F.some(Se=>Se.includes(_e)||_e.includes(Se))});ne.value={totalInFile:P.length,missingItems:N,existingItems:X,currentCategory:ie.value,categoryName:Me(ie.value)},D.value=!1,A.value=!0},He=()=>{ne.value=null,A.value=!1},Ee=async()=>{const _=(s==null?void 0:s.mediaData)||[];if(_.length===0){t.showInfo("Keine Media Items zum Exportieren gefunden.","Nichts zu exportieren");return}const P=await r.showInput({title:"Export Format wählen",message:`1 = CSV
2 = JSON
3 = Beide

Geben Sie die Nummer ein:`,placeholder:"1",defaultValue:"1"});if(!P||!["1","2","3"].includes(P))return;const K=new Date().toISOString().split("T")[0];(P==="1"||P==="3")&&Fe(_,K),(P==="2"||P==="3")&&Le(_,K),t.showSuccess(`Collection mit ${_.length} Items wurde erfolgreich exportiert!`,"Export erfolgreich")},Fe=(_,P)=>{const F=[["Titel","Kategorie","Release","Rating","Platforms","Genre","Spielzeit","Status","Beschreibung"].join(","),..._.map(N=>[`"${(N.title||"").replace(/"/g,'""')}"`,`"${(N.category||N.category_name||"Unbekannt").replace(/"/g,'""')}"`,`"${N.release||""}"`,`"${N.rating||""}"`,`"${(N.platforms||"").replace(/"/g,'""')}"`,`"${(N.genre||"").replace(/"/g,'""')}"`,`"${N.spielzeit||""}"`,`"${N.isAiring?"Airing":"Abgeschlossen"}"`,`"${(N.description||"").replace(/"/g,'""')}"`].join(","))].join(`
`);Ue(F,`media_collection_${P}.csv`,"text/csv;charset=utf-8;")},Le=(_,P)=>{const K={exportDate:new Date().toISOString(),totalItems:_.length,categories:[...new Set(_.map(F=>F.category||F.category_name||"Unbekannt"))],items:_.map(F=>({id:F.id,title:F.title||"",category:F.category||F.category_name||"Unbekannt",release:F.release||"",rating:F.rating||null,platforms:F.platforms||"",genre:F.genre||"",spielzeit:F.spielzeit||null,status:F.isAiring?"Airing":"Abgeschlossen",description:F.description||"",isNew:F.isNew||!1,nextSeason:F.nextSeason||null,discovered:F.discovered||null}))};Ue(JSON.stringify(K,null,2),`media_collection_${P}.json`,"application/json;charset=utf-8;")},Ue=(_,P,K)=>{const F=new Blob([_],{type:K}),N=document.createElement("a"),X=URL.createObjectURL(F);N.setAttribute("href",X),N.setAttribute("download",P),N.style.visibility="hidden",document.body.appendChild(N),N.click(),document.body.removeChild(N),URL.revokeObjectURL(X)};return{showLoginModal:n,showRegisterModal:c,showEditModal:f,showFloatingMenu:d,showBulkAddModal:x,showTxtImportModal:D,showTxtImportResults:A,editingItem:w,gridColumns:Z,sortBy:Y,categories:de,txtImportResults:ne,isLoggedIn:p,isAdmin:le,userName:G,currentCategory:ie,searchQuery:ke,categoryCounts:fe,loading:we,error:Ie,paginatedMedia:y,setCategory:l,clearSearch:h,editItem:I,closeEditModal:g,closeBulkAddModal:M,handleBulkAddItems:q,handleSaveItem:te,handleDeleteItem:ce,logout:E,loadMedia:J,toggleFloatingMenu:pe,addNewItem:Be,bulkAddItems:W,importFromTxt:ue,importFromAPI:je,createCollection:Re,exportMediaCollection:Ee,exportAsCSV:Fe,exportAsJSON:Le,downloadFile:Ue,deleteAllInCategory:Ye,getCategoryDisplayName:Me,navigateToCalendar:()=>{l("calendar")},navigateToProfile:()=>{l("profile")},navigateToAdmin:()=>{console.log("🔥 navigateToAdmin function called!"),console.log("🔥 Router object:",i),console.log("🔥 Pushing to /admin...");try{i.push("/admin"),console.log("🔥 Successfully navigated to /admin!")}catch(_){console.error("🔥 Error navigating to admin:",_)}},processTxtContent:qe,closeTxtImportResults:He,cleanup:()=>{typeof window<"u"&&window.removeEventListener("resize",ge)},router:i}}const Yt={name:"MediaItem",props:{item:{type:Object,required:!0}},emits:["edit"],computed:{showWatchlistTag(){return this.item.category==="watchlist"||this.item.isNew===!0},isWatchlistItem(){return this.item.category==="watchlist"||this.item.isNew===!0},isSeries(){return this.item.category==="series"||this.item.watchlist_type==="series"}},methods:{getImageUrl(i){return i?i.startsWith("http")?i.startsWith("http://")?i.replace("http://","https://"):i:i.startsWith("/")?i:i.startsWith("storage/")?`/${i}`:`/storage/${i}`:""},handleImageError(i){var e;i.target.style.display="none",(e=i.target.nextElementSibling)==null||e.classList.add("show")},formatDate(i){return i?new Date(i).toLocaleDateString():""},editItem(){this.$emit("edit",this.item)},openExtraLink(){this.item.extra_link&&window.open(this.item.extra_link,"_blank","noopener,noreferrer")},getWatchlistReleaseStatus(){if(!this.item.release)return"";const i=new Date(this.item.release),e=new Date;e.setHours(0,0,0,0),i.setHours(0,0,0,0);const s=i.getTime()-e.getTime(),t=Math.ceil(s/(1e3*3600*24));if(t>0)return t===1?"Tomorrow!":t<=7?`${t} days left`:t<=30?`${t} days left`:`${Math.ceil(t/30)} months left`;if(t===0)return"Released today!";{const a=this.getTypeTagText().toLowerCase();return a==="game"?"Unplayed yet":a==="series"||a==="movie"?"Unwatched yet":a==="buecher"?"Unread yet":"Unconsumed yet"}},getWatchlistReleaseStatusClass(){if(!this.item.release)return"";const i=new Date(this.item.release),e=new Date;e.setHours(0,0,0,0),i.setHours(0,0,0,0);const s=i.getTime()-e.getTime(),t=Math.ceil(s/(1e3*3600*24));return t>0?"countdown":t===0?"released-today":"unconsumed"},getTypeTagText(){var e,s,t;const i=this.item.watchlistType||this.item.watchlist_type;if(i)return i.charAt(0).toUpperCase()+i.slice(1);if(this.item.genre){const a=this.item.genre.toLowerCase();if(a.includes("game")||a.includes("gaming")||(e=this.item.platforms)!=null&&e.toLowerCase().includes("steam")||(s=this.item.platforms)!=null&&s.toLowerCase().includes("ps")||(t=this.item.platforms)!=null&&t.toLowerCase().includes("xbox"))return"Game";if(a.includes("series")||a.includes("tv")||a.includes("episode")||this.item.isAiring)return"Series";if(a.includes("movie")||a.includes("film")||a.includes("cinema"))return"Movie";if(a.includes("book")||a.includes("literature")||a.includes("novel")||a.includes("author"))return"Bücher"}if(this.item.platforms){const a=this.item.platforms.toLowerCase();if(a.includes("steam")||a.includes("ps")||a.includes("xbox")||a.includes("nintendo")||a.includes("pc"))return"Game";if(a.includes("netflix")||a.includes("hulu")||a.includes("disney")||a.includes("hbo"))return"Series";if(a.includes("cinema")||a.includes("theater"))return"Movie";if(a.includes("book")||a.includes("kindle")||a.includes("audible")||a.includes("author"))return"Bücher"}return"Media"},getTypeTagClass(){return`type-${this.getTypeTagText().toLowerCase()}`},getNextSeasonCountdown(){if(!this.item.nextSeasonRelease)return"";const i=new Date(this.item.nextSeasonRelease),e=new Date;e.setHours(0,0,0,0),i.setHours(0,0,0,0);const s=i.getTime()-e.getTime(),t=Math.ceil(s/(1e3*3600*24));return t>0?t===1?"Tomorrow!":t<=7?`${t} days`:t<=30?`${t} days`:`${Math.ceil(t/30)} months`:t===0?"Today!":"Released"},getCategoryClass(){var e,s;const i=((e=this.item.category)==null?void 0:e.toLowerCase())||((s=this.item.category_name)==null?void 0:s.toLowerCase());return i==="movies"||i==="movie"?"category-movies":i==="books"||i==="buecher"||i==="book"?"category-books":i==="series"||i==="tv"||i==="serie"?"category-series":i==="games"||i==="game"||i==="spiele"?"category-games":i==="watchlist"?"category-watchlist":"category-default"},getCategoryIcon(){var e;const i=(e=this.item.category)==null?void 0:e.toLowerCase();return i==="movies"||i==="movie"?"🎬":i==="books"||i==="buecher"?"📚":i==="series"||i==="tv"?"📺":i==="games"||i==="game"?"🎮":"📁"},getCategoryStyle(){var e;const i=(e=this.item.category)==null?void 0:e.toLowerCase();if(i==="games"||i==="game"){const s=this.item.rating||0;return this.getGameStyleByRating(s)}return{}},getGameStyleByRating(i){return i>=4.5?{"--game-primary":"#ffd700","--game-secondary":"#ffed4e","--game-accent":"#ff6b35","--game-glow":"0 0 20px rgba(255, 215, 0, 0.6)","--game-border":"3px solid #ffd700"}:i>=4?{"--game-primary":"#00d4ff","--game-secondary":"#e8f4fd","--game-accent":"#00ff88","--game-glow":"0 0 15px rgba(0, 212, 255, 0.5)","--game-border":"3px solid #00d4ff"}:i>=3.5?{"--game-primary":"#00ff88","--game-secondary":"#4caf50","--game-accent":"#8bc34a","--game-glow":"0 0 12px rgba(0, 255, 136, 0.4)","--game-border":"3px solid #00ff88"}:i>=3?{"--game-primary":"#ff9800","--game-secondary":"#ffc107","--game-accent":"#ff5722","--game-glow":"0 0 10px rgba(255, 152, 0, 0.3)","--game-border":"3px solid #ff9800"}:i>=2?{"--game-primary":"#ff5722","--game-secondary":"#f44336","--game-accent":"#d32f2f","--game-glow":"0 0 8px rgba(255, 87, 34, 0.3)","--game-border":"3px solid #ff5722"}:{"--game-primary":"#9e9e9e","--game-secondary":"#757575","--game-accent":"#616161","--game-glow":"0 0 5px rgba(158, 158, 158, 0.2)","--game-border":"3px solid #9e9e9e"}}}},qt={class:"media-image"},Ht=["src","alt"],Qt={key:1,class:"no-image"},Jt={class:"no-image-icon"},Kt={class:"media-info"},Zt={class:"media-title"},Xt={class:"media-meta"},$t={key:0,class:"media-release"},eo={key:1},to={key:1,class:"media-rating"},oo={key:0,class:"media-platforms"},so={key:1,class:"media-genre"},ao={key:2,class:"media-description"},io={key:3,class:"media-airing"},no={key:0,class:"next-season"},lo={key:1,class:"countdown"},ro={key:4,class:"watchlist-type-tag"};function co(i,e,s,t,a,r){return u(),m("div",{class:Q(["media-item",r.getCategoryClass()]),style:xe(r.getCategoryStyle()),onClick:e[2]||(e[2]=(...n)=>r.editItem&&r.editItem(...n))},[o("div",qt,[s.item.image_url||s.item.path?(u(),m("img",{key:0,src:r.getImageUrl(s.item.image_url||s.item.path),alt:s.item.title,onError:e[0]||(e[0]=(...n)=>r.handleImageError&&r.handleImageError(...n))},null,40,Ht)):(u(),m("div",Qt,[o("span",Jt,v(r.getCategoryIcon()),1)]))]),o("div",Kt,[o("h3",Zt,v(s.item.title),1),o("div",Xt,[s.item.release?(u(),m("span",$t,[r.isWatchlistItem&&s.item.release?(u(),m("span",{key:0,class:Q(r.getWatchlistReleaseStatusClass())},v(r.getWatchlistReleaseStatus()),3)):(u(),m("span",eo,v(r.formatDate(s.item.release)),1))])):k("",!0),s.item.rating?(u(),m("span",to,v("★".repeat(Math.max(0,Math.min(5,Math.floor(s.item.rating)))))+v("☆".repeat(Math.max(0,5-Math.max(0,Math.min(5,Math.floor(s.item.rating)))))),1)):k("",!0)]),s.item.platforms?(u(),m("div",oo,v(s.item.platforms),1)):k("",!0),s.item.genre?(u(),m("div",so,v(s.item.genre),1)):k("",!0),s.item.description?(u(),m("div",ao,v(s.item.description),1)):k("",!0),s.item.isAiring?(u(),m("div",io,[e[3]||(e[3]=o("span",{class:"airing-badge"},[o("span",{class:"airing-dot"}),Ae(" Airing ")],-1)),s.item.nextSeason?(u(),m("span",no,"S"+v(s.item.nextSeason),1)):k("",!0),s.item.nextSeasonRelease?(u(),m("span",lo,v(r.getNextSeasonCountdown()),1)):k("",!0)])):k("",!0),r.showWatchlistTag?(u(),m("div",ro,[o("span",{class:Q(["type-tag",r.getTypeTagClass()])},v(r.getTypeTagText()),3)])):k("",!0)]),r.isSeries&&s.item.extra_link?(u(),m("div",{key:0,class:"series-extra-button",onClick:e[1]||(e[1]=re((...n)=>r.openExtraLink&&r.openExtraLink(...n),["stop"]))},[...e[4]||(e[4]=[o("span",{class:"extra-link-icon"},"🔗",-1),o("span",{class:"extra-link-text"},"Extra Link",-1)])])):k("",!0),e[5]||(e[5]=o("div",{class:"edit-indicator"},[o("span",{class:"edit-icon"},"✏️")],-1))],6)}const uo=ee(Yt,[["render",co],["__scopeId","data-v-35cdd815"]]),go={name:"VersionInfo",data(){return{version:"1.0.0"}}},mo={class:"version-info"},fo={class:"version-label"};function po(i,e,s,t,a,r){return u(),m("div",mo,[o("span",fo,"Build #"+v(a.version),1)])}const vo=ee(go,[["render",po],["__scopeId","data-v-2d54e3c7"]]),ho={name:"Sidebar",components:{VersionInfo:vo},props:{collapsed:{type:Boolean,default:!1},mobileOpen:{type:Boolean,default:!1},isLoggedIn:{type:Boolean,default:!1},userName:{type:String,default:""},currentCategory:{type:String,default:"watchlist"},categoryCounts:{type:Object,default:()=>({})},categories:{type:Array,default:()=>[{key:"game",name:"Games",icon:"🎮"},{key:"series",name:"Series",icon:"📺"},{key:"movie",name:"Movies",icon:"🎬"},{key:"buecher",name:"Bücher",icon:"📚"},{key:"watchlist",name:"Watchlist",icon:"❤️"}]}},emits:["toggle","setCategory","addItem","navigateToCalendar","navigateToProfile","showLogin","showRegister","logout"],methods:{}},yo={class:"sidebar-content"},bo={class:"sidebar-section"},ko={class:"sidebar-nav"},wo=["onClick"],So={class:"nav-icon"},Io={class:"nav-text"},_o={class:"nav-count"},Co=["onClick","title"],Do={class:"sidebar-section"},Ao={key:0,class:"auth-buttons"},xo={key:1,class:"user-info"},To={class:"user-profile"},Mo={class:"profile-details"},Uo={class:"user-name"};function Po(i,e,s,t,a,r){const n=ae("VersionInfo");return u(),m("aside",{id:"sidebar",class:Q(["sidebar",{collapsed:s.collapsed,open:s.mobileOpen}])},[o("div",{class:"sidebar-header",onClick:e[0]||(e[0]=c=>i.$emit("toggle"))},[...e[8]||(e[8]=[o("h2",null,"Media Library",-1),o("button",{class:"sidebar-toggle"},"☰",-1)])]),o("div",yo,[o("div",bo,[e[13]||(e[13]=o("h3",null,"Browse",-1)),o("nav",ko,[(u(!0),m(oe,null,se(s.categories,c=>(u(),m("div",{key:c.key,class:"nav-item"},[o("button",{class:Q(["nav-btn",{active:s.currentCategory===c.key}]),onClick:f=>i.$emit("setCategory",c.key)},[o("span",So,v(c.icon),1),o("span",Io,v(c.name),1),o("span",_o,v(s.categoryCounts[c.key]||0),1)],10,wo),o("button",{class:"add-btn",onClick:f=>i.$emit("addItem",c.key),title:`Add ${c.name}`},[...e[9]||(e[9]=[o("span",{class:"add-icon"},"+",-1)])],8,Co)]))),128)),o("button",{class:Q(["nav-btn",{active:s.currentCategory==="statistics"}]),onClick:e[1]||(e[1]=c=>i.$emit("setCategory","statistics"))},[...e[10]||(e[10]=[o("span",{class:"nav-icon"},"📊",-1),o("span",{class:"nav-text"},"Statistics",-1)])],2),o("button",{class:Q(["nav-btn",{active:s.currentCategory==="calendar"}]),onClick:e[2]||(e[2]=c=>i.$emit("setCategory","calendar"))},[...e[11]||(e[11]=[o("span",{class:"nav-icon"},"📅",-1),o("span",{class:"nav-text"},"Calendar",-1)])],2),o("button",{class:Q(["nav-btn",{active:s.currentCategory==="profile"}]),onClick:e[3]||(e[3]=c=>i.$emit("setCategory","profile"))},[...e[12]||(e[12]=[o("span",{class:"nav-icon"},"👤",-1),o("span",{class:"nav-text"},"Profile",-1)])],2)])]),o("div",Do,[e[15]||(e[15]=o("h3",null,"Account",-1)),s.isLoggedIn?(u(),m("div",xo,[o("div",To,[e[14]||(e[14]=o("div",{class:"profile-avatar"},[o("span",{class:"avatar-text"},"👤")],-1)),o("div",Mo,[o("span",Uo,v(s.userName),1)]),o("button",{class:"account-btn",onClick:e[6]||(e[6]=c=>i.$emit("navigateToProfile"))},"⚙️")]),o("button",{class:"auth-btn",onClick:e[7]||(e[7]=c=>i.$emit("logout"))},"Logout")])):(u(),m("div",Ao,[o("button",{class:"auth-btn",onClick:e[4]||(e[4]=c=>i.$emit("showLogin"))},"Login"),o("button",{class:"auth-btn",onClick:e[5]||(e[5]=c=>i.$emit("showRegister"))},"Register")]))])]),he(n)],2)}const Bo=ee(ho,[["render",Po],["__scopeId","data-v-63e93abb"]]),Ro={name:"MainHeader",props:{searchQuery:{type:String,default:""},sortBy:{type:String,default:"order_asc"}},emits:["update:searchQuery","update:sortBy","toggleMobileSidebar","clearSearch"]},Eo={class:"main-header"},Fo={class:"header-left"},Lo={class:"header-center"},No={class:"search-container"},Go=["value"],Wo={class:"header-right"},Oo={class:"sort-container"},Vo=["value"];function zo(i,e,s,t,a,r){return u(),m("header",Eo,[o("div",Fo,[o("button",{class:"mobile-sidebar-toggle",onClick:e[0]||(e[0]=n=>i.$emit("toggleMobileSidebar"))},"☰")]),o("div",Lo,[o("div",No,[o("input",{type:"text",value:s.searchQuery,onInput:e[1]||(e[1]=n=>i.$emit("update:searchQuery",n.target.value)),placeholder:"Search..."},null,40,Go),o("button",{class:"search-clear",onClick:e[2]||(e[2]=n=>i.$emit("clearSearch"))},"×")])]),o("div",Wo,[o("div",Oo,[o("select",{value:s.sortBy,onChange:e[3]||(e[3]=n=>i.$emit("update:sortBy",n.target.value))},[...e[4]||(e[4]=[Oe('<option value="order_asc" data-v-8aca1f2e>Original order ↑</option><option value="order_desc" data-v-8aca1f2e>Original order ↓</option><option value="title_asc" data-v-8aca1f2e>Title A-Z</option><option value="title_desc" data-v-8aca1f2e>Title Z-A</option><option value="release_asc" data-v-8aca1f2e>Release ↑</option><option value="release_desc" data-v-8aca1f2e>Release ↓</option><option value="api_rating_asc" data-v-8aca1f2e>API Rating ↑</option><option value="api_rating_desc" data-v-8aca1f2e>API Rating ↓</option><option value="personal_rating_asc" data-v-8aca1f2e>Personal Rating ↑</option><option value="personal_rating_desc" data-v-8aca1f2e>Personal Rating ↓</option><option value="airing_desc" data-v-8aca1f2e>Airing first</option><option value="airing_asc" data-v-8aca1f2e>Finished first</option>',12)])],40,Vo)])])])}const jo=ee(Ro,[["render",zo],["__scopeId","data-v-8aca1f2e"]]),Yo={name:"FloatingActionButton",props:{showMenu:{type:Boolean,default:!1},showDeleteAll:{type:Boolean,default:!1},categoryName:{type:String,default:""},itemCount:{type:Number,default:0}},emits:["toggleMenu","addNewItem","bulkAddItems","importFromTxt","importFromAPI","createCollection","deleteAllInCategory"]},qo={class:"floating-actions"},Ho={class:"menu-text"},Qo={class:"item-count-badge"};function Jo(i,e,s,t,a,r){return u(),m("div",qo,[o("div",{class:Q(["floating-menu",{show:s.showMenu}])},[o("button",{class:"floating-menu-item",onClick:e[0]||(e[0]=n=>i.$emit("addNewItem"))},[...e[7]||(e[7]=[o("span",{class:"menu-icon"},"➕",-1),o("span",{class:"menu-text"},"Add Item",-1)])]),o("button",{class:"floating-menu-item",onClick:e[1]||(e[1]=n=>i.$emit("bulkAddItems"))},[...e[8]||(e[8]=[o("span",{class:"menu-icon"},"📦",-1),o("span",{class:"menu-text"},"Bulk Add",-1)])]),o("button",{class:"floating-menu-item",onClick:e[2]||(e[2]=n=>i.$emit("importFromTxt"))},[...e[9]||(e[9]=[o("span",{class:"menu-icon"},"📄",-1),o("span",{class:"menu-text"},"Import from TXT",-1)])]),o("button",{class:"floating-menu-item",onClick:e[3]||(e[3]=n=>i.$emit("importFromAPI"))},[...e[10]||(e[10]=[o("span",{class:"menu-icon"},"🌐",-1),o("span",{class:"menu-text"},"Import from API",-1)])]),o("button",{class:"floating-menu-item",onClick:e[4]||(e[4]=n=>i.$emit("createCollection"))},[...e[11]||(e[11]=[o("span",{class:"menu-icon"},"📚",-1),o("span",{class:"menu-text"},"Create Collection",-1)])]),s.showDeleteAll&&s.itemCount>0?(u(),m("button",{key:0,class:"floating-menu-item delete-all-item",onClick:e[5]||(e[5]=n=>i.$emit("deleteAllInCategory"))},[e[12]||(e[12]=o("span",{class:"menu-icon"},"🗑️",-1)),o("span",Ho,"Delete All "+v(s.categoryName),1),o("span",Qo,"("+v(s.itemCount)+")",1)])):k("",!0)],2),o("button",{class:"floating-add-btn",onClick:e[6]||(e[6]=n=>i.$emit("toggleMenu"))},v(s.showMenu?"✕":"+"),1)])}const Ko=ee(Yo,[["render",Jo],["__scopeId","data-v-f77e6366"]]),Zo={name:"LoginModal",emits:["close","success"],setup(i,{emit:e}){const s=Ve(),t=Te({email:"",password:""}),a=S(!1),r=S("");return{form:t,loading:a,error:r,handleLogin:async()=>{a.value=!0,r.value="";try{const D=await s.login(t.email,t.password);D.success?e("success",D):r.value=D.error}catch(D){r.value=D.message||"Login failed"}finally{a.value=!1}},closeModal:()=>{e("close")},checkLocalDB:async()=>{try{const A=await(await fetch("http://127.0.0.1:8000/api/check-db")).json();alert(`Local DB: ${A.success?"✅ Connected":"❌ Error"}
Users: ${A.user_count}
Error: ${A.error||"None"}`)}catch(D){alert(`Local DB Check Failed: ${D.message}`)}},checkProdDB:async()=>{try{const D=window.location.origin,w=await(await fetch(`${D}/api/check-db`)).json();alert(`Prod DB: ${w.success?"✅ Connected":"❌ Error"}
Users: ${w.user_count}
Error: ${w.error||"None"}`)}catch(D){alert(`Prod DB Check Failed: ${D.message}`)}},deleteAllUsers:async()=>{if(confirm("⚠️ WARNING: This will delete ALL users! Are you sure?"))try{const D=window.location.origin,w=await(await fetch(`${D}/api/delete-all-users`,{method:"POST",headers:{"Content-Type":"application/json"}})).json();alert(`Delete Result: ${w.success?"✅ Success":"❌ Error"}
Deleted: ${w.deleted_count} users
Error: ${w.error||"None"}`)}catch(D){alert(`Delete Failed: ${D.message}`)}}}}},Xo={class:"form-group"},$o=["disabled"],es={class:"form-group"},ts=["disabled"],os={key:0,class:"error-message"},ss={class:"modal-buttons"},as=["disabled"],is=["disabled"];function ns(i,e,s,t,a,r){return u(),m("div",{class:"modal",onClick:e[5]||(e[5]=(...n)=>t.closeModal&&t.closeModal(...n))},[o("div",{class:"modal-content auth-modal",onClick:e[4]||(e[4]=re(()=>{},["stop"]))},[e[8]||(e[8]=o("h2",null,"Login",-1)),o("form",{onSubmit:e[3]||(e[3]=re((...n)=>t.handleLogin&&t.handleLogin(...n),["prevent"]))},[o("div",Xo,[e[6]||(e[6]=o("label",{for:"email"},"Email:",-1)),T(o("input",{type:"email",id:"email","onUpdate:modelValue":e[0]||(e[0]=n=>t.form.email=n),required:"",disabled:t.loading},null,8,$o),[[L,t.form.email]])]),o("div",es,[e[7]||(e[7]=o("label",{for:"password"},"Password:",-1)),T(o("input",{type:"password",id:"password","onUpdate:modelValue":e[1]||(e[1]=n=>t.form.password=n),required:"",disabled:t.loading},null,8,ts),[[L,t.form.password]])]),t.error?(u(),m("div",os,v(t.error),1)):k("",!0),o("div",ss,[o("button",{type:"submit",disabled:t.loading},v(t.loading?"Logging in...":"Login"),9,as),o("button",{type:"button",onClick:e[2]||(e[2]=(...n)=>t.closeModal&&t.closeModal(...n)),disabled:t.loading}," Cancel ",8,is)])],32)])])}const ls=ee(Zo,[["render",ns],["__scopeId","data-v-64f3b00b"]]),rs={name:"RegisterModal",emits:["close","success"],setup(i,{emit:e}){const s=Ve(),t=Te({name:"",username:"",email:"",password:"",passwordConfirm:""}),a=S(!1),r=S(""),n=O(()=>t.name&&t.username&&t.email&&t.password&&t.passwordConfirm&&t.password===t.passwordConfirm&&t.password.length>=8);return{form:t,loading:a,error:r,isFormValid:n,handleRegister:async()=>{if(!n.value){r.value="Please fill in all fields and ensure passwords match";return}a.value=!0,r.value="";try{const d=await s.register(t.name,t.username,t.email,t.password,t.passwordConfirm);d.success?e("success"):r.value=d.error}catch(d){r.value=d.message||"Registration failed"}finally{a.value=!1}},closeModal:()=>{e("close")}}}},ds={class:"form-group"},cs=["disabled"],us={class:"form-group"},gs=["disabled"],ms={class:"form-group"},fs=["disabled"],ps={class:"form-group"},vs=["disabled"],hs={class:"form-group"},ys=["disabled"],bs={key:0,class:"error-message"},ks={class:"modal-buttons"},ws=["disabled"],Ss=["disabled"];function Is(i,e,s,t,a,r){return u(),m("div",{class:"modal",onClick:e[8]||(e[8]=(...n)=>t.closeModal&&t.closeModal(...n))},[o("div",{class:"modal-content auth-modal",onClick:e[7]||(e[7]=re(()=>{},["stop"]))},[e[14]||(e[14]=o("h2",null,"Register",-1)),o("form",{onSubmit:e[6]||(e[6]=re((...n)=>t.handleRegister&&t.handleRegister(...n),["prevent"]))},[o("div",ds,[e[9]||(e[9]=o("label",{for:"name"},"Name:",-1)),T(o("input",{type:"text",id:"name","onUpdate:modelValue":e[0]||(e[0]=n=>t.form.name=n),required:"",disabled:t.loading},null,8,cs),[[L,t.form.name]])]),o("div",us,[e[10]||(e[10]=o("label",{for:"username"},"Username:",-1)),T(o("input",{type:"text",id:"username","onUpdate:modelValue":e[1]||(e[1]=n=>t.form.username=n),required:"",disabled:t.loading},null,8,gs),[[L,t.form.username]])]),o("div",ms,[e[11]||(e[11]=o("label",{for:"email"},"Email:",-1)),T(o("input",{type:"email",id:"email","onUpdate:modelValue":e[2]||(e[2]=n=>t.form.email=n),required:"",disabled:t.loading},null,8,fs),[[L,t.form.email]])]),o("div",ps,[e[12]||(e[12]=o("label",{for:"password"},"Password:",-1)),T(o("input",{type:"password",id:"password","onUpdate:modelValue":e[3]||(e[3]=n=>t.form.password=n),required:"",minlength:"8",disabled:t.loading},null,8,vs),[[L,t.form.password]])]),o("div",hs,[e[13]||(e[13]=o("label",{for:"passwordConfirm"},"Confirm Password:",-1)),T(o("input",{type:"password",id:"passwordConfirm","onUpdate:modelValue":e[4]||(e[4]=n=>t.form.passwordConfirm=n),required:"",minlength:"8",disabled:t.loading},null,8,ys),[[L,t.form.passwordConfirm]])]),t.error?(u(),m("div",bs,v(t.error),1)):k("",!0),o("div",ks,[o("button",{type:"submit",disabled:t.loading||!t.isFormValid},v(t.loading?"Registering...":"Register"),9,ws),o("button",{type:"button",onClick:e[5]||(e[5]=(...n)=>t.closeModal&&t.closeModal(...n)),disabled:t.loading}," Cancel ",8,Ss)])],32)])])}const _s=ee(rs,[["render",Is],["__scopeId","data-v-eec5201a"]]),st="http://127.0.0.1:8000/api",Cs={async getConfig(){try{console.log("📚 Simple Google Books - Getting config...");const i=await fetch(`${st}/google-books-config`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);const e=await i.json();return console.log("📚 Simple Google Books - Config loaded:",e),e}catch(i){throw console.error("📚 Simple Google Books - Config failed:",i),i}},async searchBooks(i,e=10){try{console.log("📚 Simple Google Books - Searching:",i);const s=await fetch(`${st}/google-books/search?q=${encodeURIComponent(i)}&maxResults=${e}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);const t=await s.json();return console.log("📚 Simple Google Books - Search success:",t),t}catch(s){throw console.error("📚 Simple Google Books - Search failed:",s),s}}},Ds=!1,As=!0,xs="production",Ts={production:{apiUrl:"https://teabubble.attrebi.ch",apiBaseUrl:"https://teabubble.attrebi.ch/api",googleBooksUrl:"https://teabubble.attrebi.ch/api/google-books",debug:!1}};function Ms(){return Ts.production}const We=Ms();We.debug&&console.log("🔧 [Environment] Configuration loaded:",{mode:xs,isDevelopment:Ds,isProduction:As,apiUrl:We.apiUrl,apiBaseUrl:We.apiBaseUrl,googleBooksUrl:We.googleBooksUrl});class Us{constructor(){this.baseUrl="https://en.wikipedia.org/w/api.php",this.timeout=1e4,this.maxResults=10}async searchBooks(e,s=10){if(console.log("📚 [Wikipedia] Searching books:",{query:e,maxResults:s}),!e||typeof e!="string"||e.trim().length===0)return console.warn("📚 [Wikipedia] Invalid query provided"),{success:!1,error:"Search query is required",data:[]};try{const t=await this.searchPages(e,s);if(!t.success||t.data.length===0)return{success:!1,error:"No results found",data:[]};const a=await this.getPageDetails(t.data),r=this.filterAndFormatBookResults(a);return console.log("📚 [Wikipedia] Search completed:",{totalResults:a.length,bookResults:r.length}),{success:!0,data:r,source:"wikipedia"}}catch(t){return console.error("📚 [Wikipedia] Search failed:",t),{success:!1,error:`Search failed: ${t.message}`,data:[]}}}async searchPages(e,s){var a;const t=new URLSearchParams({action:"query",format:"json",list:"search",srsearch:`${e} book novel`,srnamespace:0,srlimit:s,srprop:"snippet|timestamp",origin:"*"});try{const r=await fetch(`${this.baseUrl}?${t}`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout)});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const n=await r.json();if(n.error)throw new Error(n.error.info||"Wikipedia API error");return{success:!0,data:(((a=n.query)==null?void 0:a.search)||[]).map(f=>({pageid:f.pageid,title:f.title,snippet:f.snippet,timestamp:f.timestamp}))}}catch(r){return console.error("📚 [Wikipedia] Page search failed:",r),{success:!1,error:r.message,data:[]}}}async getPageDetails(e){var a;if(!e||e.length===0)return[];const s=e.map(r=>r.pageid).join("|"),t=new URLSearchParams({action:"query",format:"json",pageids:s,prop:"extracts|pageimages|info",exintro:"true",explaintext:"true",exsectionformat:"plain",piprop:"thumbnail|original",pithumbsize:300,pilimit:1,inprop:"url",origin:"*"});try{const r=await fetch(`${this.baseUrl}?${t}`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout)});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const n=await r.json();if(n.error)throw new Error(n.error.info||"Wikipedia API error");const c=((a=n.query)==null?void 0:a.pages)||{};return Object.values(c).map(f=>{var d;return{pageid:f.pageid,title:f.title,extract:f.extract||"",thumbnail:((d=f.thumbnail)==null?void 0:d.source)||null,fullurl:f.fullurl||null,canonicalurl:f.canonicalurl||null}})}catch(r){return console.error("📚 [Wikipedia] Page details failed:",r),[]}}filterAndFormatBookResults(e){const s=["book","novel","fiction","non-fiction","author","published","publisher","isbn","literature","story","chapter","edition","written by","series","trilogy","saga","collection","anthology"];return e.filter(t=>{const a=(t.extract||"").toLowerCase(),r=(t.title||"").toLowerCase(),n=s.some(d=>a.includes(d)||r.includes(d)),f=["book","novel","story","tale","chronicles","saga","trilogy"].some(d=>r.includes(d));return n||f}).map(t=>{const a=t.extract||"",r=t.title||"",n=a.match(/written by[^,.\n]*?([A-Z][^,.\n]*?[A-Z][^,.\n]*?)(?:\s|\.|,|$)/i),c=a.match(/(\d{4})/),f=a.match(/(?:published by|publisher)\s+([^,.\n]+)/i);let d="";if(n&&(d=n[1].trim().replace(/^(British|American|German|French|Spanish|Italian)\s+(?:author|writer|novelist)?\s*/i,""),d.includes("author")||d.includes("writer"))){const D=d.match(/([A-Z][^,.\n]*?[A-Z][^,.\n]*?)(?:\s|\.|,|$)/);d=D?D[1].trim():d}if(!d){const x=a.match(/(?:by|author|written by)\s+([A-Z][^,.\n]*?[A-Z][^,.\n]*?)(?:\s|\.|,|$)/i);x&&(d=x[1].trim().replace(/^(British|American|German|French|Spanish|Italian)\s+(?:author|writer|novelist)?\s*/i,""))}return{id:`wikipedia_${t.pageid}`,title:r,author:d,description:a.substring(0,300)+(a.length>300?"...":""),publishedDate:c?c[1]:"",publisher:f?f[1].trim():"",imageUrl:t.thumbnail||null,link:t.fullurl||t.canonicalurl||"",apiSource:"wikipedia",snippet:a.substring(0,150)+(a.length>150?"...":""),categories:this.extractCategories(a)}}).slice(0,this.maxResults)}extractCategories(e){const s=[],t=e.toLowerCase();return t.includes("fiction")&&s.push("Fiction"),(t.includes("non-fiction")||t.includes("nonfiction"))&&s.push("Non-Fiction"),t.includes("novel")&&s.push("Novel"),t.includes("biography")&&s.push("Biography"),t.includes("history")&&s.push("History"),t.includes("science")&&s.push("Science"),t.includes("philosophy")&&s.push("Philosophy"),t.includes("poetry")&&s.push("Poetry"),t.includes("drama")&&s.push("Drama"),t.includes("mystery")&&s.push("Mystery"),t.includes("romance")&&s.push("Romance"),t.includes("fantasy")&&s.push("Fantasy"),(t.includes("science fiction")||t.includes("sci-fi"))&&s.push("Science Fiction"),t.includes("thriller")&&s.push("Thriller"),t.includes("horror")&&s.push("Horror"),s}async getBookById(e){var s,t;try{const a=new URLSearchParams({action:"query",format:"json",pageids:e,prop:"extracts|pageimages|info",exintro:"true",explaintext:"true",piprop:"thumbnail",pithumbsize:300,inprop:"url",origin:"*"}),r=await fetch(`${this.baseUrl}?${a}`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout)});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const n=await r.json(),c=Object.values(((s=n.query)==null?void 0:s.pages)||{})[0];if(!c)throw new Error("Page not found");return{success:!0,data:{id:`wikipedia_${c.pageid}`,title:c.title,description:c.extract||"",imageUrl:((t=c.thumbnail)==null?void 0:t.source)||null,link:c.fullurl||c.canonicalurl||"",apiSource:"wikipedia"}}}catch(a){return console.error("📚 [Wikipedia] Get book by ID failed:",a),{success:!1,error:a.message,data:null}}}}const Ps=new Us;class Bs{constructor(){this.wikipediaService=Ps,this.googleBooksService=Cs}getUserPreferences(){try{const e=localStorage.getItem("profileData");if(e){const s=JSON.parse(e);return{booksApiProvider:s.booksApiProvider||"wikipedia",enableGoogleBooksFallback:s.enableGoogleBooksFallback!==!1}}}catch(e){console.warn("Failed to load user preferences:",e)}return{booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}}async searchBooks(e,s=10){console.log("📚 [UnifiedBooks] Starting search:",{query:e,maxResults:s});const t=this.getUserPreferences();if(console.log("📚 [UnifiedBooks] User preferences:",t),!e||typeof e!="string"||e.trim().length===0)return{success:!1,error:"Search query is required",data:[]};try{let a=[],r="",n=!1;switch(t.booksApiProvider){case"wikipedia":a=await this.searchWithWikipediaFirst(e,s,t),r="wikipedia";break;case"google_books":a=await this.searchWithGoogleBooksFirst(e,s,t),r="google_books";break;case"both":a=await this.searchWithBothApis(e,s,t),r="both";break;default:a=await this.searchWithWikipediaFirst(e,s,t),r="wikipedia"}return console.log("📚 [UnifiedBooks] Search completed:",{totalResults:a.length,primarySource:r,fallbackUsed:n}),{success:!0,data:a,source:r,fallbackUsed:n}}catch(a){return console.error("📚 [UnifiedBooks] Search failed:",a),{success:!1,error:`Search failed: ${a.message}`,data:[]}}}async searchWithWikipediaFirst(e,s,t){console.log("📚 [UnifiedBooks] Searching Wikipedia first...");const a=await this.wikipediaService.searchBooks(e,s);if(a.success&&a.data.length>0)return console.log("📚 [UnifiedBooks] Wikipedia search successful:",a.data.length,"results"),a.data;if(t.enableGoogleBooksFallback){console.log("📚 [UnifiedBooks] Wikipedia failed, trying Google Books fallback...");const r=await this.googleBooksService.searchBooks(e,s);if(r.success&&r.data.length>0)return console.log("📚 [UnifiedBooks] Google Books fallback successful:",r.data.length,"results"),r.data}return console.log("📚 [UnifiedBooks] All searches failed"),[]}async searchWithGoogleBooksFirst(e,s,t){console.log("📚 [UnifiedBooks] Searching Google Books first...");const a=await this.googleBooksService.searchBooks(e,s);if(a.success&&a.data.length>0)return console.log("📚 [UnifiedBooks] Google Books search successful:",a.data.length,"results"),a.data;if(t.enableGoogleBooksFallback){console.log("📚 [UnifiedBooks] Google Books failed, trying Wikipedia fallback...");const r=await this.wikipediaService.searchBooks(e,s);if(r.success&&r.data.length>0)return console.log("📚 [UnifiedBooks] Wikipedia fallback successful:",r.data.length,"results"),r.data}return console.log("📚 [UnifiedBooks] All searches failed"),[]}async searchWithBothApis(e,s,t){console.log("📚 [UnifiedBooks] Searching both APIs...");const[a,r]=await Promise.allSettled([this.wikipediaService.searchBooks(e,Math.ceil(s/2)),this.googleBooksService.searchBooks(e,Math.ceil(s/2))]);let n=[];return a.status==="fulfilled"&&a.value.success&&(n=n.concat(a.value.data),console.log("📚 [UnifiedBooks] Wikipedia results:",a.value.data.length)),r.status==="fulfilled"&&r.value.success&&(n=n.concat(r.value.data),console.log("📚 [UnifiedBooks] Google Books results:",r.value.data.length)),n=this.removeDuplicateResults(n),n=n.slice(0,s),console.log("📚 [UnifiedBooks] Combined results:",n.length),n}removeDuplicateResults(e){const s=new Set,t=[];for(const a of e){const r=a.title.toLowerCase().replace(/[^\w\s]/g,"").trim();s.has(r)||(s.add(r),t.push(a))}return t}async getBookById(e){if(e.startsWith("wikipedia_")){const s=e.replace("wikipedia_","");return await this.wikipediaService.getBookById(s)}else return await this.googleBooksService.getBookById(e)}getApiStatus(){const e=this.getUserPreferences();return{primaryProvider:e.booksApiProvider,fallbackEnabled:e.enableGoogleBooksFallback,availableProviders:["wikipedia","google_books"],wikipediaAvailable:!0,googleBooksAvailable:!0}}}const Ke=new Bs,Rs={name:"BooksApiControlPanel",props:{expanded:{type:Boolean,default:!1}},emits:["preferences-changed"],setup(i,{emit:e}){const s=S(i.expanded),t=S(!1),a=S(null),r=S("checking"),n=Te({booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}),c=()=>{s.value=!s.value},f=()=>{try{const A=localStorage.getItem("profileData");if(A){const w=JSON.parse(A);n.booksApiProvider=w.booksApiProvider||"wikipedia",n.enableGoogleBooksFallback=w.enableGoogleBooksFallback!==!1}}catch(A){console.warn("Failed to load preferences:",A)}},d=()=>{try{const A=localStorage.getItem("profileData"),w=A?JSON.parse(A):{};w.booksApiProvider=n.booksApiProvider,w.enableGoogleBooksFallback=n.enableGoogleBooksFallback,localStorage.setItem("profileData",JSON.stringify(w)),e("preferences-changed",{...n}),console.log("📚 [ControlPanel] Preferences updated:",n)}catch(A){console.error("Failed to save preferences:",A)}},x=async()=>{t.value=!0,a.value=null;try{const A=await Ke.searchBooks("Harry Potter",3);A.success&&A.data.length>0?a.value={success:!0,message:`✅ Found ${A.data.length} results using ${A.source}`}:a.value={success:!1,message:`❌ No results found: ${A.error||"Unknown error"}`}}catch(A){a.value={success:!1,message:`❌ Test failed: ${A.message}`}}finally{t.value=!1}},D=async()=>{try{const A=await Ke.getApiStatus();r.value=A.googleBooksAvailable?"available":"unavailable"}catch{r.value="unavailable"}};return at(()=>{f(),D()}),{isExpanded:s,localPreferences:n,testing:t,testResult:a,googleBooksStatus:r,toggleExpanded:c,updatePreferences:d,testSearch:x}}},Es={class:"books-api-control-panel"},Fs={class:"control-header"},Ls={key:0,class:"control-content"},Ns={class:"form-group"},Gs={class:"form-group"},Ws={class:"checkbox-container"},Os={class:"api-status"},Vs={class:"status-item"},zs={class:"search-preview"},js=["disabled"];function Ys(i,e,s,t,a,r){return u(),m("div",Es,[o("div",Fs,[e[6]||(e[6]=o("h4",null,"📚 Books API Settings",-1)),o("button",{class:Q(["toggle-btn",{expanded:t.isExpanded}]),onClick:e[0]||(e[0]=(...n)=>t.toggleExpanded&&t.toggleExpanded(...n))},v(t.isExpanded?"▼":"▶"),3)]),t.isExpanded?(u(),m("div",Ls,[o("div",Ns,[e[8]||(e[8]=o("label",{for:"apiProvider"},"Primary API Provider:",-1)),T(o("select",{id:"apiProvider","onUpdate:modelValue":e[1]||(e[1]=n=>t.localPreferences.booksApiProvider=n),onChange:e[2]||(e[2]=(...n)=>t.updatePreferences&&t.updatePreferences(...n))},[...e[7]||(e[7]=[o("option",{value:"wikipedia"},"Wikipedia (Recommended)",-1),o("option",{value:"google_books"},"Google Books",-1),o("option",{value:"both"},"Both APIs",-1)])],544),[[ye,t.localPreferences.booksApiProvider]]),e[9]||(e[9]=o("div",{class:"field-hint"}," Choose your primary source for book information ",-1))]),o("div",Gs,[o("div",Ws,[T(o("input",{type:"checkbox",id:"enableFallback","onUpdate:modelValue":e[3]||(e[3]=n=>t.localPreferences.enableGoogleBooksFallback=n),onChange:e[4]||(e[4]=(...n)=>t.updatePreferences&&t.updatePreferences(...n))},null,544),[[it,t.localPreferences.enableGoogleBooksFallback]]),e[10]||(e[10]=o("label",{for:"enableFallback",class:"checkbox-label"}," Enable Google Books Fallback ",-1))]),e[11]||(e[11]=o("div",{class:"field-hint"}," Use Google Books when primary API fails ",-1))]),o("div",Os,[e[13]||(e[13]=o("div",{class:"status-item"},[o("span",{class:"status-label"},"Wikipedia:"),o("span",{class:"status-value available"},"✅ Available")],-1)),o("div",Vs,[e[12]||(e[12]=o("span",{class:"status-label"},"Google Books:",-1)),o("span",{class:Q(["status-value",t.googleBooksStatus])},v(t.googleBooksStatus==="available"?"✅ Available":"⚠️ Check API Key"),3)])]),o("div",zs,[o("button",{class:"test-search-btn",onClick:e[5]||(e[5]=(...n)=>t.testSearch&&t.testSearch(...n)),disabled:t.testing},v(t.testing?"Testing...":"Test Search"),9,js),t.testResult?(u(),m("div",{key:0,class:Q(["test-result",t.testResult.success?"success":"error"])},v(t.testResult.message),3)):k("",!0)])])):k("",!0)])}const qs=ee(Rs,[["render",Ys],["__scopeId","data-v-e0308fa0"]]),Hs={name:"EditModal",components:{BooksApiControlPanel:qs},props:{item:{type:Object,default:null},currentCategory:{type:String,default:"watchlist"}},emits:["close","save","delete"],setup(i,{emit:e}){const s=ze(),t=S(!1),a=S(""),r=S([]),n=S(null),c=S(null),f=S(""),d=Te({category:"watchlist",title:"",release:"",apiRating:"",personalRating:"",count:"",platforms:"",genre:"",description:"",link:"",extraLink:"",path:"",discovered:"",spielzeit:"",isAiring:!1,nextSeason:"",nextSeasonRelease:"",imageUrl:"",watchlistType:"",imageCleared:!1}),x=O(()=>!!i.item),D=O(()=>d.category==="game"),A=O(()=>d.category==="series"),w=O(()=>d.category==="watchlist");Ce(()=>i.item,l=>{l?(console.log("EditModal - Loading item data:",l),console.log("EditModal - Item rating:",l.rating),console.log("EditModal - Item personal_rating:",l.personal_rating),l.watchlist_type!==void 0&&l.watchlist_type!==null&&(d.watchlistType=l.watchlist_type,console.log("EditModal - Set watchlistType from watchlist_type:",l.watchlist_type)),l.watchlistType!==void 0&&l.watchlistType!==null&&(d.watchlistType=l.watchlistType,console.log("EditModal - Set watchlistType from watchlistType:",l.watchlistType)),Object.keys(d).forEach(h=>{h!=="watchlistType"&&(d[h]=l[h]||"")}),l.is_airing!==void 0&&(d.isAiring=l.is_airing),l.next_season!==void 0&&(d.nextSeason=l.next_season),l.next_season_release!==void 0&&(d.nextSeasonRelease=l.next_season_release),l.api_rating!==void 0&&(d.apiRating=l.api_rating),l.personal_rating!==void 0&&(d.personalRating=l.personal_rating),l.description!==void 0&&(d.description=l.description),l.image_url!==void 0&&(d.imageUrl=l.image_url),l.path!==void 0&&(d.path=l.path),l.extra_link!==void 0&&(d.extraLink=l.extra_link,console.log("EditModal - Set extraLink from extra_link:",l.extra_link)),l.rating!==void 0&&!d.personalRating&&(d.personalRating=l.rating),console.log("EditModal - Form after initialization:"),console.log("EditModal - form.personalRating:",d.personalRating),console.log("EditModal - form.rating:",d.rating),console.log("EditModal - form.watchlistType:",d.watchlistType),console.log("EditModal - form.extraLink:",d.extraLink),console.log("EditModal - newItem.watchlist_type:",l.watchlist_type),console.log("EditModal - newItem.watchlistType:",l.watchlistType),console.log("EditModal - newItem.extra_link:",l.extra_link)):Object.keys(d).forEach(h=>{h==="category"?d[h]=i.currentCategory||"watchlist":h==="release"?d[h]=new Date().toISOString().split("T")[0]:d[h]=""})},{immediate:!0}),Ce(()=>i.currentCategory,l=>{!i.item&&l&&(d.category=l)});const V=async()=>{var l,h,I;if(!d.title){a.value="Title is required";return}if(d.category==="watchlist"&&!d.watchlistType){a.value="Please select a type for watchlist items";return}if(d.category==="watchlist"&&!d.release){a.value="Release date is required for watchlist items";return}t.value=!0,a.value="";try{const g={...d};Object.keys(g).forEach(M=>{g[M]===""&&M!=="watchlistType"&&M!=="imageUrl"&&M!=="path"&&M!=="extraLink"&&(g[M]=null)}),f.value?(g.path=f.value,g.imageUrl=f.value):g.imageUrl&&g.imageUrl.trim()?g.path=g.imageUrl:x.value&&i.item?i.item.image_url?(g.imageUrl=i.item.image_url,g.path=i.item.path||i.item.image_url):i.item.path&&(g.path=i.item.path,g.imageUrl=i.item.path):(g.imageUrl=null,g.path=null),g.apiRating!==void 0&&g.apiRating!==null&&g.apiRating!==""&&(g.apiRating=parseFloat(g.apiRating)),g.personalRating!==void 0&&g.personalRating!==null&&g.personalRating!==""&&(g.personalRating=parseFloat(g.personalRating)),g.count!==void 0&&g.count!==null&&g.count!==""&&(g.count=parseInt(g.count)),g.spielzeit!==void 0&&g.spielzeit!==null&&g.spielzeit!==""&&(g.spielzeit=parseInt(g.spielzeit)),g.nextSeason!==void 0&&g.nextSeason!==null&&g.nextSeason!==""&&(g.nextSeason=parseInt(g.nextSeason)),g.watchlistType&&(g.watchlist_type=g.watchlistType,delete g.watchlistType),g.isAiring!==void 0&&(g.is_airing=g.isAiring,delete g.isAiring),g.nextSeason&&(g.next_season=g.nextSeason,delete g.nextSeason),g.nextSeasonRelease&&(g.next_season_release=g.nextSeasonRelease,delete g.nextSeasonRelease),g.personalRating!==void 0?(g.rating=g.personalRating,delete g.personalRating):g.apiRating!==void 0&&(g.rating=g.apiRating,delete g.apiRating),g.imageUrl&&(g.image_url=g.imageUrl,delete g.imageUrl),g.extraLink!==void 0&&(g.extra_link=g.extraLink,delete g.extraLink),console.log("EditModal - Saving item data:",g),console.log("EditModal - personalRating value:",g.personalRating),console.log("EditModal - rating value:",g.rating),console.log("EditModal - extraLink value:",g.extraLink),console.log("EditModal - extra_link value:",g.extra_link),x.value&&i.item?await s.updateMediaItem(i.item.id,g):await s.addMediaItem(g),Z()}catch(g){g.isDuplicate||((l=g.response)==null?void 0:l.status)===409&&((I=(h=g.response)==null?void 0:h.data)!=null&&I.duplicate)?a.value="Ein Eintrag mit diesem Titel und dieser Kategorie existiert bereits. Bitte wählen Sie einen anderen Titel oder bearbeiten Sie den bestehenden Eintrag.":a.value=g.message||"Failed to save item"}finally{t.value=!1}},Z=()=>{a.value="",e("close")},Y=()=>{e("delete",i.item),Z()},ne=async()=>{if(f.value){r.value=[];return}if(n.value&&clearTimeout(n.value),!d.title||d.title.length<3){r.value=[];return}n.value=setTimeout(async()=>{try{console.log("🔍 EditModal API Search:",{title:d.title,category:d.category,watchlistType:d.watchlistType});const l=d.category==="watchlist"?d.watchlistType:d.category;if(d.category==="watchlist"&&!d.watchlistType){r.value=[];return}let h=[],I=[];if(l==="buecher"){console.log("📚 Searching Unified Books API for:",d.title);const g=await Ke.searchBooks(d.title,10);g.success&&g.data?(console.log("📚 Unified Books API Success:",g.data.length,"results from",g.source),I=g.data.map(M=>({title:M.title,release:M.publishedDate?p(M.publishedDate):"",genre:M.categories?M.categories.join(", "):"",platforms:M.author||"",link:M.link||"",imageUrl:M.imageUrl||"",rating:"",apiSource:M.apiSource||g.source,id:M.id,author:M.author,description:M.description,publisher:M.publisher,isbn10:M.isbn10,isbn13:M.isbn13})),console.log("📚 Formatted Unified Books results:",I)):console.warn("📚 Unified Books API failed:",g.error)}else console.log("🎬 Searching Media API for:",d.title,"category:",l),h=await me.searchApi(d.title,l,10),h&&h.length>0&&(I=h.map(g=>({title:g.title,release:g.release,genre:g.genre||"",description:g.overview||"",platforms:g.platforms||"",link:g.link||"",imageUrl:g.image||"",rating:g.rating||"",apiSource:g.api_source||"",id:g.id||""})));I.length>0?(console.log("✅ API Search Results:",I.length,"items found"),r.value=I):(console.log("❌ No API results found"),r.value=[{title:`"${d.title}" - Keine Ergebnisse gefunden`,release:"",genre:"Bitte manuell ausfüllen",isPlaceholder:!0}])}catch(l){console.error("❌ API search failed:",l),r.value=[{title:`"${d.title}" - API nicht verfügbar`,release:"",genre:"Bitte manuell ausfüllen",isPlaceholder:!0}]}},500)},ge=async l=>{if(l.isPlaceholder){r.value=[];return}if(console.log("📚 Selecting API result:",{title:l.title,apiSource:l.apiSource,author:l.author}),d.title=l.title,l.release&&(d.release=l.release),l.platforms&&(d.platforms=l.platforms),l.genre&&(d.genre=l.genre),l.description&&(d.description=l.description),l.link&&(d.link=l.link),l.rating&&(d.apiRating=l.rating),(l.apiSource==="google_books"||l.apiSource==="wikipedia")&&(console.log("📚 Filling Books API data:",{apiSource:l.apiSource,author:l.author,description:l.description,publisher:l.publisher,isbn10:l.isbn10,isbn13:l.isbn13}),l.author&&(d.platforms=l.author),l.publisher)){const h=d.link||"";d.link=h||`Publisher: ${l.publisher}`}l.imageUrl?(d.imageUrl=l.imageUrl,d.path=l.imageUrl):(d.imageUrl="",d.path=""),r.value=[]},de=l=>l?new Date(l).toLocaleDateString():"",p=l=>{if(!l)return"";let h;if(typeof l=="string"){if(/^\d{4}$/.test(l))return`${l}-01-01`;if(/^\d{4}-\d{2}$/.test(l))return`${l}-01`;if(/^\d{4}-\d{2}-\d{2}$/.test(l))return l;h=new Date(l)}else h=new Date(l);return isNaN(h.getTime())?(console.warn("📚 Invalid date format:",l),""):h.toISOString().split("T")[0]};return{form:d,loading:t,error:a,apiResults:r,isEditing:x,isGame:D,isSeries:A,isWatchlist:w,imageUploadRef:c,uploadedImagePath:f,handleSave:V,closeModal:Z,deleteItem:Y,searchApi:ne,selectApiResult:ge,formatDate:de,formatDateForInput:p,ensureHttpsUrl:l=>l&&(l.startsWith("http://")?l.replace("http://","https://"):l),getReleasePreview:()=>{var M;if(!d.release)return"";const l=new Date(d.release),h=new Date;h.setHours(0,0,0,0),l.setHours(0,0,0,0);const I=l.getTime()-h.getTime(),g=Math.ceil(I/(1e3*3600*24));if(g>0)return g===1?"Tomorrow!":g<=7?`${g} days left`:g<=30?`${g} days left`:`${Math.ceil(g/30)} months left`;if(g===0)return"Released today!";{const q=((M=d.watchlistType)==null?void 0:M.toLowerCase())||"media";return q==="game"?"Unplayed yet":q==="series"||q==="movie"?"Unwatched yet":"Unconsumed yet"}},triggerImageUpload:()=>{var l;(l=c.value)==null||l.click()},handleImageUpload:async l=>{const h=l.target.files[0];if(h){if(!h.type.startsWith("image/")){a.value="Please select a valid image file";return}if(h.size>10*1024*1024){a.value="Image file too large. Maximum size is 10MB";return}t.value=!0,a.value="";try{const I=d.title.replace(/[^a-zA-Z0-9\s\-_\.]/g,"").trim()||"item",g=Date.now(),M=h.name.split(".").pop()||"jpg",q=`images_downloads/uploads/${I}_${g}.${M}`,te=await me.uploadImage(h,q);te.success?(f.value=te.saved,d.path=te.saved,d.imageUrl=te.saved):a.value=te.error||"Failed to upload image"}catch(I){a.value=I.message||"Failed to upload image"}finally{t.value=!1}}},getImagePreviewUrl:()=>f.value?f.value.startsWith("storage/")?`/${f.value}`:`/storage/${f.value}`:d.imageUrl?d.imageUrl.startsWith("http")?d.imageUrl:d.imageUrl.startsWith("storage/")?`/${d.imageUrl}`:`/storage/${d.imageUrl}`:"",handleImageError:l=>{console.warn("Image preview failed:",l.target.src),l.target.style.display="none"},clearImage:()=>{d.imageUrl="",d.path="",f.value="",c.value&&(c.value.value="")},removeUploadedImage:()=>{f.value="",d.imageUrl===f.value&&(d.imageUrl=""),d.path===f.value&&(d.path=""),c.value&&(c.value.value="")},handlePreferencesChanged:l=>{console.log("📚 [EditModal] Preferences changed:",l),r.value=[]}}}},Qs={class:"form-header"},Js={class:"form-group category-group"},Ks={class:"form-group title-group"},Zs={class:"search-container"},Xs=["placeholder","disabled"],$s={key:0,class:"search-results"},ea=["onClick"],ta={class:"result-thumbnail"},oa=["src","alt"],sa={key:1,class:"no-image"},aa={class:"result-content"},ia={class:"result-title"},na={class:"result-meta"},la={key:0},ra={key:1},da={key:2,class:"rating"},ca={class:"form-row"},ua={class:"form-group"},ga={for:"release"},ma={key:0,class:"required"},fa=["required"],pa={key:0,class:"field-hint"},va={key:1,class:"release-preview"},ha={class:"form-group"},ya={class:"form-group"},ba={class:"form-row"},ka={class:"form-group"},wa={class:"form-group"},Sa={class:"form-row"},Ia={class:"form-group"},_a={class:"form-group"},Ca={class:"form-row"},Da={class:"form-group full-width"},Aa={key:0,class:"form-row"},xa={class:"form-group"},Ta={key:0,class:"debug-info",style:{"font-size":"10px",color:"#666","margin-top":"4px"}},Ma={key:1,class:"field-error"},Ua={class:"form-row"},Pa={class:"form-group"},Ba={class:"form-group"},Ra={key:2,class:"form-row"},Ea={class:"form-group"},Fa={key:3,class:"form-row"},La={class:"form-group"},Na={key:0,class:"form-group"},Ga={key:4,class:"form-row"},Wa={class:"form-group full-width"},Oa={key:5,class:"form-row"},Va={class:"form-group"},za={class:"form-row"},ja={class:"form-group"},Ya={class:"form-group"},qa={class:"image-upload-container"},Ha=["disabled"],Qa={key:0,class:"upload-success"},Ja={key:6,class:"form-row"},Ka={class:"form-group image-preview-group"},Za={class:"image-preview"},Xa=["src","alt"],$a={key:7,class:"error-message"},ei={class:"modal-buttons"},ti=["disabled"],oi=["disabled"],si=["disabled"],ai=["disabled"];function ii(i,e,s,t,a,r){const n=ae("BooksApiControlPanel");return u(),m("div",{class:"modal",onClick:e[30]||(e[30]=(...c)=>t.closeModal&&t.closeModal(...c))},[o("div",{class:"modal-content",onClick:e[29]||(e[29]=re(()=>{},["stop"]))},[o("h2",null,v(t.isEditing?"Edit Item":"Add Item"),1),o("form",{onSubmit:e[28]||(e[28]=re((...c)=>t.handleSave&&t.handleSave(...c),["prevent"]))},[o("div",Qs,[o("div",Js,[e[32]||(e[32]=o("label",{for:"category"},"Category:",-1)),T(o("select",{id:"category","onUpdate:modelValue":e[0]||(e[0]=c=>t.form.category=c),required:""},[...e[31]||(e[31]=[Oe('<option value="watchlist" data-v-91326b66>Watchlist</option><option value="game" data-v-91326b66>Game</option><option value="series" data-v-91326b66>Series</option><option value="movie" data-v-91326b66>Movie</option><option value="buecher" data-v-91326b66>Bücher</option>',5)])],512),[[ye,t.form.category]])]),o("div",Ks,[e[33]||(e[33]=o("label",{for:"title"},"Title:",-1)),o("div",Zs,[T(o("input",{type:"text",id:"title","onUpdate:modelValue":e[1]||(e[1]=c=>t.form.title=c),onInput:e[2]||(e[2]=(...c)=>t.searchApi&&t.searchApi(...c)),required:"",placeholder:t.isWatchlist?"Enter title (API search + manual input available)":"Enter title",disabled:t.loading},null,40,Xs),[[L,t.form.title]]),t.apiResults.length>0?(u(),m("div",$s,[(u(!0),m(oe,null,se(t.apiResults,c=>(u(),m("div",{key:c.title,class:"search-result-item",onClick:f=>t.selectApiResult(c)},[o("div",ta,[c.imageUrl?(u(),m("img",{key:0,src:t.ensureHttpsUrl(c.imageUrl),alt:c.title},null,8,oa)):(u(),m("div",sa,[o("span",null,v(c.title.charAt(0).toUpperCase()),1)]))]),o("div",aa,[o("div",ia,v(c.title),1),o("div",na,[c.release?(u(),m("span",la,v(t.formatDate(c.release)),1)):k("",!0),c.genre?(u(),m("span",ra,v(c.genre),1)):k("",!0),c.rating?(u(),m("span",da,"⭐ "+v(c.rating),1)):k("",!0)])])],8,ea))),128))])):k("",!0)])])]),o("div",ca,[o("div",ua,[o("label",ga,[Ae(v(t.isWatchlist?"Release Date:":"Release:")+" ",1),t.isWatchlist?(u(),m("span",ma,"*")):k("",!0)]),T(o("input",{type:"date",id:"release","onUpdate:modelValue":e[3]||(e[3]=c=>t.form.release=c),required:t.isWatchlist},null,8,fa),[[L,t.form.release]]),t.isWatchlist?(u(),m("div",pa," 📅 Set the release date to track countdown or status ")):k("",!0),t.isWatchlist&&t.form.release?(u(),m("div",va,[e[34]||(e[34]=o("strong",null,"Preview:",-1)),Ae(" "+v(t.getReleasePreview()),1)])):k("",!0)]),o("div",ha,[e[35]||(e[35]=o("label",{for:"apiRating"},"API Rating:",-1)),T(o("input",{type:"number",id:"apiRating","onUpdate:modelValue":e[4]||(e[4]=c=>t.form.apiRating=c),step:"0.1",min:"0",max:"10",placeholder:"0-10",readonly:""},null,512),[[L,t.form.apiRating]]),e[36]||(e[36]=o("div",{class:"field-hint"},"From API - read only",-1))]),o("div",ya,[e[37]||(e[37]=o("label",{for:"personalRating"},"Personal Rating:",-1)),T(o("input",{type:"number",id:"personalRating","onUpdate:modelValue":e[5]||(e[5]=c=>t.form.personalRating=c),step:"0.1",min:"0",max:"10",placeholder:"0-10"},null,512),[[L,t.form.personalRating]]),e[38]||(e[38]=o("div",{class:"field-hint"},"Your personal rating",-1))])]),o("div",ba,[o("div",ka,[e[39]||(e[39]=o("label",{for:"views"},"Views:",-1)),T(o("input",{type:"number",id:"views","onUpdate:modelValue":e[6]||(e[6]=c=>t.form.count=c),min:"0",placeholder:"0"},null,512),[[L,t.form.count]])]),o("div",wa,[e[40]||(e[40]=o("label",{for:"discovered"},"Discovered:",-1)),T(o("input",{type:"date",id:"discovered","onUpdate:modelValue":e[7]||(e[7]=c=>t.form.discovered=c)},null,512),[[L,t.form.discovered]])])]),o("div",Sa,[o("div",Ia,[e[41]||(e[41]=o("label",{for:"platforms"},"Platforms:",-1)),T(o("input",{type:"text",id:"platforms","onUpdate:modelValue":e[8]||(e[8]=c=>t.form.platforms=c),placeholder:"PC, PS5, Xbox"},null,512),[[L,t.form.platforms]])]),o("div",_a,[e[42]||(e[42]=o("label",{for:"genre"},"Genre:",-1)),T(o("input",{type:"text",id:"genre","onUpdate:modelValue":e[9]||(e[9]=c=>t.form.genre=c),placeholder:"Action, Adventure, RPG"},null,512),[[L,t.form.genre]])])]),o("div",Ca,[o("div",Da,[e[43]||(e[43]=o("label",{for:"description"},"Description:",-1)),T(o("textarea",{id:"description","onUpdate:modelValue":e[10]||(e[10]=c=>t.form.description=c),placeholder:"Enter description...",rows:"3"},null,512),[[L,t.form.description]])])]),t.form.category==="watchlist"?(u(),m("div",Aa,[o("div",xa,[e[45]||(e[45]=o("label",{for:"watchlistType"},[Ae("Type: "),o("span",{class:"required"},"*")],-1)),T(o("select",{id:"watchlistType","onUpdate:modelValue":e[11]||(e[11]=c=>t.form.watchlistType=c)},[...e[44]||(e[44]=[Oe('<option value="" data-v-91326b66>Select Type</option><option value="game" data-v-91326b66>Game</option><option value="series" data-v-91326b66>Series</option><option value="movie" data-v-91326b66>Movie</option><option value="buecher" data-v-91326b66>Bücher</option>',5)])],512),[[ye,t.form.watchlistType]]),t.form.category==="watchlist"?(u(),m("div",Ta,' Debug: watchlistType = "'+v(t.form.watchlistType)+'" ',1)):k("",!0),t.form.category==="watchlist"&&!t.form.watchlistType?(u(),m("div",Ma," Please select a type for watchlist items ")):k("",!0)])])):k("",!0),t.form.category==="buecher"||t.form.watchlistType==="buecher"?(u(),De(n,{key:1,expanded:!1,onPreferencesChanged:t.handlePreferencesChanged},null,8,["onPreferencesChanged"])):k("",!0),o("div",Ua,[o("div",Pa,[e[46]||(e[46]=o("label",{for:"link"},"Link:",-1)),T(o("input",{type:"url",id:"link","onUpdate:modelValue":e[12]||(e[12]=c=>t.form.link=c),placeholder:"https://..."},null,512),[[L,t.form.link]])]),o("div",Ba,[e[47]||(e[47]=o("label",{for:"path"},"Image Path:",-1)),T(o("input",{type:"text",id:"path","onUpdate:modelValue":e[13]||(e[13]=c=>t.form.path=c),placeholder:"images/movies/filename.jpg"},null,512),[[L,t.form.path]])])]),t.isGame?(u(),m("div",Ra,[o("div",Ea,[e[48]||(e[48]=o("label",{for:"playtime"},"Playtime (Minutes):",-1)),T(o("input",{type:"number",id:"playtime","onUpdate:modelValue":e[14]||(e[14]=c=>t.form.spielzeit=c),min:"0",placeholder:"0"},null,512),[[L,t.form.spielzeit]])])])):k("",!0),t.isSeries?(u(),m("div",Fa,[o("div",La,[e[50]||(e[50]=o("label",{for:"isAiring"},"Status:",-1)),T(o("select",{id:"isAiring","onUpdate:modelValue":e[15]||(e[15]=c=>t.form.isAiring=c)},[...e[49]||(e[49]=[o("option",{value:!1},"Finished",-1),o("option",{value:!0},"Airing",-1)])],512),[[ye,t.form.isAiring]])]),t.form.isAiring?(u(),m("div",Na,[e[51]||(e[51]=o("label",{for:"nextSeason"},"Next Season:",-1)),T(o("input",{type:"number",id:"nextSeason","onUpdate:modelValue":e[16]||(e[16]=c=>t.form.nextSeason=c),min:"1",placeholder:"1"},null,512),[[L,t.form.nextSeason]])])):k("",!0)])):k("",!0),t.isSeries?(u(),m("div",Ga,[o("div",Wa,[e[52]||(e[52]=o("label",{for:"extraLink"},"Extra Link:",-1)),T(o("input",{type:"url",id:"extraLink","onUpdate:modelValue":e[17]||(e[17]=c=>t.form.extraLink=c),placeholder:"https://... (e.g., streaming platform, official website)"},null,512),[[L,t.form.extraLink]]),e[53]||(e[53]=o("div",{class:"field-hint"},"Optional: Additional link for series (e.g., streaming platform, official website)",-1))])])):k("",!0),t.form.isAiring?(u(),m("div",Oa,[o("div",Va,[e[54]||(e[54]=o("label",{for:"nextSeasonRelease"},"Next Season Release:",-1)),T(o("input",{type:"date",id:"nextSeasonRelease","onUpdate:modelValue":e[18]||(e[18]=c=>t.form.nextSeasonRelease=c)},null,512),[[L,t.form.nextSeasonRelease]])])])):k("",!0),o("div",za,[o("div",ja,[e[55]||(e[55]=o("label",{for:"imageUrl"},"Image URL (optional):",-1)),T(o("input",{type:"text",id:"imageUrl","onUpdate:modelValue":e[19]||(e[19]=c=>t.form.imageUrl=c),placeholder:"https://... or leave empty for API images"},null,512),[[L,t.form.imageUrl]])]),o("div",Ya,[e[56]||(e[56]=o("label",{for:"imageUpload"},"Upload Image:",-1)),o("div",qa,[o("input",{type:"file",id:"imageUpload",ref:"imageUploadRef",onChange:e[20]||(e[20]=(...c)=>t.handleImageUpload&&t.handleImageUpload(...c)),accept:"image/*",style:{display:"none"}},null,544),o("button",{type:"button",onClick:e[21]||(e[21]=(...c)=>t.triggerImageUpload&&t.triggerImageUpload(...c)),class:"upload-btn",disabled:t.loading}," 📁 Choose Image ",8,Ha),t.uploadedImagePath?(u(),m("div",Qa,[Ae(" ✅ Image uploaded: "+v(t.uploadedImagePath)+" ",1),o("button",{type:"button",onClick:e[22]||(e[22]=(...c)=>t.removeUploadedImage&&t.removeUploadedImage(...c)),class:"remove-uploaded-btn",title:"Remove uploaded image to enable API search"}," ✕ Remove ")])):k("",!0)])])]),t.form.imageUrl||t.uploadedImagePath?(u(),m("div",Ja,[o("div",Ka,[e[57]||(e[57]=o("label",null,"Image Preview:",-1)),o("div",Za,[o("img",{src:t.getImagePreviewUrl(),alt:t.form.title,onError:e[23]||(e[23]=(...c)=>t.handleImageError&&t.handleImageError(...c))},null,40,Xa),o("button",{type:"button",onClick:e[24]||(e[24]=(...c)=>t.clearImage&&t.clearImage(...c)),class:"clear-image-btn",title:"Remove image"}," ✕ ")])])])):k("",!0),t.error?(u(),m("div",$a,v(t.error),1)):k("",!0),o("div",ei,[o("button",{type:"submit",disabled:t.loading},v(t.loading?"Saving...":"Save"),9,ti),o("button",{type:"button",onClick:e[25]||(e[25]=(...c)=>t.closeModal&&t.closeModal(...c)),disabled:t.loading}," Cancel ",8,oi),t.isEditing?(u(),m("button",{key:0,type:"button",onClick:e[26]||(e[26]=(...c)=>t.deleteItem&&t.deleteItem(...c)),disabled:t.loading,class:"delete-btn"}," Delete ",8,si)):k("",!0),o("button",{type:"button",onClick:e[27]||(e[27]=(...c)=>t.handleSave&&t.handleSave(...c)),disabled:t.loading,class:"check-btn",title:"Add to list"}," ✓ ",8,ai)])],32)])])}const ni=ee(Hs,[["render",ii],["__scopeId","data-v-91326b66"]]),li={name:"BulkAddModal",props:{show:{type:Boolean,default:!1},currentCategory:{type:String,default:""}},emits:["close"],setup(i,{emit:e}){const s=ze(),t=S(1),a=S(!1),r=S(!0),n=S(!1),c=S(0),f=S(0),d=S(0),x=S(0),D=S(null),A=S(""),w=S(""),V=S([]),Z=S([]),Y=S({category:"",itemsText:"",defaultRating:null}),ne=O(()=>Y.value.category&&Y.value.itemsText.trim()&&!a.value),ge=O(()=>{const y=de().length;return y>0?Math.round(c.value/y*100):0}),de=()=>!Y.value.itemsText||!Y.value.itemsText.trim()?[]:Y.value.itemsText.split(`
`).map(y=>y.trim()).filter(y=>y.length>0).map(y=>{const l=y.split("|").map(h=>h.trim());return{searchTerm:l[0]||"",additionalInfo:l[1]||null}}),p=()=>{c.value=0,f.value=0,d.value=0,x.value=0,D.value=null,A.value="",w.value="",V.value=[],Z.value=[]},G=(y,l,h)=>{D.value=y,A.value=l,w.value=h},le=(y,l,h="")=>{const I={searching:"Searching...",found:"Found",adding:"Adding...",added:"Added",skipped:"Skipped",error:"Error"}[l]||l;V.value.push({title:y,status:l,statusText:I,message:h})},ie=async()=>{var h,I,g;if(!ne.value)return;t.value=2,a.value=!0,r.value=!0,p();const y=de();let l=0;try{let M=[];const q=localStorage.getItem("authToken"),te=localStorage.getItem("currentUser");if(q&&te)try{G({title:"Checking all items..."},"searching","Checking profile for duplicates..."),M=(await me.checkExistingItems(y.map(E=>({title:E.searchTerm,category:Y.value.category})))).existing_items||[],console.log(`🔍 Found ${M.length} existing items out of ${y.length} total`)}catch(ce){console.warn("Failed to check existing items, falling back to individual checks:",ce)}for(let ce=0;ce<y.length;ce++){const E=y[ce];c.value=ce+1,G({title:E.searchTerm,description:E.additionalInfo},"searching","Processing...");try{let J=!1;if(q&&te&&M.length>0?J=M.some(W=>W.title.toLowerCase().trim()===E.searchTerm.toLowerCase().trim()):J=(s.mediaData||[]).some(ue=>ue.title&&ue.title.toLowerCase().trim()===E.searchTerm.toLowerCase().trim()&&ue.category===Y.value.category),J){console.log(`✅ Found exact match in profile for "${E.searchTerm}"`),G({title:E.searchTerm},"skipped","Already exists in profile - skipped"),Z.value.push({searchTerm:E.searchTerm,additionalInfo:E.additionalInfo,reason:"duplicate"}),d.value++,le(E.searchTerm,"skipped","Already exists in profile - skipped");continue}G({title:E.searchTerm,description:E.additionalInfo},"searching","Searching API..."),le(E.searchTerm,"searching","Searching API..."),console.log(`🔍 Searching API for: "${E.searchTerm}" in category: ${Y.value.category}`);const pe=await me.searchApi(E.searchTerm,Y.value.category,1);if(console.log(`🔍 Search results for "${E.searchTerm}":`,pe),pe&&pe.length>0&&pe[0]&&pe[0].api_source&&pe[0].image){const W=pe[0];console.log(`✅ Found real API data for "${E.searchTerm}":`,{title:W.title,api_source:W.api_source,has_image:!!W.image,has_genre:!!W.genre,has_release:!!W.release}),G({title:W.title,description:`Found: ${W.genre||"Unknown genre"} • ${W.release||"Unknown year"} • ${W.api_source}`},"found","Found in API with data"),le(E.searchTerm,"found",`Found: ${W.title} (${W.api_source})`),G({title:W.title},"adding","Adding to library...");const ue={title:W.title,category:Y.value.category,release:W.release||null,rating:W.rating?Math.round(W.rating):Y.value.defaultRating||null,platforms:W.platforms||null,genre:W.genre||null,link:W.link||null,path:W.image||null,external_id:W.id||null,count:1,is_airing:!1,spielzeit:0,description:W.overview||E.additionalInfo||null};await s.addMediaItem(ue,!0),f.value++,G({title:W.title},"added","Successfully added with API data"),le(E.searchTerm,"added",`Added: ${W.title} with API data`)}else console.log(`❌ No real API data found for "${E.searchTerm}"`),G({title:E.searchTerm},"skipped","No API data found - will retry"),Z.value.push({searchTerm:E.searchTerm,additionalInfo:E.additionalInfo,reason:"no_api_data"}),d.value++,le(E.searchTerm,"skipped","No API data found - ready for retry")}catch(J){console.error(`Error processing "${E.searchTerm}":`,J),J.isDuplicate||((h=J.response)==null?void 0:h.status)===409&&((g=(I=J.response)==null?void 0:I.data)!=null&&g.duplicate)?(G({title:E.searchTerm},"skipped","Already exists - skipped"),d.value++,le(E.searchTerm,"skipped","Item already exists in library")):(G({title:E.searchTerm},"error","Error occurred"),x.value++,le(E.searchTerm,"error",J.message||"Unknown error"))}if(l++,l>=5){console.log("🔄 Reloading media data after 5 items...");try{await s.loadMedia(),l=0}catch(J){console.warn("Failed to reload media data:",J)}}if(!a.value)break;for(;n.value&&a.value;)await new Promise(J=>setTimeout(J,100));await new Promise(J=>setTimeout(J,1e3))}console.log("🔄 Final media data reload...");try{await s.loadMedia()}catch(ce){console.warn("Failed to reload media data at end:",ce)}t.value=3,G(null,"","")}catch(M){console.error("Bulk processing error:",M),x.value++}finally{a.value=!1,r.value=!1}},ke=()=>{a.value=!1,r.value=!1,n.value=!1,t.value=1,p()},fe=()=>{n.value=!0},we=()=>{n.value=!1},Ie=()=>{const y=Z.value.filter(h=>h.reason!=="duplicate");if(y.length===0){b();return}const l=y.map(h=>h.additionalInfo?`${h.searchTerm} | ${h.additionalInfo}`:h.searchTerm).join(`
`);Y.value.itemsText=l,c.value=0,f.value=0,x.value=0,D.value=null,A.value="",w.value="",V.value=[],t.value=1},b=()=>{t.value=1,a.value=!1,r.value=!0,p(),Y.value={category:"",itemsText:"",defaultRating:null},e("close")};return Ce(()=>i.show,y=>{y&&i.currentCategory?Y.value.category=i.currentCategory:y||b()}),{currentStep:t,isProcessing:a,canCancel:r,isPaused:n,processedCount:c,addedCount:f,skippedCount:d,errorCount:x,currentItem:D,currentItemStatus:A,currentItemStatusText:w,processingResults:V,skippedItems:Z,bulkData:Y,canStart:ne,progressPercentage:ge,startProcessing:ie,cancelProcessing:ke,pauseProcessing:fe,resumeProcessing:we,retrySkippedItems:Ie,closeModal:b}}},ri={class:"modal-header"},di={class:"modal-body"},ci={key:0,class:"step-container"},ui={class:"bulk-add-form"},gi={class:"form-group"},mi={class:"form-group"},fi={class:"form-group"},pi={key:1,class:"step-container"},vi={class:"processing-container"},hi={class:"progress-overview"},yi={class:"progress-stats"},bi={class:"stat"},ki={class:"stat-number"},wi={class:"stat"},Si={class:"stat-number"},Ii={class:"stat"},_i={class:"stat-number"},Ci={class:"stat"},Di={class:"stat-number"},Ai={class:"progress-bar"},xi={class:"progress-text"},Ti={class:"current-item"},Mi={class:"current-item-header"},Ui={class:"current-item-title"},Pi={key:0,class:"paused-indicator"},Bi={key:0,class:"current-item-description"},Ri={key:1,class:"api-data-indicator"},Ei={key:2,class:"no-api-indicator"},Fi={class:"results-list"},Li={class:"result-header"},Ni={class:"result-title"},Gi={class:"result-status"},Wi={key:0,class:"result-message"},Oi={key:2,class:"step-container"},Vi={class:"results-summary"},zi={class:"summary-stats"},ji={class:"summary-stat success"},Yi={class:"stat-number"},qi={class:"summary-stat warning"},Hi={class:"stat-number"},Qi={class:"summary-stat info"},Ji={class:"stat-number"},Ki={class:"summary-stat error"},Zi={class:"stat-number"},Xi={key:0,class:"retry-section"},$i={class:"retry-list"},en=["onUpdate:modelValue","disabled"],tn={key:0,class:"retry-additional"},on={key:1,class:"duplicate-badge"},sn={key:2,class:"retry-badge"},an={key:1,class:"detailed-results"},nn={class:"results-list"},ln={class:"result-header"},rn={class:"result-title"},dn={class:"result-status"},cn={key:0,class:"result-message"},un={class:"modal-footer"},gn=["disabled"],mn={key:2,class:"processing-controls"},fn=["disabled"],pn=["disabled"],vn={key:3,class:"footer-buttons"};function hn(i,e,s,t,a,r){var n,c;return s.show?(u(),m("div",{key:0,class:"modal-overlay",onClick:e[12]||(e[12]=(...f)=>t.closeModal&&t.closeModal(...f))},[o("div",{class:"modal-content",onClick:e[11]||(e[11]=re(()=>{},["stop"]))},[o("div",ri,[e[13]||(e[13]=o("h2",null,"Bulk Add Items",-1)),o("button",{class:"close-btn",onClick:e[0]||(e[0]=(...f)=>t.closeModal&&t.closeModal(...f))},"✕")]),o("div",di,[t.currentStep===1?(u(),m("div",ci,[e[19]||(e[19]=o("div",{class:"step-header"},[o("div",{class:"step-number"},"1"),o("h3",null,"Enter Your List")],-1)),o("div",ui,[o("div",gi,[e[15]||(e[15]=o("label",{for:"category"},"Category *",-1)),T(o("select",{id:"category","onUpdate:modelValue":e[1]||(e[1]=f=>t.bulkData.category=f),required:""},[...e[14]||(e[14]=[Oe('<option value="" data-v-11f7dfb2>Select Category</option><option value="game" data-v-11f7dfb2>Game</option><option value="series" data-v-11f7dfb2>Series</option><option value="movie" data-v-11f7dfb2>Movie</option><option value="buecher" data-v-11f7dfb2>Bücher</option><option value="watchlist" data-v-11f7dfb2>Watchlist</option>',6)])],512),[[ye,t.bulkData.category]])]),o("div",mi,[e[16]||(e[16]=o("label",{for:"items-text"},"Items (one per line) *",-1)),T(o("textarea",{id:"items-text","onUpdate:modelValue":e[2]||(e[2]=f=>t.bulkData.itemsText=f),placeholder:`Enter items one per line, for example:
The Witcher 3
Cyberpunk 2077
Red Dead Redemption 2`,rows:"10",required:""},null,512),[[L,t.bulkData.itemsText]]),e[17]||(e[17]=o("small",{class:"help-text"},"Enter one item per line. The system will automatically search and add each item individually.",-1))]),o("div",fi,[e[18]||(e[18]=o("label",{for:"default-rating"},"Default Rating",-1)),T(o("input",{id:"default-rating","onUpdate:modelValue":e[3]||(e[3]=f=>t.bulkData.defaultRating=f),type:"number",min:"0",max:"10",step:"0.1",placeholder:"Optional rating for all items"},null,512),[[L,t.bulkData.defaultRating,void 0,{number:!0}]])])])])):k("",!0),t.currentStep===2?(u(),m("div",pi,[e[24]||(e[24]=o("div",{class:"step-header"},[o("div",{class:"step-number"},"2"),o("h3",null,"Processing Items")],-1)),o("div",vi,[o("div",hi,[o("div",yi,[o("span",bi,[o("span",ki,v(t.processedCount),1),e[20]||(e[20]=o("span",{class:"stat-label"},"Processed",-1))]),o("span",wi,[o("span",Si,v(t.addedCount),1),e[21]||(e[21]=o("span",{class:"stat-label"},"Added",-1))]),o("span",Ii,[o("span",_i,v(t.skippedCount),1),e[22]||(e[22]=o("span",{class:"stat-label"},"Skipped",-1))]),o("span",Ci,[o("span",Di,v(t.errorCount),1),e[23]||(e[23]=o("span",{class:"stat-label"},"Errors",-1))])]),o("div",Ai,[o("div",{class:"progress-fill",style:xe({width:t.progressPercentage+"%"})},null,4)]),o("div",xi,v(t.progressPercentage)+"% Complete",1)]),o("div",Ti,[o("div",Mi,[o("span",Ui,"Processing: "+v(((n=t.currentItem)==null?void 0:n.title)||"..."),1),o("span",{class:Q(["current-item-status",t.currentItemStatus])},[t.isPaused?(u(),m("span",Pi,"⏸️ PAUSED - ")):k("",!0),Ae(v(t.currentItemStatusText),1)],2)]),(c=t.currentItem)!=null&&c.description?(u(),m("div",Bi,v(t.currentItem.description),1)):k("",!0),t.currentItemStatus==="found"?(u(),m("div",Ri," ✅ Real API data found with image and metadata ")):k("",!0),t.currentItemStatus==="skipped"?(u(),m("div",Ei," ❌ No API data found - will be retried ")):k("",!0)]),o("div",Fi,[(u(!0),m(oe,null,se(t.processingResults,(f,d)=>(u(),m("div",{key:d,class:Q(["result-item",f.status])},[o("div",Li,[o("span",Ni,v(f.title),1),o("span",Gi,v(f.statusText),1)]),f.message?(u(),m("div",Wi,v(f.message),1)):k("",!0)],2))),128))])])])):k("",!0),t.currentStep===3?(u(),m("div",Oi,[e[32]||(e[32]=o("div",{class:"step-header"},[o("div",{class:"step-number"},"3"),o("h3",null,"Results")],-1)),o("div",Vi,[o("div",zi,[o("div",ji,[o("span",Yi,v(t.addedCount),1),e[25]||(e[25]=o("span",{class:"stat-label"},"Successfully Added",-1))]),o("div",qi,[o("span",Hi,v(t.skippedItems.filter(f=>f.reason!=="duplicate").length),1),e[26]||(e[26]=o("span",{class:"stat-label"},"Not Found (Ready for Retry)",-1))]),o("div",Qi,[o("span",Ji,v(t.skippedItems.filter(f=>f.reason==="duplicate").length),1),e[27]||(e[27]=o("span",{class:"stat-label"},"Already in Profile",-1))]),o("div",Ki,[o("span",Zi,v(t.errorCount),1),e[28]||(e[28]=o("span",{class:"stat-label"},"Errors",-1))])]),t.skippedItems.length>0?(u(),m("div",Xi,[e[29]||(e[29]=o("h4",null,"Items Ready for Retry",-1)),e[30]||(e[30]=o("p",{class:"retry-description"}," The following items can be edited and tried again: ",-1)),o("div",$i,[(u(!0),m(oe,null,se(t.skippedItems,(f,d)=>(u(),m("div",{key:d,class:Q(["retry-item",{"duplicate-item":f.reason==="duplicate"}])},[T(o("input",{"onUpdate:modelValue":x=>f.searchTerm=x,class:"retry-input",placeholder:"Edit search term...",disabled:f.reason==="duplicate"},null,8,en),[[L,f.searchTerm]]),f.additionalInfo?(u(),m("span",tn," | "+v(f.additionalInfo),1)):k("",!0),f.reason==="duplicate"?(u(),m("span",on," Already in profile ")):(u(),m("span",sn," No API data "))],2))),128))])])):k("",!0),t.processingResults.length>0?(u(),m("div",an,[e[31]||(e[31]=o("h4",null,"Detailed Results",-1)),o("div",nn,[(u(!0),m(oe,null,se(t.processingResults,(f,d)=>(u(),m("div",{key:d,class:Q(["result-item",f.status])},[o("div",ln,[o("span",rn,v(f.title),1),o("span",dn,v(f.statusText),1)]),f.message?(u(),m("div",cn,v(f.message),1)):k("",!0)],2))),128))])])):k("",!0)])])):k("",!0)]),o("div",un,[t.currentStep===1?(u(),m("button",{key:0,class:"btn btn-secondary",onClick:e[4]||(e[4]=(...f)=>t.closeModal&&t.closeModal(...f))}," Cancel ")):k("",!0),t.currentStep===1?(u(),m("button",{key:1,class:"btn btn-primary",onClick:e[5]||(e[5]=(...f)=>t.startProcessing&&t.startProcessing(...f)),disabled:!t.canStart}," Check All and Add ",8,gn)):k("",!0),t.currentStep===2?(u(),m("div",mn,[o("button",{class:"btn btn-secondary",onClick:e[6]||(e[6]=(...f)=>t.cancelProcessing&&t.cancelProcessing(...f)),disabled:!t.canCancel}," Cancel ",8,fn),t.isPaused?k("",!0):(u(),m("button",{key:0,class:"btn btn-warning",onClick:e[7]||(e[7]=(...f)=>t.pauseProcessing&&t.pauseProcessing(...f)),disabled:!t.isProcessing}," Pause ",8,pn)),t.isPaused?(u(),m("button",{key:1,class:"btn btn-primary",onClick:e[8]||(e[8]=(...f)=>t.resumeProcessing&&t.resumeProcessing(...f))}," Resume ")):k("",!0)])):k("",!0),t.currentStep===3?(u(),m("div",vn,[t.skippedItems.filter(f=>f.reason!=="duplicate").length>0?(u(),m("button",{key:0,class:"btn btn-warning",onClick:e[9]||(e[9]=(...f)=>t.retrySkippedItems&&t.retrySkippedItems(...f))}," Retry "+v(t.skippedItems.filter(f=>f.reason!=="duplicate").length)+" Items ",1)):k("",!0),o("button",{class:"btn btn-primary",onClick:e[10]||(e[10]=(...f)=>t.closeModal&&t.closeModal(...f))}," Done ")])):k("",!0)])])])):k("",!0)}const yn=ee(li,[["render",hn],["__scopeId","data-v-11f7dfb2"]]),bn={name:"TxtImportModal",props:{show:{type:Boolean,default:!1}},emits:["close","fileProcessed"],methods:{handleFileUpload(i){const e=i.target.files[0];if(!e)return;if(!e.name.toLowerCase().endsWith(".txt")){alert("Bitte wählen Sie eine .txt Datei aus.");return}const s=new FileReader;s.onload=t=>{const a=t.target.result;this.$emit("fileProcessed",a)},s.readAsText(e,"UTF-8")}}},kn={class:"file-upload-area"},wn={class:"modal-buttons"};function Sn(i,e,s,t,a,r){return s.show?(u(),m("div",{key:0,class:"modal",onClick:e[3]||(e[3]=n=>i.$emit("close"))},[o("div",{class:"modal-content",onClick:e[2]||(e[2]=re(()=>{},["stop"]))},[e[5]||(e[5]=o("h2",null,"📄 Import from TXT File",-1)),e[6]||(e[6]=o("p",null,"Wählen Sie eine .txt Datei mit einer Liste von Titeln aus, um zu prüfen, welche Items in der aktuellen Kategorie fehlen.",-1)),o("div",kn,[o("input",{type:"file",id:"txtFileInput",accept:".txt",onChange:e[0]||(e[0]=(...n)=>r.handleFileUpload&&r.handleFileUpload(...n)),style:{display:"none"}},null,32),e[4]||(e[4]=o("label",{for:"txtFileInput",class:"file-upload-label"},[o("span",{class:"upload-icon"},"📁"),o("span",{class:"upload-text"},"TXT-Datei auswählen"),o("span",{class:"upload-hint"},"Eine .txt Datei mit einer Liste von Titeln")],-1))]),o("div",wn,[o("button",{type:"button",onClick:e[1]||(e[1]=n=>i.$emit("close"))}," Cancel ")])])])):k("",!0)}const In=ee(bn,[["render",Sn],["__scopeId","data-v-e20860d6"]]),_n={name:"TxtImportResultsModal",props:{show:{type:Boolean,default:!1},results:{type:Object,default:null}},emits:["close"]},Cn={class:"results-summary"},Dn={class:"summary-item"},An={class:"summary-value"},xn={class:"summary-item"},Tn={class:"summary-value"},Mn={class:"summary-item"},Un={class:"summary-value existing"},Pn={class:"summary-item"},Bn={class:"summary-value missing"},Rn={key:0,class:"missing-items"},En={class:"items-list"},Fn={key:1,class:"existing-items"},Ln={class:"items-list"},Nn={class:"modal-buttons"};function Gn(i,e,s,t,a,r){return s.show&&s.results?(u(),m("div",{key:0,class:"modal",onClick:e[2]||(e[2]=n=>i.$emit("close"))},[o("div",{class:"modal-content results-modal",onClick:e[1]||(e[1]=re(()=>{},["stop"]))},[e[7]||(e[7]=o("h2",null,"📊 TXT Import Ergebnisse",-1)),o("div",Cn,[o("div",Dn,[e[3]||(e[3]=o("span",{class:"summary-label"},"Kategorie:",-1)),o("span",An,v(s.results.categoryName),1)]),o("div",xn,[e[4]||(e[4]=o("span",{class:"summary-label"},"Titel in Datei:",-1)),o("span",Tn,v(s.results.totalInFile),1)]),o("div",Mn,[e[5]||(e[5]=o("span",{class:"summary-label"},"Bereits vorhanden:",-1)),o("span",Un,v(s.results.existingItems.length),1)]),o("div",Pn,[e[6]||(e[6]=o("span",{class:"summary-label"},"Fehlende Titel:",-1)),o("span",Bn,v(s.results.missingItems.length),1)])]),s.results.missingItems.length>0?(u(),m("div",Rn,[o("h3",null,"❌ Fehlende Titel ("+v(s.results.missingItems.length)+"):",1),o("div",En,[(u(!0),m(oe,null,se(s.results.missingItems,(n,c)=>(u(),m("div",{key:c,class:"missing-item"},v(n),1))),128))])])):k("",!0),s.results.existingItems.length>0?(u(),m("div",Fn,[o("h3",null,"✅ Bereits vorhanden ("+v(s.results.existingItems.length)+"):",1),o("div",Ln,[(u(!0),m(oe,null,se(s.results.existingItems,(n,c)=>(u(),m("div",{key:c,class:"existing-item"},v(n),1))),128))])])):k("",!0),o("div",Nn,[o("button",{type:"button",onClick:e[0]||(e[0]=n=>i.$emit("close"))}," Schließen ")])])])):k("",!0)}const Wn=ee(_n,[["render",Gn],["__scopeId","data-v-ec385b83"]]),On={name:"SimpleAddItem",setup(){const i=S(!1),e=S(null),s=Te({title:"Test Game",category:"game",release:"2003-01-01",count:1});return{form:s,loading:i,result:e,addItem:async()=>{i.value=!0,e.value=null;try{const a=window.location.origin,r=await fetch(`${a}/api/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:"admin@example.com",password:"admin123"})});if(!r.ok)throw new Error("Login failed");const c=(await r.json()).token,d=await(await fetch(`${a}/api/media`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify(s)})).json();d.success?e.value={success:!0,message:`Success! Item added with ID: ${d.data.id}`}:e.value={success:!1,message:`Error: ${JSON.stringify(d)}`}}catch(a){e.value={success:!1,message:`Error: ${a.message}`}}finally{i.value=!1}}}}},Vn={class:"simple-add-item"},zn=["disabled"];function jn(i,e,s,t,a,r){return u(),m("div",Vn,[e[10]||(e[10]=o("h3",null,"Simple Add Item Test",-1)),o("form",{onSubmit:e[4]||(e[4]=re((...n)=>t.addItem&&t.addItem(...n),["prevent"]))},[o("div",null,[e[5]||(e[5]=o("label",null,"Title:",-1)),T(o("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>t.form.title=n),type:"text",required:""},null,512),[[L,t.form.title]])]),o("div",null,[e[7]||(e[7]=o("label",null,"Category:",-1)),T(o("select",{"onUpdate:modelValue":e[1]||(e[1]=n=>t.form.category=n)},[...e[6]||(e[6]=[o("option",{value:"game"},"Game",-1),o("option",{value:"movie"},"Movie",-1),o("option",{value:"series"},"Series",-1)])],512),[[ye,t.form.category]])]),o("div",null,[e[8]||(e[8]=o("label",null,"Release:",-1)),T(o("input",{"onUpdate:modelValue":e[2]||(e[2]=n=>t.form.release=n),type:"date"},null,512),[[L,t.form.release]])]),o("div",null,[e[9]||(e[9]=o("label",null,"Count:",-1)),T(o("input",{"onUpdate:modelValue":e[3]||(e[3]=n=>t.form.count=n),type:"number",min:"0"},null,512),[[L,t.form.count]])]),o("button",{type:"submit",disabled:t.loading},v(t.loading?"Adding...":"Add Item"),9,zn)],32),t.result?(u(),m("div",{key:0,class:Q(["result",t.result.success?"success":"error"])},v(t.result.message),3)):k("",!0)])}const Yn=ee(On,[["render",jn],["__scopeId","data-v-4298065b"]]),qn={name:"LoadingSpinner",props:{loading:{type:Boolean,default:!0},message:{type:String,default:"Loading..."}}},Hn={key:0,class:"loading-spinner"},Qn={key:0};function Jn(i,e,s,t,a,r){return s.loading?(u(),m("div",Hn,[e[0]||(e[0]=o("div",{class:"spinner"},null,-1)),s.message?(u(),m("p",Qn,v(s.message),1)):k("",!0)])):k("",!0)}const Kn=ee(qn,[["render",Jn],["__scopeId","data-v-0e82c46a"]]),Zn={name:"MessageBox",props:{show:{type:Boolean,default:!1},type:{type:String,default:"info",validator:i=>["success","error","warning","info"].includes(i)},title:{type:String,default:""},message:{type:String,required:!0},details:{type:String,default:""}},emits:["close"],setup(i,{emit:e}){const s=()=>{e("close")},t=O(()=>{switch(i.type){case"success":return"✅";case"error":return"❌";case"warning":return"⚠️";case"info":return"ℹ️";default:return"ℹ️"}}),a=O(()=>`message-${i.type}`);return{closeMessage:s,icon:t,messageType:a}}},Xn={class:"message-header"},$n={class:"message-icon"},el={class:"message-title"},tl={class:"message-body"},ol={key:0,class:"message-details"},sl={class:"message-footer"};function al(i,e,s,t,a,r){return s.show?(u(),m("div",{key:0,class:"message-overlay",onClick:e[3]||(e[3]=(...n)=>t.closeMessage&&t.closeMessage(...n))},[o("div",{class:Q(["message-box",t.messageType]),onClick:e[2]||(e[2]=re(()=>{},["stop"]))},[o("div",Xn,[o("span",$n,v(t.icon),1),o("h3",el,v(s.title),1),o("button",{class:"close-btn",onClick:e[0]||(e[0]=(...n)=>t.closeMessage&&t.closeMessage(...n))},"✕")]),o("div",tl,[o("p",null,v(s.message),1),s.details?(u(),m("div",ol,[o("pre",null,v(s.details),1)])):k("",!0)]),o("div",sl,[o("button",{class:"btn btn-primary",onClick:e[1]||(e[1]=(...n)=>t.closeMessage&&t.closeMessage(...n))},"OK")])],2)])):k("",!0)}const il=ee(Zn,[["render",al],["__scopeId","data-v-198ec3cc"]]),nl={name:"ConfirmDialog",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm Action"},message:{type:String,required:!0}},emits:["confirm","close"],setup(i,{emit:e}){const s=()=>{e("close")};return{closeDialog:s,confirmAction:()=>{e("confirm"),s()}}}},ll={class:"confirm-header"},rl={class:"confirm-title"},dl={class:"confirm-body"},cl={class:"confirm-footer"};function ul(i,e,s,t,a,r){return s.show?(u(),m("div",{key:0,class:"confirm-overlay",onClick:e[4]||(e[4]=(...n)=>t.closeDialog&&t.closeDialog(...n))},[o("div",{class:"confirm-dialog",onClick:e[3]||(e[3]=re(()=>{},["stop"]))},[o("div",ll,[o("h3",rl,v(s.title),1),o("button",{class:"close-btn",onClick:e[0]||(e[0]=(...n)=>t.closeDialog&&t.closeDialog(...n))},"✕")]),o("div",dl,[o("p",null,v(s.message),1)]),o("div",cl,[o("button",{class:"btn btn-secondary",onClick:e[1]||(e[1]=(...n)=>t.closeDialog&&t.closeDialog(...n))},"Cancel"),o("button",{class:"btn btn-danger",onClick:e[2]||(e[2]=(...n)=>t.confirmAction&&t.confirmAction(...n))},"Confirm")])])])):k("",!0)}const gl=ee(nl,[["render",ul],["__scopeId","data-v-fd570f57"]]),ml={name:"InputDialog",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Input Required"},message:{type:String,required:!0},placeholder:{type:String,default:""},inputType:{type:String,default:"text"},defaultValue:{type:String,default:""}},emits:["confirm","close"],setup(i,{emit:e}){const s=S(""),t=S(null),a=()=>{e("close")},r=()=>{e("confirm",s.value),a()};return Ce(()=>i.show,async n=>{n&&(s.value=i.defaultValue,await Ot(),t.value&&(t.value.focus(),t.value.select()))}),{inputValue:s,inputRef:t,closeDialog:a,confirmAction:r}}},fl={class:"input-header"},pl={class:"input-title"},vl={class:"input-body"},hl={class:"input-message"},yl=["type","placeholder"],bl={class:"input-footer"};function kl(i,e,s,t,a,r){return s.show?(u(),m("div",{key:0,class:"input-overlay",onClick:e[6]||(e[6]=(...n)=>t.closeDialog&&t.closeDialog(...n))},[o("div",{class:"input-dialog",onClick:e[5]||(e[5]=re(()=>{},["stop"]))},[o("div",fl,[o("h3",pl,v(s.title),1),o("button",{class:"close-btn",onClick:e[0]||(e[0]=(...n)=>t.closeDialog&&t.closeDialog(...n))},"✕")]),o("div",vl,[o("p",hl,v(s.message),1),T(o("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>t.inputValue=n),type:s.inputType,placeholder:s.placeholder,class:"input-field",onKeyup:e[2]||(e[2]=Wt((...n)=>t.confirmAction&&t.confirmAction(...n),["enter"])),ref:"inputRef"},null,40,yl),[[Gt,t.inputValue]])]),o("div",bl,[o("button",{class:"btn btn-secondary",onClick:e[3]||(e[3]=(...n)=>t.closeDialog&&t.closeDialog(...n))},"Cancel"),o("button",{class:"btn btn-primary",onClick:e[4]||(e[4]=(...n)=>t.confirmAction&&t.confirmAction(...n))},"OK")])])])):k("",!0)}const wl=ee(ml,[["render",kl],["__scopeId","data-v-0ee78a4d"]]),Sl={name:"MediaLibrary",components:{MediaItem:uo,Sidebar:Bo,MainHeader:jo,FloatingActionButton:Ko,LoginModal:ls,RegisterModal:_s,EditModal:ni,BulkAddModal:yn,TxtImportModal:In,TxtImportResultsModal:Wn,SimpleAddItem:Yn,LoadingSpinner:Kn,MessageBox:il,ConfirmDialog:gl,InputDialog:wl},setup(){const i=ze(),e=nt(),s=lt(),t=rt(),a=Ve(),r=dt();r||console.error("SidebarStore not properly initialized");const n=O(()=>r||{collapsed:!1,mobileOpen:!1,toggleSidebar:()=>{},toggleMobileSidebar:()=>{},closeMobileSidebar:()=>{}}),c=S(!1),f=S(null),d=S(new Date),x=S(null),D=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],A=S(null),w=Te({firstName:"",lastName:"",displayName:"",email:"",bio:"",avatar:"",language:"en",timezone:"UTC",dateFormat:"MM/DD/YYYY",booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}),{showLoginModal:V,showRegisterModal:Z,showEditModal:Y,showFloatingMenu:ne,showBulkAddModal:ge,showTxtImportModal:de,showTxtImportResults:p,editingItem:G,sortBy:le,categories:ie,txtImportResults:ke,isLoggedIn:fe,isAdmin:we,userName:Ie,currentCategory:b,searchQuery:y,categoryCounts:l,loading:h,error:I,paginatedMedia:g,setCategory:M,clearSearch:q,editItem:te,closeEditModal:ce,closeBulkAddModal:E,handleBulkAddItems:J,handleSaveItem:pe,handleDeleteItem:Be,logout:W,loadMedia:ue,toggleFloatingMenu:je,addNewItem:Re,bulkAddItems:Me,importFromTxt:Ye,importFromAPI:qe,createCollection:He,exportMediaCollection:Ee,exportAsCSV:Fe,exportAsJSON:Le,downloadFile:Ue,deleteAllInCategory:Ze,getCategoryDisplayName:Ne,navigateToCalendar:Xe,navigateToProfile:$e,processTxtContent:_,closeTxtImportResults:P,cleanup:K,router:F}=jt(),N=O(()=>{try{return Ne?Ne(b.value):b.value}catch(C){return console.error("Error getting category display name:",C),b.value||"Unknown"}}),X=O(()=>d.value.getFullYear()),z=O(()=>d.value.getMonth()),_e=O(()=>d.value.toLocaleDateString("en-US",{month:"long"})),Se=O(()=>{const C=X.value,U=z.value,R=new Date(C,U,1),j=new Date(R),B=R.getDay(),H=B===0?6:B-1;j.setDate(j.getDate()-H);const be=[],$=new Date;for(let Qe=0;Qe<42;Qe++){const ve=new Date(j);ve.setDate(j.getDate()+Qe);const Rt=ve.getMonth()===U,Et=ve.toDateString()===$.toDateString(),Ft=ve.getDay()===0||ve.getDay()===6;be.push({date:ve.getDate(),month:ve.getMonth(),year:ve.getFullYear(),fullDate:new Date(ve),isCurrentMonth:Rt,isToday:Et,isWeekend:Ft,hasEvents:et(ve),events:tt(ve)})}return be}),ct=O(()=>{const C=i.mediaData||[],U={totalItems:C.length,totalCollections:0,totalPlaytime:0,avgRating:0,categoryDistribution:{},ratingDistribution:{},platformDistribution:{},genreDistribution:{},recentActivity:[],airingSeries:[]};let R=0,j=0;return C.forEach(B=>{const H=B.category||"unknown";if(U.categoryDistribution[H]=(U.categoryDistribution[H]||0)+1,B.rating&&B.rating>0){const be=Math.floor(B.rating);U.ratingDistribution[be]=(U.ratingDistribution[be]||0)+1,R+=B.rating,j++}if(B.platforms&&B.category==="game"&&B.platforms.split(",").map($=>$.trim()).filter($=>$).forEach($=>{U.platformDistribution[$]=(U.platformDistribution[$]||0)+1}),B.genre&&(B.category==="series"||B.category==="movie")&&B.genre.split(",").map($=>$.trim()).filter($=>$).forEach($=>{U.genreDistribution[$]=(U.genreDistribution[$]||0)+1}),B.spielzeit&&B.spielzeit>0&&(U.totalPlaytime+=B.spielzeit),B.category==="series"&&B.isAiring===!0&&U.airingSeries.push({title:B.title,nextSeason:B.nextSeason,nextSeasonRelease:B.nextSeasonRelease}),B.discovered){const be=new Date(B.discovered),$=new Date;$.setDate($.getDate()-30),be>=$&&U.recentActivity.push({title:B.title,category:B.category,discovered:B.discovered})}}),j>0&&(U.avgRating=(R/j).toFixed(1)),U.totalPlaytime=Math.round(U.totalPlaytime/60),U.recentActivity.sort((B,H)=>new Date(H.discovered)-new Date(B.discovered)),U}),ut=C=>C?new Date(C).toLocaleDateString():"",gt=C=>{const U=Math.max(0,Math.min(5,parseInt(C)||0)),R="★".repeat(U),j="☆".repeat(5-U);return R+j},mt=C=>{M(C),Re()},ft=()=>{V.value=!1,Z.value=!0},pt=()=>{V.value=!0},vt=C=>{V.value=!1,ue()},ht=()=>{Z.value=!1,ue()},yt=async()=>{c.value=!0,f.value=null;try{console.log("🔧 Starting admin setup...");const C=await a.adminSetup();C.success?(console.log("✅ Admin setup successful:",C),f.value={type:"success",text:`✅ Admin created and logged in! User: ${C.user.name} (${C.user.email})`},await ue(),setTimeout(()=>{f.value=null},5e3)):(console.log("ℹ️ Admin already exists:",C),f.value={type:"info",text:`ℹ️ ${C.message} (${C.admin_count} admin(s) exist)`},setTimeout(()=>{f.value=null},3e3))}catch(C){console.error("❌ Admin setup failed:",C),f.value={type:"error",text:`❌ Admin setup failed: ${C.message||"Unknown error"}`},setTimeout(()=>{f.value=null},5e3)}finally{c.value=!1}},bt=()=>{console.log("🔥 DEBUG: Direct admin navigation called!"),console.log("🔥 DEBUG: Router object:",F);try{F.push("/admin"),console.log("🔥 DEBUG: Successfully navigated to /admin!")}catch(C){console.error("🔥 DEBUG: Error navigating to admin:",C)}},kt=()=>{d.value=new Date(d.value.getFullYear(),d.value.getMonth()-1,1),x.value=null},wt=()=>{d.value=new Date(d.value.getFullYear(),d.value.getMonth()+1,1),x.value=null},St=C=>{C.isCurrentMonth&&(x.value=C)},It=C=>C.fullDate.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),et=C=>ot(C).length>0,tt=C=>ot(C).map(R=>({id:R.id,title:R.title,time:"Release",type:R.watchlistType||R.watchlist_type||"unknown",item:R})),ot=C=>i.mediaData.filter(R=>R.category==="watchlist"&&R.release).filter(R=>{if(!R.release)return!1;const j=new Date(R.release),B=new Date(C);return j.getFullYear()===B.getFullYear()&&j.getMonth()===B.getMonth()&&j.getDate()===B.getDate()}),_t=()=>{var R,j;const C=((R=w.firstName)==null?void 0:R.charAt(0))||"U",U=((j=w.lastName)==null?void 0:j.charAt(0))||"S";return(C+U).toUpperCase()},Ct=()=>{var C;(C=A.value)==null||C.click()},Dt=C=>{const U=C.target.files[0];if(U){const R=new FileReader;R.onload=j=>{w.avatar=j.target.result},R.readAsDataURL(U)}},At=()=>{const C={profile:w,media:i.mediaData,settings:{language:w.language,timezone:w.timezone,dateFormat:w.dateFormat},exportDate:new Date().toISOString()},U=new Blob([JSON.stringify(C,null,2)],{type:"application/json"}),R=URL.createObjectURL(U),j=document.createElement("a");j.href=R,j.download=`media-library-backup-${new Date().toISOString().split("T")[0]}.json`,j.click(),URL.revokeObjectURL(R)},xt=()=>{const C=document.createElement("input");C.type="file",C.accept=".json",C.onchange=U=>{const R=U.target.files[0];if(R){const j=new FileReader;j.onload=B=>{try{const H=JSON.parse(B.target.result);H.profile&&Object.assign(w,H.profile),H.media&&(i.mediaData=H.media,i.saveMedia()),H.settings&&Object.assign(w,H.settings),Ge()}catch(H){console.error("Failed to import data:",H)}},j.readAsText(R)}},C.click()},Tt=()=>{const C={profile:w,media:i.mediaData,settings:{language:w.language,timezone:w.timezone,dateFormat:w.dateFormat},backupDate:new Date().toISOString()},U=`backup_${Date.now()}`;localStorage.setItem(U,JSON.stringify(C)),alert("Backup created successfully!")},Mt=()=>{alert("Cache cleared successfully!")},Ut=()=>{confirm("Are you sure you want to reset all settings?")&&(Object.assign(w,{firstName:"",lastName:"",displayName:"",email:"",bio:"",avatar:"",language:"en",timezone:"UTC",dateFormat:"MM/DD/YYYY",booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}),Ge())},Pt=()=>{confirm("Are you sure you want to clear all data? This cannot be undone!")&&(localStorage.clear(),window.location.reload())},Ge=()=>{localStorage.setItem("profileData",JSON.stringify(w))},Bt=()=>{Ge(),alert("All changes saved successfully!")};return at(async()=>{var C,U;try{await ue();const R=localStorage.getItem("profileData");if(R)try{const H=JSON.parse(R);Object.assign(w,H)}catch(H){console.error("Failed to load profile data:",H)}a.user&&(w.firstName=((C=a.user.name)==null?void 0:C.split(" ")[0])||"",w.lastName=((U=a.user.name)==null?void 0:U.split(" ").slice(1).join(" "))||"",w.email=a.user.email||"");const j=new Date,B=Se.value.find(H=>H.isToday&&H.isCurrentMonth);if(B&&(x.value=B),fe.value)try{i.initializeRealtimeUpdates()}catch(H){console.error("Error initializing realtime updates:",H)}}catch(R){console.error("Error during initialization:",R)}}),Vt(()=>{if(fe.value)try{i.cleanupRealtimeUpdates()}catch(C){console.error("Error cleaning up realtime updates:",C)}K()}),{showLoginModal:V,showRegisterModal:Z,showEditModal:Y,showFloatingMenu:ne,showBulkAddModal:ge,showTxtImportModal:de,showTxtImportResults:p,editingItem:G,sortBy:le,categories:ie,txtImportResults:ke,adminSetupLoading:c,adminSetupMessage:f,currentDate:d,selectedDay:x,weekdays:D,avatarInput:A,profileData:w,isLoggedIn:fe,isAdmin:we,userName:Ie,currentCategory:b,currentCategoryDisplayName:N,searchQuery:y,categoryCounts:l,loading:h,error:I,paginatedMedia:g,currentYear:X,currentMonth:z,currentMonthName:_e,calendarDays:Se,setCategory:M,clearSearch:q,navigateToCalendar:Xe,navigateToProfile:$e,addItemFromSidebar:mt,editItem:te,switchToRegister:ft,showAdminLogin:pt,handleLoginSuccess:vt,handleRegisterSuccess:ht,handleAdminSetup:yt,debugNavigateToAdmin:bt,closeEditModal:ce,closeBulkAddModal:E,handleBulkAddItems:J,handleSaveItem:pe,handleDeleteItem:Be,logout:W,loadMedia:ue,toggleFloatingMenu:je,addNewItem:Re,bulkAddItems:Me,importFromTxt:Ye,importFromAPI:qe,createCollection:He,exportMediaCollection:Ee,exportAsCSV:Fe,exportAsJSON:Le,downloadFile:Ue,deleteAllInCategory:Ze,getCategoryDisplayName:Ne,processTxtContent:_,closeTxtImportResults:P,previousMonth:kt,nextMonth:wt,selectDay:St,formatSelectedDay:It,hasEventsForDate:et,getEventsForDate:tt,getInitials:_t,changeAvatar:Ct,handleAvatarChange:Dt,exportData:At,importData:xt,createBackup:Tt,clearCache:Mt,resetSettings:Ut,clearAllData:Pt,saveProfileData:Ge,saveAllChanges:Bt,messageStore:e,confirmStore:s,inputStore:t,statistics:ct,formatDate:ut,getRatingStars:gt,sidebarStore:r,safeSidebarStore:n}}},Il={class:"vue-app"},_l={class:"main-content"},Cl={class:"content-area"},Dl={key:1,class:"error"},Al={key:2},xl={key:0,class:"calendar-view"},Tl={class:"calendar-header"},Ml=["disabled"],Ul={class:"month-year-display"},Pl={class:"month-name"},Bl={class:"year"},Rl=["disabled"],El={class:"calendar-container"},Fl={class:"calendar-grid"},Ll=["onClick"],Nl={class:"day-number"},Gl={key:0,class:"event-indicator"},Wl={key:0,class:"event-count"},Ol={key:0,class:"selected-day-info"},Vl={class:"day-events"},zl={key:0,class:"no-events"},jl={key:1,class:"events-list"},Yl={class:"event-header"},ql={class:"event-time"},Hl={class:"event-type-badge"},Ql={class:"event-title"},Jl={key:0,class:"event-platforms"},Kl={key:1,class:"event-genre"},Zl={key:1,class:"profile-container"},Xl={class:"profile-header"},$l={class:"profile-avatar-section"},er=["src"],tr={key:1,class:"avatar-initials"},or={class:"profile-info-header"},sr={class:"profile-stats"},ar={class:"stat-item"},ir={class:"stat-number"},nr={class:"stat-item"},lr={class:"stat-number"},rr={class:"settings-sections"},dr={class:"settings-section"},cr={class:"section-content"},ur={class:"form-row"},gr={class:"form-group"},mr={class:"form-group"},fr={class:"form-group"},pr={class:"form-group"},vr={class:"form-group"},hr={class:"settings-section"},yr={class:"section-content"},br={class:"form-row"},kr={class:"form-group"},wr={class:"form-group"},Sr={class:"form-row"},Ir={class:"form-group"},_r={class:"form-group"},Cr={class:"form-row"},Dr={class:"form-group"},Ar={class:"checkbox-container"},xr={class:"settings-section"},Tr={class:"section-content"},Mr={class:"data-actions"},Ur={class:"settings-section danger-zone"},Pr={class:"section-content"},Br={class:"danger-actions"},Rr={key:2,class:"statistics-container"},Er={class:"statistics-header"},Fr={class:"refresh-controls"},Lr={class:"statistics-content"},Nr={class:"stats-summary"},Gr={class:"summary-card"},Wr={class:"summary-number"},Or={class:"summary-card"},Vr={class:"summary-number"},zr={class:"summary-card"},jr={class:"summary-number"},Yr={class:"summary-card"},qr={class:"summary-number"},Hr={class:"chart-container"},Qr={class:"category-stats"},Jr={class:"category-name"},Kr={class:"category-bar"},Zr={class:"category-count"},Xr={class:"chart-container"},$r={class:"rating-stats"},ed={class:"rating-stars"},td={class:"rating-bar"},od={class:"rating-count"},sd={class:"chart-container"},ad={class:"platform-stats"},id={class:"platform-name"},nd={class:"platform-bar"},ld={class:"platform-count"},rd={class:"chart-container"},dd={class:"genre-stats"},cd={class:"genre-name"},ud={class:"genre-bar"},gd={class:"genre-count"},md={class:"chart-container"},fd={class:"recent-activity"},pd={class:"activity-title"},vd={class:"activity-category"},hd={class:"activity-date"},yd={class:"chart-container"},bd={class:"airing-series"},kd={class:"airing-title"},wd={class:"airing-next"},Sd={class:"airing-date"},Id={key:3,class:"grid"},_d={key:0,class:"admin-setup-container"},Cd=["disabled"],Dd={key:0},Ad={key:1};function xd(i,e,s,t,a,r){const n=ae("Sidebar"),c=ae("MainHeader"),f=ae("LoadingSpinner"),d=ae("MediaItem"),x=ae("LoginModal"),D=ae("RegisterModal"),A=ae("EditModal"),w=ae("BulkAddModal"),V=ae("TxtImportModal"),Z=ae("TxtImportResultsModal"),Y=ae("FloatingActionButton"),ne=ae("MessageBox"),ge=ae("ConfirmDialog"),de=ae("InputDialog");return u(),m("div",Il,[o("div",{class:Q(["mobile-overlay",{show:t.safeSidebarStore.mobileOpen}]),onClick:e[0]||(e[0]=(...p)=>t.safeSidebarStore.closeMobileSidebar&&t.safeSidebarStore.closeMobileSidebar(...p))},null,2),he(n,{collapsed:t.safeSidebarStore.collapsed,"mobile-open":t.safeSidebarStore.mobileOpen,"is-logged-in":t.isLoggedIn,"is-admin":t.isAdmin,"user-name":t.userName,"current-category":t.currentCategory,"category-counts":t.categoryCounts,categories:t.categories,onToggle:t.safeSidebarStore.toggleSidebar,onSetCategory:t.setCategory,onNavigateToCalendar:t.navigateToCalendar,onNavigateToProfile:t.navigateToProfile,onNavigateToAdmin:t.debugNavigateToAdmin,onAddItem:t.addItemFromSidebar,onShowLogin:e[1]||(e[1]=p=>t.showLoginModal=!0),onShowRegister:e[2]||(e[2]=p=>t.showRegisterModal=!0),onShowAdminLogin:t.showAdminLogin,onLogout:t.logout},null,8,["collapsed","mobile-open","is-logged-in","is-admin","user-name","current-category","category-counts","categories","onToggle","onSetCategory","onNavigateToCalendar","onNavigateToProfile","onNavigateToAdmin","onAddItem","onShowAdminLogin","onLogout"]),o("div",_l,[he(c,{"search-query":t.searchQuery,"onUpdate:searchQuery":e[3]||(e[3]=p=>t.searchQuery=p),"sort-by":t.sortBy,"onUpdate:sortBy":e[4]||(e[4]=p=>t.sortBy=p),onToggleMobileSidebar:t.safeSidebarStore.toggleMobileSidebar,onClearSearch:t.clearSearch},null,8,["search-query","sort-by","onToggleMobileSidebar","onClearSearch"]),o("main",Cl,[t.loading?(u(),De(f,{key:0,message:"Loading media data..."})):t.error?(u(),m("div",Dl,[o("p",null,v(t.error),1),o("button",{onClick:e[5]||(e[5]=(...p)=>t.loadMedia&&t.loadMedia(...p))},"Retry")])):(u(),m("div",Al,[t.currentCategory==="calendar"?(u(),m("div",xl,[o("div",Tl,[o("button",{class:"month-nav-btn",onClick:e[6]||(e[6]=(...p)=>t.previousMonth&&t.previousMonth(...p)),disabled:i.isLoading},[...e[31]||(e[31]=[o("span",{class:"nav-icon"},"‹",-1)])],8,Ml),o("div",Ul,[o("h2",Pl,v(t.currentMonthName),1),o("span",Bl,v(t.currentYear),1)]),o("button",{class:"month-nav-btn",onClick:e[7]||(e[7]=(...p)=>t.nextMonth&&t.nextMonth(...p)),disabled:i.isLoading},[...e[32]||(e[32]=[o("span",{class:"nav-icon"},"›",-1)])],8,Rl)]),o("div",El,[o("div",Fl,[(u(!0),m(oe,null,se(t.weekdays,p=>(u(),m("div",{class:"weekday-header",key:p},v(p),1))),128)),(u(!0),m(oe,null,se(t.calendarDays,p=>(u(),m("div",{key:`${p.date}-${p.month}`,class:Q(["calendar-day",{"other-month":!p.isCurrentMonth,today:p.isToday,weekend:p.isWeekend,"has-events":p.hasEvents}]),onClick:G=>t.selectDay(p)},[o("span",Nl,v(p.day),1),p.hasEvents?(u(),m("div",Gl,[e[33]||(e[33]=o("div",{class:"event-dot"},null,-1)),p.events&&p.events.length>1?(u(),m("span",Wl,v(p.events.length),1)):k("",!0)])):k("",!0)],10,Ll))),128))])]),t.selectedDay?(u(),m("div",Ol,[o("h3",null,v(t.formatSelectedDay(t.selectedDay)),1),o("div",Vl,[!t.selectedDay.events||t.selectedDay.events.length===0?(u(),m("p",zl," No watchlist releases scheduled for this day ")):(u(),m("div",jl,[(u(!0),m(oe,null,se(t.selectedDay.events,p=>(u(),m("div",{key:p.id,class:Q(["event-item",`event-${p.type}`])},[o("div",Yl,[o("span",ql,v(p.time),1),o("span",Hl,v(p.type),1)]),o("span",Ql,v(p.title),1),p.item.platforms?(u(),m("div",Jl,v(p.item.platforms),1)):k("",!0),p.item.genre?(u(),m("div",Kl,v(p.item.genre),1)):k("",!0)],2))),128))]))])])):k("",!0)])):t.currentCategory==="profile"?(u(),m("div",Zl,[o("div",Xl,[o("div",$l,[o("div",{class:"profile-avatar-large",onClick:e[8]||(e[8]=(...p)=>t.changeAvatar&&t.changeAvatar(...p))},[t.profileData.avatar?(u(),m("img",{key:0,src:t.profileData.avatar,alt:"Profile Picture"},null,8,er)):(u(),m("span",tr,v(t.getInitials()),1))]),o("input",{type:"file",ref:"avatarInput",accept:"image/*",onChange:e[9]||(e[9]=(...p)=>t.handleAvatarChange&&t.handleAvatarChange(...p)),style:{display:"none"}},null,544)]),o("div",or,[o("h2",null,v(t.profileData.displayName||t.profileData.firstName+" "+t.profileData.lastName||"User"),1),o("p",null,v(t.profileData.email||"user@example.com"),1),o("div",sr,[o("div",ar,[o("span",ir,v(i.totalItems),1),e[34]||(e[34]=o("span",{class:"stat-label"},"Total Items",-1))]),o("div",nr,[o("span",lr,v(new Date().getFullYear()),1),e[35]||(e[35]=o("span",{class:"stat-label"},"Member Since",-1))])])])]),o("div",rr,[o("div",dr,[e[41]||(e[41]=o("div",{class:"section-header"},[o("h3",null,"Personal Information"),o("p",null,"Manage your personal details and account information")],-1)),o("div",cr,[o("div",ur,[o("div",gr,[e[36]||(e[36]=o("label",{for:"firstName"},"First Name",-1)),T(o("input",{type:"text",id:"firstName","onUpdate:modelValue":e[10]||(e[10]=p=>t.profileData.firstName=p),placeholder:"Enter your first name"},null,512),[[L,t.profileData.firstName]])]),o("div",mr,[e[37]||(e[37]=o("label",{for:"lastName"},"Last Name",-1)),T(o("input",{type:"text",id:"lastName","onUpdate:modelValue":e[11]||(e[11]=p=>t.profileData.lastName=p),placeholder:"Enter your last name"},null,512),[[L,t.profileData.lastName]])])]),o("div",fr,[e[38]||(e[38]=o("label",{for:"displayName"},"Display Name",-1)),T(o("input",{type:"text",id:"displayName","onUpdate:modelValue":e[12]||(e[12]=p=>t.profileData.displayName=p),placeholder:"How others see your name"},null,512),[[L,t.profileData.displayName]])]),o("div",pr,[e[39]||(e[39]=o("label",{for:"email"},"Email Address",-1)),T(o("input",{type:"email",id:"email","onUpdate:modelValue":e[13]||(e[13]=p=>t.profileData.email=p),placeholder:"your.email@example.com"},null,512),[[L,t.profileData.email]])]),o("div",vr,[e[40]||(e[40]=o("label",{for:"bio"},"Bio",-1)),T(o("textarea",{id:"bio","onUpdate:modelValue":e[14]||(e[14]=p=>t.profileData.bio=p),placeholder:"Tell us about yourself...",rows:"4"},null,512),[[L,t.profileData.bio]])])])]),o("div",hr,[e[53]||(e[53]=o("div",{class:"section-header"},[o("h3",null,"Preferences"),o("p",null,"Customize your application experience")],-1)),o("div",yr,[o("div",br,[o("div",kr,[e[43]||(e[43]=o("label",{for:"language"},"Language",-1)),T(o("select",{id:"language","onUpdate:modelValue":e[15]||(e[15]=p=>t.profileData.language=p)},[...e[42]||(e[42]=[o("option",{value:"en"},"English",-1),o("option",{value:"de"},"Deutsch",-1),o("option",{value:"fr"},"Français",-1),o("option",{value:"es"},"Español",-1)])],512),[[ye,t.profileData.language]])]),o("div",wr,[e[45]||(e[45]=o("label",{for:"timezone"},"Timezone",-1)),T(o("select",{id:"timezone","onUpdate:modelValue":e[16]||(e[16]=p=>t.profileData.timezone=p)},[...e[44]||(e[44]=[o("option",{value:"UTC"},"UTC",-1),o("option",{value:"Europe/Berlin"},"Europe/Berlin",-1),o("option",{value:"America/New_York"},"America/New_York",-1),o("option",{value:"America/Los_Angeles"},"America/Los_Angeles",-1)])],512),[[ye,t.profileData.timezone]])])]),o("div",Sr,[o("div",Ir,[e[47]||(e[47]=o("label",{for:"dateFormat"},"Date Format",-1)),T(o("select",{id:"dateFormat","onUpdate:modelValue":e[17]||(e[17]=p=>t.profileData.dateFormat=p)},[...e[46]||(e[46]=[o("option",{value:"MM/DD/YYYY"},"MM/DD/YYYY",-1),o("option",{value:"DD/MM/YYYY"},"DD/MM/YYYY",-1),o("option",{value:"YYYY-MM-DD"},"YYYY-MM-DD",-1)])],512),[[ye,t.profileData.dateFormat]])]),o("div",_r,[e[49]||(e[49]=o("label",{for:"booksApiProvider"},"Books API Provider",-1)),T(o("select",{id:"booksApiProvider","onUpdate:modelValue":e[18]||(e[18]=p=>t.profileData.booksApiProvider=p)},[...e[48]||(e[48]=[o("option",{value:"wikipedia"},"Wikipedia (Primary)",-1),o("option",{value:"google_books"},"Google Books (Fallback)",-1),o("option",{value:"both"},"Both (Wikipedia + Google Books)",-1)])],512),[[ye,t.profileData.booksApiProvider]])])]),o("div",Cr,[o("div",Dr,[e[51]||(e[51]=o("label",{for:"enableGoogleBooksFallback"},"Enable Google Books Fallback",-1)),o("div",Ar,[T(o("input",{type:"checkbox",id:"enableGoogleBooksFallback","onUpdate:modelValue":e[19]||(e[19]=p=>t.profileData.enableGoogleBooksFallback=p)},null,512),[[it,t.profileData.enableGoogleBooksFallback]]),e[50]||(e[50]=o("label",{for:"enableGoogleBooksFallback",class:"checkbox-label"}," Use Google Books as fallback when Wikipedia search fails ",-1))])]),e[52]||(e[52]=o("div",{class:"form-group"},null,-1))])])]),o("div",xr,[e[58]||(e[58]=o("div",{class:"section-header"},[o("h3",null,"Data Management"),o("p",null,"Manage your data and account")],-1)),o("div",Tr,[o("div",Mr,[o("button",{class:"data-btn export-btn",onClick:e[20]||(e[20]=(...p)=>t.exportData&&t.exportData(...p))},[...e[54]||(e[54]=[o("span",{class:"btn-icon"},"📦",-1),o("span",{class:"btn-text"},"Export All Data",-1),o("span",{class:"btn-description"},"Download your complete media library",-1)])]),o("button",{class:"data-btn import-btn",onClick:e[21]||(e[21]=(...p)=>t.importData&&t.importData(...p))},[...e[55]||(e[55]=[o("span",{class:"btn-icon"},"📥",-1),o("span",{class:"btn-text"},"Import Data",-1),o("span",{class:"btn-description"},"Import data from a backup file",-1)])]),o("button",{class:"data-btn backup-btn",onClick:e[22]||(e[22]=(...p)=>t.createBackup&&t.createBackup(...p))},[...e[56]||(e[56]=[o("span",{class:"btn-icon"},"💾",-1),o("span",{class:"btn-text"},"Create Backup",-1),o("span",{class:"btn-description"},"Create a local backup of your data",-1)])]),o("button",{class:"data-btn cache-btn",onClick:e[23]||(e[23]=(...p)=>t.clearCache&&t.clearCache(...p))},[...e[57]||(e[57]=[o("span",{class:"btn-icon"},"🗑️",-1),o("span",{class:"btn-text"},"Clear Cache",-1),o("span",{class:"btn-description"},"Clear temporary files and cache",-1)])])])])]),o("div",Ur,[e[61]||(e[61]=o("div",{class:"section-header"},[o("h3",null,"Danger Zone"),o("p",null,"Irreversible and destructive actions")],-1)),o("div",Pr,[o("div",Br,[o("button",{class:"danger-btn reset-btn",onClick:e[24]||(e[24]=(...p)=>t.resetSettings&&t.resetSettings(...p))},[...e[59]||(e[59]=[o("span",{class:"btn-icon"},"🔄",-1),o("span",{class:"btn-text"},"Reset All Settings",-1),o("span",{class:"btn-description"},"Reset all settings to default values",-1)])]),o("button",{class:"danger-btn clear-btn",onClick:e[25]||(e[25]=(...p)=>t.clearAllData&&t.clearAllData(...p))},[...e[60]||(e[60]=[o("span",{class:"btn-icon"},"🗑️",-1),o("span",{class:"btn-text"},"Clear All Data",-1),o("span",{class:"btn-description"},"Permanently delete all your data",-1)])])])])])])])):t.currentCategory==="statistics"?(u(),m("div",Rr,[o("div",Er,[e[62]||(e[62]=o("h1",null,"📊 Media Library Statistics",-1)),e[63]||(e[63]=o("p",null,"Übersicht über deine Media Collection",-1)),o("div",Fr,[o("button",{class:"refresh-btn",onClick:e[26]||(e[26]=(...p)=>t.loadMedia&&t.loadMedia(...p))},"🔄 Refresh Statistics")])]),o("div",Lr,[o("div",Nr,[o("div",Gr,[o("div",Wr,v(t.statistics.totalItems),1),e[64]||(e[64]=o("div",{class:"summary-label"},"Total Items",-1))]),o("div",Or,[o("div",Vr,v(t.statistics.totalCollections),1),e[65]||(e[65]=o("div",{class:"summary-label"},"Collections",-1))]),o("div",zr,[o("div",jr,v(t.statistics.totalPlaytime)+"h",1),e[66]||(e[66]=o("div",{class:"summary-label"},"Total Playtime",-1))]),o("div",Yr,[o("div",qr,v(t.statistics.avgRating),1),e[67]||(e[67]=o("div",{class:"summary-label"},"Avg Rating",-1))])]),o("div",Hr,[e[68]||(e[68]=o("h3",{class:"chart-title"},"📈 Category Distribution",-1)),o("div",Qr,[(u(!0),m(oe,null,se(t.statistics.categoryDistribution,(p,G)=>(u(),m("div",{key:G,class:"category-stat"},[o("div",Jr,v(G),1),o("div",Kr,[o("div",{class:"category-fill",style:xe({width:`${p/t.statistics.totalItems*100}%`})},null,4)]),o("div",Zr,v(p)+" ("+v((p/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),o("div",Xr,[e[69]||(e[69]=o("h3",{class:"chart-title"},"⭐ Rating Distribution",-1)),o("div",$r,[(u(!0),m(oe,null,se(t.statistics.ratingDistribution,(p,G)=>(u(),m("div",{key:G,class:"rating-stat"},[o("div",ed,v(t.getRatingStars(G)),1),o("div",td,[o("div",{class:"rating-fill",style:xe({width:`${p/t.statistics.totalItems*100}%`})},null,4)]),o("div",od,v(p)+" ("+v((p/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),o("div",sd,[e[70]||(e[70]=o("h3",{class:"chart-title"},"🎮 Platform Distribution",-1)),o("div",ad,[(u(!0),m(oe,null,se(t.statistics.platformDistribution,(p,G)=>(u(),m("div",{key:G,class:"platform-stat"},[o("div",id,v(G),1),o("div",nd,[o("div",{class:"platform-fill",style:xe({width:`${p/t.statistics.totalItems*100}%`})},null,4)]),o("div",ld,v(p)+" ("+v((p/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),o("div",rd,[e[71]||(e[71]=o("h3",{class:"chart-title"},"🎭 Top Genres",-1)),o("div",dd,[(u(!0),m(oe,null,se(t.statistics.genreDistribution,(p,G)=>(u(),m("div",{key:G,class:"genre-stat"},[o("div",cd,v(G),1),o("div",ud,[o("div",{class:"genre-fill",style:xe({width:`${p/t.statistics.totalItems*100}%`})},null,4)]),o("div",gd,v(p)+" ("+v((p/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),o("div",md,[e[72]||(e[72]=o("h3",{class:"chart-title"},"📅 Recent Activity",-1)),o("div",fd,[(u(!0),m(oe,null,se(t.statistics.recentActivity,p=>(u(),m("div",{key:p.title,class:"activity-item"},[o("div",pd,v(p.title),1),o("div",vd,v(p.category),1),o("div",hd,v(t.formatDate(p.discovered)),1)]))),128))])]),o("div",yd,[e[73]||(e[73]=o("h3",{class:"chart-title"},"📺 Currently Airing Series",-1)),o("div",bd,[(u(!0),m(oe,null,se(t.statistics.airingSeries,p=>(u(),m("div",{key:p.title,class:"airing-item"},[o("div",kd,v(p.title),1),o("div",wd,"Next: Season "+v(p.nextSeason),1),o("div",Sd,v(p.nextSeasonRelease?t.formatDate(p.nextSeasonRelease):"TBA"),1)]))),128))])])])])):(u(),m("div",Id,[(u(!0),m(oe,null,se(t.paginatedMedia,p=>(u(),De(d,{key:p.id,item:p,onEdit:t.editItem},null,8,["item","onEdit"]))),128))]))]))])]),t.isLoggedIn?k("",!0):(u(),m("div",_d,[o("button",{onClick:e[27]||(e[27]=(...p)=>t.handleAdminSetup&&t.handleAdminSetup(...p)),disabled:t.adminSetupLoading,class:"admin-setup-btn",title:"Setup Admin Account (Creates admin account with default password)"},[t.adminSetupLoading?(u(),m("span",Dd,"🔧 Setting up...")):(u(),m("span",Ad,"🔧 Admin Setup"))],8,Cd),t.adminSetupMessage?(u(),m("div",{key:0,class:Q(["admin-setup-message",t.adminSetupMessage.type])},v(t.adminSetupMessage.text),3)):k("",!0)])),t.showLoginModal?(u(),De(x,{key:1,onClose:e[28]||(e[28]=p=>t.showLoginModal=!1),onSuccess:t.handleLoginSuccess,onSwitchToRegister:t.switchToRegister},null,8,["onSuccess","onSwitchToRegister"])):k("",!0),t.showRegisterModal?(u(),De(D,{key:2,onClose:e[29]||(e[29]=p=>t.showRegisterModal=!1),onSuccess:t.handleRegisterSuccess},null,8,["onSuccess"])):k("",!0),t.showEditModal?(u(),De(A,{key:3,item:t.editingItem,"current-category":t.currentCategory,onClose:t.closeEditModal,onSave:t.handleSaveItem,onDelete:t.handleDeleteItem},null,8,["item","current-category","onClose","onSave","onDelete"])):k("",!0),he(w,{show:t.showBulkAddModal,"current-category":t.currentCategory,onClose:t.closeBulkAddModal},null,8,["show","current-category","onClose"]),he(V,{show:t.showTxtImportModal,onClose:e[30]||(e[30]=p=>t.showTxtImportModal=!1),onFileProcessed:t.processTxtContent},null,8,["show","onFileProcessed"]),he(Z,{show:t.showTxtImportResults,results:t.txtImportResults,onClose:t.closeTxtImportResults},null,8,["show","results","onClose"]),he(Y,{"show-menu":t.showFloatingMenu,"show-delete-all":t.isLoggedIn&&t.currentCategory!=="all"&&t.categoryCounts[t.currentCategory]>0,"category-name":t.currentCategoryDisplayName,"item-count":t.categoryCounts[t.currentCategory]||0,onToggleMenu:t.toggleFloatingMenu,onAddNewItem:t.addNewItem,onBulkAddItems:t.bulkAddItems,onImportFromTxt:t.importFromTxt,onImportFromApi:t.importFromAPI,onCreateCollection:t.createCollection,onDeleteAllInCategory:t.deleteAllInCategory},null,8,["show-menu","show-delete-all","category-name","item-count","onToggleMenu","onAddNewItem","onBulkAddItems","onImportFromTxt","onImportFromApi","onCreateCollection","onDeleteAllInCategory"]),he(ne,{show:t.messageStore.show,type:t.messageStore.type,title:t.messageStore.title,message:t.messageStore.message,details:t.messageStore.details,onClose:t.messageStore.closeMessage},null,8,["show","type","title","message","details","onClose"]),he(ge,{show:t.confirmStore.show,title:t.confirmStore.title,message:t.confirmStore.message,onConfirm:t.confirmStore.confirm,onClose:t.confirmStore.cancel},null,8,["show","title","message","onConfirm","onClose"]),he(de,{show:t.inputStore.show,title:t.inputStore.title,message:t.inputStore.message,placeholder:t.inputStore.placeholder,"input-type":t.inputStore.inputType,"default-value":t.inputStore.defaultValue,onConfirm:t.inputStore.confirm,onClose:t.inputStore.cancel},null,8,["show","title","message","placeholder","input-type","default-value","onConfirm","onClose"])])}const Md=ee(Sl,[["render",xd],["__scopeId","data-v-546287fa"]]);export{Md as default};
