import{A as Ht,d as Le,r as S,w as De,c as F,m as ne,u as Qt,a as ze,_ as ee,b as f,e as s,f as b,F as X,g as $,t as h,n as j,o as g,h as Te,i as de,j as ye,k as ae,l as Ue,p as Fe,q as Pe,s as D,v as T,x as ct,y as be,z as ut,B as Re,C as Jt,D as Kt,E as Zt,G as Xt}from"./index-CDE_v922.js";class $t{constructor(){this.isConnected={value:!1},this.listeners=new Map,this.pollingInterval=null,this.lastUpdate=null,this.pollingIntervalMs=2e4}getApiBaseUrl(){return Ht.BASE_URL}connect(){if(this.pollingInterval)return;const e=localStorage.getItem("authToken"),o=localStorage.getItem("currentUser");!e||!o||(this.isConnected.value=!0,this.lastUpdate=new Date,this.pollingInterval=setInterval(()=>{this.checkForUpdates()},this.pollingIntervalMs))}async checkForUpdates(){try{const e=localStorage.getItem("authToken"),o=localStorage.getItem("currentUser");if(!e||!o)return;const t=this.getApiBaseUrl(),n=await fetch(`${t}/api/media`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!n.ok){if(n.status===401){this.disconnect();return}throw new Error(`HTTP error! status: ${n.status}`)}const c=await n.json();c&&c.length>0&&this.listeners.forEach((l,r)=>{try{l({type:"media_updated",items:c,count:c.length,timestamp:new Date().toISOString()})}catch{}}),this.lastUpdate=new Date}catch{}}addListener(e,o){this.listeners.set(e,o)}removeListener(e){this.listeners.delete(e)}disconnect(){this.pollingInterval&&(clearInterval(this.pollingInterval),this.pollingInterval=null),this.isConnected.value=!1}destroy(){this.disconnect(),this.listeners.clear()}}const Xe=new $t,Ye=Le("media",()=>{const i=()=>{try{return localStorage.getItem("currentCategory")||"game"}catch(a){return console.error("Failed to load current category from localStorage:",a),"game"}},e=a=>{try{localStorage.setItem("currentCategory",a)}catch(u){console.error("Failed to save current category to localStorage:",u)}},o=()=>{try{return localStorage.getItem("searchQuery")||""}catch(a){return console.error("Failed to load search query from localStorage:",a),""}},t=a=>{try{localStorage.setItem("searchQuery",a)}catch(u){console.error("Failed to save search query to localStorage:",u)}},n=S(m()),c=S(i()),l=S(o()),r=S(null),p=S([]),I=S(!1),A=S(null),C=S(!1);De(c,a=>{e(a)},{immediate:!1}),De(l,a=>{t(a)},{immediate:!1});function m(){try{const a=localStorage.getItem("authToken"),u=localStorage.getItem("currentUser");if(!a||!u){const _=localStorage.getItem("mediaData");return _?JSON.parse(_):[]}return[]}catch(a){return console.error("Failed to load media from storage:",a),[]}}function k(){try{const a=localStorage.getItem("authToken"),u=localStorage.getItem("currentUser");(!a||!u)&&localStorage.setItem("mediaData",JSON.stringify(n.value))}catch(a){console.error("Failed to save media to storage:",a)}}const H=F(()=>n.value.length),te=F(()=>{const a={};return n.value.forEach(u=>{const _=u.category||"unknown";a[_]=(a[_]||0)+1}),a}),O=F(()=>{let a=[...n.value];if(c.value&&c.value!=="all"&&(a=a.filter(u=>c.value==="watchlist"?u.category==="watchlist"||u.isNew===!0:u.category===c.value)),p.value&&p.value.length>0&&(a=a.filter(u=>{if(!u.genre)return!1;const _=u.genre.split(",").map(d=>d.trim().toLowerCase());return p.value.some(d=>_.some(y=>y.includes(d.toLowerCase())))})),l.value){const u=l.value.toLowerCase();a=a.filter(_=>{var d,y,R,ge;return((d=_.title)==null?void 0:d.toLowerCase().includes(u))||((y=_.description)==null?void 0:y.toLowerCase().includes(u))||((R=_.genre)==null?void 0:R.toLowerCase().includes(u))||((ge=_.platforms)==null?void 0:ge.toLowerCase().includes(u))})}return a});async function Q(){var a,u;I.value=!0,A.value=null;try{const _=localStorage.getItem("authToken"),d=localStorage.getItem("currentUser");if(_&&d)try{const y=await ne.getMedia();n.value=y||[]}catch(y){console.warn("API load failed for logged in user:",y),n.value=[]}else{const y=m();if(y.length>0)n.value=y;else{const R=await ne.getMedia();n.value=R||[],k()}}}catch(_){A.value=((u=(a=_.response)==null?void 0:a.data)==null?void 0:u.message)||_.message||"Failed to load media data",console.error("Failed to load media:",_)}finally{I.value=!1}}function ce(a){c.value=a}function me(a){l.value=a}function v(a){r.value=a}function N(){r.value=null}function re(a){p.value=a}function ie(){p.value=[]}function Se(){C.value=!C.value}function fe(a){C.value=a}async function _e(a,u){try{const _=localStorage.getItem("authToken"),d=localStorage.getItem("currentUser");if(_&&d)try{await ne.updateMediaItem(a,{personal_rating:u});const y=n.value.findIndex(R=>R.id===a);return y!==-1&&(n.value[y].personal_rating=u),!0}catch(y){throw console.error("API rating update failed:",y),y}else{const y=n.value.findIndex(R=>R.id===a);if(y!==-1)return n.value[y].personal_rating=u,k(),!0;throw new Error("Media item not found")}}catch(_){throw console.error("Failed to update rating:",_),_}}async function Ie(a,u=!1){var _,d,y;A.value=null;try{const R=localStorage.getItem("authToken"),ge=localStorage.getItem("currentUser");if(R&&ge)try{const oe=await ne.addMediaItem(a);if(!u)await Q();else{const we={...oe,__order:n.value.length};n.value.push(we)}return oe}catch(oe){if(((_=oe.response)==null?void 0:_.status)===409&&((y=(d=oe.response)==null?void 0:d.data)!=null&&y.duplicate)){const we=new Error(oe.response.data.error||"Ein Eintrag mit diesem Titel und dieser Kategorie existiert bereits.");throw we.isDuplicate=!0,we}throw A.value=oe.message||"Failed to add media item",console.error("API save failed for logged in user:",oe),oe}else{const oe={id:Date.now(),...a,__order:n.value.length};return n.value.push(oe),k(),oe}}catch(R){throw R}}async function K(a,u){A.value=null,console.log("DEBUG: updateMediaItem called with:",{id:a,itemData:u,is_airing:u.is_airing,type:typeof u.is_airing});try{const _=localStorage.getItem("authToken"),d=localStorage.getItem("currentUser");if(_&&d)try{console.log("DEBUG: Calling API updateMediaItem with:",u);const y=await ne.updateMediaItem(a,u);return console.log("DEBUG: API updateMediaItem returned:",y),await Q(),y}catch(y){throw console.error("API update failed for logged in user:",y),y}else{const y=n.value.findIndex(R=>R.id===a);if(y!==-1)return n.value[y]={...n.value[y],...u},k(),n.value[y];throw new Error("Media item not found")}}catch(_){throw _.isDuplicate||(A.value=_.message||"Failed to update media item"),_}}async function G(a){var u;try{const _=localStorage.getItem("authToken"),d=localStorage.getItem("currentUser");if(_&&d)try{return await ne.deleteMediaItem(a),await Q(),!0}catch(y){if(((u=y.response)==null?void 0:u.status)===404||y.isNotFound)return await Q(),!0;throw console.error("API delete failed for logged in user:",y),y}else{const y=n.value.findIndex(R=>R.id===a);if(y!==-1)return n.value.splice(y,1),k(),!0;throw new Error("Media item not found")}}catch(_){throw A.value=_.message||"Failed to delete media item",_}}async function z(a){try{const u=localStorage.getItem("authToken"),_=localStorage.getItem("currentUser");if(u&&_)try{const d=await ne.batchAddMediaItems(a);return await Q(),d}catch(d){throw console.error("API batch add failed for logged in user:",d),d}else{const d=a.map((y,R)=>({id:Date.now()+R,...y,__order:n.value.length+R}));return n.value.push(...d),k(),{success:!0,stats:{created:d.length,failed:0,errors:[]}}}}catch(u){throw A.value=u.message||"Failed to add media items",u}}async function q(a){try{const u=localStorage.getItem("authToken"),_=localStorage.getItem("currentUser");if(u&&_)try{return await ne.batchDeleteMediaItems(a),await Q(),!0}catch(d){if(d.silent)return console.log("Silent batch delete error (some items may not exist):",d.message),await Q(),!0;throw console.error("API batch delete failed for logged in user:",d),d}else return n.value=n.value.filter(d=>!a.includes(d.id)),k(),!0}catch(u){throw u.silent||(A.value=u.message||"Failed to delete media items"),u}}async function pe(){try{const a=localStorage.getItem("authToken"),u=localStorage.getItem("currentUser");a&&u?await ne.saveMedia(n.value):k()}catch(a){console.error("Failed to save media:",a)}}function ve(){A.value=null}function ue(a){if(console.log("Processing real-time update:",a),a.type==="media_updated"&&a.items)a.items.forEach(u=>{const _=n.value.findIndex(d=>d.id===u.id);_!==-1?n.value[_]={...n.value[_],...u}:n.value.push(u)});else if(a.action==="created"||a.action==="updated"){const u=a.item,_=n.value.findIndex(d=>d.id===u.id);_!==-1?n.value[_]={...n.value[_],...u}:n.value.push(u)}else if(a.action==="deleted"){const u=n.value.findIndex(_=>_.id===a.id);u!==-1&&n.value.splice(u,1)}k()}function ke(){const a=localStorage.getItem("authToken"),u=localStorage.getItem("currentUser");if(!a||!u){console.log("Skipping realtime initialization - user not authenticated");return}try{Xe.addListener("media-store",ue),Xe.connect()}catch(_){console.error("Failed to initialize realtime updates:",_)}}function Ce(){Xe.removeListener("media-store")}return{mediaData:n,currentCategory:c,searchQuery:l,selectedGenre:r,selectedGenres:p,loading:I,error:A,editMode:C,totalItems:H,categoryCounts:te,filteredMedia:O,loadMedia:Q,setCategory:ce,setSearchQuery:me,setGenre:v,clearGenre:N,setGenres:re,clearGenres:ie,toggleEditMode:Se,setEditMode:fe,updateItemRating:_e,addMediaItem:Ie,updateMediaItem:K,deleteMediaItem:G,batchAddMediaItems:z,batchDeleteMediaItems:q,saveMedia:pe,clearError:ve,initializeRealtimeUpdates:ke,cleanupRealtimeUpdates:Ce,resetMediaState:()=>{c.value="game",l.value="",localStorage.removeItem("currentCategory"),localStorage.removeItem("searchQuery")}}}),gt=Le("message",()=>{const i=S(!1),e=S("info"),o=S(""),t=S(""),n=S("");function c(C){e.value=C.type||"info",o.value=C.title||"",t.value=C.message||"",n.value=C.details||"",i.value=!0}function l(C,m="Success",k=""){c({type:"success",title:m,message:C,details:k})}function r(C,m="Error",k=""){c({type:"error",title:m,message:C,details:k})}function p(C,m="Warning",k=""){c({type:"warning",title:m,message:C,details:k})}function I(C,m="Info",k=""){c({type:"info",title:m,message:C,details:k})}function A(){i.value=!1,setTimeout(()=>{e.value="info",o.value="",t.value="",n.value=""},300)}return{show:i,type:e,title:o,message:t,details:n,showMessage:c,showSuccess:l,showError:r,showWarning:p,showInfo:I,closeMessage:A}}),mt=Le("confirm",()=>{const i=S(!1),e=S("Confirm Action"),o=S(""),t=S(null);function n(r){return new Promise(p=>{e.value=r.title||"Confirm Action",o.value=r.message||"",i.value=!0,t.value=p})}function c(){t.value&&(t.value(!0),t.value=null),i.value=!1}function l(){t.value&&(t.value(!1),t.value=null),i.value=!1}return{show:i,title:e,message:o,showConfirm:n,confirm:c,cancel:l}}),ft=Le("input",()=>{const i=S(!1),e=S("Input Required"),o=S(""),t=S(""),n=S("text"),c=S(""),l=S(null);function r(A){return new Promise(C=>{e.value=A.title||"Input Required",o.value=A.message||"",t.value=A.placeholder||"",n.value=A.inputType||"text",c.value=A.defaultValue||"",i.value=!0,l.value=C})}function p(A){l.value&&(l.value(A),l.value=null),i.value=!1}function I(){l.value&&(l.value(null),l.value=null),i.value=!1}return{show:i,title:e,message:o,placeholder:t,inputType:n,defaultValue:c,showInput:r,confirm:p,cancel:I}}),pt=Le("sidebar",()=>{const i=()=>{try{const k=localStorage.getItem("sidebarState");if(k)return{collapsed:JSON.parse(k).collapsed||!1,mobileOpen:!1}}catch(k){console.error("Failed to load sidebar state from localStorage:",k)}return{collapsed:!1,mobileOpen:!1}},e=k=>{try{localStorage.setItem("sidebarState",JSON.stringify({collapsed:k.collapsed}))}catch(H){console.error("Failed to save sidebar state to localStorage:",H)}},o=i(),t=S(o.collapsed),n=S(o.mobileOpen);De(t,k=>{e({collapsed:k,mobileOpen:n.value})},{immediate:!1});const c=()=>{t.value=!t.value},l=()=>{n.value=!n.value},r=()=>{n.value=!1},p=k=>{t.value=k},I=k=>{n.value=k},A=()=>{t.value=!1,n.value=!1,localStorage.removeItem("sidebarState")},C=F(()=>t.value),m=F(()=>n.value);return{collapsed:t,mobileOpen:n,toggleSidebar:c,toggleMobileSidebar:l,closeMobileSidebar:r,setCollapsed:p,setMobileOpen:I,resetSidebarState:A,isCollapsed:C,isMobileOpen:m}});function es(){const i=Qt(),e=ze(),o=Ye(),t=gt(),n=mt(),c=ft(),l=S(!1),r=S(!1),p=S(!1),I=S(!1),A=S(!1),C=S(!1),m=S(!1),k=S(null),H=()=>typeof window<"u"?window.innerWidth>768?8:3:8,te=S(H()),O=S("order_asc"),Q=S(null),ce=()=>{te.value=H()};typeof window<"u"&&window.addEventListener("resize",ce);const me=[{key:"game",name:"Games",icon:"🎮"},{key:"series",name:"Series",icon:"📺"},{key:"movie",name:"Movies",icon:"🎬"},{key:"buecher",name:"Bücher",icon:"📚"},{key:"watchlist",name:"Watchlist",icon:"❤️"}],v=F(()=>{try{return e.isLoggedIn}catch(x){return console.error("Error accessing authStore.isLoggedIn:",x),!1}}),N=F(()=>{try{return e.userName}catch(x){return console.error("Error accessing authStore.userName:",x),""}}),re=F(()=>{try{return e.isAdmin}catch(x){return console.error("Error accessing authStore.isAdmin:",x),!1}}),ie=F(()=>{try{return o.currentCategory}catch(x){return console.error("Error accessing mediaStore.currentCategory:",x),"game"}}),Se=F({get:()=>{try{return o.searchQuery}catch(x){return console.error("Error accessing mediaStore.searchQuery:",x),""}},set:x=>{try{o.setSearchQuery(x)}catch(U){console.error("Error setting mediaStore.searchQuery:",U)}}}),fe=F(()=>{try{return o.categoryCounts}catch(x){return console.error("Error accessing mediaStore.categoryCounts:",x),{}}}),_e=F(()=>{try{return o.loading}catch(x){return console.error("Error accessing mediaStore.loading:",x),!1}}),Ie=F(()=>{try{return o.error}catch(x){return console.error("Error accessing mediaStore.error:",x),null}}),K=F(()=>{try{const x=[...o.filteredMedia||[]],[U,J]=O.value.split("_");return x.sort((E,L)=>{let se=E[U],V=L[U];return U==="order"?(se=E.__order||0,V=L.__order||0):U==="airing"?(se=E.isAiring?1:0,V=L.isAiring?1:0):U==="api_rating"?(se=E.api_rating||E.rating||0,V=L.api_rating||L.rating||0):U==="personal_rating"&&(se=E.personal_rating||0,V=L.personal_rating||0),typeof se=="string"&&(se=se.toLowerCase(),V=V.toLowerCase()),J==="asc"?se>V?1:-1:se<V?1:-1})}catch(x){return console.error("Error in sortedMedia computed:",x),[]}}),G=F(()=>K.value),z=x=>{o.setCategory(x),pt().closeMobileSidebar()},q=()=>{o.setSearchQuery("")},pe=x=>{k.value=x,p.value=!0},ve=()=>{p.value=!1,k.value=null},ue=()=>{A.value=!1},ke=async x=>{console.log("handleBulkAddItems called but not used in new workflow")},Ce=async x=>{k.value?await o.updateMediaItem(k.value.id,x):await o.addMediaItem(x),ve()},le=async x=>{var U;try{await o.deleteMediaItem(x.id)}catch(J){((U=J.response)==null?void 0:U.status)!==404&&!J.silent&&(console.error("Delete failed:",J),t.showError("Failed to delete item: "+(J.message||"Unknown error"),"Delete Failed"))}},a=async()=>{await e.logout(),await u()},u=async()=>{try{await o.loadMedia()}catch(x){console.error("Error loading media:",x)}},_=()=>{I.value=!I.value},d=()=>{if(I.value=!1,!v.value){t.showWarning("Bitte loggen Sie sich ein, um neue Items hinzuzufügen.","Login erforderlich");return}k.value=null,p.value=!0},y=()=>{if(I.value=!1,!v.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}A.value=!0},R=()=>{if(I.value=!1,!v.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}C.value=!0},ge=()=>{if(I.value=!1,!v.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}t.showInfo("API Import feature coming soon!","Feature in Entwicklung")},oe=()=>{if(I.value=!1,!v.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}Ne()},we=x=>{if(!x)return"Unknown";const U=me.find(J=>J.key===x);return U?U.name:x},qe=async()=>{const x=we(ie.value),U=fe.value[ie.value]||0;if(U===0){t.showInfo("No items to delete in this category.","Nothing to Delete");return}const J=`Are you sure you want to delete ALL ${U} items in "${x}"?

This action cannot be undone!`;if(await n.showConfirm({title:"Delete All Items",message:J}))try{const se=((o==null?void 0:o.mediaData)||[]).filter(V=>ie.value==="watchlist"?V.category==="watchlist"||V.isNew===!0:V.category===ie.value).map(V=>V.id);await o.batchDeleteMediaItems(se),await u(),t.showSuccess(`Successfully deleted ${U} items from "${x}"`,"Items Deleted")}catch(L){console.error("Error deleting items:",L),L.silent?t.showSuccess(`Items deleted from "${x}" (some items may not have existed)`,"Items Deleted"):L.isNotFound?t.showWarning("Some items were not found and could not be deleted, but the operation completed.","Partial Success"):t.showError("Error occurred while deleting items. Please try again.","Delete Failed")}},He=x=>{const U=x.split(`
`).map(V=>V.trim()).filter(V=>V.length>0);if(U.length===0){t.showWarning("Die TXT-Datei ist leer oder enthält keine gültigen Einträge.","Leere Datei");return}const E=o.filteredMedia.map(V=>V.title.toLowerCase().trim()),L=U.filter(V=>{const Me=V.toLowerCase().trim();return!E.some(Ae=>Ae.includes(Me)||Me.includes(Ae))}),se=U.filter(V=>{const Me=V.toLowerCase().trim();return E.some(Ae=>Ae.includes(Me)||Me.includes(Ae))});Q.value={totalInFile:U.length,missingItems:L,existingItems:se,currentCategory:ie.value,categoryName:we(ie.value)},C.value=!1,m.value=!0},Qe=()=>{Q.value=null,m.value=!1},Ne=async()=>{const x=(o==null?void 0:o.mediaData)||[];if(x.length===0){t.showInfo("Keine Media Items zum Exportieren gefunden.","Nichts zu exportieren");return}const U=await c.showInput({title:"Export Format wählen",message:`1 = CSV
2 = JSON
3 = Beide

Geben Sie die Nummer ein:`,placeholder:"1",defaultValue:"1"});if(!U||!["1","2","3"].includes(U))return;const J=new Date().toISOString().split("T")[0];(U==="1"||U==="3")&&Ge(x,J),(U==="2"||U==="3")&&We(x,J),t.showSuccess(`Collection mit ${x.length} Items wurde erfolgreich exportiert!`,"Export erfolgreich")},Ge=(x,U)=>{const E=[["Titel","Kategorie","Release","Rating","Platforms","Genre","Spielzeit","Status","Beschreibung"].join(","),...x.map(L=>[`"${(L.title||"").replace(/"/g,'""')}"`,`"${(L.category||L.category_name||"Unbekannt").replace(/"/g,'""')}"`,`"${L.release||""}"`,`"${L.rating||""}"`,`"${(L.platforms||"").replace(/"/g,'""')}"`,`"${(L.genre||"").replace(/"/g,'""')}"`,`"${L.spielzeit||""}"`,`"${L.isAiring?"Airing":"Abgeschlossen"}"`,`"${(L.description||"").replace(/"/g,'""')}"`].join(","))].join(`
`);Be(E,`media_collection_${U}.csv`,"text/csv;charset=utf-8;")},We=(x,U)=>{const J={exportDate:new Date().toISOString(),totalItems:x.length,categories:[...new Set(x.map(E=>E.category||E.category_name||"Unbekannt"))],items:x.map(E=>({id:E.id,title:E.title||"",category:E.category||E.category_name||"Unbekannt",release:E.release||"",rating:E.rating||null,platforms:E.platforms||"",genre:E.genre||"",spielzeit:E.spielzeit||null,status:E.isAiring?"Airing":"Abgeschlossen",description:E.description||"",isNew:E.isNew||!1,nextSeason:E.nextSeason||null,discovered:E.discovered||null}))};Be(JSON.stringify(J,null,2),`media_collection_${U}.json`,"application/json;charset=utf-8;")},Be=(x,U,J)=>{const E=new Blob([x],{type:J}),L=document.createElement("a"),se=URL.createObjectURL(E);L.setAttribute("href",se),L.setAttribute("download",U),L.style.visibility="hidden",document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(se)};return{showLoginModal:l,showRegisterModal:r,showEditModal:p,showFloatingMenu:I,showBulkAddModal:A,showTxtImportModal:C,showTxtImportResults:m,editingItem:k,gridColumns:te,sortBy:O,categories:me,txtImportResults:Q,isLoggedIn:v,isAdmin:re,userName:N,currentCategory:ie,searchQuery:Se,categoryCounts:fe,loading:_e,error:Ie,paginatedMedia:G,setCategory:z,clearSearch:q,editItem:pe,closeEditModal:ve,closeBulkAddModal:ue,handleBulkAddItems:ke,handleSaveItem:Ce,handleDeleteItem:le,logout:a,loadMedia:u,toggleFloatingMenu:_,addNewItem:d,bulkAddItems:y,importFromTxt:R,importFromAPI:ge,createCollection:oe,exportMediaCollection:Ne,exportAsCSV:Ge,exportAsJSON:We,downloadFile:Be,deleteAllInCategory:qe,getCategoryDisplayName:we,navigateToCalendar:()=>{z("calendar")},navigateToProfile:()=>{z("profile")},navigateToAdmin:()=>{console.log("🔥 navigateToAdmin function called!"),console.log("🔥 Router object:",i),console.log("🔥 Pushing to /admin...");try{i.push("/admin"),console.log("🔥 Successfully navigated to /admin!")}catch(x){console.error("🔥 Error navigating to admin:",x)}},processTxtContent:He,closeTxtImportResults:Qe,cleanup:()=>{typeof window<"u"&&window.removeEventListener("resize",ce)},router:i}}const ts={name:"StarRating",props:{rating:{type:Number,default:0},editMode:{type:Boolean,default:!1},itemId:{type:[Number,String],required:!0}},emits:["rating-changed"],data(){return{currentRating:this.rating||0,hoverRating:0}},watch:{rating(i){this.currentRating=i||0}},methods:{handleStarClick(i){this.editMode&&(this.currentRating=i,this.showSuccessAnimation(),this.$emit("rating-changed",{itemId:this.itemId,rating:i}))},showSuccessAnimation(){const i=document.createElement("div");i.innerHTML="✓",i.style.cssText=`
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: #4CAF50;
        color: white;
        padding: 8px 12px;
        border-radius: 50%;
        font-size: 16px;
        font-weight: bold;
        z-index: 10000;
        animation: successPulse 0.6s ease-out;
        pointer-events: none;
      `;const e=document.createElement("style");e.textContent=`
        @keyframes successPulse {
          0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
          50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
          100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
        }
      `,document.head.appendChild(e),document.body.appendChild(i),setTimeout(()=>{document.body.removeChild(i),document.head.removeChild(e)},600)},handleMouseEnter(i){this.editMode&&(this.hoverRating=i)},handleMouseLeave(){this.editMode&&(this.hoverRating=0)},clearRating(){this.editMode&&(this.currentRating=0,this.$emit("rating-changed",{itemId:this.itemId,rating:0}))}}},ss={class:"stars-container"},os=["onClick","onMouseenter","disabled","title"],as={class:"star-number"},is={key:0,class:"rating-info"},ns={class:"rating-text"};function rs(i,e,o,t,n,c){return g(),f("div",{class:j(["star-rating",{"edit-mode":o.editMode}])},[s("div",ss,[(g(),f(X,null,$(10,l=>s("button",{key:l,class:j(["star",{filled:l<=n.currentRating,hover:l<=n.hoverRating,"edit-mode":o.editMode}]),onClick:r=>c.handleStarClick(l),onMouseenter:r=>c.handleMouseEnter(l),onMouseleave:e[0]||(e[0]=(...r)=>c.handleMouseLeave&&c.handleMouseLeave(...r)),disabled:!o.editMode,title:o.editMode?`Rate ${l}/10`:`Current rating: ${n.currentRating}/10`},[e[2]||(e[2]=s("span",{class:"star-icon"},"★",-1)),s("span",as,h(l),1)],42,os)),64))]),o.editMode&&n.currentRating>0?(g(),f("div",is,[s("span",ns,h(n.currentRating)+"/10",1),s("button",{class:"clear-rating",onClick:e[1]||(e[1]=(...l)=>c.clearRating&&c.clearRating(...l)),title:"Clear rating"}," ✕ ")])):b("",!0)],2)}const ls=ee(ts,[["render",rs],["__scopeId","data-v-da28a946"]]),ds={name:"MediaItem",components:{StarRating:ls},props:{item:{type:Object,required:!0},editMode:{type:Boolean,default:!1}},emits:["edit","watchlist-toggled","show-message","rating-changed"],computed:{showWatchlistTag(){return this.item.category==="watchlist"||this.item.isNew===!0},isWatchlistItem(){return this.item.category==="watchlist"||this.item.isNew===!0},isSeries(){return this.item.category==="series"||this.item.watchlist_type==="series"},isInWatchlist(){return!1},shouldShowHeartButton(){const i=this.isSeries&&this.item.is_airing;return console.log("💖 Should show heart button:",{isSeries:this.isSeries,is_airing:this.item.is_airing,shouldShow:i,item:this.item}),i}},methods:{getImageUrl(i){return i?i.startsWith("http")?i.startsWith("http://")?i.replace("http://","https://"):i:i.startsWith("/")?i:i.startsWith("storage/")?`/${i}`:`/${i}`:""},handleImageError(i){var e;i.target.style.display="none",(e=i.target.nextElementSibling)==null||e.classList.add("show")},formatDate(i){return i?new Date(i).toLocaleDateString():""},editItem(){this.editMode||this.$emit("edit",this.item)},handleRatingChanged(i){this.$emit("rating-changed",i)},openExtraLink(){this.item.extra_link&&window.open(this.item.extra_link,"_blank","noopener,noreferrer")},getStatusIcon(){switch(this.item.series_status){case"Ended":return"✅";case"Canceled":return"❌";case"In Production":return"🔧";default:return"📺"}},getDaysLeftText(){if(!this.item.next_season_release)return"";const i=new Date(this.item.next_season_release),e=new Date,o=i.getTime()-e.getTime(),t=Math.ceil(o/(1e3*3600*24));return t>0?`${t} day${t>1?"s":""} left`:t===0?"Airs today!":`Aired ${Math.abs(t)} day${Math.abs(t)>1?"s":""} ago`},handleHeartClick(){console.log("💖 Heart button clicked!"),console.log("💖 Button visible:",this.isSeries&&this.item.is_airing),console.log("💖 Series check:",this.isSeries),console.log("💖 Airing check:",this.item.is_airing),this.toggleToWatchlist()},async toggleToWatchlist(){try{console.log("💖 Toggling series to watchlist:",this.item.title),console.log("💖 Item details:",{id:this.item.id,title:this.item.title,category:this.item.category,is_airing:this.item.is_airing});const i=await ne.toggleSeriesToWatchlist(this.item.id);i.success?(console.log("💖 Watchlist toggle successful:",i),this.$emit("watchlist-toggled",{seriesId:this.item.id,action:i.action,watchlistType:i.watchlist_type,seasonInfo:i.season_info,message:i.message}),this.$emit("show-message",{type:"success",text:i.message})):(console.error("❌ Watchlist toggle failed:",i.error),this.$emit("show-message",{type:"error",text:i.error||"Failed to toggle watchlist"}))}catch(i){console.error("❌ Watchlist toggle error:",i),this.$emit("show-message",{type:"error",text:"Failed to toggle watchlist"})}},getWatchlistReleaseStatus(){if(!this.item.release)return"";const i=new Date(this.item.release),e=new Date;e.setHours(0,0,0,0),i.setHours(0,0,0,0);const o=i.getTime()-e.getTime(),t=Math.ceil(o/(1e3*3600*24));if(t>0)return t===1?"Tomorrow!":t<=7?`${t} days left`:t<=30?`${t} days left`:`${Math.ceil(t/30)} months left`;if(t===0)return"Released today!";{const n=this.getTypeTagText().toLowerCase();return n==="game"?"Unplayed yet":n==="series"||n==="movie"?"Unwatched yet":n==="buecher"?"Unread yet":"Unconsumed yet"}},getWatchlistReleaseStatusClass(){if(!this.item.release)return"";const i=new Date(this.item.release),e=new Date;e.setHours(0,0,0,0),i.setHours(0,0,0,0);const o=i.getTime()-e.getTime(),t=Math.ceil(o/(1e3*3600*24));return t>0?"countdown":t===0?"released-today":"unconsumed"},getTypeTagText(){var e,o,t;const i=this.item.watchlistType||this.item.watchlist_type;if(i)return i.charAt(0).toUpperCase()+i.slice(1);if(this.item.genre){const n=this.item.genre.toLowerCase();if(n.includes("game")||n.includes("gaming")||(e=this.item.platforms)!=null&&e.toLowerCase().includes("steam")||(o=this.item.platforms)!=null&&o.toLowerCase().includes("ps")||(t=this.item.platforms)!=null&&t.toLowerCase().includes("xbox"))return"Game";if(n.includes("series")||n.includes("tv")||n.includes("episode")||this.item.isAiring)return"Series";if(n.includes("movie")||n.includes("film")||n.includes("cinema"))return"Movie";if(n.includes("book")||n.includes("literature")||n.includes("novel")||n.includes("author"))return"Bücher"}if(this.item.platforms){const n=this.item.platforms.toLowerCase();if(n.includes("steam")||n.includes("ps")||n.includes("xbox")||n.includes("nintendo")||n.includes("pc"))return"Game";if(n.includes("netflix")||n.includes("hulu")||n.includes("disney")||n.includes("hbo"))return"Series";if(n.includes("cinema")||n.includes("theater"))return"Movie";if(n.includes("book")||n.includes("kindle")||n.includes("audible")||n.includes("author"))return"Bücher"}return"Media"},getTypeTagClass(){return`type-${this.getTypeTagText().toLowerCase()}`},getNextSeasonCountdown(){if(!this.item.nextSeasonRelease)return"";const i=new Date(this.item.nextSeasonRelease),e=new Date;e.setHours(0,0,0,0),i.setHours(0,0,0,0);const o=i.getTime()-e.getTime(),t=Math.ceil(o/(1e3*3600*24));return t>0?t===1?"Tomorrow!":t<=7?`${t} days`:t<=30?`${t} days`:`${Math.ceil(t/30)} months`:t===0?"Today!":"Released"},getCategoryClass(){var e,o;const i=((e=this.item.category)==null?void 0:e.toLowerCase())||((o=this.item.category_name)==null?void 0:o.toLowerCase());return i==="movies"||i==="movie"?"category-movies":i==="books"||i==="buecher"||i==="book"?"category-books":i==="series"||i==="tv"||i==="serie"?"category-series":i==="games"||i==="game"||i==="spiele"?"category-games":i==="watchlist"?"category-watchlist":"category-default"},getCategoryIcon(){var e;const i=(e=this.item.category)==null?void 0:e.toLowerCase();return i==="movies"||i==="movie"?"🎬":i==="books"||i==="buecher"?"📚":i==="series"||i==="tv"?"📺":i==="games"||i==="game"?"🎮":"📁"},getCategoryStyle(){var e;const i=(e=this.item.category)==null?void 0:e.toLowerCase();if(i==="games"||i==="game"){const o=this.item.rating||0;return this.getGameStyleByRating(o)}return{}},getGameStyleByRating(i){return i>=4.5?{"--game-primary":"#ffd700","--game-secondary":"#ffed4e","--game-accent":"#ff6b35","--game-glow":"0 0 20px rgba(255, 215, 0, 0.6)","--game-border":"3px solid #ffd700"}:i>=4?{"--game-primary":"#00d4ff","--game-secondary":"#e8f4fd","--game-accent":"#00ff88","--game-glow":"0 0 15px rgba(0, 212, 255, 0.5)","--game-border":"3px solid #00d4ff"}:i>=3.5?{"--game-primary":"#00ff88","--game-secondary":"#4caf50","--game-accent":"#8bc34a","--game-glow":"0 0 12px rgba(0, 255, 136, 0.4)","--game-border":"3px solid #00ff88"}:i>=3?{"--game-primary":"#ff9800","--game-secondary":"#ffc107","--game-accent":"#ff5722","--game-glow":"0 0 10px rgba(255, 152, 0, 0.3)","--game-border":"3px solid #ff9800"}:i>=2?{"--game-primary":"#ff5722","--game-secondary":"#f44336","--game-accent":"#d32f2f","--game-glow":"0 0 8px rgba(255, 87, 34, 0.3)","--game-border":"3px solid #ff5722"}:{"--game-primary":"#9e9e9e","--game-secondary":"#757575","--game-accent":"#616161","--game-glow":"0 0 5px rgba(158, 158, 158, 0.2)","--game-border":"3px solid #9e9e9e"}}}},cs={class:"media-image"},us=["src","alt"],gs={key:1,class:"no-image"},ms={class:"no-image-icon"},fs={class:"media-info"},ps={class:"media-title"},vs={key:0,class:"watchlist-tags"},hs={key:0,class:"watchlist-tag new-series"},ys={key:1,class:"watchlist-tag new-season"},bs={key:1,class:"series-info"},ks={key:0,class:"airing-status"},ws={key:1,class:"airing-status"},Ss={class:"status-badge finished"},_s={key:2,class:"next-season-info"},Is={class:"season-label"},Cs={class:"season-text"},xs={key:0,class:"season-name"},As={key:0,class:"days-left"},Ds={class:"days-text"},Ms={key:3,class:"series-stats"},Ts={key:0,class:"stat"},Rs={key:1,class:"stat"},Us={key:4,class:"networks"},Ps={class:"network-text"},Bs={class:"heart-text"},Es={key:2,class:"star-rating-overlay"};function Fs(i,e,o,t,n,c){const l=ae("StarRating");return g(),f("div",{class:j(["media-item",c.getCategoryClass()]),style:Ue(c.getCategoryStyle()),onClick:e[3]||(e[3]=(...r)=>c.editItem&&c.editItem(...r))},[s("div",cs,[o.item.image_url||o.item.path?(g(),f("img",{key:0,src:c.getImageUrl(o.item.image_url||o.item.path),alt:o.item.title,onError:e[0]||(e[0]=(...r)=>c.handleImageError&&c.handleImageError(...r))},null,40,us)):(g(),f("div",gs,[s("span",ms,h(c.getCategoryIcon()),1)]))]),s("div",fs,[s("h3",ps,h(o.item.title),1),c.isWatchlistItem&&o.item.watchlist_series_type?(g(),f("div",vs,[o.item.watchlist_series_type==="new_series"?(g(),f("span",hs," 🆕 New Series ")):o.item.watchlist_series_type==="new_season"?(g(),f("span",ys," 📺 "+h(o.item.watchlist_season_info||"New Season"),1)):b("",!0)])):b("",!0),c.isSeries?(g(),f("div",bs,[o.item.is_airing?(g(),f("div",ks,[...e[4]||(e[4]=[s("span",{class:"status-badge airing"},"🔴 Airing",-1)])])):o.item.series_status?(g(),f("div",ws,[s("span",Ss,h(c.getStatusIcon())+" "+h(o.item.series_status),1)])):b("",!0),o.item.is_airing&&o.item.next_season?(g(),f("div",_s,[s("div",Is,[e[5]||(e[5]=s("span",{class:"season-icon"},"📺",-1)),s("span",Cs,"Season "+h(o.item.next_season),1),o.item.next_season_name?(g(),f("span",xs,"- "+h(o.item.next_season_name),1)):b("",!0)]),o.item.next_season_release?(g(),f("div",As,[e[6]||(e[6]=s("span",{class:"days-icon"},"⏰",-1)),s("span",Ds,h(c.getDaysLeftText()),1)])):b("",!0)])):b("",!0),o.item.total_seasons||o.item.total_episodes?(g(),f("div",Ms,[o.item.total_seasons?(g(),f("span",Ts,[e[7]||(e[7]=s("span",{class:"stat-icon"},"📚",-1)),Te(" "+h(o.item.total_seasons)+" Season"+h(o.item.total_seasons>1?"s":""),1)])):b("",!0),o.item.total_episodes?(g(),f("span",Rs,[e[8]||(e[8]=s("span",{class:"stat-icon"},"🎬",-1)),Te(" "+h(o.item.total_episodes)+" Episode"+h(o.item.total_episodes>1?"s":""),1)])):b("",!0)])):b("",!0),o.item.networks?(g(),f("div",Us,[e[9]||(e[9]=s("span",{class:"network-icon"},"📡",-1)),s("span",Ps,h(o.item.networks),1)])):b("",!0)])):b("",!0)]),c.isSeries&&o.item.extra_link?(g(),f("div",{key:0,class:"series-extra-button",onClick:e[1]||(e[1]=de((...r)=>c.openExtraLink&&c.openExtraLink(...r),["stop"]))},[...e[10]||(e[10]=[s("span",{class:"extra-link-icon"},"🔗",-1),s("span",{class:"extra-link-text"},"Extra Link",-1)])])):b("",!0),c.shouldShowHeartButton?(g(),f("div",{key:1,class:"heart-toggle-button",onClick:e[2]||(e[2]=de((...r)=>c.handleHeartClick&&c.handleHeartClick(...r),["stop"]))},[s("span",{class:j(["heart-icon",{active:c.isInWatchlist}])},h(c.isInWatchlist?"❤️":"🤍"),3),s("span",Bs,h(c.isInWatchlist?"In Watchlist":"Add to Watchlist"),1)])):b("",!0),o.editMode?(g(),f("div",Es,[ye(l,{rating:o.item.personal_rating||0,"edit-mode":o.editMode,"item-id":o.item.id,onRatingChanged:c.handleRatingChanged},null,8,["rating","edit-mode","item-id","onRatingChanged"])])):b("",!0),e[11]||(e[11]=s("div",{class:"edit-indicator"},[s("span",{class:"edit-icon"},"✏️")],-1))],6)}const Ls=ee(ds,[["render",Fs],["__scopeId","data-v-73209eed"]]),Ns={name:"VersionInfo",data(){return{version:"1.0.0"}}},Gs={class:"version-info"},Ws={class:"version-label"};function Vs(i,e,o,t,n,c){return g(),f("div",Gs,[s("span",Ws,"Build #"+h(n.version),1)])}const Os=ee(Ns,[["render",Vs],["__scopeId","data-v-2d54e3c7"]]),js={name:"Sidebar",components:{VersionInfo:Os},props:{collapsed:{type:Boolean,default:!1},mobileOpen:{type:Boolean,default:!1},isLoggedIn:{type:Boolean,default:!1},userName:{type:String,default:""},currentCategory:{type:String,default:"watchlist"},categoryCounts:{type:Object,default:()=>({})},categories:{type:Array,default:()=>[{key:"game",name:"Games",icon:"🎮"},{key:"series",name:"Series",icon:"📺"},{key:"movie",name:"Movies",icon:"🎬"},{key:"buecher",name:"Bücher",icon:"📚"},{key:"watchlist",name:"Watchlist",icon:"❤️"}]},selectedGenres:{type:Array,default:()=>[]},genres:{type:Array,default:()=>[]},genreLoading:{type:Boolean,default:!1},genreError:{type:String,default:null}},emits:["toggle","setCategory","addItem","navigateToCalendar","navigateToProfile","showLogin","showRegister","logout","genres-updated","genres-cleared","load-genres"],computed:{showGenreSection(){return this.currentCategory&&this.currentCategory!=="statistics"&&this.currentCategory!=="calendar"&&this.currentCategory!=="profile"}},methods:{toggleGenre(i){const e=[...this.selectedGenres],o=e.indexOf(i);o>-1?e.splice(o,1):e.push(i),this.$emit("genres-updated",e)},clearGenreFilter(){this.$emit("genres-cleared")},loadGenres(){this.$emit("load-genres")}}},zs={class:"sidebar-content"},Ys={class:"sidebar-section"},qs={class:"sidebar-nav"},Hs=["onClick"],Qs={class:"nav-icon"},Js={class:"nav-text"},Ks={class:"nav-count"},Zs=["onClick","title"],Xs={key:0,class:"sidebar-section"},$s={key:0,class:"genre-loading"},eo={key:1,class:"genre-error"},to={key:2,class:"genre-empty"},so={key:3,class:"genre-list"},oo=["title"],ao={class:"genre-checkbox-label"},io=["value","checked","onChange"],no={class:"genre-checkbox-text"},ro={class:"genre-name"},lo={class:"genre-count"},co={class:"sidebar-section"},uo={key:0,class:"auth-buttons"},go={key:1,class:"user-info"},mo={class:"user-profile"},fo={class:"profile-details"},po={class:"user-name"};function vo(i,e,o,t,n,c){const l=ae("VersionInfo");return g(),f("aside",{id:"sidebar",class:j(["sidebar",{collapsed:o.collapsed,open:o.mobileOpen}])},[s("div",{class:"sidebar-header",onClick:e[0]||(e[0]=r=>i.$emit("toggle"))},[...e[10]||(e[10]=[s("h2",null,"Media Library",-1),s("button",{class:"sidebar-toggle"},"☰",-1)])]),s("div",zs,[s("div",Ys,[e[15]||(e[15]=s("h3",null,"Browse",-1)),s("nav",qs,[(g(!0),f(X,null,$(o.categories,r=>(g(),f("div",{key:r.key,class:"nav-item"},[s("button",{class:j(["nav-btn",{active:o.currentCategory===r.key}]),onClick:p=>i.$emit("setCategory",r.key)},[s("span",Qs,h(r.icon),1),s("span",Js,h(r.name),1),s("span",Ks,h(o.categoryCounts[r.key]||0),1)],10,Hs),s("button",{class:"add-btn",onClick:p=>i.$emit("addItem",r.key),title:`Add ${r.name}`},[...e[11]||(e[11]=[s("span",{class:"add-icon"},"+",-1)])],8,Zs)]))),128)),s("button",{class:j(["nav-btn",{active:o.currentCategory==="statistics"}]),onClick:e[1]||(e[1]=r=>i.$emit("setCategory","statistics"))},[...e[12]||(e[12]=[s("span",{class:"nav-icon"},"📊",-1),s("span",{class:"nav-text"},"Statistics",-1)])],2),s("button",{class:j(["nav-btn",{active:o.currentCategory==="calendar"}]),onClick:e[2]||(e[2]=r=>i.$emit("setCategory","calendar"))},[...e[13]||(e[13]=[s("span",{class:"nav-icon"},"📅",-1),s("span",{class:"nav-text"},"Calendar",-1)])],2),s("button",{class:j(["nav-btn",{active:o.currentCategory==="profile"}]),onClick:e[3]||(e[3]=r=>i.$emit("setCategory","profile"))},[...e[14]||(e[14]=[s("span",{class:"nav-icon"},"👤",-1),s("span",{class:"nav-text"},"Profile",-1)])],2)])]),c.showGenreSection?(g(),f("div",Xs,[e[19]||(e[19]=s("h3",null,"Genres",-1)),o.genreLoading?(g(),f("div",$s,[...e[16]||(e[16]=[s("div",{class:"loading-spinner"},null,-1),s("span",null,"Loading genres...",-1)])])):o.genreError?(g(),f("div",eo,[e[17]||(e[17]=s("span",null,"Failed to load genres",-1)),s("button",{onClick:e[4]||(e[4]=(...r)=>c.loadGenres&&c.loadGenres(...r)),class:"retry-btn"},"Retry")])):o.genres.length===0?(g(),f("div",to,[...e[18]||(e[18]=[s("span",null,"No genres available",-1)])])):(g(),f("div",so,[(g(!0),f(X,null,$(o.genres,r=>(g(),f("div",{key:r.name,class:"genre-checkbox-item",title:`${r.name} (${r.count} items)`},[s("label",ao,[s("input",{type:"checkbox",value:r.name,checked:o.selectedGenres.includes(r.name),onChange:p=>c.toggleGenre(r.name),class:"genre-checkbox"},null,40,io),s("span",no,[s("span",ro,h(r.name),1),s("span",lo,h(r.count),1)])])],8,oo))),128)),o.selectedGenres.length>0?(g(),f("button",{key:0,class:"clear-genre-btn",onClick:e[5]||(e[5]=(...r)=>c.clearGenreFilter&&c.clearGenreFilter(...r)),title:"Clear all genre filters"}," Clear All Filters ("+h(o.selectedGenres.length)+") ",1)):b("",!0)]))])):b("",!0),s("div",co,[e[21]||(e[21]=s("h3",null,"Account",-1)),o.isLoggedIn?(g(),f("div",go,[s("div",mo,[e[20]||(e[20]=s("div",{class:"profile-avatar"},[s("span",{class:"avatar-text"},"👤")],-1)),s("div",fo,[s("span",po,h(o.userName),1)]),s("button",{class:"account-btn",onClick:e[8]||(e[8]=r=>i.$emit("navigateToProfile"))},"⚙️")]),s("button",{class:"auth-btn",onClick:e[9]||(e[9]=r=>i.$emit("logout"))},"Logout")])):(g(),f("div",uo,[s("button",{class:"auth-btn",onClick:e[6]||(e[6]=r=>i.$emit("showLogin"))},"Login"),s("button",{class:"auth-btn",onClick:e[7]||(e[7]=r=>i.$emit("showRegister"))},"Register")]))])]),ye(l)],2)}const ho=ee(js,[["render",vo],["__scopeId","data-v-23b04853"]]),yo={name:"MainHeader",props:{searchQuery:{type:String,default:""},sortBy:{type:String,default:"order_asc"},editMode:{type:Boolean,default:!1}},emits:["update:searchQuery","update:sortBy","toggleMobileSidebar","clearSearch","toggleEditMode"]},bo={class:"main-header"},ko={class:"header-left"},wo={class:"header-center"},So={class:"search-container"},_o=["value"],Io={class:"header-right"},Co={class:"edit-mode-container"},xo=["title"],Ao={class:"edit-icon"},Do={class:"edit-text"},Mo={class:"sort-container"},To=["value"];function Ro(i,e,o,t,n,c){return g(),f("header",bo,[s("div",ko,[s("button",{class:"mobile-sidebar-toggle",onClick:e[0]||(e[0]=l=>i.$emit("toggleMobileSidebar"))},"☰")]),s("div",wo,[s("div",So,[s("input",{type:"text",value:o.searchQuery,onInput:e[1]||(e[1]=l=>i.$emit("update:searchQuery",l.target.value)),placeholder:"Search..."},null,40,_o),s("button",{class:"search-clear",onClick:e[2]||(e[2]=l=>i.$emit("clearSearch"))},"×")])]),s("div",Io,[s("div",Co,[s("button",{class:j(["edit-mode-toggle",{active:o.editMode}]),onClick:e[3]||(e[3]=l=>i.$emit("toggleEditMode")),title:o.editMode?"Exit Edit Mode":"Enter Edit Mode"},[s("span",Ao,h(o.editMode?"✓":"✏️"),1),s("span",Do,h(o.editMode?"Done":"Edit"),1)],10,xo)]),s("div",Mo,[s("select",{value:o.sortBy,onChange:e[4]||(e[4]=l=>i.$emit("update:sortBy",l.target.value))},[...e[5]||(e[5]=[Fe('<option value="order_asc" data-v-e88ee4fe>Original order ↑</option><option value="order_desc" data-v-e88ee4fe>Original order ↓</option><option value="title_asc" data-v-e88ee4fe>Title A-Z</option><option value="title_desc" data-v-e88ee4fe>Title Z-A</option><option value="release_asc" data-v-e88ee4fe>Release ↑</option><option value="release_desc" data-v-e88ee4fe>Release ↓</option><option value="api_rating_asc" data-v-e88ee4fe>API Rating ↑</option><option value="api_rating_desc" data-v-e88ee4fe>API Rating ↓</option><option value="personal_rating_asc" data-v-e88ee4fe>Personal Rating ↑</option><option value="personal_rating_desc" data-v-e88ee4fe>Personal Rating ↓</option><option value="airing_desc" data-v-e88ee4fe>Airing first</option><option value="airing_asc" data-v-e88ee4fe>Finished first</option>',12)])],40,To)])])])}const Uo=ee(yo,[["render",Ro],["__scopeId","data-v-e88ee4fe"]]),Po={name:"FloatingActionButton",props:{showMenu:{type:Boolean,default:!1},showDeleteAll:{type:Boolean,default:!1},categoryName:{type:String,default:""},itemCount:{type:Number,default:0}},emits:["toggleMenu","addNewItem","bulkAddItems","importFromTxt","importFromAPI","createCollection","deleteAllInCategory"]},Bo={class:"floating-actions"},Eo={class:"menu-text"},Fo={class:"item-count-badge"};function Lo(i,e,o,t,n,c){return g(),f("div",Bo,[s("div",{class:j(["floating-menu",{show:o.showMenu}])},[s("button",{class:"floating-menu-item",onClick:e[0]||(e[0]=l=>i.$emit("addNewItem"))},[...e[7]||(e[7]=[s("span",{class:"menu-icon"},"➕",-1),s("span",{class:"menu-text"},"Add Item",-1)])]),s("button",{class:"floating-menu-item",onClick:e[1]||(e[1]=l=>i.$emit("bulkAddItems"))},[...e[8]||(e[8]=[s("span",{class:"menu-icon"},"📦",-1),s("span",{class:"menu-text"},"Bulk Add",-1)])]),s("button",{class:"floating-menu-item",onClick:e[2]||(e[2]=l=>i.$emit("importFromTxt"))},[...e[9]||(e[9]=[s("span",{class:"menu-icon"},"📄",-1),s("span",{class:"menu-text"},"Import from TXT",-1)])]),s("button",{class:"floating-menu-item",onClick:e[3]||(e[3]=l=>i.$emit("importFromAPI"))},[...e[10]||(e[10]=[s("span",{class:"menu-icon"},"🌐",-1),s("span",{class:"menu-text"},"Import from API",-1)])]),s("button",{class:"floating-menu-item",onClick:e[4]||(e[4]=l=>i.$emit("createCollection"))},[...e[11]||(e[11]=[s("span",{class:"menu-icon"},"📚",-1),s("span",{class:"menu-text"},"Create Collection",-1)])]),o.showDeleteAll&&o.itemCount>0?(g(),f("button",{key:0,class:"floating-menu-item delete-all-item",onClick:e[5]||(e[5]=l=>i.$emit("deleteAllInCategory"))},[e[12]||(e[12]=s("span",{class:"menu-icon"},"🗑️",-1)),s("span",Eo,"Delete All "+h(o.categoryName),1),s("span",Fo,"("+h(o.itemCount)+")",1)])):b("",!0)],2),s("button",{class:"floating-add-btn",onClick:e[6]||(e[6]=l=>i.$emit("toggleMenu"))},h(o.showMenu?"✕":"+"),1)])}const No=ee(Po,[["render",Lo],["__scopeId","data-v-f77e6366"]]),Go={name:"LoginModal",emits:["close","success"],setup(i,{emit:e}){const o=ze(),t=Pe({email:"",password:""}),n=S(!1),c=S("");return{form:t,loading:n,error:c,handleLogin:async()=>{n.value=!0,c.value="";try{const C=await o.login(t.email,t.password);C.success?e("success",C):c.value=C.error}catch(C){c.value=C.message||"Login failed"}finally{n.value=!1}},closeModal:()=>{e("close")},checkLocalDB:async()=>{try{const m=await(await fetch("http://127.0.0.1:8000/api/check-db")).json();alert(`Local DB: ${m.success?"✅ Connected":"❌ Error"}
Users: ${m.user_count}
Error: ${m.error||"None"}`)}catch(C){alert(`Local DB Check Failed: ${C.message}`)}},checkProdDB:async()=>{try{const C=window.location.origin,k=await(await fetch(`${C}/api/check-db`)).json();alert(`Prod DB: ${k.success?"✅ Connected":"❌ Error"}
Users: ${k.user_count}
Error: ${k.error||"None"}`)}catch(C){alert(`Prod DB Check Failed: ${C.message}`)}},deleteAllUsers:async()=>{if(confirm("⚠️ WARNING: This will delete ALL users! Are you sure?"))try{const C=window.location.origin,k=await(await fetch(`${C}/api/delete-all-users`,{method:"POST",headers:{"Content-Type":"application/json"}})).json();alert(`Delete Result: ${k.success?"✅ Success":"❌ Error"}
Deleted: ${k.deleted_count} users
Error: ${k.error||"None"}`)}catch(C){alert(`Delete Failed: ${C.message}`)}}}}},Wo={class:"form-group"},Vo=["disabled"],Oo={class:"form-group"},jo=["disabled"],zo={key:0,class:"error-message"},Yo={class:"modal-buttons"},qo=["disabled"],Ho=["disabled"];function Qo(i,e,o,t,n,c){return g(),f("div",{class:"modal",onClick:e[5]||(e[5]=(...l)=>t.closeModal&&t.closeModal(...l))},[s("div",{class:"modal-content auth-modal",onClick:e[4]||(e[4]=de(()=>{},["stop"]))},[e[8]||(e[8]=s("h2",null,"Login",-1)),s("form",{onSubmit:e[3]||(e[3]=de((...l)=>t.handleLogin&&t.handleLogin(...l),["prevent"]))},[s("div",Wo,[e[6]||(e[6]=s("label",{for:"email"},"Email:",-1)),D(s("input",{type:"email",id:"email","onUpdate:modelValue":e[0]||(e[0]=l=>t.form.email=l),required:"",disabled:t.loading},null,8,Vo),[[T,t.form.email]])]),s("div",Oo,[e[7]||(e[7]=s("label",{for:"password"},"Password:",-1)),D(s("input",{type:"password",id:"password","onUpdate:modelValue":e[1]||(e[1]=l=>t.form.password=l),required:"",disabled:t.loading},null,8,jo),[[T,t.form.password]])]),t.error?(g(),f("div",zo,h(t.error),1)):b("",!0),s("div",Yo,[s("button",{type:"submit",disabled:t.loading},h(t.loading?"Logging in...":"Login"),9,qo),s("button",{type:"button",onClick:e[2]||(e[2]=(...l)=>t.closeModal&&t.closeModal(...l)),disabled:t.loading}," Cancel ",8,Ho)])],32)])])}const Jo=ee(Go,[["render",Qo],["__scopeId","data-v-64f3b00b"]]),Ko={name:"RegisterModal",emits:["close","success"],setup(i,{emit:e}){const o=ze(),t=Pe({name:"",username:"",email:"",password:"",passwordConfirm:""}),n=S(!1),c=S(""),l=F(()=>t.name&&t.username&&t.email&&t.password&&t.passwordConfirm&&t.password===t.passwordConfirm&&t.password.length>=8);return{form:t,loading:n,error:c,isFormValid:l,handleRegister:async()=>{if(!l.value){c.value="Please fill in all fields and ensure passwords match";return}n.value=!0,c.value="";try{const I=await o.register(t.name,t.username,t.email,t.password,t.passwordConfirm);I.success?e("success"):c.value=I.error}catch(I){c.value=I.message||"Registration failed"}finally{n.value=!1}},closeModal:()=>{e("close")}}}},Zo={class:"form-group"},Xo=["disabled"],$o={class:"form-group"},ea=["disabled"],ta={class:"form-group"},sa=["disabled"],oa={class:"form-group"},aa=["disabled"],ia={class:"form-group"},na=["disabled"],ra={key:0,class:"error-message"},la={class:"modal-buttons"},da=["disabled"],ca=["disabled"];function ua(i,e,o,t,n,c){return g(),f("div",{class:"modal",onClick:e[8]||(e[8]=(...l)=>t.closeModal&&t.closeModal(...l))},[s("div",{class:"modal-content auth-modal",onClick:e[7]||(e[7]=de(()=>{},["stop"]))},[e[14]||(e[14]=s("h2",null,"Register",-1)),s("form",{onSubmit:e[6]||(e[6]=de((...l)=>t.handleRegister&&t.handleRegister(...l),["prevent"]))},[s("div",Zo,[e[9]||(e[9]=s("label",{for:"name"},"Name:",-1)),D(s("input",{type:"text",id:"name","onUpdate:modelValue":e[0]||(e[0]=l=>t.form.name=l),required:"",disabled:t.loading},null,8,Xo),[[T,t.form.name]])]),s("div",$o,[e[10]||(e[10]=s("label",{for:"username"},"Username:",-1)),D(s("input",{type:"text",id:"username","onUpdate:modelValue":e[1]||(e[1]=l=>t.form.username=l),required:"",disabled:t.loading},null,8,ea),[[T,t.form.username]])]),s("div",ta,[e[11]||(e[11]=s("label",{for:"email"},"Email:",-1)),D(s("input",{type:"email",id:"email","onUpdate:modelValue":e[2]||(e[2]=l=>t.form.email=l),required:"",disabled:t.loading},null,8,sa),[[T,t.form.email]])]),s("div",oa,[e[12]||(e[12]=s("label",{for:"password"},"Password:",-1)),D(s("input",{type:"password",id:"password","onUpdate:modelValue":e[3]||(e[3]=l=>t.form.password=l),required:"",minlength:"8",disabled:t.loading},null,8,aa),[[T,t.form.password]])]),s("div",ia,[e[13]||(e[13]=s("label",{for:"passwordConfirm"},"Confirm Password:",-1)),D(s("input",{type:"password",id:"passwordConfirm","onUpdate:modelValue":e[4]||(e[4]=l=>t.form.passwordConfirm=l),required:"",minlength:"8",disabled:t.loading},null,8,na),[[T,t.form.passwordConfirm]])]),t.error?(g(),f("div",ra,h(t.error),1)):b("",!0),s("div",la,[s("button",{type:"submit",disabled:t.loading||!t.isFormValid},h(t.loading?"Registering...":"Register"),9,da),s("button",{type:"button",onClick:e[5]||(e[5]=(...l)=>t.closeModal&&t.closeModal(...l)),disabled:t.loading}," Cancel ",8,ca)])],32)])])}const ga=ee(Ko,[["render",ua],["__scopeId","data-v-eec5201a"]]),dt="http://127.0.0.1:8000/api",ma={async getConfig(){try{const i=await fetch(`${dt}/google-books-config`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);return await i.json()}catch(i){throw console.error("Simple Google Books - Config failed:",i),i}},async searchBooks(i,e=10){try{const o=await fetch(`${dt}/google-books/search?q=${encodeURIComponent(i)}&maxResults=${e}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!o.ok)throw new Error(`HTTP ${o.status}: ${o.statusText}`);return await o.json()}catch(o){throw console.error("Simple Google Books - Search failed:",o),o}}},fa=!1,pa=!0,va="production",ha={production:{apiUrl:"https://teabubble.attrebi.ch",apiBaseUrl:"https://teabubble.attrebi.ch/api",googleBooksUrl:"https://teabubble.attrebi.ch/api/google-books",debug:!1}};function ya(){return ha.production}const je=ya();je.debug&&console.log("🔧 Environment Configuration:",{mode:va,isDevelopment:fa,isProduction:pa,apiUrl:je.apiUrl,apiBaseUrl:je.apiBaseUrl,googleBooksUrl:je.googleBooksUrl});class ba{constructor(){this.baseUrl="https://en.wikipedia.org/w/api.php",this.timeout=1e4,this.maxResults=10}async searchBooks(e,o=10){if(!e||typeof e!="string"||e.trim().length===0)return console.warn("📚 [Wikipedia] Invalid query provided"),{success:!1,error:"Search query is required",data:[]};try{const t=await this.searchPages(e,o);if(!t.success||t.data.length===0)return{success:!1,error:"No results found",data:[]};const n=await this.getPageDetails(t.data),c=this.filterAndFormatBookResults(n);return console.log("📚 [Wikipedia] Search completed:",{totalResults:n.length,bookResults:c.length}),{success:!0,data:c,source:"wikipedia"}}catch(t){return console.error("📚 [Wikipedia] Search failed:",t),{success:!1,error:`Search failed: ${t.message}`,data:[]}}}async searchPages(e,o){var n;const t=new URLSearchParams({action:"query",format:"json",list:"search",srsearch:`${e} book novel`,srnamespace:0,srlimit:o,srprop:"snippet|timestamp",origin:"*"});try{const c=await fetch(`${this.baseUrl}?${t}`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout)});if(!c.ok)throw new Error(`HTTP ${c.status}: ${c.statusText}`);const l=await c.json();if(l.error)throw new Error(l.error.info||"Wikipedia API error");return{success:!0,data:(((n=l.query)==null?void 0:n.search)||[]).map(p=>({pageid:p.pageid,title:p.title,snippet:p.snippet,timestamp:p.timestamp}))}}catch(c){return console.error("📚 [Wikipedia] Page search failed:",c),{success:!1,error:c.message,data:[]}}}async getPageDetails(e){var n;if(!e||e.length===0)return[];const o=e.map(c=>c.pageid).join("|"),t=new URLSearchParams({action:"query",format:"json",pageids:o,prop:"extracts|pageimages|info",exintro:"true",explaintext:"true",exsectionformat:"plain",piprop:"thumbnail|original",pithumbsize:300,pilimit:1,inprop:"url",origin:"*"});try{const c=await fetch(`${this.baseUrl}?${t}`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout)});if(!c.ok)throw new Error(`HTTP ${c.status}: ${c.statusText}`);const l=await c.json();if(l.error)throw new Error(l.error.info||"Wikipedia API error");const r=((n=l.query)==null?void 0:n.pages)||{};return Object.values(r).map(p=>{var I;return{pageid:p.pageid,title:p.title,extract:p.extract||"",thumbnail:((I=p.thumbnail)==null?void 0:I.source)||null,fullurl:p.fullurl||null,canonicalurl:p.canonicalurl||null}})}catch(c){return console.error("📚 [Wikipedia] Page details failed:",c),[]}}filterAndFormatBookResults(e){const o=["book","novel","fiction","non-fiction","author","published","publisher","isbn","literature","story","chapter","edition","written by","series","trilogy","saga","collection","anthology"];return e.filter(t=>{const n=(t.extract||"").toLowerCase(),c=(t.title||"").toLowerCase(),l=o.some(I=>n.includes(I)||c.includes(I)),p=["book","novel","story","tale","chronicles","saga","trilogy"].some(I=>c.includes(I));return l||p}).map(t=>{const n=t.extract||"",c=t.title||"",l=n.match(/written by[^,.\n]*?([A-Z][^,.\n]*?[A-Z][^,.\n]*?)(?:\s|\.|,|$)/i),r=n.match(/(\d{4})/),p=n.match(/(?:published by|publisher)\s+([^,.\n]+)/i);let I="";if(l&&(I=l[1].trim().replace(/^(British|American|German|French|Spanish|Italian)\s+(?:author|writer|novelist)?\s*/i,""),I.includes("author")||I.includes("writer"))){const C=I.match(/([A-Z][^,.\n]*?[A-Z][^,.\n]*?)(?:\s|\.|,|$)/);I=C?C[1].trim():I}if(!I){const A=n.match(/(?:by|author|written by)\s+([A-Z][^,.\n]*?[A-Z][^,.\n]*?)(?:\s|\.|,|$)/i);A&&(I=A[1].trim().replace(/^(British|American|German|French|Spanish|Italian)\s+(?:author|writer|novelist)?\s*/i,""))}return{id:`wikipedia_${t.pageid}`,title:c,author:I,description:n.substring(0,300)+(n.length>300?"...":""),publishedDate:r?r[1]:"",publisher:p?p[1].trim():"",imageUrl:t.thumbnail||null,link:t.fullurl||t.canonicalurl||"",apiSource:"wikipedia",snippet:n.substring(0,150)+(n.length>150?"...":""),categories:this.extractCategories(n)}}).slice(0,this.maxResults)}extractCategories(e){const o=[],t=e.toLowerCase();return t.includes("fiction")&&o.push("Fiction"),(t.includes("non-fiction")||t.includes("nonfiction"))&&o.push("Non-Fiction"),t.includes("novel")&&o.push("Novel"),t.includes("biography")&&o.push("Biography"),t.includes("history")&&o.push("History"),t.includes("science")&&o.push("Science"),t.includes("philosophy")&&o.push("Philosophy"),t.includes("poetry")&&o.push("Poetry"),t.includes("drama")&&o.push("Drama"),t.includes("mystery")&&o.push("Mystery"),t.includes("romance")&&o.push("Romance"),t.includes("fantasy")&&o.push("Fantasy"),(t.includes("science fiction")||t.includes("sci-fi"))&&o.push("Science Fiction"),t.includes("thriller")&&o.push("Thriller"),t.includes("horror")&&o.push("Horror"),o}async getBookById(e){var o,t;try{const n=new URLSearchParams({action:"query",format:"json",pageids:e,prop:"extracts|pageimages|info",exintro:"true",explaintext:"true",piprop:"thumbnail",pithumbsize:300,inprop:"url",origin:"*"}),c=await fetch(`${this.baseUrl}?${n}`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout)});if(!c.ok)throw new Error(`HTTP ${c.status}: ${c.statusText}`);const l=await c.json(),r=Object.values(((o=l.query)==null?void 0:o.pages)||{})[0];if(!r)throw new Error("Page not found");return{success:!0,data:{id:`wikipedia_${r.pageid}`,title:r.title,description:r.extract||"",imageUrl:((t=r.thumbnail)==null?void 0:t.source)||null,link:r.fullurl||r.canonicalurl||"",apiSource:"wikipedia"}}}catch(n){return console.error("📚 [Wikipedia] Get book by ID failed:",n),{success:!1,error:n.message,data:null}}}}const ka=new ba;class wa{constructor(){this.wikipediaService=ka,this.googleBooksService=ma}getUserPreferences(){try{const e=localStorage.getItem("profileData");if(e){const o=JSON.parse(e);return{booksApiProvider:o.booksApiProvider||"wikipedia",enableGoogleBooksFallback:o.enableGoogleBooksFallback!==!1}}}catch(e){console.warn("Failed to load user preferences:",e)}return{booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}}async searchBooks(e,o=10){const t=this.getUserPreferences();if(!e||typeof e!="string"||e.trim().length===0)return{success:!1,error:"Search query is required",data:[]};try{let n=[],c="",l=!1;switch(t.booksApiProvider){case"wikipedia":n=await this.searchWithWikipediaFirst(e,o,t),c="wikipedia";break;case"google_books":n=await this.searchWithGoogleBooksFirst(e,o,t),c="google_books";break;case"both":n=await this.searchWithBothApis(e,o,t),c="both";break;default:n=await this.searchWithWikipediaFirst(e,o,t),c="wikipedia"}return{success:!0,data:n,source:c,fallbackUsed:l}}catch(n){return console.error("📚 [UnifiedBooks] Search failed:",n),{success:!1,error:`Search failed: ${n.message}`,data:[]}}}async searchWithWikipediaFirst(e,o,t){const n=await this.wikipediaService.searchBooks(e,o);if(n.success&&n.data.length>0)return n.data;if(t.enableGoogleBooksFallback){const c=await this.googleBooksService.searchBooks(e,o);if(c.success&&c.data.length>0)return c.data}return[]}async searchWithGoogleBooksFirst(e,o,t){const n=await this.googleBooksService.searchBooks(e,o);if(n.success&&n.data.length>0)return n.data;if(t.enableGoogleBooksFallback){const c=await this.wikipediaService.searchBooks(e,o);if(c.success&&c.data.length>0)return c.data}return[]}async searchWithBothApis(e,o,t){const[n,c]=await Promise.allSettled([this.wikipediaService.searchBooks(e,Math.ceil(o/2)),this.googleBooksService.searchBooks(e,Math.ceil(o/2))]);let l=[];return n.status==="fulfilled"&&n.value.success&&(l=l.concat(n.value.data)),c.status==="fulfilled"&&c.value.success&&(l=l.concat(c.value.data)),l=this.removeDuplicateResults(l),l=l.slice(0,o),l}removeDuplicateResults(e){const o=new Set,t=[];for(const n of e){const c=n.title.toLowerCase().replace(/[^\w\s]/g,"").trim();o.has(c)||(o.add(c),t.push(n))}return t}async getBookById(e){if(e.startsWith("wikipedia_")){const o=e.replace("wikipedia_","");return await this.wikipediaService.getBookById(o)}else return await this.googleBooksService.getBookById(e)}getApiStatus(){const e=this.getUserPreferences();return{primaryProvider:e.booksApiProvider,fallbackEnabled:e.enableGoogleBooksFallback,availableProviders:["wikipedia","google_books"],wikipediaAvailable:!0,googleBooksAvailable:!0}}}const $e=new wa,Sa={name:"BooksApiControlPanel",props:{expanded:{type:Boolean,default:!1}},emits:["preferences-changed"],setup(i,{emit:e}){const o=S(i.expanded),t=S(!1),n=S(null),c=S("checking"),l=Pe({booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}),r=()=>{o.value=!o.value},p=()=>{try{const m=localStorage.getItem("profileData");if(m){const k=JSON.parse(m);l.booksApiProvider=k.booksApiProvider||"wikipedia",l.enableGoogleBooksFallback=k.enableGoogleBooksFallback!==!1}}catch(m){console.warn("Failed to load preferences:",m)}},I=()=>{try{const m=localStorage.getItem("profileData"),k=m?JSON.parse(m):{};k.booksApiProvider=l.booksApiProvider,k.enableGoogleBooksFallback=l.enableGoogleBooksFallback,localStorage.setItem("profileData",JSON.stringify(k)),e("preferences-changed",{...l})}catch(m){console.error("Failed to save preferences:",m)}},A=async()=>{t.value=!0,n.value=null;try{const m=await $e.searchBooks("Harry Potter",3);m.success&&m.data.length>0?n.value={success:!0,message:`✅ Found ${m.data.length} results using ${m.source}`}:n.value={success:!1,message:`❌ No results found: ${m.error||"Unknown error"}`}}catch(m){n.value={success:!1,message:`❌ Test failed: ${m.message}`}}finally{t.value=!1}},C=async()=>{try{const m=await $e.getApiStatus();c.value=m.googleBooksAvailable?"available":"unavailable"}catch{c.value="unavailable"}};return ct(()=>{p(),C()}),{isExpanded:o,localPreferences:l,testing:t,testResult:n,googleBooksStatus:c,toggleExpanded:r,updatePreferences:I,testSearch:A}}},_a={class:"books-api-control-panel"},Ia={class:"control-header"},Ca={key:0,class:"control-content"},xa={class:"form-group"},Aa={class:"form-group"},Da={class:"checkbox-container"},Ma={class:"api-status"},Ta={class:"status-item"},Ra={class:"search-preview"},Ua=["disabled"];function Pa(i,e,o,t,n,c){return g(),f("div",_a,[s("div",Ia,[e[6]||(e[6]=s("h4",null,"📚 Books API Settings",-1)),s("button",{class:j(["toggle-btn",{expanded:t.isExpanded}]),onClick:e[0]||(e[0]=(...l)=>t.toggleExpanded&&t.toggleExpanded(...l))},h(t.isExpanded?"▼":"▶"),3)]),t.isExpanded?(g(),f("div",Ca,[s("div",xa,[e[8]||(e[8]=s("label",{for:"apiProvider"},"Primary API Provider:",-1)),D(s("select",{id:"apiProvider","onUpdate:modelValue":e[1]||(e[1]=l=>t.localPreferences.booksApiProvider=l),onChange:e[2]||(e[2]=(...l)=>t.updatePreferences&&t.updatePreferences(...l))},[...e[7]||(e[7]=[s("option",{value:"wikipedia"},"Wikipedia (Recommended)",-1),s("option",{value:"google_books"},"Google Books",-1),s("option",{value:"both"},"Both APIs",-1)])],544),[[be,t.localPreferences.booksApiProvider]]),e[9]||(e[9]=s("div",{class:"field-hint"}," Choose your primary source for book information ",-1))]),s("div",Aa,[s("div",Da,[D(s("input",{type:"checkbox",id:"enableFallback","onUpdate:modelValue":e[3]||(e[3]=l=>t.localPreferences.enableGoogleBooksFallback=l),onChange:e[4]||(e[4]=(...l)=>t.updatePreferences&&t.updatePreferences(...l))},null,544),[[ut,t.localPreferences.enableGoogleBooksFallback]]),e[10]||(e[10]=s("label",{for:"enableFallback",class:"checkbox-label"}," Enable Google Books Fallback ",-1))]),e[11]||(e[11]=s("div",{class:"field-hint"}," Use Google Books when primary API fails ",-1))]),s("div",Ma,[e[13]||(e[13]=s("div",{class:"status-item"},[s("span",{class:"status-label"},"Wikipedia:"),s("span",{class:"status-value available"},"✅ Available")],-1)),s("div",Ta,[e[12]||(e[12]=s("span",{class:"status-label"},"Google Books:",-1)),s("span",{class:j(["status-value",t.googleBooksStatus])},h(t.googleBooksStatus==="available"?"✅ Available":"⚠️ Check API Key"),3)])]),s("div",Ra,[s("button",{class:"test-search-btn",onClick:e[5]||(e[5]=(...l)=>t.testSearch&&t.testSearch(...l)),disabled:t.testing},h(t.testing?"Testing...":"Test Search"),9,Ua),t.testResult?(g(),f("div",{key:0,class:j(["test-result",t.testResult.success?"success":"error"])},h(t.testResult.message),3)):b("",!0)])])):b("",!0)])}const Ba=ee(Sa,[["render",Pa],["__scopeId","data-v-09652cba"]]),Ea={name:"EditModal",components:{BooksApiControlPanel:Ba},props:{item:{type:Object,default:null},currentCategory:{type:String,default:"watchlist"}},emits:["close","save","delete"],setup(i,{emit:e}){const o=Ye(),t=S(!1),n=S(""),c=S([]),l=S(null),r=S(null),p=S(""),I=S(!1),A=S(""),C=S(!1),m=Pe({category:"watchlist",title:"",release:"",apiRating:"",personalRating:"",count:"",platforms:"",genre:"",description:"",link:"",extraLink:"",path:"",discovered:"",spielzeit:"",isAiring:!1,nextSeason:"",nextSeasonRelease:"",imageUrl:"",watchlistType:"",imageCleared:!1,tmdbId:"",nextSeasonName:"",lastAirDate:"",totalSeasons:"",totalEpisodes:"",seriesStatus:"",networks:"",createdBy:""}),k=F(()=>!!i.item),H=F(()=>m.category==="game"),te=F(()=>m.category==="series"),O=F(()=>m.category==="watchlist");De(()=>i.item,a=>{a?(a.watchlist_type!==void 0?m.watchlistType=a.watchlist_type||"":a.watchlistType!==void 0?m.watchlistType=a.watchlistType||"":m.watchlistType="",Object.keys(m).forEach(u=>{u!=="watchlistType"&&(m[u]=a[u]||"")}),a.is_airing!==void 0&&(console.log("DEBUG: Loading isAiring from backend:",{is_airing:a.is_airing,type:typeof a.is_airing,form_isAiring_before:m.isAiring}),m.isAiring=a.is_airing,console.log("DEBUG: form.isAiring after setting:",m.isAiring)),a.tmdb_id!==void 0&&(m.tmdbId=a.tmdb_id),a.next_season_name!==void 0&&(m.nextSeasonName=a.next_season_name),a.last_air_date!==void 0&&(m.lastAirDate=a.last_air_date),a.total_seasons!==void 0&&(m.totalSeasons=a.total_seasons),a.total_episodes!==void 0&&(m.totalEpisodes=a.total_episodes),a.series_status!==void 0&&(m.seriesStatus=a.series_status),a.networks!==void 0&&(m.networks=a.networks),a.created_by!==void 0&&(m.createdBy=a.created_by),a.next_season!==void 0&&(m.nextSeason=a.next_season),a.next_season_release!==void 0&&(m.nextSeasonRelease=a.next_season_release),a.api_rating!==void 0&&(m.apiRating=a.api_rating),a.personal_rating!==void 0&&(m.personalRating=a.personal_rating),a.description!==void 0&&(m.description=a.description),a.image_url!==void 0&&(m.imageUrl=a.image_url),a.path!==void 0&&(m.path=a.path),a.extra_link!==void 0&&(m.extraLink=a.extra_link),a.rating!==void 0&&!m.personalRating&&(m.personalRating=a.rating)):Object.keys(m).forEach(u=>{u==="category"?m[u]=i.currentCategory||"watchlist":u==="release"?m[u]=new Date().toISOString().split("T")[0]:u==="watchlistType"?m[u]=i.currentCategory==="watchlist"?"series":"":m[u]=""})},{immediate:!0}),De(()=>i.currentCategory,a=>{!i.item&&a&&(m.category=a)});const Q=async()=>{var a,u,_;if(!m.title){n.value="Title is required";return}if(m.category==="watchlist"&&!m.watchlistType){n.value="Please select a type for watchlist items";return}if(m.category==="watchlist"&&!m.release){n.value="Release date is required for watchlist items";return}t.value=!0,n.value="";try{const d={...m};Object.keys(d).forEach(y=>{d[y]===""&&y!=="watchlistType"&&y!=="imageUrl"&&y!=="path"&&y!=="extraLink"&&(d[y]=null)}),p.value?(d.path=p.value,d.imageUrl=p.value):d.imageUrl&&d.imageUrl.trim()?d.path=d.imageUrl:k.value&&i.item?i.item.image_url?(d.imageUrl=i.item.image_url,d.path=i.item.path||i.item.image_url):i.item.path&&(d.path=i.item.path,d.imageUrl=i.item.path):(d.imageUrl=null,d.path=null),d.apiRating!==void 0&&d.apiRating!==null&&d.apiRating!==""&&(d.apiRating=parseFloat(d.apiRating)),d.personalRating!==void 0&&d.personalRating!==null&&d.personalRating!==""&&(d.personalRating=parseFloat(d.personalRating)),d.count!==void 0&&d.count!==null&&d.count!==""&&(d.count=parseInt(d.count)),d.spielzeit!==void 0&&d.spielzeit!==null&&d.spielzeit!==""&&(d.spielzeit=parseInt(d.spielzeit)),d.nextSeason!==void 0&&d.nextSeason!==null&&d.nextSeason!==""&&(d.nextSeason=parseInt(d.nextSeason)),d.watchlistType!==void 0&&(d.watchlist_type=d.watchlistType||null,delete d.watchlistType),d.isAiring!==void 0&&(console.log("DEBUG: Saving isAiring to backend:",{form_isAiring:m.isAiring,itemData_isAiring:d.isAiring,type:typeof d.isAiring}),d.is_airing=d.isAiring,console.log("DEBUG: itemData.is_airing after mapping:",d.is_airing),delete d.isAiring),d.tmdbId!==void 0&&(d.tmdb_id=d.tmdbId,delete d.tmdbId),d.nextSeasonName!==void 0&&(d.next_season_name=d.nextSeasonName,delete d.nextSeasonName),d.lastAirDate!==void 0&&(d.last_air_date=d.lastAirDate,delete d.lastAirDate),d.totalSeasons!==void 0&&(d.total_seasons=d.totalSeasons,delete d.totalSeasons),d.totalEpisodes!==void 0&&(d.total_episodes=d.totalEpisodes,delete d.totalEpisodes),d.seriesStatus!==void 0&&(d.series_status=d.seriesStatus,delete d.seriesStatus),d.networks!==void 0&&(d.networks=d.networks),d.createdBy!==void 0&&(d.created_by=d.createdBy,delete d.createdBy),d.nextSeason&&(d.next_season=d.nextSeason,delete d.nextSeason),d.nextSeasonRelease&&(d.next_season_release=d.nextSeasonRelease,delete d.nextSeasonRelease),d.personalRating!==void 0?(d.rating=d.personalRating,delete d.personalRating):d.apiRating!==void 0&&(d.rating=d.apiRating,delete d.apiRating),d.imageUrl&&(d.image_url=d.imageUrl,delete d.imageUrl),d.extraLink!==void 0&&(d.extra_link=d.extraLink,delete d.extraLink),k.value&&i.item?(console.log("DEBUG: Calling updateMediaItem with data:",{id:i.item.id,itemData:d,is_airing:d.is_airing}),await o.updateMediaItem(i.item.id,d)):await o.addMediaItem(d),ce()}catch(d){d.isDuplicate||((a=d.response)==null?void 0:a.status)===409&&((_=(u=d.response)==null?void 0:u.data)!=null&&_.duplicate)?n.value="Ein Eintrag mit diesem Titel und dieser Kategorie existiert bereits. Bitte wählen Sie einen anderen Titel oder bearbeiten Sie den bestehenden Eintrag.":n.value=d.message||"Failed to save item"}finally{t.value=!1}},ce=()=>{n.value="",e("close")},me=()=>{e("delete",i.item),ce()},v=async()=>{if(p.value){c.value=[];return}if(l.value&&clearTimeout(l.value),!m.title||m.title.length<3){c.value=[];return}l.value=setTimeout(async()=>{try{const a=m.category==="watchlist"?m.watchlistType:m.category;if(m.category==="watchlist"&&!m.watchlistType){c.value=[];return}let u=[],_=[];if(a==="buecher"){const d=await $e.searchBooks(m.title,10);d.success&&d.data&&(_=d.data.map(y=>({title:y.title,release:y.publishedDate?ie(y.publishedDate):"",genre:y.categories?y.categories.join(", "):"",platforms:y.author||"",link:y.link||"",imageUrl:y.imageUrl||"",rating:"",apiSource:y.apiSource||d.source,id:y.id,author:y.author,description:y.description,publisher:y.publisher,isbn10:y.isbn10,isbn13:y.isbn13})))}else u=await ne.searchApi(m.title,a,10),u&&u.length>0&&(_=u.map(d=>({title:d.title,release:d.release,genre:d.genre||"",description:d.overview||"",platforms:d.platforms||"",link:d.link||"",imageUrl:d.image||"",rating:d.rating||"",apiSource:d.api_source||"",id:d.id||""})));_.length>0?c.value=_:c.value=[{title:`"${m.title}" - Keine Ergebnisse gefunden`,release:"",genre:"Bitte manuell ausfüllen",isPlaceholder:!0}]}catch{c.value=[{title:`"${m.title}" - API nicht verfügbar`,release:"",genre:"Bitte manuell ausfüllen",isPlaceholder:!0}]}},500)},N=async a=>{if(a.isPlaceholder){c.value=[];return}if(m.title=a.title,a.release&&(m.release=a.release),a.platforms&&(m.platforms=a.platforms),a.genre&&(m.genre=a.genre),a.description&&(m.description=a.description),a.link&&(m.link=a.link),a.rating&&(m.apiRating=a.rating),(a.apiSource==="google_books"||a.apiSource==="wikipedia")&&(a.author&&(m.platforms=a.author),a.publisher)){const u=m.link||"";m.link=u||`Publisher: ${a.publisher}`}a.imageUrl?(m.imageUrl=a.imageUrl,m.path=a.imageUrl):(m.imageUrl="",m.path=""),c.value=[]},re=a=>a?new Date(a).toLocaleDateString():"",ie=a=>{if(!a)return"";let u;if(typeof a=="string"){if(/^\d{4}$/.test(a))return`${a}-01-01`;if(/^\d{4}-\d{2}$/.test(a))return`${a}-01`;if(/^\d{4}-\d{2}-\d{2}$/.test(a))return a;u=new Date(a)}else u=new Date(a);return isNaN(u.getTime())?"":u.toISOString().split("T")[0]},Se=a=>a&&(a.startsWith("http://")?a.replace("http://","https://"):a),fe=()=>{var y;if(!m.release)return"";const a=new Date(m.release),u=new Date;u.setHours(0,0,0,0),a.setHours(0,0,0,0);const _=a.getTime()-u.getTime(),d=Math.ceil(_/(1e3*3600*24));if(d>0)return d===1?"Tomorrow!":d<=7?`${d} days left`:d<=30?`${d} days left`:`${Math.ceil(d/30)} months left`;if(d===0)return"Released today!";{const R=((y=m.watchlistType)==null?void 0:y.toLowerCase())||"media";return R==="game"?"Unplayed yet":R==="series"||R==="movie"?"Unwatched yet":"Unconsumed yet"}},_e=()=>{var a;(a=r.value)==null||a.click()},Ie=async a=>{const u=a.target.files[0];if(u){if(!u.type.startsWith("image/")){n.value="Please select a valid image file";return}if(u.size>10*1024*1024){n.value="Image file too large. Maximum size is 10MB";return}t.value=!0,n.value="";try{const _=m.title.replace(/[^a-zA-Z0-9\s\-_\.]/g,"").trim()||"item",d=Date.now(),y=u.name.split(".").pop()||"jpg",R=`images_downloads/uploads/${_}_${d}.${y}`,ge=await ne.uploadImage(u,R);ge.success?(p.value=ge.saved,m.path=ge.saved,m.imageUrl=ge.saved):n.value=ge.error||"Failed to upload image"}catch(_){n.value=_.message||"Failed to upload image"}finally{t.value=!1}}},K=()=>p.value?p.value.startsWith("storage/")?`/${p.value}`:`/${p.value}`:m.imageUrl?m.imageUrl.startsWith("http")?m.imageUrl:m.imageUrl.startsWith("storage/")?`/${m.imageUrl}`:`/${m.imageUrl}`:"",G=a=>{a.target.style.display="none",n.value="Failed to load image: "+a.target.src},z=a=>{n.value&&n.value.includes("Failed to load image")&&(n.value="")},q=a=>{},pe=a=>{},ve=()=>{m.imageUrl="",m.path="",p.value="",r.value&&(r.value.value="")},ue=()=>{p.value="",m.imageUrl===p.value&&(m.imageUrl=""),m.path===p.value&&(m.path=""),r.value&&(r.value.value="")},ke=F(()=>!!(m.imageUrl||p.value));return{form:m,loading:t,error:n,apiResults:c,isEditing:k,isGame:H,isSeries:te,isWatchlist:O,imageUploadRef:r,uploadedImagePath:p,apiLoading:I,apiError:A,apiSuccess:C,handleSave:Q,closeModal:ce,deleteItem:me,searchApi:v,selectApiResult:N,formatDate:re,formatDateForInput:ie,ensureHttpsUrl:Se,getReleasePreview:fe,triggerImageUpload:_e,handleImageUpload:Ie,getImagePreviewUrl:K,handleImageError:G,handleImageLoad:z,handleImageLoadStart:q,handleImageLoadEnd:pe,clearImage:ve,removeUploadedImage:ue,shouldShowImagePreview:ke,handlePreferencesChanged:a=>{c.value=[]},checkSeriesAPI:async()=>{if(!m.title||m.title.trim()===""){A.value="Please enter a series title first";return}console.log("🔍 Starting TMDB API check for:",m.title),I.value=!0,A.value="",C.value=!1;try{console.log("📡 Calling checkSeriesInfo API...");const a=await ne.checkSeriesInfo(m.title);if(console.log("📡 API Response:",a),a.success&&a.data){const u=a.data;console.log("📊 Series Data received:",u),u.tmdb_id&&(m.tmdbId=u.tmdb_id,console.log("✅ Set tmdbId:",u.tmdb_id)),u.is_airing!==void 0&&(m.isAiring=u.is_airing,console.log("✅ Set isAiring:",u.is_airing)),u.next_episode&&(m.nextSeason=u.next_episode.season_number,m.nextSeasonRelease=u.next_episode.air_date,m.nextSeasonName=u.next_episode.name,console.log("✅ Set next season info:",{season:u.next_episode.season_number,release:u.next_episode.air_date,name:u.next_episode.name})),u.last_air_date&&(m.lastAirDate=u.last_air_date,console.log("✅ Set lastAirDate:",u.last_air_date)),u.number_of_seasons&&(m.totalSeasons=u.number_of_seasons,console.log("✅ Set totalSeasons:",u.number_of_seasons)),u.number_of_episodes&&(m.totalEpisodes=u.number_of_episodes,console.log("✅ Set totalEpisodes:",u.number_of_episodes)),u.status&&(m.seriesStatus=u.status,console.log("✅ Set seriesStatus:",u.status)),u.networks&&u.networks.length>0&&(m.networks=u.networks.join(", "),console.log("✅ Set networks:",u.networks.join(", "))),u.created_by&&u.created_by.length>0&&(m.createdBy=u.created_by.join(", "),console.log("✅ Set createdBy:",u.created_by.join(", "))),u.overview&&(m.description=u.overview,console.log("✅ Set description")),u.genres&&u.genres.length>0&&(m.genre=u.genres.join(", "),console.log("✅ Set genre:",u.genres.join(", "))),u.poster_path&&(m.imageUrl=u.poster_path,m.path=u.poster_path,console.log("✅ Set imageUrl:",u.poster_path)),console.log("📝 Final form state:",m),C.value=!0,setTimeout(()=>{C.value=!1},3e3)}else console.error("❌ API returned error:",a.error),A.value=a.error||"Failed to fetch series information"}catch(a){console.error("❌ TMDB API check failed:",a),A.value=a.message||"Failed to check series information"}finally{I.value=!1}}}}},Fa={class:"form-header"},La={class:"form-group category-group"},Na={class:"form-group title-group"},Ga={class:"search-container"},Wa=["placeholder","disabled"],Va={key:0,class:"search-results"},Oa=["onClick"],ja={class:"result-thumbnail"},za=["src","alt"],Ya={key:1,class:"no-image"},qa={class:"result-content"},Ha={class:"result-title"},Qa={class:"result-meta"},Ja={key:0},Ka={key:1},Za={key:2,class:"rating"},Xa={class:"form-row"},$a={class:"form-group"},ei={for:"release"},ti={key:0,class:"required"},si=["required"],oi={key:0,class:"field-hint"},ai={key:1,class:"release-preview"},ii={class:"form-group"},ni={class:"form-group"},ri={class:"form-row"},li={class:"form-group"},di={class:"form-group"},ci={class:"form-row"},ui={class:"form-group"},gi={class:"form-group"},mi={class:"form-row"},fi={class:"form-group full-width"},pi={key:0,class:"form-row"},vi={class:"form-group"},hi={key:0,class:"field-error"},yi={class:"form-row"},bi={class:"form-group"},ki={class:"form-group"},wi={key:2,class:"form-row"},Si={class:"form-group"},_i={key:3,class:"form-row"},Ii={class:"form-group"},Ci={key:0,class:"form-group"},xi={key:4,class:"form-row"},Ai={class:"form-group full-width"},Di={class:"api-check-container"},Mi=["disabled"],Ti={key:0},Ri={key:1},Ui={key:0,class:"api-error"},Pi={key:1,class:"api-success"},Bi={key:5,class:"form-row"},Ei={class:"form-group"},Fi={class:"form-group"},Li={key:6,class:"form-row"},Ni={class:"form-group"},Gi={class:"form-group"},Wi={key:7,class:"form-row"},Vi={class:"form-group"},Oi={class:"form-group"},ji={key:8,class:"form-row"},zi={class:"form-group full-width"},Yi={key:9,class:"form-row"},qi={class:"form-group full-width"},Hi={key:10,class:"form-row"},Qi={class:"form-group"},Ji={class:"form-row"},Ki={class:"form-group"},Zi={class:"form-group"},Xi={class:"image-upload-container"},$i=["disabled"],en={key:0,class:"upload-success"},tn={key:11,class:"form-row"},sn={class:"form-group image-preview-group"},on={class:"image-preview"},an=["src","alt"],nn={key:12,class:"error-message"},rn={class:"modal-buttons"},ln=["disabled"],dn=["disabled"],cn=["disabled"],un=["disabled"];function gn(i,e,o,t,n,c){const l=ae("BooksApiControlPanel");return g(),f("div",{class:"modal",onClick:e[41]||(e[41]=(...r)=>t.closeModal&&t.closeModal(...r))},[s("div",{class:"modal-content",onClick:e[40]||(e[40]=de(()=>{},["stop"]))},[s("h2",null,h(t.isEditing?"Edit Item":"Add Item"),1),s("form",{onSubmit:e[39]||(e[39]=de((...r)=>t.handleSave&&t.handleSave(...r),["prevent"]))},[s("div",Fa,[s("div",La,[e[43]||(e[43]=s("label",{for:"category"},"Category:",-1)),D(s("select",{id:"category","onUpdate:modelValue":e[0]||(e[0]=r=>t.form.category=r),required:""},[...e[42]||(e[42]=[Fe('<option value="watchlist" data-v-5dc54a7d>Watchlist</option><option value="game" data-v-5dc54a7d>Game</option><option value="series" data-v-5dc54a7d>Series</option><option value="movie" data-v-5dc54a7d>Movie</option><option value="buecher" data-v-5dc54a7d>Bücher</option>',5)])],512),[[be,t.form.category]])]),s("div",Na,[e[44]||(e[44]=s("label",{for:"title"},"Title:",-1)),s("div",Ga,[D(s("input",{type:"text",id:"title","onUpdate:modelValue":e[1]||(e[1]=r=>t.form.title=r),onInput:e[2]||(e[2]=(...r)=>t.searchApi&&t.searchApi(...r)),required:"",placeholder:t.isWatchlist?"Enter title (API search + manual input available)":"Enter title",disabled:t.loading},null,40,Wa),[[T,t.form.title]]),t.apiResults.length>0?(g(),f("div",Va,[(g(!0),f(X,null,$(t.apiResults,r=>(g(),f("div",{key:r.title,class:"search-result-item",onClick:p=>t.selectApiResult(r)},[s("div",ja,[r.imageUrl?(g(),f("img",{key:0,src:t.ensureHttpsUrl(r.imageUrl),alt:r.title},null,8,za)):(g(),f("div",Ya,[s("span",null,h(r.title.charAt(0).toUpperCase()),1)]))]),s("div",qa,[s("div",Ha,h(r.title),1),s("div",Qa,[r.release?(g(),f("span",Ja,h(t.formatDate(r.release)),1)):b("",!0),r.genre?(g(),f("span",Ka,h(r.genre),1)):b("",!0),r.rating?(g(),f("span",Za,"⭐ "+h(r.rating),1)):b("",!0)])])],8,Oa))),128))])):b("",!0)])])]),s("div",Xa,[s("div",$a,[s("label",ei,[Te(h(t.isWatchlist?"Release Date:":"Release:")+" ",1),t.isWatchlist?(g(),f("span",ti,"*")):b("",!0)]),D(s("input",{type:"date",id:"release","onUpdate:modelValue":e[3]||(e[3]=r=>t.form.release=r),required:t.isWatchlist},null,8,si),[[T,t.form.release]]),t.isWatchlist?(g(),f("div",oi," 📅 Set the release date to track countdown or status ")):b("",!0),t.isWatchlist&&t.form.release?(g(),f("div",ai,[e[45]||(e[45]=s("strong",null,"Preview:",-1)),Te(" "+h(t.getReleasePreview()),1)])):b("",!0)]),s("div",ii,[e[46]||(e[46]=s("label",{for:"apiRating"},"API Rating:",-1)),D(s("input",{type:"number",id:"apiRating","onUpdate:modelValue":e[4]||(e[4]=r=>t.form.apiRating=r),step:"0.1",min:"0",max:"10",placeholder:"0-10",readonly:""},null,512),[[T,t.form.apiRating]]),e[47]||(e[47]=s("div",{class:"field-hint"},"From API - read only",-1))]),s("div",ni,[e[48]||(e[48]=s("label",{for:"personalRating"},"Personal Rating:",-1)),D(s("input",{type:"number",id:"personalRating","onUpdate:modelValue":e[5]||(e[5]=r=>t.form.personalRating=r),step:"0.1",min:"0",max:"10",placeholder:"0-10"},null,512),[[T,t.form.personalRating]]),e[49]||(e[49]=s("div",{class:"field-hint"},"Your personal rating",-1))])]),s("div",ri,[s("div",li,[e[50]||(e[50]=s("label",{for:"views"},"Views:",-1)),D(s("input",{type:"number",id:"views","onUpdate:modelValue":e[6]||(e[6]=r=>t.form.count=r),min:"0",placeholder:"0"},null,512),[[T,t.form.count]])]),s("div",di,[e[51]||(e[51]=s("label",{for:"discovered"},"Discovered:",-1)),D(s("input",{type:"date",id:"discovered","onUpdate:modelValue":e[7]||(e[7]=r=>t.form.discovered=r)},null,512),[[T,t.form.discovered]])])]),s("div",ci,[s("div",ui,[e[52]||(e[52]=s("label",{for:"platforms"},"Platforms:",-1)),D(s("input",{type:"text",id:"platforms","onUpdate:modelValue":e[8]||(e[8]=r=>t.form.platforms=r),placeholder:"PC, PS5, Xbox"},null,512),[[T,t.form.platforms]])]),s("div",gi,[e[53]||(e[53]=s("label",{for:"genre"},"Genre:",-1)),D(s("input",{type:"text",id:"genre","onUpdate:modelValue":e[9]||(e[9]=r=>t.form.genre=r),placeholder:"Action, Adventure, RPG"},null,512),[[T,t.form.genre]])])]),s("div",mi,[s("div",fi,[e[54]||(e[54]=s("label",{for:"description"},"Description:",-1)),D(s("textarea",{id:"description","onUpdate:modelValue":e[10]||(e[10]=r=>t.form.description=r),placeholder:"Enter description...",rows:"3"},null,512),[[T,t.form.description]])])]),t.form.category==="watchlist"?(g(),f("div",pi,[s("div",vi,[e[56]||(e[56]=s("label",{for:"watchlistType"},[Te("Type: "),s("span",{class:"required"},"*")],-1)),D(s("select",{id:"watchlistType","onUpdate:modelValue":e[11]||(e[11]=r=>t.form.watchlistType=r)},[...e[55]||(e[55]=[Fe('<option value="" data-v-5dc54a7d>Select Type</option><option value="game" data-v-5dc54a7d>Game</option><option value="series" data-v-5dc54a7d>Series</option><option value="movie" data-v-5dc54a7d>Movie</option><option value="buecher" data-v-5dc54a7d>Bücher</option>',5)])],512),[[be,t.form.watchlistType]]),t.form.category==="watchlist"&&!t.form.watchlistType?(g(),f("div",hi," Please select a type for watchlist items ")):b("",!0)])])):b("",!0),t.form.category==="buecher"||t.form.watchlistType==="buecher"?(g(),Re(l,{key:1,expanded:!1,onPreferencesChanged:t.handlePreferencesChanged},null,8,["onPreferencesChanged"])):b("",!0),s("div",yi,[s("div",bi,[e[57]||(e[57]=s("label",{for:"link"},"Link:",-1)),D(s("input",{type:"url",id:"link","onUpdate:modelValue":e[12]||(e[12]=r=>t.form.link=r),placeholder:"https://..."},null,512),[[T,t.form.link]])]),s("div",ki,[e[58]||(e[58]=s("label",{for:"path"},"Image Path:",-1)),D(s("input",{type:"text",id:"path","onUpdate:modelValue":e[13]||(e[13]=r=>t.form.path=r),placeholder:"images/movies/filename.jpg"},null,512),[[T,t.form.path]])])]),t.isGame?(g(),f("div",wi,[s("div",Si,[e[59]||(e[59]=s("label",{for:"playtime"},"Playtime (Minutes):",-1)),D(s("input",{type:"number",id:"playtime","onUpdate:modelValue":e[14]||(e[14]=r=>t.form.spielzeit=r),min:"0",placeholder:"0"},null,512),[[T,t.form.spielzeit]])])])):b("",!0),t.isSeries?(g(),f("div",_i,[s("div",Ii,[e[61]||(e[61]=s("label",{for:"isAiring"},"Status:",-1)),D(s("select",{id:"isAiring","onUpdate:modelValue":e[15]||(e[15]=r=>t.form.isAiring=r)},[...e[60]||(e[60]=[s("option",{value:!1},"Finished",-1),s("option",{value:!0},"Airing",-1)])],512),[[be,t.form.isAiring]])]),t.form.isAiring?(g(),f("div",Ci,[e[62]||(e[62]=s("label",{for:"nextSeason"},"Next Season:",-1)),D(s("input",{type:"number",id:"nextSeason","onUpdate:modelValue":e[16]||(e[16]=r=>t.form.nextSeason=r),min:"1",placeholder:"1"},null,512),[[T,t.form.nextSeason]])])):b("",!0)])):b("",!0),t.isSeries?(g(),f("div",xi,[s("div",Ai,[e[63]||(e[63]=s("label",null,"TMDB Series Information:",-1)),s("div",Di,[s("button",{type:"button",onClick:e[17]||(e[17]=(...r)=>t.checkSeriesAPI&&t.checkSeriesAPI(...r)),disabled:t.loading||!t.form.title,class:"api-check-btn"},[t.apiLoading?(g(),f("span",Ti,"🔍 Checking...")):(g(),f("span",Ri,"🔍 Check Series Info"))],8,Mi),t.apiError?(g(),f("div",Ui,h(t.apiError),1)):b("",!0),t.apiSuccess?(g(),f("div",Pi," ✅ Series information updated from TMDB ")):b("",!0)])])])):b("",!0),t.isSeries?(g(),f("div",Bi,[s("div",Ei,[e[64]||(e[64]=s("label",{for:"nextSeasonName"},"Next Season Name:",-1)),D(s("input",{type:"text",id:"nextSeasonName","onUpdate:modelValue":e[18]||(e[18]=r=>t.form.nextSeasonName=r),placeholder:"e.g., The Final Season"},null,512),[[T,t.form.nextSeasonName]])]),s("div",Fi,[e[65]||(e[65]=s("label",{for:"lastAirDate"},"Last Air Date:",-1)),D(s("input",{type:"date",id:"lastAirDate","onUpdate:modelValue":e[19]||(e[19]=r=>t.form.lastAirDate=r)},null,512),[[T,t.form.lastAirDate]])])])):b("",!0),t.isSeries?(g(),f("div",Li,[s("div",Ni,[e[66]||(e[66]=s("label",{for:"totalSeasons"},"Total Seasons:",-1)),D(s("input",{type:"number",id:"totalSeasons","onUpdate:modelValue":e[20]||(e[20]=r=>t.form.totalSeasons=r),min:"0",placeholder:"0"},null,512),[[T,t.form.totalSeasons]])]),s("div",Gi,[e[67]||(e[67]=s("label",{for:"totalEpisodes"},"Total Episodes:",-1)),D(s("input",{type:"number",id:"totalEpisodes","onUpdate:modelValue":e[21]||(e[21]=r=>t.form.totalEpisodes=r),min:"0",placeholder:"0"},null,512),[[T,t.form.totalEpisodes]])])])):b("",!0),t.isSeries?(g(),f("div",Wi,[s("div",Vi,[e[69]||(e[69]=s("label",{for:"seriesStatus"},"Series Status:",-1)),D(s("select",{id:"seriesStatus","onUpdate:modelValue":e[22]||(e[22]=r=>t.form.seriesStatus=r)},[...e[68]||(e[68]=[Fe('<option value="" data-v-5dc54a7d>Select Status</option><option value="Returning Series" data-v-5dc54a7d>Returning Series</option><option value="Ended" data-v-5dc54a7d>Ended</option><option value="In Production" data-v-5dc54a7d>In Production</option><option value="Canceled" data-v-5dc54a7d>Canceled</option>',5)])],512),[[be,t.form.seriesStatus]])]),s("div",Oi,[e[70]||(e[70]=s("label",{for:"networks"},"Networks:",-1)),D(s("input",{type:"text",id:"networks","onUpdate:modelValue":e[23]||(e[23]=r=>t.form.networks=r),placeholder:"e.g., Netflix, HBO"},null,512),[[T,t.form.networks]])])])):b("",!0),t.isSeries?(g(),f("div",ji,[s("div",zi,[e[71]||(e[71]=s("label",{for:"createdBy"},"Created By:",-1)),D(s("input",{type:"text",id:"createdBy","onUpdate:modelValue":e[24]||(e[24]=r=>t.form.createdBy=r),placeholder:"e.g., The Duffer Brothers"},null,512),[[T,t.form.createdBy]])])])):b("",!0),t.isSeries?(g(),f("div",Yi,[s("div",qi,[e[72]||(e[72]=s("label",{for:"extraLink"},"Extra Link:",-1)),D(s("input",{type:"url",id:"extraLink","onUpdate:modelValue":e[25]||(e[25]=r=>t.form.extraLink=r),placeholder:"https://... (e.g., streaming platform, official website)"},null,512),[[T,t.form.extraLink]]),e[73]||(e[73]=s("div",{class:"field-hint"},"Optional: Additional link for series (e.g., streaming platform, official website)",-1))])])):b("",!0),t.form.isAiring?(g(),f("div",Hi,[s("div",Qi,[e[74]||(e[74]=s("label",{for:"nextSeasonRelease"},"Next Season Release:",-1)),D(s("input",{type:"date",id:"nextSeasonRelease","onUpdate:modelValue":e[26]||(e[26]=r=>t.form.nextSeasonRelease=r)},null,512),[[T,t.form.nextSeasonRelease]])])])):b("",!0),s("div",Ji,[s("div",Ki,[e[75]||(e[75]=s("label",{for:"imageUrl"},"Image URL (optional):",-1)),D(s("input",{type:"text",id:"imageUrl","onUpdate:modelValue":e[27]||(e[27]=r=>t.form.imageUrl=r),placeholder:"https://... or leave empty for API images"},null,512),[[T,t.form.imageUrl]])]),s("div",Zi,[e[76]||(e[76]=s("label",{for:"imageUpload"},"Upload Image:",-1)),s("div",Xi,[s("input",{type:"file",id:"imageUpload",ref:"imageUploadRef",onChange:e[28]||(e[28]=(...r)=>t.handleImageUpload&&t.handleImageUpload(...r)),accept:"image/*",style:{display:"none"}},null,544),s("button",{type:"button",onClick:e[29]||(e[29]=(...r)=>t.triggerImageUpload&&t.triggerImageUpload(...r)),class:"upload-btn",disabled:t.loading}," 📁 Choose Image ",8,$i),t.uploadedImagePath?(g(),f("div",en,[Te(" ✅ Image uploaded: "+h(t.uploadedImagePath)+" ",1),s("button",{type:"button",onClick:e[30]||(e[30]=(...r)=>t.removeUploadedImage&&t.removeUploadedImage(...r)),class:"remove-uploaded-btn",title:"Remove uploaded image to enable API search"}," ✕ Remove ")])):b("",!0)])])]),t.shouldShowImagePreview?(g(),f("div",tn,[s("div",sn,[e[77]||(e[77]=s("label",null,"Image Preview:",-1)),s("div",on,[s("img",{src:t.getImagePreviewUrl(),alt:t.form.title,onError:e[31]||(e[31]=(...r)=>t.handleImageError&&t.handleImageError(...r)),onLoad:e[32]||(e[32]=(...r)=>t.handleImageLoad&&t.handleImageLoad(...r)),onLoadstart:e[33]||(e[33]=(...r)=>t.handleImageLoadStart&&t.handleImageLoadStart(...r)),onLoadend:e[34]||(e[34]=(...r)=>t.handleImageLoadEnd&&t.handleImageLoadEnd(...r))},null,40,an),s("button",{type:"button",onClick:e[35]||(e[35]=(...r)=>t.clearImage&&t.clearImage(...r)),class:"clear-image-btn",title:"Remove image"}," ✕ ")])])])):b("",!0),t.error?(g(),f("div",nn,h(t.error),1)):b("",!0),s("div",rn,[s("button",{type:"submit",disabled:t.loading},h(t.loading?"Saving...":"Save"),9,ln),s("button",{type:"button",onClick:e[36]||(e[36]=(...r)=>t.closeModal&&t.closeModal(...r)),disabled:t.loading}," Cancel ",8,dn),t.isEditing?(g(),f("button",{key:0,type:"button",onClick:e[37]||(e[37]=(...r)=>t.deleteItem&&t.deleteItem(...r)),disabled:t.loading,class:"delete-btn"}," Delete ",8,cn)):b("",!0),s("button",{type:"button",onClick:e[38]||(e[38]=(...r)=>t.handleSave&&t.handleSave(...r)),disabled:t.loading,class:"check-btn",title:"Add to list"}," ✓ ",8,un)])],32)])])}const mn=ee(Ea,[["render",gn],["__scopeId","data-v-5dc54a7d"]]),fn={name:"BulkAddModal",props:{show:{type:Boolean,default:!1},currentCategory:{type:String,default:""}},emits:["close"],setup(i,{emit:e}){const o=Ye(),t=S(1),n=S(!1),c=S(!0),l=S(!1),r=S(0),p=S(0),I=S(0),A=S(0),C=S(null),m=S(""),k=S(""),H=S([]),te=S([]),O=S({category:"",itemsText:"",defaultRating:null}),Q=F(()=>O.value.category&&O.value.itemsText.trim()&&!n.value),ce=F(()=>{const G=me().length;return G>0?Math.round(r.value/G*100):0}),me=()=>!O.value.itemsText||!O.value.itemsText.trim()?[]:O.value.itemsText.split(`
`).map(G=>G.trim()).filter(G=>G.length>0).map(G=>{const z=G.split("|").map(q=>q.trim());return{searchTerm:z[0]||"",additionalInfo:z[1]||null}}),v=()=>{r.value=0,p.value=0,I.value=0,A.value=0,C.value=null,m.value="",k.value="",H.value=[],te.value=[]},N=(G,z,q)=>{C.value=G,m.value=z,k.value=q},re=(G,z,q="")=>{const pe={searching:"Searching...",found:"Found",adding:"Adding...",added:"Added",skipped:"Skipped",error:"Error"}[z]||z;H.value.push({title:G,status:z,statusText:pe,message:q})},ie=async()=>{var q,pe,ve;if(!Q.value)return;t.value=2,n.value=!0,c.value=!0,v();const G=me();let z=0;try{let ue=[];const ke=localStorage.getItem("authToken"),Ce=localStorage.getItem("currentUser");if(ke&&Ce)try{N({title:"Checking all items..."},"searching","Checking profile for duplicates..."),ue=(await ne.checkExistingItems(G.map(a=>({title:a.searchTerm,category:O.value.category})))).existing_items||[]}catch(le){console.warn("Failed to check existing items, falling back to individual checks:",le)}for(let le=0;le<G.length;le++){const a=G[le];r.value=le+1,N({title:a.searchTerm,description:a.additionalInfo},"searching","Processing...");try{let u=!1;if(ke&&Ce&&ue.length>0?u=ue.some(y=>y.title.toLowerCase().trim()===a.searchTerm.toLowerCase().trim()):u=(o.mediaData||[]).some(R=>R.title&&R.title.toLowerCase().trim()===a.searchTerm.toLowerCase().trim()&&R.category===O.value.category),u){console.log(`✅ Found exact match in profile for "${a.searchTerm}"`),N({title:a.searchTerm},"skipped","Already exists in profile - skipped"),te.value.push({searchTerm:a.searchTerm,additionalInfo:a.additionalInfo,reason:"duplicate"}),I.value++,re(a.searchTerm,"skipped","Already exists in profile - skipped");continue}N({title:a.searchTerm,description:a.additionalInfo},"searching","Searching API..."),re(a.searchTerm,"searching","Searching API...");const _=await ne.searchApi(a.searchTerm,O.value.category,1);if(_&&_.length>0&&_[0]&&_[0].api_source&&_[0].image){const y=_[0];console.log(`✅ Found real API data for "${a.searchTerm}":`,{title:y.title,api_source:y.api_source,has_image:!!y.image,has_genre:!!y.genre,has_release:!!y.release}),N({title:y.title,description:`Found: ${y.genre||"Unknown genre"} • ${y.release||"Unknown year"} • ${y.api_source}`},"found","Found in API with data"),re(a.searchTerm,"found",`Found: ${y.title} (${y.api_source})`),N({title:y.title},"adding","Adding to library...");const R={title:y.title,category:O.value.category,release:y.release||null,rating:y.rating?Math.round(y.rating):O.value.defaultRating||null,platforms:y.platforms||null,genre:y.genre||null,link:y.link||null,path:y.image||null,external_id:y.id||null,count:1,is_airing:!1,spielzeit:0,description:y.overview||a.additionalInfo||null};await o.addMediaItem(R,!0),p.value++,N({title:y.title},"added","Successfully added with API data"),re(a.searchTerm,"added",`Added: ${y.title} with API data`)}else console.log(`❌ No real API data found for "${a.searchTerm}"`),N({title:a.searchTerm},"skipped","No API data found - will retry"),te.value.push({searchTerm:a.searchTerm,additionalInfo:a.additionalInfo,reason:"no_api_data"}),I.value++,re(a.searchTerm,"skipped","No API data found - ready for retry")}catch(u){console.error(`Error processing "${a.searchTerm}":`,u),u.isDuplicate||((q=u.response)==null?void 0:q.status)===409&&((ve=(pe=u.response)==null?void 0:pe.data)!=null&&ve.duplicate)?(N({title:a.searchTerm},"skipped","Already exists - skipped"),I.value++,re(a.searchTerm,"skipped","Item already exists in library")):(N({title:a.searchTerm},"error","Error occurred"),A.value++,re(a.searchTerm,"error",u.message||"Unknown error"))}if(z++,z>=5){console.log("🔄 Reloading media data after 5 items...");try{await o.loadMedia(),z=0}catch(u){console.warn("Failed to reload media data:",u)}}if(!n.value)break;for(;l.value&&n.value;)await new Promise(u=>setTimeout(u,100));await new Promise(u=>setTimeout(u,1e3))}console.log("🔄 Final media data reload...");try{await o.loadMedia()}catch(le){console.warn("Failed to reload media data at end:",le)}t.value=3,N(null,"","")}catch(ue){console.error("Bulk processing error:",ue),A.value++}finally{n.value=!1,c.value=!1}},Se=()=>{n.value=!1,c.value=!1,l.value=!1,t.value=1,v()},fe=()=>{l.value=!0},_e=()=>{l.value=!1},Ie=()=>{const G=te.value.filter(q=>q.reason!=="duplicate");if(G.length===0){K();return}const z=G.map(q=>q.additionalInfo?`${q.searchTerm} | ${q.additionalInfo}`:q.searchTerm).join(`
`);O.value.itemsText=z,r.value=0,p.value=0,A.value=0,C.value=null,m.value="",k.value="",H.value=[],t.value=1},K=()=>{t.value=1,n.value=!1,c.value=!0,v(),O.value={category:"",itemsText:"",defaultRating:null},e("close")};return De(()=>i.show,G=>{G&&i.currentCategory?O.value.category=i.currentCategory:G||K()}),{currentStep:t,isProcessing:n,canCancel:c,isPaused:l,processedCount:r,addedCount:p,skippedCount:I,errorCount:A,currentItem:C,currentItemStatus:m,currentItemStatusText:k,processingResults:H,skippedItems:te,bulkData:O,canStart:Q,progressPercentage:ce,startProcessing:ie,cancelProcessing:Se,pauseProcessing:fe,resumeProcessing:_e,retrySkippedItems:Ie,closeModal:K}}},pn={class:"modal-header"},vn={class:"modal-body"},hn={key:0,class:"step-container"},yn={class:"bulk-add-form"},bn={class:"form-group"},kn={class:"form-group"},wn={class:"form-group"},Sn={key:1,class:"step-container"},_n={class:"processing-container"},In={class:"progress-overview"},Cn={class:"progress-stats"},xn={class:"stat"},An={class:"stat-number"},Dn={class:"stat"},Mn={class:"stat-number"},Tn={class:"stat"},Rn={class:"stat-number"},Un={class:"stat"},Pn={class:"stat-number"},Bn={class:"progress-bar"},En={class:"progress-text"},Fn={class:"current-item"},Ln={class:"current-item-header"},Nn={class:"current-item-title"},Gn={key:0,class:"paused-indicator"},Wn={key:0,class:"current-item-description"},Vn={key:1,class:"api-data-indicator"},On={key:2,class:"no-api-indicator"},jn={class:"results-list"},zn={class:"result-header"},Yn={class:"result-title"},qn={class:"result-status"},Hn={key:0,class:"result-message"},Qn={key:2,class:"step-container"},Jn={class:"results-summary"},Kn={class:"summary-stats"},Zn={class:"summary-stat success"},Xn={class:"stat-number"},$n={class:"summary-stat warning"},er={class:"stat-number"},tr={class:"summary-stat info"},sr={class:"stat-number"},or={class:"summary-stat error"},ar={class:"stat-number"},ir={key:0,class:"retry-section"},nr={class:"retry-list"},rr=["onUpdate:modelValue","disabled"],lr={key:0,class:"retry-additional"},dr={key:1,class:"duplicate-badge"},cr={key:2,class:"retry-badge"},ur={key:1,class:"detailed-results"},gr={class:"results-list"},mr={class:"result-header"},fr={class:"result-title"},pr={class:"result-status"},vr={key:0,class:"result-message"},hr={class:"modal-footer"},yr=["disabled"],br={key:2,class:"processing-controls"},kr=["disabled"],wr=["disabled"],Sr={key:3,class:"footer-buttons"};function _r(i,e,o,t,n,c){var l,r;return o.show?(g(),f("div",{key:0,class:"modal-overlay",onClick:e[12]||(e[12]=(...p)=>t.closeModal&&t.closeModal(...p))},[s("div",{class:"modal-content",onClick:e[11]||(e[11]=de(()=>{},["stop"]))},[s("div",pn,[e[13]||(e[13]=s("h2",null,"Bulk Add Items",-1)),s("button",{class:"close-btn",onClick:e[0]||(e[0]=(...p)=>t.closeModal&&t.closeModal(...p))},"✕")]),s("div",vn,[t.currentStep===1?(g(),f("div",hn,[e[19]||(e[19]=s("div",{class:"step-header"},[s("div",{class:"step-number"},"1"),s("h3",null,"Enter Your List")],-1)),s("div",yn,[s("div",bn,[e[15]||(e[15]=s("label",{for:"category"},"Category *",-1)),D(s("select",{id:"category","onUpdate:modelValue":e[1]||(e[1]=p=>t.bulkData.category=p),required:""},[...e[14]||(e[14]=[Fe('<option value="" data-v-007de140>Select Category</option><option value="game" data-v-007de140>Game</option><option value="series" data-v-007de140>Series</option><option value="movie" data-v-007de140>Movie</option><option value="buecher" data-v-007de140>Bücher</option><option value="watchlist" data-v-007de140>Watchlist</option>',6)])],512),[[be,t.bulkData.category]])]),s("div",kn,[e[16]||(e[16]=s("label",{for:"items-text"},"Items (one per line) *",-1)),D(s("textarea",{id:"items-text","onUpdate:modelValue":e[2]||(e[2]=p=>t.bulkData.itemsText=p),placeholder:`Enter items one per line, for example:
The Witcher 3
Cyberpunk 2077
Red Dead Redemption 2`,rows:"10",required:""},null,512),[[T,t.bulkData.itemsText]]),e[17]||(e[17]=s("small",{class:"help-text"},"Enter one item per line. The system will automatically search and add each item individually.",-1))]),s("div",wn,[e[18]||(e[18]=s("label",{for:"default-rating"},"Default Rating",-1)),D(s("input",{id:"default-rating","onUpdate:modelValue":e[3]||(e[3]=p=>t.bulkData.defaultRating=p),type:"number",min:"0",max:"10",step:"0.1",placeholder:"Optional rating for all items"},null,512),[[T,t.bulkData.defaultRating,void 0,{number:!0}]])])])])):b("",!0),t.currentStep===2?(g(),f("div",Sn,[e[24]||(e[24]=s("div",{class:"step-header"},[s("div",{class:"step-number"},"2"),s("h3",null,"Processing Items")],-1)),s("div",_n,[s("div",In,[s("div",Cn,[s("span",xn,[s("span",An,h(t.processedCount),1),e[20]||(e[20]=s("span",{class:"stat-label"},"Processed",-1))]),s("span",Dn,[s("span",Mn,h(t.addedCount),1),e[21]||(e[21]=s("span",{class:"stat-label"},"Added",-1))]),s("span",Tn,[s("span",Rn,h(t.skippedCount),1),e[22]||(e[22]=s("span",{class:"stat-label"},"Skipped",-1))]),s("span",Un,[s("span",Pn,h(t.errorCount),1),e[23]||(e[23]=s("span",{class:"stat-label"},"Errors",-1))])]),s("div",Bn,[s("div",{class:"progress-fill",style:Ue({width:t.progressPercentage+"%"})},null,4)]),s("div",En,h(t.progressPercentage)+"% Complete",1)]),s("div",Fn,[s("div",Ln,[s("span",Nn,"Processing: "+h(((l=t.currentItem)==null?void 0:l.title)||"..."),1),s("span",{class:j(["current-item-status",t.currentItemStatus])},[t.isPaused?(g(),f("span",Gn,"⏸️ PAUSED - ")):b("",!0),Te(h(t.currentItemStatusText),1)],2)]),(r=t.currentItem)!=null&&r.description?(g(),f("div",Wn,h(t.currentItem.description),1)):b("",!0),t.currentItemStatus==="found"?(g(),f("div",Vn," ✅ Real API data found with image and metadata ")):b("",!0),t.currentItemStatus==="skipped"?(g(),f("div",On," ❌ No API data found - will be retried ")):b("",!0)]),s("div",jn,[(g(!0),f(X,null,$(t.processingResults,(p,I)=>(g(),f("div",{key:I,class:j(["result-item",p.status])},[s("div",zn,[s("span",Yn,h(p.title),1),s("span",qn,h(p.statusText),1)]),p.message?(g(),f("div",Hn,h(p.message),1)):b("",!0)],2))),128))])])])):b("",!0),t.currentStep===3?(g(),f("div",Qn,[e[32]||(e[32]=s("div",{class:"step-header"},[s("div",{class:"step-number"},"3"),s("h3",null,"Results")],-1)),s("div",Jn,[s("div",Kn,[s("div",Zn,[s("span",Xn,h(t.addedCount),1),e[25]||(e[25]=s("span",{class:"stat-label"},"Successfully Added",-1))]),s("div",$n,[s("span",er,h(t.skippedItems.filter(p=>p.reason!=="duplicate").length),1),e[26]||(e[26]=s("span",{class:"stat-label"},"Not Found (Ready for Retry)",-1))]),s("div",tr,[s("span",sr,h(t.skippedItems.filter(p=>p.reason==="duplicate").length),1),e[27]||(e[27]=s("span",{class:"stat-label"},"Already in Profile",-1))]),s("div",or,[s("span",ar,h(t.errorCount),1),e[28]||(e[28]=s("span",{class:"stat-label"},"Errors",-1))])]),t.skippedItems.length>0?(g(),f("div",ir,[e[29]||(e[29]=s("h4",null,"Items Ready for Retry",-1)),e[30]||(e[30]=s("p",{class:"retry-description"}," The following items can be edited and tried again: ",-1)),s("div",nr,[(g(!0),f(X,null,$(t.skippedItems,(p,I)=>(g(),f("div",{key:I,class:j(["retry-item",{"duplicate-item":p.reason==="duplicate"}])},[D(s("input",{"onUpdate:modelValue":A=>p.searchTerm=A,class:"retry-input",placeholder:"Edit search term...",disabled:p.reason==="duplicate"},null,8,rr),[[T,p.searchTerm]]),p.additionalInfo?(g(),f("span",lr," | "+h(p.additionalInfo),1)):b("",!0),p.reason==="duplicate"?(g(),f("span",dr," Already in profile ")):(g(),f("span",cr," No API data "))],2))),128))])])):b("",!0),t.processingResults.length>0?(g(),f("div",ur,[e[31]||(e[31]=s("h4",null,"Detailed Results",-1)),s("div",gr,[(g(!0),f(X,null,$(t.processingResults,(p,I)=>(g(),f("div",{key:I,class:j(["result-item",p.status])},[s("div",mr,[s("span",fr,h(p.title),1),s("span",pr,h(p.statusText),1)]),p.message?(g(),f("div",vr,h(p.message),1)):b("",!0)],2))),128))])])):b("",!0)])])):b("",!0)]),s("div",hr,[t.currentStep===1?(g(),f("button",{key:0,class:"btn btn-secondary",onClick:e[4]||(e[4]=(...p)=>t.closeModal&&t.closeModal(...p))}," Cancel ")):b("",!0),t.currentStep===1?(g(),f("button",{key:1,class:"btn btn-primary",onClick:e[5]||(e[5]=(...p)=>t.startProcessing&&t.startProcessing(...p)),disabled:!t.canStart}," Check All and Add ",8,yr)):b("",!0),t.currentStep===2?(g(),f("div",br,[s("button",{class:"btn btn-secondary",onClick:e[6]||(e[6]=(...p)=>t.cancelProcessing&&t.cancelProcessing(...p)),disabled:!t.canCancel}," Cancel ",8,kr),t.isPaused?b("",!0):(g(),f("button",{key:0,class:"btn btn-warning",onClick:e[7]||(e[7]=(...p)=>t.pauseProcessing&&t.pauseProcessing(...p)),disabled:!t.isProcessing}," Pause ",8,wr)),t.isPaused?(g(),f("button",{key:1,class:"btn btn-primary",onClick:e[8]||(e[8]=(...p)=>t.resumeProcessing&&t.resumeProcessing(...p))}," Resume ")):b("",!0)])):b("",!0),t.currentStep===3?(g(),f("div",Sr,[t.skippedItems.filter(p=>p.reason!=="duplicate").length>0?(g(),f("button",{key:0,class:"btn btn-warning",onClick:e[9]||(e[9]=(...p)=>t.retrySkippedItems&&t.retrySkippedItems(...p))}," Retry "+h(t.skippedItems.filter(p=>p.reason!=="duplicate").length)+" Items ",1)):b("",!0),s("button",{class:"btn btn-primary",onClick:e[10]||(e[10]=(...p)=>t.closeModal&&t.closeModal(...p))}," Done ")])):b("",!0)])])])):b("",!0)}const Ir=ee(fn,[["render",_r],["__scopeId","data-v-007de140"]]),Cr={name:"TxtImportModal",props:{show:{type:Boolean,default:!1}},emits:["close","fileProcessed"],methods:{handleFileUpload(i){const e=i.target.files[0];if(!e)return;if(!e.name.toLowerCase().endsWith(".txt")){alert("Bitte wählen Sie eine .txt Datei aus.");return}const o=new FileReader;o.onload=t=>{const n=t.target.result;this.$emit("fileProcessed",n)},o.readAsText(e,"UTF-8")}}},xr={class:"file-upload-area"},Ar={class:"modal-buttons"};function Dr(i,e,o,t,n,c){return o.show?(g(),f("div",{key:0,class:"modal",onClick:e[3]||(e[3]=l=>i.$emit("close"))},[s("div",{class:"modal-content",onClick:e[2]||(e[2]=de(()=>{},["stop"]))},[e[5]||(e[5]=s("h2",null,"📄 Import from TXT File",-1)),e[6]||(e[6]=s("p",null,"Wählen Sie eine .txt Datei mit einer Liste von Titeln aus, um zu prüfen, welche Items in der aktuellen Kategorie fehlen.",-1)),s("div",xr,[s("input",{type:"file",id:"txtFileInput",accept:".txt",onChange:e[0]||(e[0]=(...l)=>c.handleFileUpload&&c.handleFileUpload(...l)),style:{display:"none"}},null,32),e[4]||(e[4]=s("label",{for:"txtFileInput",class:"file-upload-label"},[s("span",{class:"upload-icon"},"📁"),s("span",{class:"upload-text"},"TXT-Datei auswählen"),s("span",{class:"upload-hint"},"Eine .txt Datei mit einer Liste von Titeln")],-1))]),s("div",Ar,[s("button",{type:"button",onClick:e[1]||(e[1]=l=>i.$emit("close"))}," Cancel ")])])])):b("",!0)}const Mr=ee(Cr,[["render",Dr],["__scopeId","data-v-e20860d6"]]),Tr={name:"TxtImportResultsModal",props:{show:{type:Boolean,default:!1},results:{type:Object,default:null}},emits:["close"]},Rr={class:"results-summary"},Ur={class:"summary-item"},Pr={class:"summary-value"},Br={class:"summary-item"},Er={class:"summary-value"},Fr={class:"summary-item"},Lr={class:"summary-value existing"},Nr={class:"summary-item"},Gr={class:"summary-value missing"},Wr={key:0,class:"missing-items"},Vr={class:"items-list"},Or={key:1,class:"existing-items"},jr={class:"items-list"},zr={class:"modal-buttons"};function Yr(i,e,o,t,n,c){return o.show&&o.results?(g(),f("div",{key:0,class:"modal",onClick:e[2]||(e[2]=l=>i.$emit("close"))},[s("div",{class:"modal-content results-modal",onClick:e[1]||(e[1]=de(()=>{},["stop"]))},[e[7]||(e[7]=s("h2",null,"📊 TXT Import Ergebnisse",-1)),s("div",Rr,[s("div",Ur,[e[3]||(e[3]=s("span",{class:"summary-label"},"Kategorie:",-1)),s("span",Pr,h(o.results.categoryName),1)]),s("div",Br,[e[4]||(e[4]=s("span",{class:"summary-label"},"Titel in Datei:",-1)),s("span",Er,h(o.results.totalInFile),1)]),s("div",Fr,[e[5]||(e[5]=s("span",{class:"summary-label"},"Bereits vorhanden:",-1)),s("span",Lr,h(o.results.existingItems.length),1)]),s("div",Nr,[e[6]||(e[6]=s("span",{class:"summary-label"},"Fehlende Titel:",-1)),s("span",Gr,h(o.results.missingItems.length),1)])]),o.results.missingItems.length>0?(g(),f("div",Wr,[s("h3",null,"❌ Fehlende Titel ("+h(o.results.missingItems.length)+"):",1),s("div",Vr,[(g(!0),f(X,null,$(o.results.missingItems,(l,r)=>(g(),f("div",{key:r,class:"missing-item"},h(l),1))),128))])])):b("",!0),o.results.existingItems.length>0?(g(),f("div",Or,[s("h3",null,"✅ Bereits vorhanden ("+h(o.results.existingItems.length)+"):",1),s("div",jr,[(g(!0),f(X,null,$(o.results.existingItems,(l,r)=>(g(),f("div",{key:r,class:"existing-item"},h(l),1))),128))])])):b("",!0),s("div",zr,[s("button",{type:"button",onClick:e[0]||(e[0]=l=>i.$emit("close"))}," Schließen ")])])])):b("",!0)}const qr=ee(Tr,[["render",Yr],["__scopeId","data-v-ec385b83"]]),Hr={name:"SimpleAddItem",setup(){const i=S(!1),e=S(null),o=Pe({title:"Test Game",category:"game",release:"2003-01-01",count:1});return{form:o,loading:i,result:e,addItem:async()=>{i.value=!0,e.value=null;try{const n=window.location.origin,c=await fetch(`${n}/api/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:"admin@example.com",password:"admin123"})});if(!c.ok)throw new Error("Login failed");const r=(await c.json()).token,I=await(await fetch(`${n}/api/media`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(o)})).json();I.success?e.value={success:!0,message:`Success! Item added with ID: ${I.data.id}`}:e.value={success:!1,message:`Error: ${JSON.stringify(I)}`}}catch(n){e.value={success:!1,message:`Error: ${n.message}`}}finally{i.value=!1}}}}},Qr={class:"simple-add-item"},Jr=["disabled"];function Kr(i,e,o,t,n,c){return g(),f("div",Qr,[e[10]||(e[10]=s("h3",null,"Simple Add Item Test",-1)),s("form",{onSubmit:e[4]||(e[4]=de((...l)=>t.addItem&&t.addItem(...l),["prevent"]))},[s("div",null,[e[5]||(e[5]=s("label",null,"Title:",-1)),D(s("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>t.form.title=l),type:"text",required:""},null,512),[[T,t.form.title]])]),s("div",null,[e[7]||(e[7]=s("label",null,"Category:",-1)),D(s("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>t.form.category=l)},[...e[6]||(e[6]=[s("option",{value:"game"},"Game",-1),s("option",{value:"movie"},"Movie",-1),s("option",{value:"series"},"Series",-1)])],512),[[be,t.form.category]])]),s("div",null,[e[8]||(e[8]=s("label",null,"Release:",-1)),D(s("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>t.form.release=l),type:"date"},null,512),[[T,t.form.release]])]),s("div",null,[e[9]||(e[9]=s("label",null,"Count:",-1)),D(s("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>t.form.count=l),type:"number",min:"0"},null,512),[[T,t.form.count]])]),s("button",{type:"submit",disabled:t.loading},h(t.loading?"Adding...":"Add Item"),9,Jr)],32),t.result?(g(),f("div",{key:0,class:j(["result",t.result.success?"success":"error"])},h(t.result.message),3)):b("",!0)])}const Zr=ee(Hr,[["render",Kr],["__scopeId","data-v-4298065b"]]),Xr={name:"LoadingSpinner",props:{loading:{type:Boolean,default:!0},message:{type:String,default:"Loading..."}}},$r={key:0,class:"loading-spinner"},el={key:0};function tl(i,e,o,t,n,c){return o.loading?(g(),f("div",$r,[e[0]||(e[0]=s("div",{class:"spinner"},null,-1)),o.message?(g(),f("p",el,h(o.message),1)):b("",!0)])):b("",!0)}const sl=ee(Xr,[["render",tl],["__scopeId","data-v-0e82c46a"]]),ol={name:"MessageBox",props:{show:{type:Boolean,default:!1},type:{type:String,default:"info",validator:i=>["success","error","warning","info"].includes(i)},title:{type:String,default:""},message:{type:String,required:!0},details:{type:String,default:""}},emits:["close"],setup(i,{emit:e}){const o=()=>{e("close")},t=F(()=>{switch(i.type){case"success":return"✅";case"error":return"❌";case"warning":return"⚠️";case"info":return"ℹ️";default:return"ℹ️"}}),n=F(()=>`message-${i.type}`);return{closeMessage:o,icon:t,messageType:n}}},al={class:"message-header"},il={class:"message-icon"},nl={class:"message-title"},rl={class:"message-body"},ll={key:0,class:"message-details"},dl={class:"message-footer"};function cl(i,e,o,t,n,c){return o.show?(g(),f("div",{key:0,class:"message-overlay",onClick:e[3]||(e[3]=(...l)=>t.closeMessage&&t.closeMessage(...l))},[s("div",{class:j(["message-box",t.messageType]),onClick:e[2]||(e[2]=de(()=>{},["stop"]))},[s("div",al,[s("span",il,h(t.icon),1),s("h3",nl,h(o.title),1),s("button",{class:"close-btn",onClick:e[0]||(e[0]=(...l)=>t.closeMessage&&t.closeMessage(...l))},"✕")]),s("div",rl,[s("p",null,h(o.message),1),o.details?(g(),f("div",ll,[s("pre",null,h(o.details),1)])):b("",!0)]),s("div",dl,[s("button",{class:"btn btn-primary",onClick:e[1]||(e[1]=(...l)=>t.closeMessage&&t.closeMessage(...l))},"OK")])],2)])):b("",!0)}const ul=ee(ol,[["render",cl],["__scopeId","data-v-198ec3cc"]]),gl={name:"ConfirmDialog",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm Action"},message:{type:String,required:!0}},emits:["confirm","close"],setup(i,{emit:e}){const o=()=>{e("close")};return{closeDialog:o,confirmAction:()=>{e("confirm"),o()}}}},ml={class:"confirm-header"},fl={class:"confirm-title"},pl={class:"confirm-body"},vl={class:"confirm-footer"};function hl(i,e,o,t,n,c){return o.show?(g(),f("div",{key:0,class:"confirm-overlay",onClick:e[4]||(e[4]=(...l)=>t.closeDialog&&t.closeDialog(...l))},[s("div",{class:"confirm-dialog",onClick:e[3]||(e[3]=de(()=>{},["stop"]))},[s("div",ml,[s("h3",fl,h(o.title),1),s("button",{class:"close-btn",onClick:e[0]||(e[0]=(...l)=>t.closeDialog&&t.closeDialog(...l))},"✕")]),s("div",pl,[s("p",null,h(o.message),1)]),s("div",vl,[s("button",{class:"btn btn-secondary",onClick:e[1]||(e[1]=(...l)=>t.closeDialog&&t.closeDialog(...l))},"Cancel"),s("button",{class:"btn btn-danger",onClick:e[2]||(e[2]=(...l)=>t.confirmAction&&t.confirmAction(...l))},"Confirm")])])])):b("",!0)}const yl=ee(gl,[["render",hl],["__scopeId","data-v-fd570f57"]]),bl={name:"InputDialog",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Input Required"},message:{type:String,required:!0},placeholder:{type:String,default:""},inputType:{type:String,default:"text"},defaultValue:{type:String,default:""}},emits:["confirm","close"],setup(i,{emit:e}){const o=S(""),t=S(null),n=()=>{e("close")},c=()=>{e("confirm",o.value),n()};return De(()=>i.show,async l=>{l&&(o.value=i.defaultValue,await Zt(),t.value&&(t.value.focus(),t.value.select()))}),{inputValue:o,inputRef:t,closeDialog:n,confirmAction:c}}},kl={class:"input-header"},wl={class:"input-title"},Sl={class:"input-body"},_l={class:"input-message"},Il=["type","placeholder"],Cl={class:"input-footer"};function xl(i,e,o,t,n,c){return o.show?(g(),f("div",{key:0,class:"input-overlay",onClick:e[6]||(e[6]=(...l)=>t.closeDialog&&t.closeDialog(...l))},[s("div",{class:"input-dialog",onClick:e[5]||(e[5]=de(()=>{},["stop"]))},[s("div",kl,[s("h3",wl,h(o.title),1),s("button",{class:"close-btn",onClick:e[0]||(e[0]=(...l)=>t.closeDialog&&t.closeDialog(...l))},"✕")]),s("div",Sl,[s("p",_l,h(o.message),1),D(s("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>t.inputValue=l),type:o.inputType,placeholder:o.placeholder,class:"input-field",onKeyup:e[2]||(e[2]=Kt((...l)=>t.confirmAction&&t.confirmAction(...l),["enter"])),ref:"inputRef"},null,40,Il),[[Jt,t.inputValue]])]),s("div",Cl,[s("button",{class:"btn btn-secondary",onClick:e[3]||(e[3]=(...l)=>t.closeDialog&&t.closeDialog(...l))},"Cancel"),s("button",{class:"btn btn-primary",onClick:e[4]||(e[4]=(...l)=>t.confirmAction&&t.confirmAction(...l))},"OK")])])])):b("",!0)}const Al=ee(bl,[["render",xl],["__scopeId","data-v-0ee78a4d"]]),Dl={name:"MediaLibrary",components:{MediaItem:Ls,Sidebar:ho,MainHeader:Uo,FloatingActionButton:No,LoginModal:Jo,RegisterModal:ga,EditModal:mn,BulkAddModal:Ir,TxtImportModal:Mr,TxtImportResultsModal:qr,SimpleAddItem:Zr,LoadingSpinner:sl,MessageBox:ul,ConfirmDialog:yl,InputDialog:Al},setup(){const i=Ye(),e=gt(),o=mt(),t=ft(),n=ze(),c=pt(),l=F(()=>!c||typeof c!="object"?(console.warn("SidebarStore not properly initialized, using fallback values"),{collapsed:!1,mobileOpen:!1,toggleSidebar:()=>{},toggleMobileSidebar:()=>{},closeMobileSidebar:()=>{}}):c),r=S(!1),p=S(null),I=S(new Date),A=S(null),C=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],m=S(null),k=Pe({firstName:"",lastName:"",displayName:"",email:"",bio:"",avatar:"",language:"en",timezone:"UTC",dateFormat:"MM/DD/YYYY",booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}),{showLoginModal:H,showRegisterModal:te,showEditModal:O,showFloatingMenu:Q,showBulkAddModal:ce,showTxtImportModal:me,showTxtImportResults:v,editingItem:N,sortBy:re,categories:ie,txtImportResults:Se,isLoggedIn:fe,isAdmin:_e,userName:Ie,currentCategory:K,searchQuery:G,categoryCounts:z,loading:q,error:pe,paginatedMedia:ve,setCategory:ue,clearSearch:ke,editItem:Ce,closeEditModal:le,closeBulkAddModal:a,handleBulkAddItems:u,handleSaveItem:_,handleDeleteItem:d,logout:y,loadMedia:R,toggleFloatingMenu:ge,addNewItem:oe,bulkAddItems:we,importFromTxt:qe,importFromAPI:He,createCollection:Qe,exportMediaCollection:Ne,exportAsCSV:Ge,exportAsJSON:We,downloadFile:Be,deleteAllInCategory:et,getCategoryDisplayName:Ve,navigateToCalendar:tt,navigateToProfile:st,processTxtContent:x,closeTxtImportResults:U,cleanup:J,router:E}=es(),L=F(()=>i.editMode),se=()=>{i.toggleEditMode()},V=async w=>{try{await i.updateItemRating(w.itemId,w.rating),console.log("✅ Rating updated successfully:",w)}catch(M){console.error("❌ Failed to update rating:",M),Ft({type:"error",text:"Failed to update rating. Please try again."})}},Me=F(()=>{try{return Ve?Ve(K.value):K.value}catch(w){return console.error("Error getting category display name:",w),K.value||"Unknown"}}),Ae=F(()=>I.value.getFullYear()),ot=F(()=>I.value.getMonth()),vt=F(()=>I.value.toLocaleDateString("en-US",{month:"long"})),Ee=S([]),Je=S(!1),Ke=S(null),at=F(()=>{const w=Ae.value,M=ot.value,B=new Date(w,M,1),W=new Date(B),P=B.getDay(),Y=P===0?6:P-1;W.setDate(W.getDate()-Y);const xe=[],Z=new Date;for(let Ze=0;Ze<42;Ze++){const he=new Date(W);he.setDate(W.getDate()+Ze);const zt=he.getMonth()===M,Yt=he.toDateString()===Z.toDateString(),qt=he.getDay()===0||he.getDay()===6;xe.push({date:he.getDate(),month:he.getMonth(),year:he.getFullYear(),fullDate:new Date(he),isCurrentMonth:zt,isToday:Yt,isWeekend:qt,hasEvents:it(he),events:nt(he)})}return xe}),ht=F(()=>{const w=i.mediaData||[],M={totalItems:w.length,totalCollections:0,totalPlaytime:0,avgRating:0,categoryDistribution:{},ratingDistribution:{},platformDistribution:{},genreDistribution:{},recentActivity:[],airingSeries:[]};let B=0,W=0;return w.forEach(P=>{const Y=P.category||"unknown";if(M.categoryDistribution[Y]=(M.categoryDistribution[Y]||0)+1,P.rating&&P.rating>0){const xe=Math.floor(P.rating);M.ratingDistribution[xe]=(M.ratingDistribution[xe]||0)+1,B+=P.rating,W++}if(P.platforms&&P.category==="game"&&P.platforms.split(",").map(Z=>Z.trim()).filter(Z=>Z).forEach(Z=>{M.platformDistribution[Z]=(M.platformDistribution[Z]||0)+1}),P.genre&&(P.category==="series"||P.category==="movie")&&P.genre.split(",").map(Z=>Z.trim()).filter(Z=>Z).forEach(Z=>{M.genreDistribution[Z]=(M.genreDistribution[Z]||0)+1}),P.spielzeit&&P.spielzeit>0&&(M.totalPlaytime+=P.spielzeit),P.category==="series"&&P.isAiring===!0&&M.airingSeries.push({title:P.title,nextSeason:P.nextSeason,nextSeasonRelease:P.nextSeasonRelease}),P.discovered){const xe=new Date(P.discovered),Z=new Date;Z.setDate(Z.getDate()-30),xe>=Z&&M.recentActivity.push({title:P.title,category:P.category,discovered:P.discovered})}}),W>0&&(M.avgRating=(B/W).toFixed(1)),M.totalPlaytime=Math.round(M.totalPlaytime/60),M.recentActivity.sort((P,Y)=>new Date(Y.discovered)-new Date(P.discovered)),M}),yt=w=>w?new Date(w).toLocaleDateString():"",bt=w=>{const M=Math.max(0,Math.min(5,parseInt(w)||0)),B="★".repeat(M),W="☆".repeat(5-M);return B+W},kt=w=>{ue(w),oe()},wt=()=>{H.value=!1,te.value=!0},St=()=>{H.value=!0},_t=w=>{H.value=!1,R()},It=()=>{te.value=!1,R()},Ct=async()=>{r.value=!0,p.value=null;try{const w=await n.adminSetup();w.success?(console.log("✅ Admin setup successful:",w),p.value={type:"success",text:`✅ Admin created and logged in! User: ${w.user.name} (${w.user.email})`},await R(),setTimeout(()=>{p.value=null},5e3)):(console.log("ℹ️ Admin already exists:",w),p.value={type:"info",text:`ℹ️ ${w.message} (${w.admin_count} admin(s) exist)`},setTimeout(()=>{p.value=null},3e3))}catch(w){console.error("❌ Admin setup failed:",w),p.value={type:"error",text:`❌ Admin setup failed: ${w.message||"Unknown error"}`},setTimeout(()=>{p.value=null},5e3)}finally{r.value=!1}},xt=()=>{console.log("🔥 DEBUG: Direct admin navigation called!"),console.log("🔥 DEBUG: Router object:",E);try{E.push("/admin"),console.log("🔥 DEBUG: Successfully navigated to /admin!")}catch(w){console.error("🔥 DEBUG: Error navigating to admin:",w)}},At=()=>{I.value=new Date(I.value.getFullYear(),I.value.getMonth()-1,1),A.value=null},Dt=()=>{I.value=new Date(I.value.getFullYear(),I.value.getMonth()+1,1),A.value=null},Mt=w=>{w.isCurrentMonth&&(A.value=w)},Tt=w=>w.fullDate.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),it=w=>rt(w).length>0,nt=w=>rt(w).map(B=>({id:B.id,title:B.title,time:"Release",type:B.watchlistType||B.watchlist_type||"unknown",item:B})),rt=w=>i.mediaData.filter(B=>B.category==="watchlist"&&B.release).filter(B=>{if(!B.release)return!1;const W=new Date(B.release),P=new Date(w);return W.getFullYear()===P.getFullYear()&&W.getMonth()===P.getMonth()&&W.getDate()===P.getDate()}),Rt=()=>{var B,W;const w=((B=k.firstName)==null?void 0:B.charAt(0))||"U",M=((W=k.lastName)==null?void 0:W.charAt(0))||"S";return(w+M).toUpperCase()},Ut=()=>{var w;(w=m.value)==null||w.click()},Pt=w=>{const M=w.target.files[0];if(M){const B=new FileReader;B.onload=W=>{k.avatar=W.target.result},B.readAsDataURL(M)}},lt=async()=>{if(!K.value||K.value==="statistics"||K.value==="calendar"||K.value==="profile"){Ee.value=[];return}Je.value=!0,Ke.value=null;try{const w=await ne.getGenres(K.value);if(w.success)Ee.value=w.genres||[];else throw new Error(w.error||"Failed to load genres")}catch(w){console.error("Failed to load genres:",w),Ke.value=w.message||"Failed to load genres",Ee.value=[]}finally{Je.value=!1}},Bt=w=>{i.setGenres(w)},Et=()=>{i.clearGenres()},Ft=w=>{console.log("📢 Message:",w.type,w.text),alert("Error: "+w.text)};De(K,w=>{w&&w!=="statistics"&&w!=="calendar"&&w!=="profile"?(lt(),i.clearGenres()):(Ee.value=[],i.clearGenres())},{immediate:!0});const Lt=()=>{const w={profile:k,media:i.mediaData,settings:{language:k.language,timezone:k.timezone,dateFormat:k.dateFormat},exportDate:new Date().toISOString()},M=new Blob([JSON.stringify(w,null,2)],{type:"application/json"}),B=URL.createObjectURL(M),W=document.createElement("a");W.href=B,W.download=`media-library-backup-${new Date().toISOString().split("T")[0]}.json`,W.click(),URL.revokeObjectURL(B)},Nt=()=>{const w=document.createElement("input");w.type="file",w.accept=".json",w.onchange=M=>{const B=M.target.files[0];if(B){const W=new FileReader;W.onload=P=>{try{const Y=JSON.parse(P.target.result);Y.profile&&Object.assign(k,Y.profile),Y.media&&(i.mediaData=Y.media,i.saveMedia()),Y.settings&&Object.assign(k,Y.settings),Oe()}catch(Y){console.error("Failed to import data:",Y)}},W.readAsText(B)}},w.click()},Gt=()=>{const w={profile:k,media:i.mediaData,settings:{language:k.language,timezone:k.timezone,dateFormat:k.dateFormat},backupDate:new Date().toISOString()},M=`backup_${Date.now()}`;localStorage.setItem(M,JSON.stringify(w)),alert("Backup created successfully!")},Wt=()=>{alert("Cache cleared successfully!")},Vt=()=>{confirm("Are you sure you want to reset all settings?")&&(Object.assign(k,{firstName:"",lastName:"",displayName:"",email:"",bio:"",avatar:"",language:"en",timezone:"UTC",dateFormat:"MM/DD/YYYY",booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}),Oe())},Ot=()=>{confirm("Are you sure you want to clear all data? This cannot be undone!")&&(localStorage.clear(),window.location.reload())},Oe=()=>{localStorage.setItem("profileData",JSON.stringify(k))},jt=()=>{Oe(),alert("All changes saved successfully!")};return ct(async()=>{var w,M;try{await R();const B=localStorage.getItem("profileData");if(B)try{const Y=JSON.parse(B);Object.assign(k,Y)}catch(Y){console.error("Failed to load profile data:",Y)}n.user&&(k.firstName=((w=n.user.name)==null?void 0:w.split(" ")[0])||"",k.lastName=((M=n.user.name)==null?void 0:M.split(" ").slice(1).join(" "))||"",k.email=n.user.email||"");const W=new Date,P=at.value.find(Y=>Y.isToday&&Y.isCurrentMonth);if(P&&(A.value=P),fe.value)try{i.initializeRealtimeUpdates()}catch(Y){console.error("Error initializing realtime updates:",Y)}}catch(B){console.error("Error during initialization:",B)}}),Xt(()=>{if(fe.value)try{i.cleanupRealtimeUpdates()}catch(w){console.error("Error cleaning up realtime updates:",w)}J()}),{showLoginModal:H,showRegisterModal:te,showEditModal:O,showFloatingMenu:Q,showBulkAddModal:ce,showTxtImportModal:me,showTxtImportResults:v,editingItem:N,sortBy:re,categories:ie,txtImportResults:Se,adminSetupLoading:r,adminSetupMessage:p,editMode:L,currentDate:I,selectedDay:A,weekdays:C,avatarInput:m,profileData:k,isLoggedIn:fe,isAdmin:_e,userName:Ie,currentCategory:K,currentCategoryDisplayName:Me,searchQuery:G,categoryCounts:z,loading:q,error:pe,paginatedMedia:ve,selectedGenres:F(()=>i.selectedGenres),genres:Ee,genreLoading:Je,genreError:Ke,currentYear:Ae,currentMonth:ot,currentMonthName:vt,calendarDays:at,setCategory:ue,clearSearch:ke,navigateToCalendar:tt,navigateToProfile:st,addItemFromSidebar:kt,editItem:Ce,switchToRegister:wt,showAdminLogin:St,handleLoginSuccess:_t,handleRegisterSuccess:It,handleAdminSetup:Ct,debugNavigateToAdmin:xt,closeEditModal:le,closeBulkAddModal:a,handleBulkAddItems:u,handleSaveItem:_,handleDeleteItem:d,logout:y,loadMedia:R,toggleFloatingMenu:ge,addNewItem:oe,bulkAddItems:we,importFromTxt:qe,importFromAPI:He,createCollection:Qe,exportMediaCollection:Ne,exportAsCSV:Ge,exportAsJSON:We,downloadFile:Be,deleteAllInCategory:et,getCategoryDisplayName:Ve,processTxtContent:x,closeTxtImportResults:U,handleGenresUpdated:Bt,handleGenresCleared:Et,loadGenres:lt,toggleEditMode:se,handleRatingChanged:V,previousMonth:At,nextMonth:Dt,selectDay:Mt,formatSelectedDay:Tt,hasEventsForDate:it,getEventsForDate:nt,getInitials:Rt,changeAvatar:Ut,handleAvatarChange:Pt,exportData:Lt,importData:Nt,createBackup:Gt,clearCache:Wt,resetSettings:Vt,clearAllData:Ot,saveProfileData:Oe,saveAllChanges:jt,messageStore:e,confirmStore:o,inputStore:t,statistics:ht,formatDate:yt,getRatingStars:bt,sidebarStore:c,safeSidebarStore:l}}},Ml={class:"vue-app"},Tl={class:"main-content"},Rl={class:"content-area"},Ul={key:1,class:"error"},Pl={key:2},Bl={key:0,class:"calendar-view"},El={class:"calendar-header"},Fl=["disabled"],Ll={class:"month-year-display"},Nl={class:"month-name"},Gl={class:"year"},Wl=["disabled"],Vl={class:"calendar-container"},Ol={class:"calendar-grid"},jl=["onClick"],zl={class:"day-number"},Yl={key:0,class:"event-indicator"},ql={key:0,class:"event-count"},Hl={key:0,class:"selected-day-info"},Ql={class:"day-events"},Jl={key:0,class:"no-events"},Kl={key:1,class:"events-list"},Zl={class:"event-header"},Xl={class:"event-time"},$l={class:"event-type-badge"},ed={class:"event-title"},td={key:0,class:"event-platforms"},sd={key:1,class:"event-genre"},od={key:1,class:"profile-container"},ad={class:"profile-header"},id={class:"profile-avatar-section"},nd=["src"],rd={key:1,class:"avatar-initials"},ld={class:"profile-info-header"},dd={class:"profile-stats"},cd={class:"stat-item"},ud={class:"stat-number"},gd={class:"stat-item"},md={class:"stat-number"},fd={class:"settings-sections"},pd={class:"settings-section"},vd={class:"section-content"},hd={class:"form-row"},yd={class:"form-group"},bd={class:"form-group"},kd={class:"form-group"},wd={class:"form-group"},Sd={class:"form-group"},_d={class:"settings-section"},Id={class:"section-content"},Cd={class:"form-row"},xd={class:"form-group"},Ad={class:"form-group"},Dd={class:"form-row"},Md={class:"form-group"},Td={class:"form-group"},Rd={class:"form-row"},Ud={class:"form-group"},Pd={class:"checkbox-container"},Bd={class:"settings-section"},Ed={class:"section-content"},Fd={class:"data-actions"},Ld={class:"settings-section danger-zone"},Nd={class:"section-content"},Gd={class:"danger-actions"},Wd={key:2,class:"statistics-container"},Vd={class:"statistics-header"},Od={class:"refresh-controls"},jd={class:"statistics-content"},zd={class:"stats-summary"},Yd={class:"summary-card"},qd={class:"summary-number"},Hd={class:"summary-card"},Qd={class:"summary-number"},Jd={class:"summary-card"},Kd={class:"summary-number"},Zd={class:"summary-card"},Xd={class:"summary-number"},$d={class:"chart-container"},ec={class:"category-stats"},tc={class:"category-name"},sc={class:"category-bar"},oc={class:"category-count"},ac={class:"chart-container"},ic={class:"rating-stats"},nc={class:"rating-stars"},rc={class:"rating-bar"},lc={class:"rating-count"},dc={class:"chart-container"},cc={class:"platform-stats"},uc={class:"platform-name"},gc={class:"platform-bar"},mc={class:"platform-count"},fc={class:"chart-container"},pc={class:"genre-stats"},vc={class:"genre-name"},hc={class:"genre-bar"},yc={class:"genre-count"},bc={class:"chart-container"},kc={class:"recent-activity"},wc={class:"activity-title"},Sc={class:"activity-category"},_c={class:"activity-date"},Ic={class:"chart-container"},Cc={class:"airing-series"},xc={class:"airing-title"},Ac={class:"airing-next"},Dc={class:"airing-date"},Mc={key:0,class:"admin-setup-container"},Tc=["disabled"],Rc={key:0},Uc={key:1};function Pc(i,e,o,t,n,c){const l=ae("Sidebar"),r=ae("MainHeader"),p=ae("LoadingSpinner"),I=ae("MediaItem"),A=ae("LoginModal"),C=ae("RegisterModal"),m=ae("EditModal"),k=ae("BulkAddModal"),H=ae("TxtImportModal"),te=ae("TxtImportResultsModal"),O=ae("FloatingActionButton"),Q=ae("MessageBox"),ce=ae("ConfirmDialog"),me=ae("InputDialog");return g(),f("div",Ml,[s("div",{class:j(["mobile-overlay",{show:t.safeSidebarStore.mobileOpen}]),onClick:e[0]||(e[0]=(...v)=>t.safeSidebarStore.closeMobileSidebar&&t.safeSidebarStore.closeMobileSidebar(...v))},null,2),ye(l,{collapsed:t.safeSidebarStore.collapsed,"mobile-open":t.safeSidebarStore.mobileOpen,"is-logged-in":t.isLoggedIn,"is-admin":t.isAdmin,"user-name":t.userName,"current-category":t.currentCategory,"category-counts":t.categoryCounts,categories:t.categories,"selected-genres":t.selectedGenres,genres:t.genres,"genre-loading":t.genreLoading,"genre-error":t.genreError,onToggle:t.safeSidebarStore.toggleSidebar,onSetCategory:t.setCategory,onNavigateToCalendar:t.navigateToCalendar,onNavigateToProfile:t.navigateToProfile,onNavigateToAdmin:t.debugNavigateToAdmin,onAddItem:t.addItemFromSidebar,onShowLogin:e[1]||(e[1]=v=>t.showLoginModal=!0),onShowRegister:e[2]||(e[2]=v=>t.showRegisterModal=!0),onShowAdminLogin:t.showAdminLogin,onLogout:t.logout,onGenresUpdated:t.handleGenresUpdated,onGenresCleared:t.handleGenresCleared,onLoadGenres:t.loadGenres},null,8,["collapsed","mobile-open","is-logged-in","is-admin","user-name","current-category","category-counts","categories","selected-genres","genres","genre-loading","genre-error","onToggle","onSetCategory","onNavigateToCalendar","onNavigateToProfile","onNavigateToAdmin","onAddItem","onShowAdminLogin","onLogout","onGenresUpdated","onGenresCleared","onLoadGenres"]),s("div",Tl,[ye(r,{"search-query":t.searchQuery,"onUpdate:searchQuery":e[3]||(e[3]=v=>t.searchQuery=v),"sort-by":t.sortBy,"onUpdate:sortBy":e[4]||(e[4]=v=>t.sortBy=v),"edit-mode":t.editMode,onToggleMobileSidebar:t.safeSidebarStore.toggleMobileSidebar,onClearSearch:t.clearSearch,onToggleEditMode:t.toggleEditMode},null,8,["search-query","sort-by","edit-mode","onToggleMobileSidebar","onClearSearch","onToggleEditMode"]),s("main",Rl,[t.loading?(g(),Re(p,{key:0,message:"Loading media data..."})):t.error?(g(),f("div",Ul,[s("p",null,h(t.error),1),s("button",{onClick:e[5]||(e[5]=(...v)=>t.loadMedia&&t.loadMedia(...v))},"Retry")])):(g(),f("div",Pl,[t.currentCategory==="calendar"?(g(),f("div",Bl,[s("div",El,[s("button",{class:"month-nav-btn",onClick:e[6]||(e[6]=(...v)=>t.previousMonth&&t.previousMonth(...v)),disabled:i.isLoading},[...e[31]||(e[31]=[s("span",{class:"nav-icon"},"‹",-1)])],8,Fl),s("div",Ll,[s("h2",Nl,h(t.currentMonthName),1),s("span",Gl,h(t.currentYear),1)]),s("button",{class:"month-nav-btn",onClick:e[7]||(e[7]=(...v)=>t.nextMonth&&t.nextMonth(...v)),disabled:i.isLoading},[...e[32]||(e[32]=[s("span",{class:"nav-icon"},"›",-1)])],8,Wl)]),s("div",Vl,[s("div",Ol,[(g(!0),f(X,null,$(t.weekdays,v=>(g(),f("div",{class:"weekday-header",key:v},h(v),1))),128)),(g(!0),f(X,null,$(t.calendarDays,v=>(g(),f("div",{key:`${v.date}-${v.month}`,class:j(["calendar-day",{"other-month":!v.isCurrentMonth,today:v.isToday,weekend:v.isWeekend,"has-events":v.hasEvents}]),onClick:N=>t.selectDay(v)},[s("span",zl,h(v.day),1),v.hasEvents?(g(),f("div",Yl,[e[33]||(e[33]=s("div",{class:"event-dot"},null,-1)),v.events&&v.events.length>1?(g(),f("span",ql,h(v.events.length),1)):b("",!0)])):b("",!0)],10,jl))),128))])]),t.selectedDay?(g(),f("div",Hl,[s("h3",null,h(t.formatSelectedDay(t.selectedDay)),1),s("div",Ql,[!t.selectedDay.events||t.selectedDay.events.length===0?(g(),f("p",Jl," No watchlist releases scheduled for this day ")):(g(),f("div",Kl,[(g(!0),f(X,null,$(t.selectedDay.events,v=>(g(),f("div",{key:v.id,class:j(["event-item",`event-${v.type}`])},[s("div",Zl,[s("span",Xl,h(v.time),1),s("span",$l,h(v.type),1)]),s("span",ed,h(v.title),1),v.item.platforms?(g(),f("div",td,h(v.item.platforms),1)):b("",!0),v.item.genre?(g(),f("div",sd,h(v.item.genre),1)):b("",!0)],2))),128))]))])])):b("",!0)])):t.currentCategory==="profile"?(g(),f("div",od,[s("div",ad,[s("div",id,[s("div",{class:"profile-avatar-large",onClick:e[8]||(e[8]=(...v)=>t.changeAvatar&&t.changeAvatar(...v))},[t.profileData.avatar?(g(),f("img",{key:0,src:t.profileData.avatar,alt:"Profile Picture"},null,8,nd)):(g(),f("span",rd,h(t.getInitials()),1))]),s("input",{type:"file",ref:"avatarInput",accept:"image/*",onChange:e[9]||(e[9]=(...v)=>t.handleAvatarChange&&t.handleAvatarChange(...v)),style:{display:"none"}},null,544)]),s("div",ld,[s("h2",null,h(t.profileData.displayName||t.profileData.firstName+" "+t.profileData.lastName||"User"),1),s("p",null,h(t.profileData.email||"user@example.com"),1),s("div",dd,[s("div",cd,[s("span",ud,h(i.totalItems),1),e[34]||(e[34]=s("span",{class:"stat-label"},"Total Items",-1))]),s("div",gd,[s("span",md,h(new Date().getFullYear()),1),e[35]||(e[35]=s("span",{class:"stat-label"},"Member Since",-1))])])])]),s("div",fd,[s("div",pd,[e[41]||(e[41]=s("div",{class:"section-header"},[s("h3",null,"Personal Information"),s("p",null,"Manage your personal details and account information")],-1)),s("div",vd,[s("div",hd,[s("div",yd,[e[36]||(e[36]=s("label",{for:"firstName"},"First Name",-1)),D(s("input",{type:"text",id:"firstName","onUpdate:modelValue":e[10]||(e[10]=v=>t.profileData.firstName=v),placeholder:"Enter your first name"},null,512),[[T,t.profileData.firstName]])]),s("div",bd,[e[37]||(e[37]=s("label",{for:"lastName"},"Last Name",-1)),D(s("input",{type:"text",id:"lastName","onUpdate:modelValue":e[11]||(e[11]=v=>t.profileData.lastName=v),placeholder:"Enter your last name"},null,512),[[T,t.profileData.lastName]])])]),s("div",kd,[e[38]||(e[38]=s("label",{for:"displayName"},"Display Name",-1)),D(s("input",{type:"text",id:"displayName","onUpdate:modelValue":e[12]||(e[12]=v=>t.profileData.displayName=v),placeholder:"How others see your name"},null,512),[[T,t.profileData.displayName]])]),s("div",wd,[e[39]||(e[39]=s("label",{for:"email"},"Email Address",-1)),D(s("input",{type:"email",id:"email","onUpdate:modelValue":e[13]||(e[13]=v=>t.profileData.email=v),placeholder:"your.email@example.com"},null,512),[[T,t.profileData.email]])]),s("div",Sd,[e[40]||(e[40]=s("label",{for:"bio"},"Bio",-1)),D(s("textarea",{id:"bio","onUpdate:modelValue":e[14]||(e[14]=v=>t.profileData.bio=v),placeholder:"Tell us about yourself...",rows:"4"},null,512),[[T,t.profileData.bio]])])])]),s("div",_d,[e[53]||(e[53]=s("div",{class:"section-header"},[s("h3",null,"Preferences"),s("p",null,"Customize your application experience")],-1)),s("div",Id,[s("div",Cd,[s("div",xd,[e[43]||(e[43]=s("label",{for:"language"},"Language",-1)),D(s("select",{id:"language","onUpdate:modelValue":e[15]||(e[15]=v=>t.profileData.language=v)},[...e[42]||(e[42]=[s("option",{value:"en"},"English",-1),s("option",{value:"de"},"Deutsch",-1),s("option",{value:"fr"},"Français",-1),s("option",{value:"es"},"Español",-1)])],512),[[be,t.profileData.language]])]),s("div",Ad,[e[45]||(e[45]=s("label",{for:"timezone"},"Timezone",-1)),D(s("select",{id:"timezone","onUpdate:modelValue":e[16]||(e[16]=v=>t.profileData.timezone=v)},[...e[44]||(e[44]=[s("option",{value:"UTC"},"UTC",-1),s("option",{value:"Europe/Berlin"},"Europe/Berlin",-1),s("option",{value:"America/New_York"},"America/New_York",-1),s("option",{value:"America/Los_Angeles"},"America/Los_Angeles",-1)])],512),[[be,t.profileData.timezone]])])]),s("div",Dd,[s("div",Md,[e[47]||(e[47]=s("label",{for:"dateFormat"},"Date Format",-1)),D(s("select",{id:"dateFormat","onUpdate:modelValue":e[17]||(e[17]=v=>t.profileData.dateFormat=v)},[...e[46]||(e[46]=[s("option",{value:"MM/DD/YYYY"},"MM/DD/YYYY",-1),s("option",{value:"DD/MM/YYYY"},"DD/MM/YYYY",-1),s("option",{value:"YYYY-MM-DD"},"YYYY-MM-DD",-1)])],512),[[be,t.profileData.dateFormat]])]),s("div",Td,[e[49]||(e[49]=s("label",{for:"booksApiProvider"},"Books API Provider",-1)),D(s("select",{id:"booksApiProvider","onUpdate:modelValue":e[18]||(e[18]=v=>t.profileData.booksApiProvider=v)},[...e[48]||(e[48]=[s("option",{value:"wikipedia"},"Wikipedia (Primary)",-1),s("option",{value:"google_books"},"Google Books (Fallback)",-1),s("option",{value:"both"},"Both (Wikipedia + Google Books)",-1)])],512),[[be,t.profileData.booksApiProvider]])])]),s("div",Rd,[s("div",Ud,[e[51]||(e[51]=s("label",{for:"enableGoogleBooksFallback"},"Enable Google Books Fallback",-1)),s("div",Pd,[D(s("input",{type:"checkbox",id:"enableGoogleBooksFallback","onUpdate:modelValue":e[19]||(e[19]=v=>t.profileData.enableGoogleBooksFallback=v)},null,512),[[ut,t.profileData.enableGoogleBooksFallback]]),e[50]||(e[50]=s("label",{for:"enableGoogleBooksFallback",class:"checkbox-label"}," Use Google Books as fallback when Wikipedia search fails ",-1))])]),e[52]||(e[52]=s("div",{class:"form-group"},null,-1))])])]),s("div",Bd,[e[58]||(e[58]=s("div",{class:"section-header"},[s("h3",null,"Data Management"),s("p",null,"Manage your data and account")],-1)),s("div",Ed,[s("div",Fd,[s("button",{class:"data-btn export-btn",onClick:e[20]||(e[20]=(...v)=>t.exportData&&t.exportData(...v))},[...e[54]||(e[54]=[s("span",{class:"btn-icon"},"📦",-1),s("span",{class:"btn-text"},"Export All Data",-1),s("span",{class:"btn-description"},"Download your complete media library",-1)])]),s("button",{class:"data-btn import-btn",onClick:e[21]||(e[21]=(...v)=>t.importData&&t.importData(...v))},[...e[55]||(e[55]=[s("span",{class:"btn-icon"},"📥",-1),s("span",{class:"btn-text"},"Import Data",-1),s("span",{class:"btn-description"},"Import data from a backup file",-1)])]),s("button",{class:"data-btn backup-btn",onClick:e[22]||(e[22]=(...v)=>t.createBackup&&t.createBackup(...v))},[...e[56]||(e[56]=[s("span",{class:"btn-icon"},"💾",-1),s("span",{class:"btn-text"},"Create Backup",-1),s("span",{class:"btn-description"},"Create a local backup of your data",-1)])]),s("button",{class:"data-btn cache-btn",onClick:e[23]||(e[23]=(...v)=>t.clearCache&&t.clearCache(...v))},[...e[57]||(e[57]=[s("span",{class:"btn-icon"},"🗑️",-1),s("span",{class:"btn-text"},"Clear Cache",-1),s("span",{class:"btn-description"},"Clear temporary files and cache",-1)])])])])]),s("div",Ld,[e[61]||(e[61]=s("div",{class:"section-header"},[s("h3",null,"Danger Zone"),s("p",null,"Irreversible and destructive actions")],-1)),s("div",Nd,[s("div",Gd,[s("button",{class:"danger-btn reset-btn",onClick:e[24]||(e[24]=(...v)=>t.resetSettings&&t.resetSettings(...v))},[...e[59]||(e[59]=[s("span",{class:"btn-icon"},"🔄",-1),s("span",{class:"btn-text"},"Reset All Settings",-1),s("span",{class:"btn-description"},"Reset all settings to default values",-1)])]),s("button",{class:"danger-btn clear-btn",onClick:e[25]||(e[25]=(...v)=>t.clearAllData&&t.clearAllData(...v))},[...e[60]||(e[60]=[s("span",{class:"btn-icon"},"🗑️",-1),s("span",{class:"btn-text"},"Clear All Data",-1),s("span",{class:"btn-description"},"Permanently delete all your data",-1)])])])])])])])):t.currentCategory==="statistics"?(g(),f("div",Wd,[s("div",Vd,[e[62]||(e[62]=s("h1",null,"📊 Media Library Statistics",-1)),e[63]||(e[63]=s("p",null,"Übersicht über deine Media Collection",-1)),s("div",Od,[s("button",{class:"refresh-btn",onClick:e[26]||(e[26]=(...v)=>t.loadMedia&&t.loadMedia(...v))},"🔄 Refresh Statistics")])]),s("div",jd,[s("div",zd,[s("div",Yd,[s("div",qd,h(t.statistics.totalItems),1),e[64]||(e[64]=s("div",{class:"summary-label"},"Total Items",-1))]),s("div",Hd,[s("div",Qd,h(t.statistics.totalCollections),1),e[65]||(e[65]=s("div",{class:"summary-label"},"Collections",-1))]),s("div",Jd,[s("div",Kd,h(t.statistics.totalPlaytime)+"h",1),e[66]||(e[66]=s("div",{class:"summary-label"},"Total Playtime",-1))]),s("div",Zd,[s("div",Xd,h(t.statistics.avgRating),1),e[67]||(e[67]=s("div",{class:"summary-label"},"Avg Rating",-1))])]),s("div",$d,[e[68]||(e[68]=s("h3",{class:"chart-title"},"📈 Category Distribution",-1)),s("div",ec,[(g(!0),f(X,null,$(t.statistics.categoryDistribution,(v,N)=>(g(),f("div",{key:N,class:"category-stat"},[s("div",tc,h(N),1),s("div",sc,[s("div",{class:"category-fill",style:Ue({width:`${v/t.statistics.totalItems*100}%`})},null,4)]),s("div",oc,h(v)+" ("+h((v/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",ac,[e[69]||(e[69]=s("h3",{class:"chart-title"},"⭐ Rating Distribution",-1)),s("div",ic,[(g(!0),f(X,null,$(t.statistics.ratingDistribution,(v,N)=>(g(),f("div",{key:N,class:"rating-stat"},[s("div",nc,h(t.getRatingStars(N)),1),s("div",rc,[s("div",{class:"rating-fill",style:Ue({width:`${v/t.statistics.totalItems*100}%`})},null,4)]),s("div",lc,h(v)+" ("+h((v/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",dc,[e[70]||(e[70]=s("h3",{class:"chart-title"},"🎮 Platform Distribution",-1)),s("div",cc,[(g(!0),f(X,null,$(t.statistics.platformDistribution,(v,N)=>(g(),f("div",{key:N,class:"platform-stat"},[s("div",uc,h(N),1),s("div",gc,[s("div",{class:"platform-fill",style:Ue({width:`${v/t.statistics.totalItems*100}%`})},null,4)]),s("div",mc,h(v)+" ("+h((v/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",fc,[e[71]||(e[71]=s("h3",{class:"chart-title"},"🎭 Top Genres",-1)),s("div",pc,[(g(!0),f(X,null,$(t.statistics.genreDistribution,(v,N)=>(g(),f("div",{key:N,class:"genre-stat"},[s("div",vc,h(N),1),s("div",hc,[s("div",{class:"genre-fill",style:Ue({width:`${v/t.statistics.totalItems*100}%`})},null,4)]),s("div",yc,h(v)+" ("+h((v/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",bc,[e[72]||(e[72]=s("h3",{class:"chart-title"},"📅 Recent Activity",-1)),s("div",kc,[(g(!0),f(X,null,$(t.statistics.recentActivity,v=>(g(),f("div",{key:v.title,class:"activity-item"},[s("div",wc,h(v.title),1),s("div",Sc,h(v.category),1),s("div",_c,h(t.formatDate(v.discovered)),1)]))),128))])]),s("div",Ic,[e[73]||(e[73]=s("h3",{class:"chart-title"},"📺 Currently Airing Series",-1)),s("div",Cc,[(g(!0),f(X,null,$(t.statistics.airingSeries,v=>(g(),f("div",{key:v.title,class:"airing-item"},[s("div",xc,h(v.title),1),s("div",Ac,"Next: Season "+h(v.nextSeason),1),s("div",Dc,h(v.nextSeasonRelease?t.formatDate(v.nextSeasonRelease):"TBA"),1)]))),128))])])])])):(g(),f("div",{key:3,class:j(["grid",{"edit-mode":t.editMode}])},[(g(!0),f(X,null,$(t.paginatedMedia,v=>(g(),Re(I,{key:v.id,item:v,"edit-mode":t.editMode,onEdit:t.editItem,onWatchlistToggled:i.handleWatchlistToggled,onShowMessage:i.showMessage,onRatingChanged:t.handleRatingChanged},null,8,["item","edit-mode","onEdit","onWatchlistToggled","onShowMessage","onRatingChanged"]))),128))],2))]))])]),t.isLoggedIn?b("",!0):(g(),f("div",Mc,[s("button",{onClick:e[27]||(e[27]=(...v)=>t.handleAdminSetup&&t.handleAdminSetup(...v)),disabled:t.adminSetupLoading,class:"admin-setup-btn",title:"Setup Admin Account (Creates admin account with default password)"},[t.adminSetupLoading?(g(),f("span",Rc,"🔧 Setting up...")):(g(),f("span",Uc,"🔧 Admin Setup"))],8,Tc),t.adminSetupMessage?(g(),f("div",{key:0,class:j(["admin-setup-message",t.adminSetupMessage.type])},h(t.adminSetupMessage.text),3)):b("",!0)])),t.showLoginModal?(g(),Re(A,{key:1,onClose:e[28]||(e[28]=v=>t.showLoginModal=!1),onSuccess:t.handleLoginSuccess,onSwitchToRegister:t.switchToRegister},null,8,["onSuccess","onSwitchToRegister"])):b("",!0),t.showRegisterModal?(g(),Re(C,{key:2,onClose:e[29]||(e[29]=v=>t.showRegisterModal=!1),onSuccess:t.handleRegisterSuccess},null,8,["onSuccess"])):b("",!0),t.showEditModal?(g(),Re(m,{key:3,item:t.editingItem,"current-category":t.currentCategory,onClose:t.closeEditModal,onSave:t.handleSaveItem,onDelete:t.handleDeleteItem},null,8,["item","current-category","onClose","onSave","onDelete"])):b("",!0),ye(k,{show:t.showBulkAddModal,"current-category":t.currentCategory,onClose:t.closeBulkAddModal},null,8,["show","current-category","onClose"]),ye(H,{show:t.showTxtImportModal,onClose:e[30]||(e[30]=v=>t.showTxtImportModal=!1),onFileProcessed:t.processTxtContent},null,8,["show","onFileProcessed"]),ye(te,{show:t.showTxtImportResults,results:t.txtImportResults,onClose:t.closeTxtImportResults},null,8,["show","results","onClose"]),ye(O,{"show-menu":t.showFloatingMenu,"show-delete-all":t.isLoggedIn&&t.currentCategory!=="all"&&t.categoryCounts[t.currentCategory]>0,"category-name":t.currentCategoryDisplayName,"item-count":t.categoryCounts[t.currentCategory]||0,onToggleMenu:t.toggleFloatingMenu,onAddNewItem:t.addNewItem,onBulkAddItems:t.bulkAddItems,onImportFromTxt:t.importFromTxt,onImportFromApi:t.importFromAPI,onCreateCollection:t.createCollection,onDeleteAllInCategory:t.deleteAllInCategory},null,8,["show-menu","show-delete-all","category-name","item-count","onToggleMenu","onAddNewItem","onBulkAddItems","onImportFromTxt","onImportFromApi","onCreateCollection","onDeleteAllInCategory"]),ye(Q,{show:t.messageStore.show,type:t.messageStore.type,title:t.messageStore.title,message:t.messageStore.message,details:t.messageStore.details,onClose:t.messageStore.closeMessage},null,8,["show","type","title","message","details","onClose"]),ye(ce,{show:t.confirmStore.show,title:t.confirmStore.title,message:t.confirmStore.message,onConfirm:t.confirmStore.confirm,onClose:t.confirmStore.cancel},null,8,["show","title","message","onConfirm","onClose"]),ye(me,{show:t.inputStore.show,title:t.inputStore.title,message:t.inputStore.message,placeholder:t.inputStore.placeholder,"input-type":t.inputStore.inputType,"default-value":t.inputStore.defaultValue,onConfirm:t.inputStore.confirm,onClose:t.inputStore.cancel},null,8,["show","title","message","placeholder","input-type","default-value","onConfirm","onClose"])])}const Ec=ee(Dl,[["render",Pc],["__scopeId","data-v-bca07264"]]);export{Ec as default};
