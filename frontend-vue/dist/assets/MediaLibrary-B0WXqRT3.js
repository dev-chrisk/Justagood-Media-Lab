import{d as je,r as p,u as Ye,a as Ze,c as F,_ as O,b as u,e as o,f as h,t as g,n as Z,g as ne,o as i,h as $e,w as ie,i as J,j as M,v as he,k as Ve,l as P,F as re,m as de,p as ze,q as He,s as et,x as tt,y as ot,z as Q,A as se,B as N,C as at,D as lt}from"./index-CqTkvu1B.js";import{u as Qe}from"./media-CUQ0YfXl.js";import{u as Ke}from"./message-Db0bZgwy.js";import{R as st,L as nt,M as it,S as rt}from"./RegisterModal-CL-LPtfY.js";import{L as dt}from"./LoadingSpinner-C_DR5yDh.js";const Xe=je("confirm",()=>{const s=p(!1),t=p("Confirm Action"),l=p(""),e=p(null);function n(m){return new Promise(c=>{t.value=m.title||"Confirm Action",l.value=m.message||"",s.value=!0,e.value=c})}function y(){e.value&&(e.value(!0),e.value=null),s.value=!1}function a(){e.value&&(e.value(!1),e.value=null),s.value=!1}return{show:s,title:t,message:l,showConfirm:n,confirm:y,cancel:a}}),Je=je("input",()=>{const s=p(!1),t=p("Input Required"),l=p(""),e=p(""),n=p("text"),y=p(""),a=p(null);function m(_){return new Promise(U=>{t.value=_.title||"Input Required",l.value=_.message||"",e.value=_.placeholder||"",n.value=_.inputType||"text",y.value=_.defaultValue||"",s.value=!0,a.value=U})}function c(_){a.value&&(a.value(_),a.value=null),s.value=!1}function V(){a.value&&(a.value(null),a.value=null),s.value=!1}return{show:s,title:t,message:l,placeholder:e,inputType:n,defaultValue:y,showInput:m,confirm:c,cancel:V}});function ct(){const s=Ye(),t=Ze(),l=Qe(),e=Ke(),n=Xe(),y=Je(),a=p(!1),m=p(!1),c=p(!1),V=p(!1),_=p(!1),U=p(!1),z=p(!1),I=p(!1),w=p(!1),f=p(null),x=()=>typeof window<"u"?window.innerWidth>768?8:3:8,B=p(x()),A=p("order_asc"),K=p(null),k=()=>{B.value=x()};typeof window<"u"&&window.addEventListener("resize",k);const $=[{key:"game",name:"Games",icon:"ðŸŽ®"},{key:"series",name:"Series",icon:"ðŸ“º"},{key:"movie",name:"Movies",icon:"ðŸŽ¬"},{key:"buecher",name:"BÃ¼cher",icon:"ðŸ“š"},{key:"watchlist",name:"Watchlist",icon:"â¤ï¸"}],q=F(()=>{try{return t.isLoggedIn}catch(r){return console.error("Error accessing authStore.isLoggedIn:",r),!1}}),ce=F(()=>{try{return t.userName}catch(r){return console.error("Error accessing authStore.userName:",r),""}}),W=F(()=>{try{return l.currentCategory}catch(r){return console.error("Error accessing mediaStore.currentCategory:",r),"game"}}),ue=F({get:()=>{try{return l.searchQuery}catch(r){return console.error("Error accessing mediaStore.searchQuery:",r),""}},set:r=>{try{l.setSearchQuery(r)}catch(v){console.error("Error setting mediaStore.searchQuery:",v)}}}),d=F(()=>{try{return l.categoryCounts}catch(r){return console.error("Error accessing mediaStore.categoryCounts:",r),{}}}),S=F(()=>{try{return l.loading}catch(r){return console.error("Error accessing mediaStore.loading:",r),!1}}),R=F(()=>{try{return l.error}catch(r){return console.error("Error accessing mediaStore.error:",r),null}}),E=F(()=>{try{const r=[...l.filteredMedia||[]],[v,D]=A.value.split("_");return r.sort((b,C)=>{let L=b[v],T=C[v];return v==="order"?(L=b.__order||0,T=C.__order||0):v==="airing"&&(L=b.isAiring?1:0,T=C.isAiring?1:0),typeof L=="string"&&(L=L.toLowerCase(),T=T.toLowerCase()),D==="asc"?L>T?1:-1:L<T?1:-1})}catch(r){return console.error("Error in sortedMedia computed:",r),[]}}),X=F(()=>E.value),G=F(()=>{try{if(!l||!l.mediaData)return[];const r=new Set;return l.mediaData.forEach(v=>{v.platforms&&v.platforms.split(",").forEach(D=>r.add(D.trim()))}),Array.from(r).sort()}catch(r){return console.error("Error in platforms computed:",r),[]}}),j=F(()=>{try{if(!l||!l.mediaData)return[];const r=new Set;return l.mediaData.forEach(v=>{v.genre&&v.genre.split(",").forEach(D=>r.add(D.trim()))}),Array.from(r).sort()}catch(r){return console.error("Error in genres computed:",r),[]}}),pe=()=>{a.value=!a.value},we=()=>{m.value=!m.value},be=()=>{m.value=!1},Ie=r=>{l.setCategory(r),m.value=!1},Se=()=>{l.setSearchQuery("")},Ce=(r,v)=>{v?l.addFilter({type:"platform",value:r}):l.removeFilter({type:"platform",value:r})},ke=(r,v)=>{v?l.addFilter({type:"genre",value:r}):l.removeFilter({type:"genre",value:r})},Te=(r,v)=>{v?l.addFilter({type:"airing",value:r}):l.removeFilter({type:"airing",value:r})},Me=r=>{f.value=r,_.value=!0},me=()=>{_.value=!1,f.value=null},Y=()=>{z.value=!1},_e=async r=>{try{const v=await l.batchAddMediaItems(r);if(v.success){const{created:D,failed:b}=v.stats;let C=`Successfully added ${D} items`;b>0&&(C+=` (${b} failed)`),e.showSuccess(C,"Bulk Add Successful")}Y()}catch(v){console.error("Bulk add failed:",v),e.showError("Failed to add items: "+(v.message||"Unknown error"),"Bulk Add Failed")}},ge=async r=>{f.value?await l.updateMediaItem(f.value.id,r):await l.addMediaItem(r),me()},xe=async r=>{await l.deleteMediaItem(r.id)},Ae=async()=>{await t.logout(),await ee()},ee=async()=>{try{await l.loadMedia()}catch(r){console.error("Error loading media:",r)}},De=()=>{U.value=!U.value},Ue=()=>{if(U.value=!1,!q.value){e.showWarning("Bitte loggen Sie sich ein, um neue Items hinzuzufÃ¼gen.","Login erforderlich");return}f.value=null,_.value=!0},Re=()=>{if(U.value=!1,!q.value){e.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}z.value=!0},Fe=()=>{if(U.value=!1,!q.value){e.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}I.value=!0},Pe=()=>{if(U.value=!1,!q.value){e.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}e.showInfo("API Import feature coming soon!","Feature in Entwicklung")},Be=()=>{if(U.value=!1,!q.value){e.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}fe()},te=r=>{const v=$.find(D=>D.key===r);return v?v.name:r},Ee=async()=>{const r=te(W.value),v=d.value[W.value]||0;if(v===0){e.showInfo("No items to delete in this category.","Nothing to Delete");return}const D=`Are you sure you want to delete ALL ${v} items in "${r}"?

This action cannot be undone!`;if(await n.showConfirm({title:"Delete All Items",message:D}))try{const L=((l==null?void 0:l.mediaData)||[]).filter(T=>W.value==="watchlist"?T.category==="watchlist"||T.isNew===!0:T.category===W.value).map(T=>T.id);await l.batchDeleteMediaItems(L),await ee(),e.showSuccess(`Successfully deleted ${v} items from "${r}"`,"Items Deleted")}catch(C){console.error("Error deleting items:",C),e.showError("Error occurred while deleting items. Please try again.","Delete Failed")}},Le=r=>{const v=r.split(`
`).map(T=>T.trim()).filter(T=>T.length>0);if(v.length===0){e.showWarning("Die TXT-Datei ist leer oder enthÃ¤lt keine gÃ¼ltigen EintrÃ¤ge.","Leere Datei");return}const b=l.filteredMedia.map(T=>T.title.toLowerCase().trim()),C=v.filter(T=>{const ae=T.toLowerCase().trim();return!b.some(le=>le.includes(ae)||ae.includes(le))}),L=v.filter(T=>{const ae=T.toLowerCase().trim();return b.some(le=>le.includes(ae)||ae.includes(le))});K.value={totalInFile:v.length,missingItems:C,existingItems:L,currentCategory:W.value,categoryName:te(W.value)},I.value=!1,w.value=!0},Ne=()=>{K.value=null,w.value=!1},fe=async()=>{const r=(l==null?void 0:l.mediaData)||[];if(r.length===0){e.showInfo("Keine Media Items zum Exportieren gefunden.","Nichts zu exportieren");return}const v=await y.showInput({title:"Export Format wÃ¤hlen",message:`1 = CSV
2 = JSON
3 = Beide

Geben Sie die Nummer ein:`,placeholder:"1",defaultValue:"1"});if(!v||!["1","2","3"].includes(v))return;const D=new Date().toISOString().split("T")[0];(v==="1"||v==="3")&&ve(r,D),(v==="2"||v==="3")&&ye(r,D),e.showSuccess(`Collection mit ${r.length} Items wurde erfolgreich exportiert!`,"Export erfolgreich")},ve=(r,v)=>{const b=[["Titel","Kategorie","Release","Rating","Platforms","Genre","Spielzeit","Status","Beschreibung"].join(","),...r.map(C=>[`"${(C.title||"").replace(/"/g,'""')}"`,`"${(C.category||C.category_name||"Unbekannt").replace(/"/g,'""')}"`,`"${C.release||""}"`,`"${C.rating||""}"`,`"${(C.platforms||"").replace(/"/g,'""')}"`,`"${(C.genre||"").replace(/"/g,'""')}"`,`"${C.spielzeit||""}"`,`"${C.isAiring?"Airing":"Abgeschlossen"}"`,`"${(C.description||"").replace(/"/g,'""')}"`].join(","))].join(`
`);oe(b,`media_collection_${v}.csv`,"text/csv;charset=utf-8;")},ye=(r,v)=>{const D={exportDate:new Date().toISOString(),totalItems:r.length,categories:[...new Set(r.map(b=>b.category||b.category_name||"Unbekannt"))],items:r.map(b=>({id:b.id,title:b.title||"",category:b.category||b.category_name||"Unbekannt",release:b.release||"",rating:b.rating||null,platforms:b.platforms||"",genre:b.genre||"",spielzeit:b.spielzeit||null,status:b.isAiring?"Airing":"Abgeschlossen",description:b.description||"",isNew:b.isNew||!1,nextSeason:b.nextSeason||null,discovered:b.discovered||null}))};oe(JSON.stringify(D,null,2),`media_collection_${v}.json`,"application/json;charset=utf-8;")},oe=(r,v,D)=>{const b=new Blob([r],{type:D}),C=document.createElement("a"),L=URL.createObjectURL(b);C.setAttribute("href",L),C.setAttribute("download",v),C.style.visibility="hidden",document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(L)};return{sidebarCollapsed:a,mobileSidebarOpen:m,showLoginModal:c,showRegisterModal:V,showEditModal:_,showFloatingMenu:U,showBulkAddModal:z,showTxtImportModal:I,showTxtImportResults:w,editingItem:f,gridColumns:B,sortBy:A,categories:$,txtImportResults:K,isLoggedIn:q,userName:ce,currentCategory:W,searchQuery:ue,categoryCounts:d,loading:S,error:R,paginatedMedia:X,platforms:G,genres:j,toggleSidebar:pe,toggleMobileSidebar:we,closeMobileSidebar:be,setCategory:Ie,clearSearch:Se,togglePlatformFilter:Ce,toggleGenreFilter:ke,toggleAiringFilter:Te,editItem:Me,closeEditModal:me,closeBulkAddModal:Y,handleBulkAddItems:_e,handleSaveItem:ge,handleDeleteItem:xe,logout:Ae,loadMedia:ee,toggleFloatingMenu:De,addNewItem:Ue,bulkAddItems:Re,importFromTxt:Fe,importFromAPI:Pe,createCollection:Be,exportMediaCollection:fe,exportAsCSV:ve,exportAsJSON:ye,downloadFile:oe,deleteAllInCategory:Ee,getCategoryDisplayName:te,navigateToStatistics:()=>{s.push("/statistics")},navigateToCalendar:()=>{s.push("/calendar")},navigateToFeatures:()=>{s.push("/features")},navigateToProfile:()=>{s.push("/profile")},navigateToAdmin:()=>{s.push("/admin")},processTxtContent:Le,closeTxtImportResults:Ne,cleanup:()=>{typeof window<"u"&&window.removeEventListener("resize",k)}}}const ut={name:"MediaItem",props:{item:{type:Object,required:!0}},emits:["edit"],computed:{showWatchlistTag(){return this.item.category==="watchlist"||this.item.isNew===!0},isWatchlistItem(){return this.item.category==="watchlist"||this.item.isNew===!0}},methods:{getImageUrl(s){return s?s.startsWith("http")||s.startsWith("/")?s:`/storage/${s}`:""},handleImageError(s){var t;s.target.style.display="none",(t=s.target.nextElementSibling)==null||t.classList.add("show")},formatDate(s){return s?new Date(s).toLocaleDateString():""},editItem(){this.$emit("edit",this.item)},getWatchlistReleaseStatus(){if(!this.item.release)return"";const s=new Date(this.item.release),t=new Date;t.setHours(0,0,0,0),s.setHours(0,0,0,0);const l=s.getTime()-t.getTime(),e=Math.ceil(l/(1e3*3600*24));if(e>0)return e===1?"Tomorrow!":e<=7?`${e} days left`:e<=30?`${e} days left`:`${Math.ceil(e/30)} months left`;if(e===0)return"Released today!";{const n=this.getTypeTagText().toLowerCase();return n==="game"?"Unplayed yet":n==="series"||n==="movie"?"Unwatched yet":n==="buecher"?"Unread yet":"Unconsumed yet"}},getWatchlistReleaseStatusClass(){if(!this.item.release)return"";const s=new Date(this.item.release),t=new Date;t.setHours(0,0,0,0),s.setHours(0,0,0,0);const l=s.getTime()-t.getTime(),e=Math.ceil(l/(1e3*3600*24));return e>0?"countdown":e===0?"released-today":"unconsumed"},getTypeTagText(){var t,l,e;const s=this.item.watchlistType||this.item.watchlist_type;if(s)return s.charAt(0).toUpperCase()+s.slice(1);if(this.item.genre){const n=this.item.genre.toLowerCase();if(n.includes("game")||n.includes("gaming")||(t=this.item.platforms)!=null&&t.toLowerCase().includes("steam")||(l=this.item.platforms)!=null&&l.toLowerCase().includes("ps")||(e=this.item.platforms)!=null&&e.toLowerCase().includes("xbox"))return"Game";if(n.includes("series")||n.includes("tv")||n.includes("episode")||this.item.isAiring)return"Series";if(n.includes("movie")||n.includes("film")||n.includes("cinema"))return"Movie";if(n.includes("book")||n.includes("literature")||n.includes("novel")||n.includes("author"))return"BÃ¼cher"}if(this.item.platforms){const n=this.item.platforms.toLowerCase();if(n.includes("steam")||n.includes("ps")||n.includes("xbox")||n.includes("nintendo")||n.includes("pc"))return"Game";if(n.includes("netflix")||n.includes("hulu")||n.includes("disney")||n.includes("hbo"))return"Series";if(n.includes("cinema")||n.includes("theater"))return"Movie";if(n.includes("book")||n.includes("kindle")||n.includes("audible")||n.includes("author"))return"BÃ¼cher"}return"Media"},getTypeTagClass(){return`type-${this.getTypeTagText().toLowerCase()}`},getNextSeasonCountdown(){if(!this.item.nextSeasonRelease)return"";const s=new Date(this.item.nextSeasonRelease),t=new Date;t.setHours(0,0,0,0),s.setHours(0,0,0,0);const l=s.getTime()-t.getTime(),e=Math.ceil(l/(1e3*3600*24));return e>0?e===1?"Tomorrow!":e<=7?`${e} days`:e<=30?`${e} days`:`${Math.ceil(e/30)} months`:e===0?"Today!":"Released"}}},mt={class:"media-image"},gt=["src","alt"],ft={key:1,class:"no-image"},vt={class:"media-info"},yt={class:"media-title"},ht={class:"media-meta"},pt={key:0,class:"media-release"},wt={key:1},bt={key:1,class:"media-rating"},It={key:0,class:"media-platforms"},St={key:1,class:"media-genre"},Ct={key:2,class:"media-airing"},kt={key:0,class:"next-season"},Tt={key:1,class:"countdown"},Mt={key:3,class:"watchlist-type-tag"};function _t(s,t,l,e,n,y){return i(),u("div",{class:"media-item",onClick:t[1]||(t[1]=(...a)=>y.editItem&&y.editItem(...a))},[o("div",mt,[l.item.path?(i(),u("img",{key:0,src:y.getImageUrl(l.item.path),alt:l.item.title,onError:t[0]||(t[0]=(...a)=>y.handleImageError&&y.handleImageError(...a))},null,40,gt)):(i(),u("div",ft,[...t[2]||(t[2]=[o("span",{class:"no-image-icon"},"ðŸ“",-1)])]))]),o("div",vt,[o("h3",yt,g(l.item.title),1),o("div",ht,[l.item.release?(i(),u("span",pt,[y.isWatchlistItem&&l.item.release?(i(),u("span",{key:0,class:Z(y.getWatchlistReleaseStatusClass())},g(y.getWatchlistReleaseStatus()),3)):(i(),u("span",wt,g(y.formatDate(l.item.release)),1))])):h("",!0),l.item.rating?(i(),u("span",bt,g("â˜…".repeat(Math.max(0,Math.min(5,Math.floor(l.item.rating)))))+g("â˜†".repeat(Math.max(0,5-Math.max(0,Math.min(5,Math.floor(l.item.rating)))))),1)):h("",!0)]),l.item.platforms?(i(),u("div",It,g(l.item.platforms),1)):h("",!0),l.item.genre?(i(),u("div",St,g(l.item.genre),1)):h("",!0),l.item.isAiring?(i(),u("div",Ct,[t[3]||(t[3]=o("span",{class:"airing-badge"},[o("span",{class:"airing-dot"}),ne(" Airing ")],-1)),l.item.nextSeason?(i(),u("span",kt,"S"+g(l.item.nextSeason),1)):h("",!0),l.item.nextSeasonRelease?(i(),u("span",Tt,g(y.getNextSeasonCountdown()),1)):h("",!0)])):h("",!0),y.showWatchlistTag?(i(),u("div",Mt,[o("span",{class:Z(["type-tag",y.getTypeTagClass()])},g(y.getTypeTagText()),3)])):h("",!0)]),t[4]||(t[4]=o("div",{class:"edit-indicator"},[o("span",{class:"edit-icon"},"âœï¸")],-1))])}const xt=O(ut,[["render",_t],["__scopeId","data-v-adb4923c"]]),At={name:"FloatingActionButton",props:{showMenu:{type:Boolean,default:!1},showDeleteAll:{type:Boolean,default:!1},categoryName:{type:String,default:""},itemCount:{type:Number,default:0}},emits:["toggleMenu","addNewItem","bulkAddItems","importFromTxt","importFromAPI","createCollection","deleteAllInCategory"]},Dt={class:"floating-actions"},Ut={class:"menu-text"},Rt={class:"item-count-badge"};function Ft(s,t,l,e,n,y){return i(),u("div",Dt,[o("div",{class:Z(["floating-menu",{show:l.showMenu}])},[o("button",{class:"floating-menu-item",onClick:t[0]||(t[0]=a=>s.$emit("addNewItem"))},[...t[7]||(t[7]=[o("span",{class:"menu-icon"},"âž•",-1),o("span",{class:"menu-text"},"Add Item",-1)])]),o("button",{class:"floating-menu-item",onClick:t[1]||(t[1]=a=>s.$emit("bulkAddItems"))},[...t[8]||(t[8]=[o("span",{class:"menu-icon"},"ðŸ“¦",-1),o("span",{class:"menu-text"},"Bulk Add",-1)])]),o("button",{class:"floating-menu-item",onClick:t[2]||(t[2]=a=>s.$emit("importFromTxt"))},[...t[9]||(t[9]=[o("span",{class:"menu-icon"},"ðŸ“„",-1),o("span",{class:"menu-text"},"Import from TXT",-1)])]),o("button",{class:"floating-menu-item",onClick:t[3]||(t[3]=a=>s.$emit("importFromAPI"))},[...t[10]||(t[10]=[o("span",{class:"menu-icon"},"ðŸŒ",-1),o("span",{class:"menu-text"},"Import from API",-1)])]),o("button",{class:"floating-menu-item",onClick:t[4]||(t[4]=a=>s.$emit("createCollection"))},[...t[11]||(t[11]=[o("span",{class:"menu-icon"},"ðŸ“š",-1),o("span",{class:"menu-text"},"Create Collection",-1)])]),l.showDeleteAll&&l.itemCount>0?(i(),u("button",{key:0,class:"floating-menu-item delete-all-item",onClick:t[5]||(t[5]=a=>s.$emit("deleteAllInCategory"))},[t[12]||(t[12]=o("span",{class:"menu-icon"},"ðŸ—‘ï¸",-1)),o("span",Ut,"Delete All "+g(l.categoryName),1),o("span",Rt,"("+g(l.itemCount)+")",1)])):h("",!0)],2),o("button",{class:"floating-add-btn",onClick:t[6]||(t[6]=a=>s.$emit("toggleMenu"))},g(l.showMenu?"âœ•":"+"),1)])}const Pt=O(At,[["render",Ft],["__scopeId","data-v-19731834"]]),Bt={name:"EditModal",props:{item:{type:Object,default:null},currentCategory:{type:String,default:"watchlist"}},emits:["close","save","delete"],setup(s,{emit:t}){const l=p(!1),e=p(""),n=p([]),y=p(null),a=p(null),m=p(""),c=$e({category:"watchlist",title:"",release:"",rating:"",count:"",platforms:"",genre:"",link:"",path:"",discovered:"",spielzeit:"",isAiring:!1,nextSeason:"",nextSeasonRelease:"",imageUrl:"",watchlistType:""}),V=F(()=>!!s.item),_=F(()=>c.category==="game"),U=F(()=>c.category==="series"),z=F(()=>c.category==="watchlist");ie(()=>s.item,d=>{d?Object.keys(c).forEach(S=>{c[S]=d[S]||""}):Object.keys(c).forEach(S=>{S==="category"?c[S]=s.currentCategory||"watchlist":S==="release"?c[S]=new Date().toISOString().split("T")[0]:c[S]=""})},{immediate:!0}),ie(()=>s.currentCategory,d=>{!s.item&&d&&(c.category=d)});const I=async()=>{if(!c.title){e.value="Title is required";return}if(c.category==="watchlist"&&!c.watchlistType){e.value="Please select a type for watchlist items";return}if(c.category==="watchlist"&&!c.release){e.value="Release date is required for watchlist items";return}l.value=!0,e.value="";try{const d={...c};m.value?(d.path=m.value,d.imageUrl=m.value):d.imageUrl&&d.imageUrl.trim()?d.path=d.imageUrl:(d.imageUrl=null,d.path=null),Object.keys(d).forEach(S=>{d[S]===""&&S!=="watchlistType"&&(d[S]=null)}),d.rating&&(d.rating=parseFloat(d.rating)),d.count&&(d.count=parseInt(d.count)),d.spielzeit&&(d.spielzeit=parseInt(d.spielzeit)),d.nextSeason&&(d.nextSeason=parseInt(d.nextSeason)),t("save",d)}catch(d){e.value=d.message||"Failed to save item"}finally{l.value=!1}},w=()=>{e.value="",t("close")};return{form:c,loading:l,error:e,apiResults:n,isEditing:V,isGame:_,isSeries:U,isWatchlist:z,imageUploadRef:a,uploadedImagePath:m,handleSave:I,closeModal:w,deleteItem:()=>{t("delete",s.item),w()},searchApi:async()=>{if(m.value){n.value=[];return}if(y.value&&clearTimeout(y.value),!c.title||c.title.length<3){n.value=[];return}y.value=setTimeout(async()=>{try{const d=c.category==="watchlist"?c.watchlistType:c.category;if(c.category==="watchlist"&&!c.watchlistType){n.value=[];return}const S=await ze.searchApi(c.title,d,10);S&&S.length>0?n.value=S.map(R=>({title:R.title,release:R.release,genre:R.overview||"",platforms:R.platforms||"",link:R.link||"",imageUrl:R.image||"",rating:R.rating||"",apiSource:R.api_source||"",id:R.id||""})):n.value=[{title:`"${c.title}" - Keine Ergebnisse gefunden`,release:"",genre:"Bitte manuell ausfÃ¼llen",isPlaceholder:!0}]}catch(d){console.error("API search failed:",d),n.value=[{title:`"${c.title}" - API nicht verfÃ¼gbar`,release:"",genre:"Bitte manuell ausfÃ¼llen",isPlaceholder:!0}]}},500)},selectApiResult:async d=>{if(d.isPlaceholder){n.value=[];return}c.title=d.title,d.release&&(c.release=d.release),d.platforms&&(c.platforms=d.platforms),d.genre&&(c.genre=d.genre),d.link&&(c.link=d.link),d.rating&&(c.rating=d.rating),d.imageUrl?(c.imageUrl=d.imageUrl,c.path=d.imageUrl):(c.imageUrl="",c.path=""),n.value=[]},formatDate:d=>d?new Date(d).toLocaleDateString():"",getReleasePreview:()=>{var X;if(!c.release)return"";const d=new Date(c.release),S=new Date;S.setHours(0,0,0,0),d.setHours(0,0,0,0);const R=d.getTime()-S.getTime(),E=Math.ceil(R/(1e3*3600*24));if(E>0)return E===1?"Tomorrow!":E<=7?`${E} days left`:E<=30?`${E} days left`:`${Math.ceil(E/30)} months left`;if(E===0)return"Released today!";{const G=((X=c.watchlistType)==null?void 0:X.toLowerCase())||"media";return G==="game"?"Unplayed yet":G==="series"||G==="movie"?"Unwatched yet":"Unconsumed yet"}},triggerImageUpload:()=>{var d;(d=a.value)==null||d.click()},handleImageUpload:async d=>{const S=d.target.files[0];if(S){if(!S.type.startsWith("image/")){e.value="Please select a valid image file";return}if(S.size>10*1024*1024){e.value="Image file too large. Maximum size is 10MB";return}l.value=!0,e.value="";try{const R=c.title.replace(/[^a-zA-Z0-9\s\-_\.]/g,"").trim()||"item",E=Date.now(),X=S.name.split(".").pop()||"jpg",G=`images_downloads/uploads/${R}_${E}.${X}`,j=await ze.uploadImage(S,G);j.success?(m.value=j.saved,c.path=j.saved,c.imageUrl=j.saved):e.value=j.error||"Failed to upload image"}catch(R){e.value=R.message||"Failed to upload image"}finally{l.value=!1}}},getImagePreviewUrl:()=>m.value?`/storage/${m.value}`:c.imageUrl?c.imageUrl.startsWith("http")?c.imageUrl:`/storage/${c.imageUrl}`:"",handleImageError:d=>{console.warn("Image preview failed:",d.target.src),d.target.style.display="none"},clearImage:()=>{c.imageUrl="",c.path="",m.value="",a.value&&(a.value.value="")},removeUploadedImage:()=>{m.value="",c.imageUrl===m.value&&(c.imageUrl=""),c.path===m.value&&(c.path=""),a.value&&(a.value.value="")}}}},Et={class:"form-header"},Lt={class:"form-group category-group"},Nt={class:"form-group title-group"},Vt={class:"search-container"},zt=["placeholder","disabled"],Wt={key:0,class:"search-results"},Gt=["onClick"],Ot={class:"result-thumbnail"},qt=["src","alt"],jt={key:1,class:"no-image"},Ht={class:"result-content"},Qt={class:"result-title"},Kt={class:"result-meta"},Xt={key:0},Jt={key:1},Yt={key:2,class:"rating"},Zt={class:"form-row"},$t={class:"form-group"},eo={for:"release"},to={key:0,class:"required"},oo=["required"],ao={key:0,class:"field-hint"},lo={key:1,class:"release-preview"},so={class:"form-group"},no={class:"form-row"},io={class:"form-group"},ro={class:"form-group"},co={class:"form-row"},uo={class:"form-group"},mo={class:"form-group"},go={key:0,class:"form-row"},fo={class:"form-group"},vo={key:0,class:"field-error"},yo={class:"form-row"},ho={class:"form-group"},po={class:"form-group"},wo={key:1,class:"form-row"},bo={class:"form-group"},Io={key:2,class:"form-row"},So={class:"form-group"},Co={key:0,class:"form-group"},ko={key:3,class:"form-row"},To={class:"form-group"},Mo={class:"form-row"},_o={class:"form-group"},xo={class:"form-group"},Ao={class:"image-upload-container"},Do=["disabled"],Uo={key:0,class:"upload-success"},Ro={key:4,class:"form-row"},Fo={class:"form-group image-preview-group"},Po={class:"image-preview"},Bo=["src","alt"],Eo={key:5,class:"error-message"},Lo={class:"modal-buttons"},No=["disabled"],Vo=["disabled"],zo=["disabled"],Wo=["disabled"];function Go(s,t,l,e,n,y){return i(),u("div",{class:"modal",onClick:t[27]||(t[27]=(...a)=>e.closeModal&&e.closeModal(...a))},[o("div",{class:"modal-content",onClick:t[26]||(t[26]=J(()=>{},["stop"]))},[o("h2",null,g(e.isEditing?"Edit Item":"Add Item"),1),o("form",{onSubmit:t[25]||(t[25]=J((...a)=>e.handleSave&&e.handleSave(...a),["prevent"]))},[o("div",Et,[o("div",Lt,[t[29]||(t[29]=o("label",{for:"category"},"Category:",-1)),M(o("select",{id:"category","onUpdate:modelValue":t[0]||(t[0]=a=>e.form.category=a),required:""},[...t[28]||(t[28]=[Ve('<option value="watchlist" data-v-02158e60>Watchlist</option><option value="game" data-v-02158e60>Game</option><option value="series" data-v-02158e60>Series</option><option value="movie" data-v-02158e60>Movie</option><option value="buecher" data-v-02158e60>BÃ¼cher</option>',5)])],512),[[he,e.form.category]])]),o("div",Nt,[t[30]||(t[30]=o("label",{for:"title"},"Title:",-1)),o("div",Vt,[M(o("input",{type:"text",id:"title","onUpdate:modelValue":t[1]||(t[1]=a=>e.form.title=a),onInput:t[2]||(t[2]=(...a)=>e.searchApi&&e.searchApi(...a)),required:"",placeholder:e.isWatchlist?"Enter title (API search + manual input available)":"Enter title",disabled:e.loading},null,40,zt),[[P,e.form.title]]),e.apiResults.length>0?(i(),u("div",Wt,[(i(!0),u(re,null,de(e.apiResults,a=>(i(),u("div",{key:a.title,class:"search-result-item",onClick:m=>e.selectApiResult(a)},[o("div",Ot,[a.imageUrl?(i(),u("img",{key:0,src:a.imageUrl,alt:a.title},null,8,qt)):(i(),u("div",jt,[o("span",null,g(a.title.charAt(0).toUpperCase()),1)]))]),o("div",Ht,[o("div",Qt,g(a.title),1),o("div",Kt,[a.release?(i(),u("span",Xt,g(e.formatDate(a.release)),1)):h("",!0),a.genre?(i(),u("span",Jt,g(a.genre),1)):h("",!0),a.rating?(i(),u("span",Yt,"â­ "+g(a.rating),1)):h("",!0)])])],8,Gt))),128))])):h("",!0)])])]),o("div",Zt,[o("div",$t,[o("label",eo,[ne(g(e.isWatchlist?"Release Date:":"Release:")+" ",1),e.isWatchlist?(i(),u("span",to,"*")):h("",!0)]),M(o("input",{type:"date",id:"release","onUpdate:modelValue":t[3]||(t[3]=a=>e.form.release=a),required:e.isWatchlist},null,8,oo),[[P,e.form.release]]),e.isWatchlist?(i(),u("div",ao," ðŸ“… Set the release date to track countdown or status ")):h("",!0),e.isWatchlist&&e.form.release?(i(),u("div",lo,[t[31]||(t[31]=o("strong",null,"Preview:",-1)),ne(" "+g(e.getReleasePreview()),1)])):h("",!0)]),o("div",so,[t[32]||(t[32]=o("label",{for:"rating"},"Rating:",-1)),M(o("input",{type:"number",id:"rating","onUpdate:modelValue":t[4]||(t[4]=a=>e.form.rating=a),step:"0.1",min:"0",max:"10",placeholder:"0-10"},null,512),[[P,e.form.rating]])])]),o("div",no,[o("div",io,[t[33]||(t[33]=o("label",{for:"views"},"Views:",-1)),M(o("input",{type:"number",id:"views","onUpdate:modelValue":t[5]||(t[5]=a=>e.form.count=a),min:"0",placeholder:"0"},null,512),[[P,e.form.count]])]),o("div",ro,[t[34]||(t[34]=o("label",{for:"discovered"},"Discovered:",-1)),M(o("input",{type:"date",id:"discovered","onUpdate:modelValue":t[6]||(t[6]=a=>e.form.discovered=a)},null,512),[[P,e.form.discovered]])])]),o("div",co,[o("div",uo,[t[35]||(t[35]=o("label",{for:"platforms"},"Platforms:",-1)),M(o("input",{type:"text",id:"platforms","onUpdate:modelValue":t[7]||(t[7]=a=>e.form.platforms=a),placeholder:"PC, PS5, Xbox"},null,512),[[P,e.form.platforms]])]),o("div",mo,[t[36]||(t[36]=o("label",{for:"genre"},"Genre:",-1)),M(o("input",{type:"text",id:"genre","onUpdate:modelValue":t[8]||(t[8]=a=>e.form.genre=a),placeholder:"Action, Adventure, RPG"},null,512),[[P,e.form.genre]])])]),e.form.category==="watchlist"?(i(),u("div",go,[o("div",fo,[t[38]||(t[38]=o("label",{for:"watchlistType"},[ne("Type: "),o("span",{class:"required"},"*")],-1)),M(o("select",{id:"watchlistType","onUpdate:modelValue":t[9]||(t[9]=a=>e.form.watchlistType=a)},[...t[37]||(t[37]=[Ve('<option value="" data-v-02158e60>Select Type</option><option value="game" data-v-02158e60>Game</option><option value="series" data-v-02158e60>Series</option><option value="movie" data-v-02158e60>Movie</option><option value="buecher" data-v-02158e60>BÃ¼cher</option>',5)])],512),[[he,e.form.watchlistType]]),e.form.category==="watchlist"&&!e.form.watchlistType?(i(),u("div",vo," Please select a type for watchlist items ")):h("",!0)])])):h("",!0),o("div",yo,[o("div",ho,[t[39]||(t[39]=o("label",{for:"link"},"Link:",-1)),M(o("input",{type:"url",id:"link","onUpdate:modelValue":t[10]||(t[10]=a=>e.form.link=a),placeholder:"https://..."},null,512),[[P,e.form.link]])]),o("div",po,[t[40]||(t[40]=o("label",{for:"path"},"Image Path:",-1)),M(o("input",{type:"text",id:"path","onUpdate:modelValue":t[11]||(t[11]=a=>e.form.path=a),placeholder:"images/movies/filename.jpg"},null,512),[[P,e.form.path]])])]),e.isGame?(i(),u("div",wo,[o("div",bo,[t[41]||(t[41]=o("label",{for:"playtime"},"Playtime (Minutes):",-1)),M(o("input",{type:"number",id:"playtime","onUpdate:modelValue":t[12]||(t[12]=a=>e.form.spielzeit=a),min:"0",placeholder:"0"},null,512),[[P,e.form.spielzeit]])])])):h("",!0),e.isSeries?(i(),u("div",Io,[o("div",So,[t[43]||(t[43]=o("label",{for:"isAiring"},"Status:",-1)),M(o("select",{id:"isAiring","onUpdate:modelValue":t[13]||(t[13]=a=>e.form.isAiring=a)},[...t[42]||(t[42]=[o("option",{value:!1},"Finished",-1),o("option",{value:!0},"Airing",-1)])],512),[[he,e.form.isAiring]])]),e.form.isAiring?(i(),u("div",Co,[t[44]||(t[44]=o("label",{for:"nextSeason"},"Next Season:",-1)),M(o("input",{type:"number",id:"nextSeason","onUpdate:modelValue":t[14]||(t[14]=a=>e.form.nextSeason=a),min:"1",placeholder:"1"},null,512),[[P,e.form.nextSeason]])])):h("",!0)])):h("",!0),e.form.isAiring?(i(),u("div",ko,[o("div",To,[t[45]||(t[45]=o("label",{for:"nextSeasonRelease"},"Next Season Release:",-1)),M(o("input",{type:"date",id:"nextSeasonRelease","onUpdate:modelValue":t[15]||(t[15]=a=>e.form.nextSeasonRelease=a)},null,512),[[P,e.form.nextSeasonRelease]])])])):h("",!0),o("div",Mo,[o("div",_o,[t[46]||(t[46]=o("label",{for:"imageUrl"},"Image URL (optional):",-1)),M(o("input",{type:"text",id:"imageUrl","onUpdate:modelValue":t[16]||(t[16]=a=>e.form.imageUrl=a),placeholder:"https://... or leave empty for API images"},null,512),[[P,e.form.imageUrl]])]),o("div",xo,[t[47]||(t[47]=o("label",{for:"imageUpload"},"Upload Image:",-1)),o("div",Ao,[o("input",{type:"file",id:"imageUpload",ref:"imageUploadRef",onChange:t[17]||(t[17]=(...a)=>e.handleImageUpload&&e.handleImageUpload(...a)),accept:"image/*",style:{display:"none"}},null,544),o("button",{type:"button",onClick:t[18]||(t[18]=(...a)=>e.triggerImageUpload&&e.triggerImageUpload(...a)),class:"upload-btn",disabled:e.loading}," ðŸ“ Choose Image ",8,Do),e.uploadedImagePath?(i(),u("div",Uo,[ne(" âœ… Image uploaded: "+g(e.uploadedImagePath)+" ",1),o("button",{type:"button",onClick:t[19]||(t[19]=(...a)=>e.removeUploadedImage&&e.removeUploadedImage(...a)),class:"remove-uploaded-btn",title:"Remove uploaded image to enable API search"}," âœ• Remove ")])):h("",!0)])])]),e.form.imageUrl||e.uploadedImagePath?(i(),u("div",Ro,[o("div",Fo,[t[48]||(t[48]=o("label",null,"Image Preview:",-1)),o("div",Po,[o("img",{src:e.getImagePreviewUrl(),alt:e.form.title,onError:t[20]||(t[20]=(...a)=>e.handleImageError&&e.handleImageError(...a))},null,40,Bo),o("button",{type:"button",onClick:t[21]||(t[21]=(...a)=>e.clearImage&&e.clearImage(...a)),class:"clear-image-btn",title:"Remove image"}," âœ• ")])])])):h("",!0),e.error?(i(),u("div",Eo,g(e.error),1)):h("",!0),o("div",Lo,[o("button",{type:"submit",disabled:e.loading},g(e.loading?"Saving...":"Save"),9,No),o("button",{type:"button",onClick:t[22]||(t[22]=(...a)=>e.closeModal&&e.closeModal(...a)),disabled:e.loading}," Cancel ",8,Vo),e.isEditing?(i(),u("button",{key:0,type:"button",onClick:t[23]||(t[23]=(...a)=>e.deleteItem&&e.deleteItem(...a)),disabled:e.loading,class:"delete-btn"}," Delete ",8,zo)):h("",!0),o("button",{type:"button",onClick:t[24]||(t[24]=(...a)=>e.handleSave&&e.handleSave(...a)),disabled:e.loading,class:"check-btn",title:"Add to list"}," âœ“ ",8,Wo)])],32)])])}const Oo=O(Bt,[["render",Go],["__scopeId","data-v-02158e60"]]),qo={name:"BulkAddModal",props:{show:{type:Boolean,default:!1},currentCategory:{type:String,default:""}},emits:["close","save"],setup(s,{emit:t}){const l=p(!1),e=p(null),n=p(0),y=p([]),a=p(!1),m=p({category:"",itemsText:"",defaultRating:null,defaultPlatforms:"",defaultGenre:""}),c=F(()=>{if(!m.value.itemsText||!m.value.itemsText.trim())return[];const I=m.value.itemsText.split(`
`).map(w=>w.trim()).filter(w=>w.length>0).map(w=>{const f=w.split("|").map(x=>x.trim());return{searchTerm:f[0]||"",additionalInfo:f[1]||null}});return y.value&&y.value.length>0?I.map((w,f)=>{const x=y.value[f];return{searchTerm:w.searchTerm,additionalInfo:w.additionalInfo,title:(x==null?void 0:x.title)||w.searchTerm,apiData:x||null,hasApiData:!!x}}):I.map(w=>({searchTerm:w.searchTerm,additionalInfo:w.additionalInfo,title:w.searchTerm,apiData:null,hasApiData:!1}))}),V=F(()=>m.value.category&&m.value.itemsText.trim()&&c.value&&c.value.length>0&&!a.value),_=()=>{e.value=null,t("close")},U=async()=>{if(!(!m.value.category||!m.value.itemsText||!m.value.itemsText.trim())){a.value=!0,n.value=0,y.value=[],e.value=null;try{const I=m.value.itemsText.split(`
`).map(f=>f.trim()).filter(f=>f.length>0).map(f=>f.split("|")[0].trim()),w=[];for(let f=0;f<I.length;f++){const x=I[f];n.value=Math.round((f+1)/I.length*100);try{const B=await ze.searchApi(x,m.value.category,1);if(B&&B.length>0){const A=B[0];w.push({title:A.title,release:A.release,rating:A.rating?Math.round(A.rating):null,platforms:A.platforms||m.value.defaultPlatforms,genre:A.genre||m.value.defaultGenre,link:A.link,path:A.image,external_id:A.id,api_source:A.api_source})}else w.push({title:x,release:null,rating:m.value.defaultRating,platforms:m.value.defaultPlatforms,genre:m.value.defaultGenre,link:null,path:null,external_id:null,api_source:null})}catch(B){console.warn(`Search failed for "${x}":`,B),w.push({title:x,release:null,rating:m.value.defaultRating,platforms:m.value.defaultPlatforms,genre:m.value.defaultGenre,link:null,path:null,external_id:null,api_source:null})}await new Promise(B=>setTimeout(B,200))}y.value=w||[]}catch(I){e.value="Failed to search API data: "+(I.message||"Unknown error"),console.error("API search error:",I)}finally{a.value=!1,n.value=100}}},z=async()=>{if(!(!V.value||!c.value)){l.value=!0,e.value=null;try{const I=c.value.map(w=>{const f=w.apiData;return{title:w.title,category:m.value.category,release:(f==null?void 0:f.release)||null,rating:(f==null?void 0:f.rating)||m.value.defaultRating||null,platforms:(f==null?void 0:f.platforms)||m.value.defaultPlatforms||null,genre:(f==null?void 0:f.genre)||m.value.defaultGenre||null,link:(f==null?void 0:f.link)||null,path:(f==null?void 0:f.path)||null,external_id:(f==null?void 0:f.external_id)||null,count:0,is_airing:!1,spielzeit:0}});t("save",I),m.value={category:"",itemsText:"",defaultRating:null,defaultPlatforms:"",defaultGenre:""},y.value=[]}catch(I){e.value=I.message||"Failed to add items",console.error("Bulk add error:",I)}finally{l.value=!1}}};return ie([()=>m.value.category,()=>m.value.itemsText],([I,w])=>{I&&w&&w.trim()&&!a.value&&setTimeout(()=>{m.value.category===I&&m.value.itemsText===w&&!a.value&&U()},1e3)}),ie(()=>s.show,I=>{I&&s.currentCategory?m.value.category=s.currentCategory:I||(m.value={category:"",itemsText:"",defaultRating:null,defaultPlatforms:"",defaultGenre:""},y.value=[],e.value=null,a.value=!1,n.value=0)}),{loading:l,error:e,bulkData:m,previewItems:c,canSave:V,closeModal:_,searchApiData:U,saveBulkItems:z,isSearching:a,searchProgress:n}}},jo={class:"modal-header"},Ho={class:"modal-body"},Qo={class:"bulk-add-form"},Ko={class:"form-group"},Xo={class:"form-group"},Jo={class:"form-group"},Yo={class:"form-group"},Zo={class:"form-group"},$o={key:0,class:"search-progress"},ea={class:"progress-bar"},ta={class:"progress-text"},oa={key:1,class:"preview-section"},aa={class:"preview-list"},la={class:"item-main"},sa={class:"item-title"},na={key:0,class:"api-badge"},ia={key:1,class:"manual-badge"},ra={key:0,class:"item-info"},da={key:1,class:"item-details"},ca={key:0,class:"item-release"},ua={key:1,class:"item-rating"},ma={key:2,class:"item-genre"},ga={key:0,class:"preview-more"},fa={class:"modal-footer"},va=["disabled"],ya={key:0},ha={key:1},pa={key:2};function wa(s,t,l,e,n,y){return l.show?(i(),u("div",{key:0,class:"modal-overlay",onClick:t[9]||(t[9]=(...a)=>e.closeModal&&e.closeModal(...a))},[o("div",{class:"modal-content",onClick:t[8]||(t[8]=J(()=>{},["stop"]))},[o("div",jo,[t[10]||(t[10]=o("h2",null,"Bulk Add Items",-1)),o("button",{class:"close-btn",onClick:t[0]||(t[0]=(...a)=>e.closeModal&&e.closeModal(...a))},"âœ•")]),o("div",Ho,[o("div",Qo,[o("div",Ko,[t[12]||(t[12]=o("label",{for:"category"},"Category *",-1)),M(o("select",{id:"category","onUpdate:modelValue":t[1]||(t[1]=a=>e.bulkData.category=a),required:""},[...t[11]||(t[11]=[Ve('<option value="" data-v-0ecb5be6>Select Category</option><option value="game" data-v-0ecb5be6>Game</option><option value="series" data-v-0ecb5be6>Series</option><option value="movie" data-v-0ecb5be6>Movie</option><option value="buecher" data-v-0ecb5be6>BÃ¼cher</option><option value="watchlist" data-v-0ecb5be6>Watchlist</option>',6)])],512),[[he,e.bulkData.category]])]),o("div",Xo,[t[13]||(t[13]=o("label",{for:"items-text"},"Items (one per line) *",-1)),M(o("textarea",{id:"items-text","onUpdate:modelValue":t[2]||(t[2]=a=>e.bulkData.itemsText=a),placeholder:`Enter items one per line, for example:
The Witcher 3
Cyberpunk 2077
Red Dead Redemption 2`,rows:"10",required:""},null,512),[[P,e.bulkData.itemsText]]),t[14]||(t[14]=o("small",{class:"help-text"},"Enter one item per line. The system will automatically search the API for each title and use the official names, images, and details. You can add additional info using: Title | Additional Info",-1))]),o("div",Jo,[t[15]||(t[15]=o("label",{for:"default-rating"},"Default Rating",-1)),M(o("input",{id:"default-rating","onUpdate:modelValue":t[3]||(t[3]=a=>e.bulkData.defaultRating=a),type:"number",min:"0",max:"10",step:"0.1",placeholder:"Optional rating for all items"},null,512),[[P,e.bulkData.defaultRating,void 0,{number:!0}]])]),o("div",Yo,[t[16]||(t[16]=o("label",{for:"default-platforms"},"Default Platforms",-1)),M(o("input",{id:"default-platforms","onUpdate:modelValue":t[4]||(t[4]=a=>e.bulkData.defaultPlatforms=a),type:"text",placeholder:"e.g., PC, PS5, Xbox"},null,512),[[P,e.bulkData.defaultPlatforms]])]),o("div",Zo,[t[17]||(t[17]=o("label",{for:"default-genre"},"Default Genre",-1)),M(o("input",{id:"default-genre","onUpdate:modelValue":t[5]||(t[5]=a=>e.bulkData.defaultGenre=a),type:"text",placeholder:"e.g., Action, Adventure, RPG"},null,512),[[P,e.bulkData.defaultGenre]])])]),e.isSearching?(i(),u("div",$o,[o("div",ea,[o("div",{class:"progress-fill",style:He({width:e.searchProgress+"%"})},null,4)]),o("span",ta,"Searching API for "+g(e.previewItems?e.previewItems.length:0)+" items... "+g(e.searchProgress)+"%",1)])):h("",!0),e.previewItems&&e.previewItems.length>0&&!e.isSearching?(i(),u("div",oa,[o("h3",null,"Preview ("+g(e.previewItems.length)+" items)",1),o("div",aa,[(i(!0),u(re,null,de(e.previewItems.slice(0,10),(a,m)=>(i(),u("div",{key:m,class:Z(["preview-item",{"has-api-data":a.hasApiData}])},[o("div",la,[o("span",sa,g(a.title),1),a.hasApiData?(i(),u("span",na,"âœ“ API")):(i(),u("span",ia,"Manual"))]),a.additionalInfo?(i(),u("div",ra," | "+g(a.additionalInfo),1)):h("",!0),a.apiData?(i(),u("div",da,[a.apiData.release?(i(),u("small",ca,g(a.apiData.release),1)):h("",!0),a.apiData.rating?(i(),u("small",ua,"â­ "+g(a.apiData.rating),1)):h("",!0),a.apiData.genre?(i(),u("small",ma,g(a.apiData.genre),1)):h("",!0)])):h("",!0)],2))),128)),e.previewItems&&e.previewItems.length>10?(i(),u("div",ga," ... and "+g(e.previewItems.length-10)+" more items ",1)):h("",!0)])])):h("",!0)]),o("div",fa,[o("button",{class:"btn btn-secondary",onClick:t[6]||(t[6]=(...a)=>e.closeModal&&e.closeModal(...a))},"Cancel"),o("button",{class:"btn btn-primary",onClick:t[7]||(t[7]=(...a)=>e.saveBulkItems&&e.saveBulkItems(...a)),disabled:!e.canSave||e.loading},[e.loading?(i(),u("span",ya,"Adding "+g(e.previewItems?e.previewItems.length:0)+" items...",1)):e.isSearching?(i(),u("span",ha,"Searching API...")):(i(),u("span",pa,"Add "+g(e.previewItems?e.previewItems.length:0)+" Items",1))],8,va)])])])):h("",!0)}const ba=O(qo,[["render",wa],["__scopeId","data-v-0ecb5be6"]]),Ia={name:"TxtImportModal",props:{show:{type:Boolean,default:!1}},emits:["close","fileProcessed"],methods:{handleFileUpload(s){const t=s.target.files[0];if(!t)return;if(!t.name.toLowerCase().endsWith(".txt")){alert("Bitte wÃ¤hlen Sie eine .txt Datei aus.");return}const l=new FileReader;l.onload=e=>{const n=e.target.result;this.$emit("fileProcessed",n)},l.readAsText(t,"UTF-8")}}},Sa={class:"file-upload-area"},Ca={class:"modal-buttons"};function ka(s,t,l,e,n,y){return l.show?(i(),u("div",{key:0,class:"modal",onClick:t[3]||(t[3]=a=>s.$emit("close"))},[o("div",{class:"modal-content",onClick:t[2]||(t[2]=J(()=>{},["stop"]))},[t[5]||(t[5]=o("h2",null,"ðŸ“„ Import from TXT File",-1)),t[6]||(t[6]=o("p",null,"WÃ¤hlen Sie eine .txt Datei mit einer Liste von Titeln aus, um zu prÃ¼fen, welche Items in der aktuellen Kategorie fehlen.",-1)),o("div",Sa,[o("input",{type:"file",id:"txtFileInput",accept:".txt",onChange:t[0]||(t[0]=(...a)=>y.handleFileUpload&&y.handleFileUpload(...a)),style:{display:"none"}},null,32),t[4]||(t[4]=o("label",{for:"txtFileInput",class:"file-upload-label"},[o("span",{class:"upload-icon"},"ðŸ“"),o("span",{class:"upload-text"},"TXT-Datei auswÃ¤hlen"),o("span",{class:"upload-hint"},"Eine .txt Datei mit einer Liste von Titeln")],-1))]),o("div",Ca,[o("button",{type:"button",onClick:t[1]||(t[1]=a=>s.$emit("close"))}," Cancel ")])])])):h("",!0)}const Ta=O(Ia,[["render",ka],["__scopeId","data-v-d761bd17"]]),Ma={name:"TxtImportResultsModal",props:{show:{type:Boolean,default:!1},results:{type:Object,default:null}},emits:["close"]},_a={class:"results-summary"},xa={class:"summary-item"},Aa={class:"summary-value"},Da={class:"summary-item"},Ua={class:"summary-value"},Ra={class:"summary-item"},Fa={class:"summary-value existing"},Pa={class:"summary-item"},Ba={class:"summary-value missing"},Ea={key:0,class:"missing-items"},La={class:"items-list"},Na={key:1,class:"existing-items"},Va={class:"items-list"},za={class:"modal-buttons"};function Wa(s,t,l,e,n,y){return l.show&&l.results?(i(),u("div",{key:0,class:"modal",onClick:t[2]||(t[2]=a=>s.$emit("close"))},[o("div",{class:"modal-content results-modal",onClick:t[1]||(t[1]=J(()=>{},["stop"]))},[t[7]||(t[7]=o("h2",null,"ðŸ“Š TXT Import Ergebnisse",-1)),o("div",_a,[o("div",xa,[t[3]||(t[3]=o("span",{class:"summary-label"},"Kategorie:",-1)),o("span",Aa,g(l.results.categoryName),1)]),o("div",Da,[t[4]||(t[4]=o("span",{class:"summary-label"},"Titel in Datei:",-1)),o("span",Ua,g(l.results.totalInFile),1)]),o("div",Ra,[t[5]||(t[5]=o("span",{class:"summary-label"},"Bereits vorhanden:",-1)),o("span",Fa,g(l.results.existingItems.length),1)]),o("div",Pa,[t[6]||(t[6]=o("span",{class:"summary-label"},"Fehlende Titel:",-1)),o("span",Ba,g(l.results.missingItems.length),1)])]),l.results.missingItems.length>0?(i(),u("div",Ea,[o("h3",null,"âŒ Fehlende Titel ("+g(l.results.missingItems.length)+"):",1),o("div",La,[(i(!0),u(re,null,de(l.results.missingItems,(a,m)=>(i(),u("div",{key:m,class:"missing-item"},g(a),1))),128))])])):h("",!0),l.results.existingItems.length>0?(i(),u("div",Na,[o("h3",null,"âœ… Bereits vorhanden ("+g(l.results.existingItems.length)+"):",1),o("div",Va,[(i(!0),u(re,null,de(l.results.existingItems,(a,m)=>(i(),u("div",{key:m,class:"existing-item"},g(a),1))),128))])])):h("",!0),o("div",za,[o("button",{type:"button",onClick:t[0]||(t[0]=a=>s.$emit("close"))}," SchlieÃŸen ")])])])):h("",!0)}const Ga=O(Ma,[["render",Wa],["__scopeId","data-v-ec385b83"]]),Oa={name:"MessageBox",props:{show:{type:Boolean,default:!1},type:{type:String,default:"info",validator:s=>["success","error","warning","info"].includes(s)},title:{type:String,default:""},message:{type:String,required:!0},details:{type:String,default:""}},emits:["close"],setup(s,{emit:t}){const l=()=>{t("close")},e=F(()=>{switch(s.type){case"success":return"âœ…";case"error":return"âŒ";case"warning":return"âš ï¸";case"info":return"â„¹ï¸";default:return"â„¹ï¸"}}),n=F(()=>`message-${s.type}`);return{closeMessage:l,icon:e,messageType:n}}},qa={class:"message-header"},ja={class:"message-icon"},Ha={class:"message-title"},Qa={class:"message-body"},Ka={key:0,class:"message-details"},Xa={class:"message-footer"};function Ja(s,t,l,e,n,y){return l.show?(i(),u("div",{key:0,class:"message-overlay",onClick:t[3]||(t[3]=(...a)=>e.closeMessage&&e.closeMessage(...a))},[o("div",{class:Z(["message-box",e.messageType]),onClick:t[2]||(t[2]=J(()=>{},["stop"]))},[o("div",qa,[o("span",ja,g(e.icon),1),o("h3",Ha,g(l.title),1),o("button",{class:"close-btn",onClick:t[0]||(t[0]=(...a)=>e.closeMessage&&e.closeMessage(...a))},"âœ•")]),o("div",Qa,[o("p",null,g(l.message),1),l.details?(i(),u("div",Ka,[o("pre",null,g(l.details),1)])):h("",!0)]),o("div",Xa,[o("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=(...a)=>e.closeMessage&&e.closeMessage(...a))},"OK")])],2)])):h("",!0)}const Ya=O(Oa,[["render",Ja],["__scopeId","data-v-e60f5606"]]),Za={name:"ConfirmDialog",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm Action"},message:{type:String,required:!0}},emits:["confirm","close"],setup(s,{emit:t}){const l=()=>{t("close")};return{closeDialog:l,confirmAction:()=>{t("confirm"),l()}}}},$a={class:"confirm-header"},el={class:"confirm-title"},tl={class:"confirm-body"},ol={class:"confirm-footer"};function al(s,t,l,e,n,y){return l.show?(i(),u("div",{key:0,class:"confirm-overlay",onClick:t[4]||(t[4]=(...a)=>e.closeDialog&&e.closeDialog(...a))},[o("div",{class:"confirm-dialog",onClick:t[3]||(t[3]=J(()=>{},["stop"]))},[o("div",$a,[o("h3",el,g(l.title),1),o("button",{class:"close-btn",onClick:t[0]||(t[0]=(...a)=>e.closeDialog&&e.closeDialog(...a))},"âœ•")]),o("div",tl,[o("p",null,g(l.message),1)]),o("div",ol,[o("button",{class:"btn btn-secondary",onClick:t[1]||(t[1]=(...a)=>e.closeDialog&&e.closeDialog(...a))},"Cancel"),o("button",{class:"btn btn-danger",onClick:t[2]||(t[2]=(...a)=>e.confirmAction&&e.confirmAction(...a))},"Confirm")])])])):h("",!0)}const ll=O(Za,[["render",al],["__scopeId","data-v-c59b3a34"]]),sl={name:"InputDialog",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Input Required"},message:{type:String,required:!0},placeholder:{type:String,default:""},inputType:{type:String,default:"text"},defaultValue:{type:String,default:""}},emits:["confirm","close"],setup(s,{emit:t}){const l=p(""),e=p(null),n=()=>{t("close")},y=()=>{t("confirm",l.value),n()};return ie(()=>s.show,async a=>{a&&(l.value=s.defaultValue,await ot(),e.value&&(e.value.focus(),e.value.select()))}),{inputValue:l,inputRef:e,closeDialog:n,confirmAction:y}}},nl={class:"input-header"},il={class:"input-title"},rl={class:"input-body"},dl={class:"input-message"},cl=["type","placeholder"],ul={class:"input-footer"};function ml(s,t,l,e,n,y){return l.show?(i(),u("div",{key:0,class:"input-overlay",onClick:t[6]||(t[6]=(...a)=>e.closeDialog&&e.closeDialog(...a))},[o("div",{class:"input-dialog",onClick:t[5]||(t[5]=J(()=>{},["stop"]))},[o("div",nl,[o("h3",il,g(l.title),1),o("button",{class:"close-btn",onClick:t[0]||(t[0]=(...a)=>e.closeDialog&&e.closeDialog(...a))},"âœ•")]),o("div",rl,[o("p",dl,g(l.message),1),M(o("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>e.inputValue=a),type:l.inputType,placeholder:l.placeholder,class:"input-field",onKeyup:t[2]||(t[2]=tt((...a)=>e.confirmAction&&e.confirmAction(...a),["enter"])),ref:"inputRef"},null,40,cl),[[et,e.inputValue]])]),o("div",ul,[o("button",{class:"btn btn-secondary",onClick:t[3]||(t[3]=(...a)=>e.closeDialog&&e.closeDialog(...a))},"Cancel"),o("button",{class:"btn btn-primary",onClick:t[4]||(t[4]=(...a)=>e.confirmAction&&e.confirmAction(...a))},"OK")])])])):h("",!0)}const gl=O(sl,[["render",ml],["__scopeId","data-v-1aa6a706"]]),fl={name:"MediaLibrary",components:{MediaItem:xt,Sidebar:rt,MainHeader:it,FloatingActionButton:Pt,LoginModal:nt,RegisterModal:st,EditModal:Oo,BulkAddModal:ba,TxtImportModal:Ta,TxtImportResultsModal:Ga,LoadingSpinner:dt,MessageBox:Ya,ConfirmDialog:ll,InputDialog:gl},setup(){const s=Qe(),t=Ke(),l=Xe(),e=Je(),{sidebarCollapsed:n,mobileSidebarOpen:y,showLoginModal:a,showRegisterModal:m,showEditModal:c,showFloatingMenu:V,showBulkAddModal:_,showTxtImportModal:U,showTxtImportResults:z,editingItem:I,gridColumns:w,sortBy:f,categories:x,txtImportResults:B,isLoggedIn:A,userName:K,currentCategory:k,searchQuery:$,categoryCounts:q,loading:ce,error:W,paginatedMedia:ue,platforms:d,genres:S,toggleSidebar:R,toggleMobileSidebar:E,closeMobileSidebar:X,setCategory:G,clearSearch:j,togglePlatformFilter:pe,toggleGenreFilter:we,toggleAiringFilter:be,editItem:Ie,closeEditModal:Se,closeBulkAddModal:Ce,handleBulkAddItems:ke,handleSaveItem:Te,handleDeleteItem:Me,logout:me,loadMedia:Y,toggleFloatingMenu:_e,addNewItem:ge,bulkAddItems:xe,importFromTxt:Ae,importFromAPI:ee,createCollection:De,exportMediaCollection:Ue,exportAsCSV:Re,exportAsJSON:Fe,downloadFile:Pe,deleteAllInCategory:Be,getCategoryDisplayName:te,navigateToStatistics:Ee,navigateToCalendar:Le,navigateToFeatures:Ne,navigateToProfile:fe,processTxtContent:ve,closeTxtImportResults:ye,cleanup:oe}=ct(),We=H=>{G(H),ge()},Ge=()=>{a.value=!1,m.value=!0},Oe=H=>{a.value=!1,Y()},qe=()=>{m.value=!1,Y()};return at(async()=>{try{if(await Y(),A.value)try{s.initializeRealtimeUpdates()}catch(H){console.error("Error initializing realtime updates:",H)}}catch(H){console.error("Error during initialization:",H)}}),lt(()=>{if(A.value)try{s.cleanupRealtimeUpdates()}catch(H){console.error("Error cleaning up realtime updates:",H)}oe()}),{sidebarCollapsed:n,mobileSidebarOpen:y,showLoginModal:a,showRegisterModal:m,showEditModal:c,showFloatingMenu:V,showBulkAddModal:_,showTxtImportModal:U,showTxtImportResults:z,editingItem:I,gridColumns:w,sortBy:f,categories:x,txtImportResults:B,isLoggedIn:A,userName:K,currentCategory:k,searchQuery:$,categoryCounts:q,loading:ce,error:W,paginatedMedia:ue,platforms:d,genres:S,toggleSidebar:R,toggleMobileSidebar:E,closeMobileSidebar:X,setCategory:G,clearSearch:j,navigateToStatistics:Ee,navigateToCalendar:Le,navigateToFeatures:Ne,navigateToProfile:fe,addItemFromSidebar:We,togglePlatformFilter:pe,toggleGenreFilter:we,toggleAiringFilter:be,editItem:Ie,switchToRegister:Ge,handleLoginSuccess:Oe,handleRegisterSuccess:qe,closeEditModal:Se,closeBulkAddModal:Ce,handleBulkAddItems:ke,handleSaveItem:Te,handleDeleteItem:Me,logout:me,loadMedia:Y,toggleFloatingMenu:_e,addNewItem:ge,bulkAddItems:xe,importFromTxt:Ae,importFromAPI:ee,createCollection:De,exportMediaCollection:Ue,exportAsCSV:Re,exportAsJSON:Fe,downloadFile:Pe,deleteAllInCategory:Be,getCategoryDisplayName:te,processTxtContent:ve,closeTxtImportResults:ye,messageStore:t,confirmStore:l,inputStore:e}}},vl={class:"vue-app"},yl={class:"main-content"},hl={class:"content-area"},pl={key:1,class:"error"},wl={key:2};function bl(s,t,l,e,n,y){const a=N("Sidebar"),m=N("MainHeader"),c=N("LoadingSpinner"),V=N("MediaItem"),_=N("LoginModal"),U=N("RegisterModal"),z=N("EditModal"),I=N("BulkAddModal"),w=N("TxtImportModal"),f=N("TxtImportResultsModal"),x=N("FloatingActionButton"),B=N("MessageBox"),A=N("ConfirmDialog"),K=N("InputDialog");return i(),u("div",vl,[o("div",{class:Z(["mobile-overlay",{show:e.mobileSidebarOpen}]),onClick:t[0]||(t[0]=(...k)=>e.closeMobileSidebar&&e.closeMobileSidebar(...k))},null,2),Q(a,{collapsed:e.sidebarCollapsed,"mobile-open":e.mobileSidebarOpen,"is-logged-in":e.isLoggedIn,"is-admin":s.isAdmin,"user-name":e.userName,"current-category":e.currentCategory,"category-counts":e.categoryCounts,platforms:e.platforms,genres:e.genres,categories:e.categories,onToggle:e.toggleSidebar,onSetCategory:e.setCategory,onNavigateToStatistics:e.navigateToStatistics,onNavigateToCalendar:e.navigateToCalendar,onNavigateToFeatures:e.navigateToFeatures,onNavigateToProfile:e.navigateToProfile,onNavigateToAdmin:s.navigateToAdmin,onTogglePlatformFilter:e.togglePlatformFilter,onToggleGenreFilter:e.toggleGenreFilter,onToggleAiringFilter:e.toggleAiringFilter,onAddItem:e.addItemFromSidebar,onShowLogin:t[1]||(t[1]=k=>e.showLoginModal=!0),onShowRegister:t[2]||(t[2]=k=>e.showRegisterModal=!0),onLogout:e.logout},null,8,["collapsed","mobile-open","is-logged-in","is-admin","user-name","current-category","category-counts","platforms","genres","categories","onToggle","onSetCategory","onNavigateToStatistics","onNavigateToCalendar","onNavigateToFeatures","onNavigateToProfile","onNavigateToAdmin","onTogglePlatformFilter","onToggleGenreFilter","onToggleAiringFilter","onAddItem","onLogout"]),o("div",yl,[Q(m,{"search-query":e.searchQuery,"onUpdate:searchQuery":t[3]||(t[3]=k=>e.searchQuery=k),"grid-columns":e.gridColumns,"onUpdate:gridColumns":t[4]||(t[4]=k=>e.gridColumns=k),"sort-by":e.sortBy,"onUpdate:sortBy":t[5]||(t[5]=k=>e.sortBy=k),onToggleMobileSidebar:e.toggleMobileSidebar,onClearSearch:e.clearSearch},null,8,["search-query","grid-columns","sort-by","onToggleMobileSidebar","onClearSearch"]),o("main",hl,[e.loading?(i(),se(c,{key:0,message:"Loading media data..."})):e.error?(i(),u("div",pl,[o("p",null,g(e.error),1),o("button",{onClick:t[6]||(t[6]=(...k)=>e.loadMedia&&e.loadMedia(...k))},"Retry")])):(i(),u("div",wl,[o("div",{class:"grid",style:He({gridTemplateColumns:`repeat(${e.gridColumns}, 1fr)`})},[(i(!0),u(re,null,de(e.paginatedMedia,k=>(i(),se(V,{key:k.id,item:k,onEdit:e.editItem},null,8,["item","onEdit"]))),128))],4)]))])]),e.showLoginModal?(i(),se(_,{key:0,onClose:t[7]||(t[7]=k=>e.showLoginModal=!1),onSuccess:e.handleLoginSuccess,onSwitchToRegister:e.switchToRegister},null,8,["onSuccess","onSwitchToRegister"])):h("",!0),e.showRegisterModal?(i(),se(U,{key:1,onClose:t[8]||(t[8]=k=>e.showRegisterModal=!1),onSuccess:e.handleRegisterSuccess},null,8,["onSuccess"])):h("",!0),e.showEditModal?(i(),se(z,{key:2,item:e.editingItem,"current-category":e.currentCategory,onClose:e.closeEditModal,onSave:e.handleSaveItem,onDelete:e.handleDeleteItem},null,8,["item","current-category","onClose","onSave","onDelete"])):h("",!0),Q(I,{show:e.showBulkAddModal,"current-category":e.currentCategory,onClose:e.closeBulkAddModal,onSave:e.handleBulkAddItems},null,8,["show","current-category","onClose","onSave"]),Q(w,{show:e.showTxtImportModal,onClose:t[9]||(t[9]=k=>e.showTxtImportModal=!1),onFileProcessed:e.processTxtContent},null,8,["show","onFileProcessed"]),Q(f,{show:e.showTxtImportResults,results:e.txtImportResults,onClose:e.closeTxtImportResults},null,8,["show","results","onClose"]),Q(x,{"show-menu":e.showFloatingMenu,"show-delete-all":e.isLoggedIn&&e.currentCategory!=="all"&&e.categoryCounts[e.currentCategory]>0,"category-name":e.getCategoryDisplayName(e.currentCategory),"item-count":e.categoryCounts[e.currentCategory]||0,onToggleMenu:e.toggleFloatingMenu,onAddNewItem:e.addNewItem,onBulkAddItems:e.bulkAddItems,onImportFromTxt:e.importFromTxt,onImportFromApi:e.importFromAPI,onCreateCollection:e.createCollection,onDeleteAllInCategory:e.deleteAllInCategory},null,8,["show-menu","show-delete-all","category-name","item-count","onToggleMenu","onAddNewItem","onBulkAddItems","onImportFromTxt","onImportFromApi","onCreateCollection","onDeleteAllInCategory"]),Q(B,{show:e.messageStore.show,type:e.messageStore.type,title:e.messageStore.title,message:e.messageStore.message,details:e.messageStore.details,onClose:e.messageStore.closeMessage},null,8,["show","type","title","message","details","onClose"]),Q(A,{show:e.confirmStore.show,title:e.confirmStore.title,message:e.confirmStore.message,onConfirm:e.confirmStore.confirm,onClose:e.confirmStore.cancel},null,8,["show","title","message","onConfirm","onClose"]),Q(K,{show:e.inputStore.show,title:e.inputStore.title,message:e.inputStore.message,placeholder:e.inputStore.placeholder,"input-type":e.inputStore.inputType,"default-value":e.inputStore.defaultValue,onConfirm:e.inputStore.confirm,onClose:e.inputStore.cancel},null,8,["show","title","message","placeholder","input-type","default-value","onConfirm","onClose"])])}const _l=O(fl,[["render",bl],["__scopeId","data-v-4f466f60"]]);export{_l as default};
