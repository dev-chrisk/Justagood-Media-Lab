import{d as He,r as h,u as nt,a as Ze,c as N,_ as X,b as d,e as s,t as c,f,n as ee,g as be,h as de,o as l,i as $e,w as Ae,j as ae,k as M,v as we,l as Oe,m as V,F as J,p as K,q as qe,s as it,x as rt,y as lt,z as oe,A as he,B as H,C as dt,D as ct}from"./index-Cgo_GXa4.js";import{u as Qe,a as et,S as ut}from"./Sidebar-tMToGHKl.js";import{R as mt,L as gt,M as ft}from"./RegisterModal-C34tNREu.js";const tt=He("message",()=>{const i=h(!1),t=h("info"),a=h(""),e=h(""),u=h("");function v(C){t.value=C.type||"info",a.value=C.title||"",e.value=C.message||"",u.value=C.details||"",i.value=!0}function o(C,F="Success",R=""){v({type:"success",title:F,message:C,details:R})}function w(C,F="Error",R=""){v({type:"error",title:F,message:C,details:R})}function r(C,F="Warning",R=""){v({type:"warning",title:F,message:C,details:R})}function S(C,F="Info",R=""){v({type:"info",title:F,message:C,details:R})}function A(){i.value=!1,setTimeout(()=>{t.value="info",a.value="",e.value="",u.value=""},300)}return{show:i,type:t,title:a,message:e,details:u,showMessage:v,showSuccess:o,showError:w,showWarning:r,showInfo:S,closeMessage:A}}),st=He("confirm",()=>{const i=h(!1),t=h("Confirm Action"),a=h(""),e=h(null);function u(w){return new Promise(r=>{t.value=w.title||"Confirm Action",a.value=w.message||"",i.value=!0,e.value=r})}function v(){e.value&&(e.value(!0),e.value=null),i.value=!1}function o(){e.value&&(e.value(!1),e.value=null),i.value=!1}return{show:i,title:t,message:a,showConfirm:u,confirm:v,cancel:o}}),ot=He("input",()=>{const i=h(!1),t=h("Input Required"),a=h(""),e=h(""),u=h("text"),v=h(""),o=h(null);function w(A){return new Promise(C=>{t.value=A.title||"Input Required",a.value=A.message||"",e.value=A.placeholder||"",u.value=A.inputType||"text",v.value=A.defaultValue||"",i.value=!0,o.value=C})}function r(A){o.value&&(o.value(A),o.value=null),i.value=!1}function S(){o.value&&(o.value(null),o.value=null),i.value=!1}return{show:i,title:t,message:a,placeholder:e,inputType:u,defaultValue:v,showInput:w,confirm:r,cancel:S}});function vt(){const i=nt(),t=Ze(),a=Qe(),e=tt(),u=st(),v=ot(),o=h(!1),w=h(!1),r=h(!1),S=h(!1),A=h(!1),C=h(!1),F=h(!1),R=h(null),q=()=>typeof window<"u"?window.innerWidth>768?8:3:8,B=h(q()),Y=h("order_asc"),Z=h(null),$=()=>{B.value=q()};typeof window<"u"&&window.addEventListener("resize",$);const Q=[{key:"game",name:"Games",icon:"ðŸŽ®"},{key:"series",name:"Series",icon:"ðŸ“º"},{key:"movie",name:"Movies",icon:"ðŸŽ¬"},{key:"buecher",name:"BÃ¼cher",icon:"ðŸ“š"},{key:"watchlist",name:"Watchlist",icon:"â¤ï¸"}],g=N(()=>{try{return t.isLoggedIn}catch(m){return console.error("Error accessing authStore.isLoggedIn:",m),!1}}),L=N(()=>{try{return t.userName}catch(m){return console.error("Error accessing authStore.userName:",m),""}}),ce=N(()=>{try{return t.isAdmin}catch(m){return console.error("Error accessing authStore.isAdmin:",m),!1}}),O=N(()=>{try{return a.currentCategory}catch(m){return console.error("Error accessing mediaStore.currentCategory:",m),"game"}}),ue=N({get:()=>{try{return a.searchQuery}catch(m){return console.error("Error accessing mediaStore.searchQuery:",m),""}},set:m=>{try{a.setSearchQuery(m)}catch(b){console.error("Error setting mediaStore.searchQuery:",b)}}}),ne=N(()=>{try{return a.categoryCounts}catch(m){return console.error("Error accessing mediaStore.categoryCounts:",m),{}}}),D=N(()=>{try{return a.loading}catch(m){return console.error("Error accessing mediaStore.loading:",m),!1}}),U=N(()=>{try{return a.error}catch(m){return console.error("Error accessing mediaStore.error:",m),null}}),n=N(()=>{try{const m=[...a.filteredMedia||[]],[b,E]=Y.value.split("_");return m.sort((I,_)=>{let z=I[b],x=_[b];return b==="order"?(z=I.__order||0,x=_.__order||0):b==="airing"?(z=I.isAiring?1:0,x=_.isAiring?1:0):b==="api_rating"?(z=I.api_rating||I.rating||0,x=_.api_rating||_.rating||0):b==="personal_rating"&&(z=I.personal_rating||0,x=_.personal_rating||0),typeof z=="string"&&(z=z.toLowerCase(),x=x.toLowerCase()),E==="asc"?z>x?1:-1:z<x?1:-1})}catch(m){return console.error("Error in sortedMedia computed:",m),[]}}),y=N(()=>n.value),W=N(()=>{try{if(!a||!a.mediaData)return[];const m=new Set;return a.mediaData.forEach(b=>{b.platforms&&b.platforms.split(",").forEach(E=>m.add(E.trim()))}),Array.from(m).sort()}catch(m){return console.error("Error in platforms computed:",m),[]}}),p=N(()=>{try{if(!a||!a.mediaData)return[];const m=new Set;return a.mediaData.forEach(b=>{b.genre&&b.genre.split(",").forEach(E=>m.add(E.trim()))}),Array.from(m).sort()}catch(m){return console.error("Error in genres computed:",m),[]}}),P=m=>{a.setCategory(m),et().closeMobileSidebar()},te=()=>{a.setSearchQuery("")},se=(m,b)=>{b?a.addFilter({type:"platform",value:m}):a.removeFilter({type:"platform",value:m})},xe=(m,b)=>{b?a.addFilter({type:"genre",value:m}):a.removeFilter({type:"genre",value:m})},Me=(m,b)=>{b?a.addFilter({type:"airing",value:m}):a.removeFilter({type:"airing",value:m})},Re=m=>{R.value=m,r.value=!0},Se=()=>{r.value=!1,R.value=null},De=()=>{A.value=!1},Ue=async m=>{console.log("handleBulkAddItems called but not used in new workflow")},Pe=async m=>{R.value?await a.updateMediaItem(R.value.id,m):await a.addMediaItem(m),Se()},Ee=async m=>{var b;try{await a.deleteMediaItem(m.id)}catch(E){((b=E.response)==null?void 0:b.status)!==404&&!E.silent&&(console.error("Delete failed:",E),e.showError("Failed to delete item: "+(E.message||"Unknown error"),"Delete Failed"))}},ie=async()=>{await t.logout(),await fe()},fe=async()=>{try{await a.loadMedia()}catch(m){console.error("Error loading media:",m)}},Ie=()=>{S.value=!S.value},Fe=()=>{if(S.value=!1,!g.value){e.showWarning("Bitte loggen Sie sich ein, um neue Items hinzuzufÃ¼gen.","Login erforderlich");return}R.value=null,r.value=!0},Be=()=>{if(S.value=!1,!g.value){e.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}A.value=!0},Le=()=>{if(S.value=!1,!g.value){e.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}C.value=!0},Ne=()=>{if(S.value=!1,!g.value){e.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}e.showInfo("API Import feature coming soon!","Feature in Entwicklung")},Ve=()=>{if(S.value=!1,!g.value){e.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}me()},ve=m=>{if(!m)return"Unknown";const b=Q.find(E=>E.key===m);return b?b.name:m},Ge=async()=>{const m=ve(O.value),b=ne.value[O.value]||0;if(b===0){e.showInfo("No items to delete in this category.","Nothing to Delete");return}const E=`Are you sure you want to delete ALL ${b} items in "${m}"?

This action cannot be undone!`;if(await u.showConfirm({title:"Delete All Items",message:E}))try{const z=((a==null?void 0:a.mediaData)||[]).filter(x=>O.value==="watchlist"?x.category==="watchlist"||x.isNew===!0:x.category===O.value).map(x=>x.id);await a.batchDeleteMediaItems(z),await fe(),e.showSuccess(`Successfully deleted ${b} items from "${m}"`,"Items Deleted")}catch(_){console.error("Error deleting items:",_),e.showError("Error occurred while deleting items. Please try again.","Delete Failed")}},ze=m=>{const b=m.split(`
`).map(x=>x.trim()).filter(x=>x.length>0);if(b.length===0){e.showWarning("Die TXT-Datei ist leer oder enthÃ¤lt keine gÃ¼ltigen EintrÃ¤ge.","Leere Datei");return}const I=a.filteredMedia.map(x=>x.title.toLowerCase().trim()),_=b.filter(x=>{const re=x.toLowerCase().trim();return!I.some(le=>le.includes(re)||re.includes(le))}),z=b.filter(x=>{const re=x.toLowerCase().trim();return I.some(le=>le.includes(re)||re.includes(le))});Z.value={totalInFile:b.length,missingItems:_,existingItems:z,currentCategory:O.value,categoryName:ve(O.value)},C.value=!1,F.value=!0},We=()=>{Z.value=null,F.value=!1},me=async()=>{const m=(a==null?void 0:a.mediaData)||[];if(m.length===0){e.showInfo("Keine Media Items zum Exportieren gefunden.","Nichts zu exportieren");return}const b=await v.showInput({title:"Export Format wÃ¤hlen",message:`1 = CSV
2 = JSON
3 = Beide

Geben Sie die Nummer ein:`,placeholder:"1",defaultValue:"1"});if(!b||!["1","2","3"].includes(b))return;const E=new Date().toISOString().split("T")[0];(b==="1"||b==="3")&&_e(m,E),(b==="2"||b==="3")&&ke(m,E),e.showSuccess(`Collection mit ${m.length} Items wurde erfolgreich exportiert!`,"Export erfolgreich")},_e=(m,b)=>{const I=[["Titel","Kategorie","Release","Rating","Platforms","Genre","Spielzeit","Status","Beschreibung"].join(","),...m.map(_=>[`"${(_.title||"").replace(/"/g,'""')}"`,`"${(_.category||_.category_name||"Unbekannt").replace(/"/g,'""')}"`,`"${_.release||""}"`,`"${_.rating||""}"`,`"${(_.platforms||"").replace(/"/g,'""')}"`,`"${(_.genre||"").replace(/"/g,'""')}"`,`"${_.spielzeit||""}"`,`"${_.isAiring?"Airing":"Abgeschlossen"}"`,`"${(_.description||"").replace(/"/g,'""')}"`].join(","))].join(`
`);ye(I,`media_collection_${b}.csv`,"text/csv;charset=utf-8;")},ke=(m,b)=>{const E={exportDate:new Date().toISOString(),totalItems:m.length,categories:[...new Set(m.map(I=>I.category||I.category_name||"Unbekannt"))],items:m.map(I=>({id:I.id,title:I.title||"",category:I.category||I.category_name||"Unbekannt",release:I.release||"",rating:I.rating||null,platforms:I.platforms||"",genre:I.genre||"",spielzeit:I.spielzeit||null,status:I.isAiring?"Airing":"Abgeschlossen",description:I.description||"",isNew:I.isNew||!1,nextSeason:I.nextSeason||null,discovered:I.discovered||null}))};ye(JSON.stringify(E,null,2),`media_collection_${b}.json`,"application/json;charset=utf-8;")},ye=(m,b,E)=>{const I=new Blob([m],{type:E}),_=document.createElement("a"),z=URL.createObjectURL(I);_.setAttribute("href",z),_.setAttribute("download",b),_.style.visibility="hidden",document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(z)};return{showLoginModal:o,showRegisterModal:w,showEditModal:r,showFloatingMenu:S,showBulkAddModal:A,showTxtImportModal:C,showTxtImportResults:F,editingItem:R,gridColumns:B,sortBy:Y,categories:Q,txtImportResults:Z,isLoggedIn:g,isAdmin:ce,userName:L,currentCategory:O,searchQuery:ue,categoryCounts:ne,loading:D,error:U,paginatedMedia:y,platforms:W,genres:p,setCategory:P,clearSearch:te,togglePlatformFilter:se,toggleGenreFilter:xe,toggleAiringFilter:Me,editItem:Re,closeEditModal:Se,closeBulkAddModal:De,handleBulkAddItems:Ue,handleSaveItem:Pe,handleDeleteItem:Ee,logout:ie,loadMedia:fe,toggleFloatingMenu:Ie,addNewItem:Fe,bulkAddItems:Be,importFromTxt:Le,importFromAPI:Ne,createCollection:Ve,exportMediaCollection:me,exportAsCSV:_e,exportAsJSON:ke,downloadFile:ye,deleteAllInCategory:Ge,getCategoryDisplayName:ve,navigateToCalendar:()=>{i.push("/calendar")},navigateToProfile:()=>{i.push("/profile")},navigateToAdmin:()=>{console.log("ðŸ”¥ navigateToAdmin function called!"),console.log("ðŸ”¥ Router object:",i),console.log("ðŸ”¥ Pushing to /admin...");try{i.push("/admin"),console.log("ðŸ”¥ Successfully navigated to /admin!")}catch(m){console.error("ðŸ”¥ Error navigating to admin:",m)}},processTxtContent:ze,closeTxtImportResults:We,cleanup:()=>{typeof window<"u"&&window.removeEventListener("resize",$)},router:i}}const yt={name:"MediaItem",props:{item:{type:Object,required:!0}},emits:["edit"],computed:{showWatchlistTag(){return this.item.category==="watchlist"||this.item.isNew===!0},isWatchlistItem(){return this.item.category==="watchlist"||this.item.isNew===!0}},methods:{getImageUrl(i){return i?i.startsWith("http")?i.startsWith("http://")?i.replace("http://","https://"):i:i.startsWith("/")?i:`/storage/${i}`:""},handleImageError(i){var t;i.target.style.display="none",(t=i.target.nextElementSibling)==null||t.classList.add("show")},formatDate(i){return i?new Date(i).toLocaleDateString():""},editItem(){this.$emit("edit",this.item)},getWatchlistReleaseStatus(){if(!this.item.release)return"";const i=new Date(this.item.release),t=new Date;t.setHours(0,0,0,0),i.setHours(0,0,0,0);const a=i.getTime()-t.getTime(),e=Math.ceil(a/(1e3*3600*24));if(e>0)return e===1?"Tomorrow!":e<=7?`${e} days left`:e<=30?`${e} days left`:`${Math.ceil(e/30)} months left`;if(e===0)return"Released today!";{const u=this.getTypeTagText().toLowerCase();return u==="game"?"Unplayed yet":u==="series"||u==="movie"?"Unwatched yet":u==="buecher"?"Unread yet":"Unconsumed yet"}},getWatchlistReleaseStatusClass(){if(!this.item.release)return"";const i=new Date(this.item.release),t=new Date;t.setHours(0,0,0,0),i.setHours(0,0,0,0);const a=i.getTime()-t.getTime(),e=Math.ceil(a/(1e3*3600*24));return e>0?"countdown":e===0?"released-today":"unconsumed"},getTypeTagText(){var t,a,e;const i=this.item.watchlistType||this.item.watchlist_type;if(i)return i.charAt(0).toUpperCase()+i.slice(1);if(this.item.genre){const u=this.item.genre.toLowerCase();if(u.includes("game")||u.includes("gaming")||(t=this.item.platforms)!=null&&t.toLowerCase().includes("steam")||(a=this.item.platforms)!=null&&a.toLowerCase().includes("ps")||(e=this.item.platforms)!=null&&e.toLowerCase().includes("xbox"))return"Game";if(u.includes("series")||u.includes("tv")||u.includes("episode")||this.item.isAiring)return"Series";if(u.includes("movie")||u.includes("film")||u.includes("cinema"))return"Movie";if(u.includes("book")||u.includes("literature")||u.includes("novel")||u.includes("author"))return"BÃ¼cher"}if(this.item.platforms){const u=this.item.platforms.toLowerCase();if(u.includes("steam")||u.includes("ps")||u.includes("xbox")||u.includes("nintendo")||u.includes("pc"))return"Game";if(u.includes("netflix")||u.includes("hulu")||u.includes("disney")||u.includes("hbo"))return"Series";if(u.includes("cinema")||u.includes("theater"))return"Movie";if(u.includes("book")||u.includes("kindle")||u.includes("audible")||u.includes("author"))return"BÃ¼cher"}return"Media"},getTypeTagClass(){return`type-${this.getTypeTagText().toLowerCase()}`},getNextSeasonCountdown(){if(!this.item.nextSeasonRelease)return"";const i=new Date(this.item.nextSeasonRelease),t=new Date;t.setHours(0,0,0,0),i.setHours(0,0,0,0);const a=i.getTime()-t.getTime(),e=Math.ceil(a/(1e3*3600*24));return e>0?e===1?"Tomorrow!":e<=7?`${e} days`:e<=30?`${e} days`:`${Math.ceil(e/30)} months`:e===0?"Today!":"Released"},getCategoryClass(){var t;const i=(t=this.item.category)==null?void 0:t.toLowerCase();return i==="movies"||i==="movie"?"category-movies":i==="books"||i==="buecher"?"category-books":i==="series"||i==="tv"?"category-series":i==="games"||i==="game"?"category-games":"category-default"},getCategoryIcon(){var t;const i=(t=this.item.category)==null?void 0:t.toLowerCase();return i==="movies"||i==="movie"?"ðŸŽ¬":i==="books"||i==="buecher"?"ðŸ“š":i==="series"||i==="tv"?"ðŸ“º":i==="games"||i==="game"?"ðŸŽ®":"ðŸ“"},getCategoryStyle(){var t;const i=(t=this.item.category)==null?void 0:t.toLowerCase();if(i==="games"||i==="game"){const a=this.item.rating||0;return this.getGameStyleByRating(a)}return{}},getGameStyleByRating(i){return i>=4.5?{"--game-primary":"#ffd700","--game-secondary":"#ffed4e","--game-accent":"#ff6b35","--game-glow":"0 0 20px rgba(255, 215, 0, 0.6)","--game-border":"3px solid #ffd700"}:i>=4?{"--game-primary":"#00d4ff","--game-secondary":"#4a9eff","--game-accent":"#00ff88","--game-glow":"0 0 15px rgba(0, 212, 255, 0.5)","--game-border":"3px solid #00d4ff"}:i>=3.5?{"--game-primary":"#00ff88","--game-secondary":"#4caf50","--game-accent":"#8bc34a","--game-glow":"0 0 12px rgba(0, 255, 136, 0.4)","--game-border":"3px solid #00ff88"}:i>=3?{"--game-primary":"#ff9800","--game-secondary":"#ffc107","--game-accent":"#ff5722","--game-glow":"0 0 10px rgba(255, 152, 0, 0.3)","--game-border":"3px solid #ff9800"}:i>=2?{"--game-primary":"#ff5722","--game-secondary":"#f44336","--game-accent":"#d32f2f","--game-glow":"0 0 8px rgba(255, 87, 34, 0.3)","--game-border":"3px solid #ff5722"}:{"--game-primary":"#9e9e9e","--game-secondary":"#757575","--game-accent":"#616161","--game-glow":"0 0 5px rgba(158, 158, 158, 0.2)","--game-border":"3px solid #9e9e9e"}}}},pt={class:"media-image"},ht=["src","alt"],bt={key:1,class:"no-image"},wt={class:"no-image-icon"},St={class:"media-info"},It={class:"media-title"},_t={class:"media-meta"},kt={key:0,class:"media-release"},Ct={key:1},Tt={key:1,class:"media-rating"},At={key:0,class:"media-platforms"},xt={key:1,class:"media-genre"},Mt={key:2,class:"media-description"},Rt={key:3,class:"media-airing"},Dt={key:0,class:"next-season"},Ut={key:1,class:"countdown"},Pt={key:4,class:"watchlist-type-tag"};function Et(i,t,a,e,u,v){return l(),d("div",{class:ee(["media-item",v.getCategoryClass()]),style:de(v.getCategoryStyle()),onClick:t[1]||(t[1]=(...o)=>v.editItem&&v.editItem(...o))},[s("div",pt,[a.item.path?(l(),d("img",{key:0,src:v.getImageUrl(a.item.path),alt:a.item.title,onError:t[0]||(t[0]=(...o)=>v.handleImageError&&v.handleImageError(...o))},null,40,ht)):(l(),d("div",bt,[s("span",wt,c(v.getCategoryIcon()),1)]))]),s("div",St,[s("h3",It,c(a.item.title),1),s("div",_t,[a.item.release?(l(),d("span",kt,[v.isWatchlistItem&&a.item.release?(l(),d("span",{key:0,class:ee(v.getWatchlistReleaseStatusClass())},c(v.getWatchlistReleaseStatus()),3)):(l(),d("span",Ct,c(v.formatDate(a.item.release)),1))])):f("",!0),a.item.rating?(l(),d("span",Tt,c("â˜…".repeat(Math.max(0,Math.min(5,Math.floor(a.item.rating)))))+c("â˜†".repeat(Math.max(0,5-Math.max(0,Math.min(5,Math.floor(a.item.rating)))))),1)):f("",!0)]),a.item.platforms?(l(),d("div",At,c(a.item.platforms),1)):f("",!0),a.item.genre?(l(),d("div",xt,c(a.item.genre),1)):f("",!0),a.item.description?(l(),d("div",Mt,c(a.item.description),1)):f("",!0),a.item.isAiring?(l(),d("div",Rt,[t[2]||(t[2]=s("span",{class:"airing-badge"},[s("span",{class:"airing-dot"}),be(" Airing ")],-1)),a.item.nextSeason?(l(),d("span",Dt,"S"+c(a.item.nextSeason),1)):f("",!0),a.item.nextSeasonRelease?(l(),d("span",Ut,c(v.getNextSeasonCountdown()),1)):f("",!0)])):f("",!0),v.showWatchlistTag?(l(),d("div",Pt,[s("span",{class:ee(["type-tag",v.getTypeTagClass()])},c(v.getTypeTagText()),3)])):f("",!0)]),t[3]||(t[3]=s("div",{class:"edit-indicator"},[s("span",{class:"edit-icon"},"âœï¸")],-1))],6)}const Ft=X(yt,[["render",Et],["__scopeId","data-v-a0d9c4df"]]),Bt={name:"FloatingActionButton",props:{showMenu:{type:Boolean,default:!1},showDeleteAll:{type:Boolean,default:!1},categoryName:{type:String,default:""},itemCount:{type:Number,default:0}},emits:["toggleMenu","addNewItem","bulkAddItems","importFromTxt","importFromAPI","createCollection","deleteAllInCategory"]},Lt={class:"floating-actions"},Nt={class:"menu-text"},Vt={class:"item-count-badge"};function Gt(i,t,a,e,u,v){return l(),d("div",Lt,[s("div",{class:ee(["floating-menu",{show:a.showMenu}])},[s("button",{class:"floating-menu-item",onClick:t[0]||(t[0]=o=>i.$emit("addNewItem"))},[...t[7]||(t[7]=[s("span",{class:"menu-icon"},"âž•",-1),s("span",{class:"menu-text"},"Add Item",-1)])]),s("button",{class:"floating-menu-item",onClick:t[1]||(t[1]=o=>i.$emit("bulkAddItems"))},[...t[8]||(t[8]=[s("span",{class:"menu-icon"},"ðŸ“¦",-1),s("span",{class:"menu-text"},"Bulk Add",-1)])]),s("button",{class:"floating-menu-item",onClick:t[2]||(t[2]=o=>i.$emit("importFromTxt"))},[...t[9]||(t[9]=[s("span",{class:"menu-icon"},"ðŸ“„",-1),s("span",{class:"menu-text"},"Import from TXT",-1)])]),s("button",{class:"floating-menu-item",onClick:t[3]||(t[3]=o=>i.$emit("importFromAPI"))},[...t[10]||(t[10]=[s("span",{class:"menu-icon"},"ðŸŒ",-1),s("span",{class:"menu-text"},"Import from API",-1)])]),s("button",{class:"floating-menu-item",onClick:t[4]||(t[4]=o=>i.$emit("createCollection"))},[...t[11]||(t[11]=[s("span",{class:"menu-icon"},"ðŸ“š",-1),s("span",{class:"menu-text"},"Create Collection",-1)])]),a.showDeleteAll&&a.itemCount>0?(l(),d("button",{key:0,class:"floating-menu-item delete-all-item",onClick:t[5]||(t[5]=o=>i.$emit("deleteAllInCategory"))},[t[12]||(t[12]=s("span",{class:"menu-icon"},"ðŸ—‘ï¸",-1)),s("span",Nt,"Delete All "+c(a.categoryName),1),s("span",Vt,"("+c(a.itemCount)+")",1)])):f("",!0)],2),s("button",{class:"floating-add-btn",onClick:t[6]||(t[6]=o=>i.$emit("toggleMenu"))},c(a.showMenu?"âœ•":"+"),1)])}const zt=X(Bt,[["render",Gt],["__scopeId","data-v-19731834"]]),Ye="http://127.0.0.1:8000/api",Wt={async getConfig(){try{console.log("ðŸ“š Simple Google Books - Getting config...");const i=await fetch(`${Ye}/google-books-config`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);const t=await i.json();return console.log("ðŸ“š Simple Google Books - Config loaded:",t),t}catch(i){throw console.error("ðŸ“š Simple Google Books - Config failed:",i),i}},async searchBooks(i,t=10){try{console.log("ðŸ“š Simple Google Books - Searching:",i);const a=await fetch(`${Ye}/google-books/search?q=${encodeURIComponent(i)}&maxResults=${t}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const e=await a.json();return console.log("ðŸ“š Simple Google Books - Search success:",e),e}catch(a){throw console.error("ðŸ“š Simple Google Books - Search failed:",a),a}}},jt={name:"EditModal",props:{item:{type:Object,default:null},currentCategory:{type:String,default:"watchlist"}},emits:["close","save","delete"],setup(i,{emit:t}){const a=h(!1),e=h(""),u=h([]),v=h(null),o=h(null),w=h(""),r=$e({category:"watchlist",title:"",release:"",apiRating:"",personalRating:"",count:"",platforms:"",genre:"",link:"",path:"",discovered:"",spielzeit:"",isAiring:!1,nextSeason:"",nextSeasonRelease:"",imageUrl:"",watchlistType:"",imageCleared:!1}),S=N(()=>!!i.item),A=N(()=>r.category==="game"),C=N(()=>r.category==="series"),F=N(()=>r.category==="watchlist");Ae(()=>i.item,n=>{n?(Object.keys(r).forEach(y=>{r[y]=n[y]||""}),n.api_rating!==void 0&&(r.apiRating=n.api_rating),n.personal_rating!==void 0&&(r.personalRating=n.personal_rating),n.rating!==void 0&&!r.apiRating&&(r.apiRating=n.rating)):Object.keys(r).forEach(y=>{y==="category"?r[y]=i.currentCategory||"watchlist":y==="release"?r[y]=new Date().toISOString().split("T")[0]:r[y]=""})},{immediate:!0}),Ae(()=>i.currentCategory,n=>{!i.item&&n&&(r.category=n)});const R=async()=>{if(!r.title){e.value="Title is required";return}if(r.category==="watchlist"&&!r.watchlistType){e.value="Please select a type for watchlist items";return}if(r.category==="watchlist"&&!r.release){e.value="Release date is required for watchlist items";return}a.value=!0,e.value="";try{const n={...r};w.value?(n.path=w.value,n.imageUrl=w.value):n.imageUrl&&n.imageUrl.trim()?n.path=n.imageUrl:(n.imageUrl=null,n.path=null),Object.keys(n).forEach(y=>{n[y]===""&&y!=="watchlistType"&&(n[y]=null)}),n.apiRating&&(n.apiRating=parseFloat(n.apiRating)),n.personalRating&&(n.personalRating=parseFloat(n.personalRating)),n.count&&(n.count=parseInt(n.count)),n.spielzeit&&(n.spielzeit=parseInt(n.spielzeit)),n.nextSeason&&(n.nextSeason=parseInt(n.nextSeason)),t("save",n)}catch(n){e.value=n.message||"Failed to save item"}finally{a.value=!1}},q=()=>{e.value="",t("close")},B=()=>{t("delete",i.item),q()},Y=async()=>{if(w.value){u.value=[];return}if(v.value&&clearTimeout(v.value),!r.title||r.title.length<3){u.value=[];return}v.value=setTimeout(async()=>{try{console.log("ðŸ” EditModal API Search:",{title:r.title,category:r.category,watchlistType:r.watchlistType});const n=r.category==="watchlist"?r.watchlistType:r.category;if(r.category==="watchlist"&&!r.watchlistType){u.value=[];return}let y=[],W=[];if(n==="buecher"){console.log("ðŸ“š Searching Google Books API for:",r.title);const p=await Wt.searchBooks(r.title,10);p.success&&p.data?(console.log("ðŸ“š Google Books API Success:",p.data.length,"results"),W=p.data.map(P=>({title:P.title,release:P.publishedDate?Q(P.publishedDate):"",genre:P.categories?P.categories.join(", "):"",platforms:"",link:P.infoLink||P.previewLink||"",imageUrl:P.imageUrl||"",rating:"",apiSource:"google_books",id:P.id,author:P.author,description:P.description,publisher:P.publisher,isbn10:P.isbn10,isbn13:P.isbn13})),console.log("ðŸ“š Formatted Google Books results:",W)):console.warn("ðŸ“š Google Books API failed:",p.error)}else console.log("ðŸŽ¬ Searching Media API for:",r.title,"category:",n),y=await qe.searchApi(r.title,n,10),y&&y.length>0&&(W=y.map(p=>({title:p.title,release:p.release,genre:p.overview||"",platforms:p.platforms||"",link:p.link||"",imageUrl:p.image||"",rating:p.rating||"",apiSource:p.api_source||"",id:p.id||""})));W.length>0?(console.log("âœ… API Search Results:",W.length,"items found"),u.value=W):(console.log("âŒ No API results found"),u.value=[{title:`"${r.title}" - Keine Ergebnisse gefunden`,release:"",genre:"Bitte manuell ausfÃ¼llen",isPlaceholder:!0}])}catch(n){console.error("âŒ API search failed:",n),u.value=[{title:`"${r.title}" - API nicht verfÃ¼gbar`,release:"",genre:"Bitte manuell ausfÃ¼llen",isPlaceholder:!0}]}},500)},Z=async n=>{if(n.isPlaceholder){u.value=[];return}if(console.log("ðŸ“š Selecting API result:",{title:n.title,apiSource:n.apiSource,author:n.author}),r.title=n.title,n.release&&(r.release=n.release),n.platforms&&(r.platforms=n.platforms),n.genre&&(r.genre=n.genre),n.link&&(r.link=n.link),n.rating&&(r.apiRating=n.rating),n.apiSource==="google_books"){if(console.log("ðŸ“š Filling Google Books data:",{author:n.author,description:n.description,publisher:n.publisher,isbn10:n.isbn10,isbn13:n.isbn13}),n.author&&(r.platforms=n.author),n.description){const y=r.genre||"";r.genre=y?`${y} | ${n.description.substring(0,100)}...`:n.description.substring(0,200)}if(n.publisher){const y=r.link||"";r.link=y||`Publisher: ${n.publisher}`}}n.imageUrl?(r.imageUrl=n.imageUrl,r.path=n.imageUrl):(r.imageUrl="",r.path=""),u.value=[]},$=n=>n?new Date(n).toLocaleDateString():"",Q=n=>{if(!n)return"";let y;if(typeof n=="string"){if(/^\d{4}$/.test(n))return`${n}-01-01`;if(/^\d{4}-\d{2}$/.test(n))return`${n}-01`;if(/^\d{4}-\d{2}-\d{2}$/.test(n))return n;y=new Date(n)}else y=new Date(n);return isNaN(y.getTime())?(console.warn("ðŸ“š Invalid date format:",n),""):y.toISOString().split("T")[0]};return{form:r,loading:a,error:e,apiResults:u,isEditing:S,isGame:A,isSeries:C,isWatchlist:F,imageUploadRef:o,uploadedImagePath:w,handleSave:R,closeModal:q,deleteItem:B,searchApi:Y,selectApiResult:Z,formatDate:$,formatDateForInput:Q,ensureHttpsUrl:n=>n&&(n.startsWith("http://")?n.replace("http://","https://"):n),getReleasePreview:()=>{var P;if(!r.release)return"";const n=new Date(r.release),y=new Date;y.setHours(0,0,0,0),n.setHours(0,0,0,0);const W=n.getTime()-y.getTime(),p=Math.ceil(W/(1e3*3600*24));if(p>0)return p===1?"Tomorrow!":p<=7?`${p} days left`:p<=30?`${p} days left`:`${Math.ceil(p/30)} months left`;if(p===0)return"Released today!";{const te=((P=r.watchlistType)==null?void 0:P.toLowerCase())||"media";return te==="game"?"Unplayed yet":te==="series"||te==="movie"?"Unwatched yet":"Unconsumed yet"}},triggerImageUpload:()=>{var n;(n=o.value)==null||n.click()},handleImageUpload:async n=>{const y=n.target.files[0];if(y){if(!y.type.startsWith("image/")){e.value="Please select a valid image file";return}if(y.size>10*1024*1024){e.value="Image file too large. Maximum size is 10MB";return}a.value=!0,e.value="";try{const W=r.title.replace(/[^a-zA-Z0-9\s\-_\.]/g,"").trim()||"item",p=Date.now(),P=y.name.split(".").pop()||"jpg",te=`images_downloads/uploads/${W}_${p}.${P}`,se=await qe.uploadImage(y,te);se.success?(w.value=se.saved,r.path=se.saved,r.imageUrl=se.saved):e.value=se.error||"Failed to upload image"}catch(W){e.value=W.message||"Failed to upload image"}finally{a.value=!1}}},getImagePreviewUrl:()=>w.value?`/storage/${w.value}`:r.imageUrl?r.imageUrl.startsWith("http")?r.imageUrl:`/storage/${r.imageUrl}`:"",handleImageError:n=>{console.warn("Image preview failed:",n.target.src),n.target.style.display="none"},clearImage:()=>{r.imageUrl="",r.path="",w.value="",o.value&&(o.value.value="")},removeUploadedImage:()=>{w.value="",r.imageUrl===w.value&&(r.imageUrl=""),r.path===w.value&&(r.path=""),o.value&&(o.value.value="")}}}},Ot={class:"form-header"},qt={class:"form-group category-group"},Ht={class:"form-group title-group"},Qt={class:"search-container"},Jt=["placeholder","disabled"],Kt={key:0,class:"search-results"},Xt=["onClick"],Yt={class:"result-thumbnail"},Zt=["src","alt"],$t={key:1,class:"no-image"},es={class:"result-content"},ts={class:"result-title"},ss={class:"result-meta"},os={key:0},as={key:1},ns={key:2,class:"rating"},is={class:"form-row"},rs={class:"form-group"},ls={for:"release"},ds={key:0,class:"required"},cs=["required"],us={key:0,class:"field-hint"},ms={key:1,class:"release-preview"},gs={class:"form-group"},fs={class:"form-group"},vs={class:"form-row"},ys={class:"form-group"},ps={class:"form-group"},hs={class:"form-row"},bs={class:"form-group"},ws={class:"form-group"},Ss={key:0,class:"form-row"},Is={class:"form-group"},_s={key:0,class:"field-error"},ks={class:"form-row"},Cs={class:"form-group"},Ts={class:"form-group"},As={key:1,class:"form-row"},xs={class:"form-group"},Ms={key:2,class:"form-row"},Rs={class:"form-group"},Ds={key:0,class:"form-group"},Us={key:3,class:"form-row"},Ps={class:"form-group"},Es={class:"form-row"},Fs={class:"form-group"},Bs={class:"form-group"},Ls={class:"image-upload-container"},Ns=["disabled"],Vs={key:0,class:"upload-success"},Gs={key:4,class:"form-row"},zs={class:"form-group image-preview-group"},Ws={class:"image-preview"},js=["src","alt"],Os={key:5,class:"error-message"},qs={class:"modal-buttons"},Hs=["disabled"],Qs=["disabled"],Js=["disabled"],Ks=["disabled"];function Xs(i,t,a,e,u,v){return l(),d("div",{class:"modal",onClick:t[28]||(t[28]=(...o)=>e.closeModal&&e.closeModal(...o))},[s("div",{class:"modal-content",onClick:t[27]||(t[27]=ae(()=>{},["stop"]))},[s("h2",null,c(e.isEditing?"Edit Item":"Add Item"),1),s("form",{onSubmit:t[26]||(t[26]=ae((...o)=>e.handleSave&&e.handleSave(...o),["prevent"]))},[s("div",Ot,[s("div",qt,[t[30]||(t[30]=s("label",{for:"category"},"Category:",-1)),M(s("select",{id:"category","onUpdate:modelValue":t[0]||(t[0]=o=>e.form.category=o),required:""},[...t[29]||(t[29]=[Oe('<option value="watchlist" data-v-f8ef7c37>Watchlist</option><option value="game" data-v-f8ef7c37>Game</option><option value="series" data-v-f8ef7c37>Series</option><option value="movie" data-v-f8ef7c37>Movie</option><option value="buecher" data-v-f8ef7c37>BÃ¼cher</option>',5)])],512),[[we,e.form.category]])]),s("div",Ht,[t[31]||(t[31]=s("label",{for:"title"},"Title:",-1)),s("div",Qt,[M(s("input",{type:"text",id:"title","onUpdate:modelValue":t[1]||(t[1]=o=>e.form.title=o),onInput:t[2]||(t[2]=(...o)=>e.searchApi&&e.searchApi(...o)),required:"",placeholder:e.isWatchlist?"Enter title (API search + manual input available)":"Enter title",disabled:e.loading},null,40,Jt),[[V,e.form.title]]),e.apiResults.length>0?(l(),d("div",Kt,[(l(!0),d(J,null,K(e.apiResults,o=>(l(),d("div",{key:o.title,class:"search-result-item",onClick:w=>e.selectApiResult(o)},[s("div",Yt,[o.imageUrl?(l(),d("img",{key:0,src:e.ensureHttpsUrl(o.imageUrl),alt:o.title},null,8,Zt)):(l(),d("div",$t,[s("span",null,c(o.title.charAt(0).toUpperCase()),1)]))]),s("div",es,[s("div",ts,c(o.title),1),s("div",ss,[o.release?(l(),d("span",os,c(e.formatDate(o.release)),1)):f("",!0),o.genre?(l(),d("span",as,c(o.genre),1)):f("",!0),o.rating?(l(),d("span",ns,"â­ "+c(o.rating),1)):f("",!0)])])],8,Xt))),128))])):f("",!0)])])]),s("div",is,[s("div",rs,[s("label",ls,[be(c(e.isWatchlist?"Release Date:":"Release:")+" ",1),e.isWatchlist?(l(),d("span",ds,"*")):f("",!0)]),M(s("input",{type:"date",id:"release","onUpdate:modelValue":t[3]||(t[3]=o=>e.form.release=o),required:e.isWatchlist},null,8,cs),[[V,e.form.release]]),e.isWatchlist?(l(),d("div",us," ðŸ“… Set the release date to track countdown or status ")):f("",!0),e.isWatchlist&&e.form.release?(l(),d("div",ms,[t[32]||(t[32]=s("strong",null,"Preview:",-1)),be(" "+c(e.getReleasePreview()),1)])):f("",!0)]),s("div",gs,[t[33]||(t[33]=s("label",{for:"apiRating"},"API Rating:",-1)),M(s("input",{type:"number",id:"apiRating","onUpdate:modelValue":t[4]||(t[4]=o=>e.form.apiRating=o),step:"0.1",min:"0",max:"10",placeholder:"0-10",readonly:""},null,512),[[V,e.form.apiRating]]),t[34]||(t[34]=s("div",{class:"field-hint"},"From API - read only",-1))]),s("div",fs,[t[35]||(t[35]=s("label",{for:"personalRating"},"Personal Rating:",-1)),M(s("input",{type:"number",id:"personalRating","onUpdate:modelValue":t[5]||(t[5]=o=>e.form.personalRating=o),step:"0.1",min:"0",max:"10",placeholder:"0-10"},null,512),[[V,e.form.personalRating]]),t[36]||(t[36]=s("div",{class:"field-hint"},"Your personal rating",-1))])]),s("div",vs,[s("div",ys,[t[37]||(t[37]=s("label",{for:"views"},"Views:",-1)),M(s("input",{type:"number",id:"views","onUpdate:modelValue":t[6]||(t[6]=o=>e.form.count=o),min:"0",placeholder:"0"},null,512),[[V,e.form.count]])]),s("div",ps,[t[38]||(t[38]=s("label",{for:"discovered"},"Discovered:",-1)),M(s("input",{type:"date",id:"discovered","onUpdate:modelValue":t[7]||(t[7]=o=>e.form.discovered=o)},null,512),[[V,e.form.discovered]])])]),s("div",hs,[s("div",bs,[t[39]||(t[39]=s("label",{for:"platforms"},"Platforms:",-1)),M(s("input",{type:"text",id:"platforms","onUpdate:modelValue":t[8]||(t[8]=o=>e.form.platforms=o),placeholder:"PC, PS5, Xbox"},null,512),[[V,e.form.platforms]])]),s("div",ws,[t[40]||(t[40]=s("label",{for:"genre"},"Genre:",-1)),M(s("input",{type:"text",id:"genre","onUpdate:modelValue":t[9]||(t[9]=o=>e.form.genre=o),placeholder:"Action, Adventure, RPG"},null,512),[[V,e.form.genre]])])]),e.form.category==="watchlist"?(l(),d("div",Ss,[s("div",Is,[t[42]||(t[42]=s("label",{for:"watchlistType"},[be("Type: "),s("span",{class:"required"},"*")],-1)),M(s("select",{id:"watchlistType","onUpdate:modelValue":t[10]||(t[10]=o=>e.form.watchlistType=o)},[...t[41]||(t[41]=[Oe('<option value="" data-v-f8ef7c37>Select Type</option><option value="game" data-v-f8ef7c37>Game</option><option value="series" data-v-f8ef7c37>Series</option><option value="movie" data-v-f8ef7c37>Movie</option><option value="buecher" data-v-f8ef7c37>BÃ¼cher</option>',5)])],512),[[we,e.form.watchlistType]]),e.form.category==="watchlist"&&!e.form.watchlistType?(l(),d("div",_s," Please select a type for watchlist items ")):f("",!0)])])):f("",!0),s("div",ks,[s("div",Cs,[t[43]||(t[43]=s("label",{for:"link"},"Link:",-1)),M(s("input",{type:"url",id:"link","onUpdate:modelValue":t[11]||(t[11]=o=>e.form.link=o),placeholder:"https://..."},null,512),[[V,e.form.link]])]),s("div",Ts,[t[44]||(t[44]=s("label",{for:"path"},"Image Path:",-1)),M(s("input",{type:"text",id:"path","onUpdate:modelValue":t[12]||(t[12]=o=>e.form.path=o),placeholder:"images/movies/filename.jpg"},null,512),[[V,e.form.path]])])]),e.isGame?(l(),d("div",As,[s("div",xs,[t[45]||(t[45]=s("label",{for:"playtime"},"Playtime (Minutes):",-1)),M(s("input",{type:"number",id:"playtime","onUpdate:modelValue":t[13]||(t[13]=o=>e.form.spielzeit=o),min:"0",placeholder:"0"},null,512),[[V,e.form.spielzeit]])])])):f("",!0),e.isSeries?(l(),d("div",Ms,[s("div",Rs,[t[47]||(t[47]=s("label",{for:"isAiring"},"Status:",-1)),M(s("select",{id:"isAiring","onUpdate:modelValue":t[14]||(t[14]=o=>e.form.isAiring=o)},[...t[46]||(t[46]=[s("option",{value:!1},"Finished",-1),s("option",{value:!0},"Airing",-1)])],512),[[we,e.form.isAiring]])]),e.form.isAiring?(l(),d("div",Ds,[t[48]||(t[48]=s("label",{for:"nextSeason"},"Next Season:",-1)),M(s("input",{type:"number",id:"nextSeason","onUpdate:modelValue":t[15]||(t[15]=o=>e.form.nextSeason=o),min:"1",placeholder:"1"},null,512),[[V,e.form.nextSeason]])])):f("",!0)])):f("",!0),e.form.isAiring?(l(),d("div",Us,[s("div",Ps,[t[49]||(t[49]=s("label",{for:"nextSeasonRelease"},"Next Season Release:",-1)),M(s("input",{type:"date",id:"nextSeasonRelease","onUpdate:modelValue":t[16]||(t[16]=o=>e.form.nextSeasonRelease=o)},null,512),[[V,e.form.nextSeasonRelease]])])])):f("",!0),s("div",Es,[s("div",Fs,[t[50]||(t[50]=s("label",{for:"imageUrl"},"Image URL (optional):",-1)),M(s("input",{type:"text",id:"imageUrl","onUpdate:modelValue":t[17]||(t[17]=o=>e.form.imageUrl=o),placeholder:"https://... or leave empty for API images"},null,512),[[V,e.form.imageUrl]])]),s("div",Bs,[t[51]||(t[51]=s("label",{for:"imageUpload"},"Upload Image:",-1)),s("div",Ls,[s("input",{type:"file",id:"imageUpload",ref:"imageUploadRef",onChange:t[18]||(t[18]=(...o)=>e.handleImageUpload&&e.handleImageUpload(...o)),accept:"image/*",style:{display:"none"}},null,544),s("button",{type:"button",onClick:t[19]||(t[19]=(...o)=>e.triggerImageUpload&&e.triggerImageUpload(...o)),class:"upload-btn",disabled:e.loading}," ðŸ“ Choose Image ",8,Ns),e.uploadedImagePath?(l(),d("div",Vs,[be(" âœ… Image uploaded: "+c(e.uploadedImagePath)+" ",1),s("button",{type:"button",onClick:t[20]||(t[20]=(...o)=>e.removeUploadedImage&&e.removeUploadedImage(...o)),class:"remove-uploaded-btn",title:"Remove uploaded image to enable API search"}," âœ• Remove ")])):f("",!0)])])]),e.form.imageUrl||e.uploadedImagePath?(l(),d("div",Gs,[s("div",zs,[t[52]||(t[52]=s("label",null,"Image Preview:",-1)),s("div",Ws,[s("img",{src:e.getImagePreviewUrl(),alt:e.form.title,onError:t[21]||(t[21]=(...o)=>e.handleImageError&&e.handleImageError(...o))},null,40,js),s("button",{type:"button",onClick:t[22]||(t[22]=(...o)=>e.clearImage&&e.clearImage(...o)),class:"clear-image-btn",title:"Remove image"}," âœ• ")])])])):f("",!0),e.error?(l(),d("div",Os,c(e.error),1)):f("",!0),s("div",qs,[s("button",{type:"submit",disabled:e.loading},c(e.loading?"Saving...":"Save"),9,Hs),s("button",{type:"button",onClick:t[23]||(t[23]=(...o)=>e.closeModal&&e.closeModal(...o)),disabled:e.loading}," Cancel ",8,Qs),e.isEditing?(l(),d("button",{key:0,type:"button",onClick:t[24]||(t[24]=(...o)=>e.deleteItem&&e.deleteItem(...o)),disabled:e.loading,class:"delete-btn"}," Delete ",8,Js)):f("",!0),s("button",{type:"button",onClick:t[25]||(t[25]=(...o)=>e.handleSave&&e.handleSave(...o)),disabled:e.loading,class:"check-btn",title:"Add to list"}," âœ“ ",8,Ks)])],32)])])}const Ys=X(jt,[["render",Xs],["__scopeId","data-v-f8ef7c37"]]),Zs={name:"BulkAddModal",props:{show:{type:Boolean,default:!1},currentCategory:{type:String,default:""}},emits:["close"],setup(i,{emit:t}){const a=Qe(),e=h(1),u=h(!1),v=h(!0),o=h(0),w=h(0),r=h(0),S=h(0),A=h(null),C=h(""),F=h(""),R=h([]),q=h([]),B=h({category:"",itemsText:"",defaultRating:null}),Y=N(()=>B.value.category&&B.value.itemsText.trim()&&!u.value),Z=N(()=>{const D=$().length;return D>0?Math.round(o.value/D*100):0}),$=()=>!B.value.itemsText||!B.value.itemsText.trim()?[]:B.value.itemsText.split(`
`).map(D=>D.trim()).filter(D=>D.length>0).map(D=>{const U=D.split("|").map(n=>n.trim());return{searchTerm:U[0]||"",additionalInfo:U[1]||null}}),Q=()=>{o.value=0,w.value=0,r.value=0,S.value=0,A.value=null,C.value="",F.value="",R.value=[],q.value=[]},g=(D,U,n)=>{A.value=D,C.value=U,F.value=n},L=(D,U,n="")=>{const y={searching:"Searching...",found:"Found",adding:"Adding...",added:"Added",skipped:"Skipped",error:"Error"}[U]||U;R.value.push({title:D,status:U,statusText:y,message:n})},ce=async()=>{if(!Y.value)return;e.value=2,u.value=!0,v.value=!0,Q();const D=$();try{for(let U=0;U<D.length;U++){const n=D[U];o.value=U+1,g({title:n.searchTerm,description:n.additionalInfo},"searching","Searching...");try{L(n.searchTerm,"searching","Searching API..."),console.log(`ðŸ” Searching for: "${n.searchTerm}" in category: ${B.value.category}`);const y=await qe.searchApi(n.searchTerm,B.value.category,1);if(console.log(`ðŸ” Search results for "${n.searchTerm}":`,y),y&&y.length>0&&y[0]&&y[0].api_source&&y[0].image){const p=y[0];console.log(`âœ… Found real API data for "${n.searchTerm}":`,{title:p.title,api_source:p.api_source,has_image:!!p.image,has_genre:!!p.genre,has_release:!!p.release}),g({title:p.title,description:`Found: ${p.genre||"Unknown genre"} â€¢ ${p.release||"Unknown year"} â€¢ ${p.api_source}`},"found","Found in API with data"),L(n.searchTerm,"found",`Found: ${p.title} (${p.api_source})`),g({title:p.title},"adding","Adding to library...");const P={title:p.title,category:B.value.category,release:p.release||null,rating:p.rating?Math.round(p.rating):B.value.defaultRating||null,platforms:p.platforms||null,genre:p.genre||null,link:p.link||null,path:p.image||null,external_id:p.id||null,count:1,is_airing:!1,spielzeit:0,description:n.additionalInfo||null};await a.addMediaItem(P),w.value++,g({title:p.title},"added","Successfully added with API data"),L(n.searchTerm,"added",`Added: ${p.title} with API data`)}else console.log(`âŒ No real API data found for "${n.searchTerm}"`),g({title:n.searchTerm},"skipped","No API data found - will retry"),q.value.push({searchTerm:n.searchTerm,additionalInfo:n.additionalInfo}),r.value++,L(n.searchTerm,"skipped","No API data found - ready for retry")}catch(y){console.error(`Error processing "${n.searchTerm}":`,y),g({title:n.searchTerm},"error","Error occurred"),S.value++,L(n.searchTerm,"error",y.message||"Unknown error")}await new Promise(y=>setTimeout(y,500))}e.value=3,g(null,"","")}catch(U){console.error("Bulk processing error:",U),S.value++}finally{u.value=!1,v.value=!1}},O=()=>{u.value=!1,v.value=!1,e.value=1,Q()},ue=()=>{const D=q.value.map(U=>U.additionalInfo?`${U.searchTerm} | ${U.additionalInfo}`:U.searchTerm).join(`
`);B.value.itemsText=D,o.value=0,w.value=0,S.value=0,A.value=null,C.value="",F.value="",R.value=[],e.value=1},ne=()=>{e.value=1,u.value=!1,v.value=!0,Q(),B.value={category:"",itemsText:"",defaultRating:null},t("close")};return Ae(()=>i.show,D=>{D&&i.currentCategory?B.value.category=i.currentCategory:D||ne()}),{currentStep:e,isProcessing:u,canCancel:v,processedCount:o,addedCount:w,skippedCount:r,errorCount:S,currentItem:A,currentItemStatus:C,currentItemStatusText:F,processingResults:R,skippedItems:q,bulkData:B,canStart:Y,progressPercentage:Z,startProcessing:ce,cancelProcessing:O,retrySkippedItems:ue,closeModal:ne}}},$s={class:"modal-header"},eo={class:"modal-body"},to={key:0,class:"step-container"},so={class:"bulk-add-form"},oo={class:"form-group"},ao={class:"form-group"},no={class:"form-group"},io={key:1,class:"step-container"},ro={class:"processing-container"},lo={class:"progress-overview"},co={class:"progress-stats"},uo={class:"stat"},mo={class:"stat-number"},go={class:"stat"},fo={class:"stat-number"},vo={class:"stat"},yo={class:"stat-number"},po={class:"stat"},ho={class:"stat-number"},bo={class:"progress-bar"},wo={class:"progress-text"},So={class:"current-item"},Io={class:"current-item-header"},_o={class:"current-item-title"},ko={key:0,class:"current-item-description"},Co={key:1,class:"api-data-indicator"},To={key:2,class:"no-api-indicator"},Ao={class:"results-list"},xo={class:"result-header"},Mo={class:"result-title"},Ro={class:"result-status"},Do={key:0,class:"result-message"},Uo={key:2,class:"step-container"},Po={class:"results-summary"},Eo={class:"summary-stats"},Fo={class:"summary-stat success"},Bo={class:"stat-number"},Lo={class:"summary-stat warning"},No={class:"stat-number"},Vo={class:"summary-stat error"},Go={class:"stat-number"},zo={key:0,class:"retry-section"},Wo={class:"retry-list"},jo=["onUpdate:modelValue"],Oo={key:0,class:"retry-additional"},qo={key:1,class:"detailed-results"},Ho={class:"results-list"},Qo={class:"result-header"},Jo={class:"result-title"},Ko={class:"result-status"},Xo={key:0,class:"result-message"},Yo={class:"modal-footer"},Zo=["disabled"],$o=["disabled"],ea={key:3,class:"footer-buttons"};function ta(i,t,a,e,u,v){var o,w;return a.show?(l(),d("div",{key:0,class:"modal-overlay",onClick:t[10]||(t[10]=(...r)=>e.closeModal&&e.closeModal(...r))},[s("div",{class:"modal-content",onClick:t[9]||(t[9]=ae(()=>{},["stop"]))},[s("div",$s,[t[11]||(t[11]=s("h2",null,"Bulk Add Items",-1)),s("button",{class:"close-btn",onClick:t[0]||(t[0]=(...r)=>e.closeModal&&e.closeModal(...r))},"âœ•")]),s("div",eo,[e.currentStep===1?(l(),d("div",to,[t[17]||(t[17]=s("div",{class:"step-header"},[s("div",{class:"step-number"},"1"),s("h3",null,"Enter Your List")],-1)),s("div",so,[s("div",oo,[t[13]||(t[13]=s("label",{for:"category"},"Category *",-1)),M(s("select",{id:"category","onUpdate:modelValue":t[1]||(t[1]=r=>e.bulkData.category=r),required:""},[...t[12]||(t[12]=[Oe('<option value="" data-v-45e8999c>Select Category</option><option value="game" data-v-45e8999c>Game</option><option value="series" data-v-45e8999c>Series</option><option value="movie" data-v-45e8999c>Movie</option><option value="buecher" data-v-45e8999c>BÃ¼cher</option><option value="watchlist" data-v-45e8999c>Watchlist</option>',6)])],512),[[we,e.bulkData.category]])]),s("div",ao,[t[14]||(t[14]=s("label",{for:"items-text"},"Items (one per line) *",-1)),M(s("textarea",{id:"items-text","onUpdate:modelValue":t[2]||(t[2]=r=>e.bulkData.itemsText=r),placeholder:`Enter items one per line, for example:
The Witcher 3
Cyberpunk 2077
Red Dead Redemption 2`,rows:"10",required:""},null,512),[[V,e.bulkData.itemsText]]),t[15]||(t[15]=s("small",{class:"help-text"},"Enter one item per line. The system will automatically search and add each item individually.",-1))]),s("div",no,[t[16]||(t[16]=s("label",{for:"default-rating"},"Default Rating",-1)),M(s("input",{id:"default-rating","onUpdate:modelValue":t[3]||(t[3]=r=>e.bulkData.defaultRating=r),type:"number",min:"0",max:"10",step:"0.1",placeholder:"Optional rating for all items"},null,512),[[V,e.bulkData.defaultRating,void 0,{number:!0}]])])])])):f("",!0),e.currentStep===2?(l(),d("div",io,[t[22]||(t[22]=s("div",{class:"step-header"},[s("div",{class:"step-number"},"2"),s("h3",null,"Processing Items")],-1)),s("div",ro,[s("div",lo,[s("div",co,[s("span",uo,[s("span",mo,c(e.processedCount),1),t[18]||(t[18]=s("span",{class:"stat-label"},"Processed",-1))]),s("span",go,[s("span",fo,c(e.addedCount),1),t[19]||(t[19]=s("span",{class:"stat-label"},"Added",-1))]),s("span",vo,[s("span",yo,c(e.skippedCount),1),t[20]||(t[20]=s("span",{class:"stat-label"},"Skipped",-1))]),s("span",po,[s("span",ho,c(e.errorCount),1),t[21]||(t[21]=s("span",{class:"stat-label"},"Errors",-1))])]),s("div",bo,[s("div",{class:"progress-fill",style:de({width:e.progressPercentage+"%"})},null,4)]),s("div",wo,c(e.progressPercentage)+"% Complete",1)]),s("div",So,[s("div",Io,[s("span",_o,"Processing: "+c(((o=e.currentItem)==null?void 0:o.title)||"..."),1),s("span",{class:ee(["current-item-status",e.currentItemStatus])},c(e.currentItemStatusText),3)]),(w=e.currentItem)!=null&&w.description?(l(),d("div",ko,c(e.currentItem.description),1)):f("",!0),e.currentItemStatus==="found"?(l(),d("div",Co," âœ… Real API data found with image and metadata ")):f("",!0),e.currentItemStatus==="skipped"?(l(),d("div",To," âŒ No API data found - will be retried ")):f("",!0)]),s("div",Ao,[(l(!0),d(J,null,K(e.processingResults,(r,S)=>(l(),d("div",{key:S,class:ee(["result-item",r.status])},[s("div",xo,[s("span",Mo,c(r.title),1),s("span",Ro,c(r.statusText),1)]),r.message?(l(),d("div",Do,c(r.message),1)):f("",!0)],2))),128))])])])):f("",!0),e.currentStep===3?(l(),d("div",Uo,[t[29]||(t[29]=s("div",{class:"step-header"},[s("div",{class:"step-number"},"3"),s("h3",null,"Results")],-1)),s("div",Po,[s("div",Eo,[s("div",Fo,[s("span",Bo,c(e.addedCount),1),t[23]||(t[23]=s("span",{class:"stat-label"},"Successfully Added",-1))]),s("div",Lo,[s("span",No,c(e.skippedCount),1),t[24]||(t[24]=s("span",{class:"stat-label"},"Not Found (Ready for Retry)",-1))]),s("div",Vo,[s("span",Go,c(e.errorCount),1),t[25]||(t[25]=s("span",{class:"stat-label"},"Errors",-1))])]),e.skippedItems.length>0?(l(),d("div",zo,[t[26]||(t[26]=s("h4",null,"Items Not Found - Ready for Retry",-1)),t[27]||(t[27]=s("p",{class:"retry-description"}," The following items were not found in the API. You can edit them and try again: ",-1)),s("div",Wo,[(l(!0),d(J,null,K(e.skippedItems,(r,S)=>(l(),d("div",{key:S,class:"retry-item"},[M(s("input",{"onUpdate:modelValue":A=>r.searchTerm=A,class:"retry-input",placeholder:"Edit search term..."},null,8,jo),[[V,r.searchTerm]]),r.additionalInfo?(l(),d("span",Oo," | "+c(r.additionalInfo),1)):f("",!0)]))),128))])])):f("",!0),e.processingResults.length>0?(l(),d("div",qo,[t[28]||(t[28]=s("h4",null,"Detailed Results",-1)),s("div",Ho,[(l(!0),d(J,null,K(e.processingResults,(r,S)=>(l(),d("div",{key:S,class:ee(["result-item",r.status])},[s("div",Qo,[s("span",Jo,c(r.title),1),s("span",Ko,c(r.statusText),1)]),r.message?(l(),d("div",Xo,c(r.message),1)):f("",!0)],2))),128))])])):f("",!0)])])):f("",!0)]),s("div",Yo,[e.currentStep===1?(l(),d("button",{key:0,class:"btn btn-secondary",onClick:t[4]||(t[4]=(...r)=>e.closeModal&&e.closeModal(...r))}," Cancel ")):f("",!0),e.currentStep===1?(l(),d("button",{key:1,class:"btn btn-primary",onClick:t[5]||(t[5]=(...r)=>e.startProcessing&&e.startProcessing(...r)),disabled:!e.canStart}," Check All and Add ",8,Zo)):f("",!0),e.currentStep===2?(l(),d("button",{key:2,class:"btn btn-secondary",onClick:t[6]||(t[6]=(...r)=>e.cancelProcessing&&e.cancelProcessing(...r)),disabled:!e.canCancel}," Cancel ",8,$o)):f("",!0),e.currentStep===3?(l(),d("div",ea,[e.skippedItems.length>0?(l(),d("button",{key:0,class:"btn btn-warning",onClick:t[7]||(t[7]=(...r)=>e.retrySkippedItems&&e.retrySkippedItems(...r))}," Retry "+c(e.skippedItems.length)+" Items ",1)):f("",!0),s("button",{class:"btn btn-primary",onClick:t[8]||(t[8]=(...r)=>e.closeModal&&e.closeModal(...r))}," Done ")])):f("",!0)])])])):f("",!0)}const sa=X(Zs,[["render",ta],["__scopeId","data-v-45e8999c"]]),oa={name:"TxtImportModal",props:{show:{type:Boolean,default:!1}},emits:["close","fileProcessed"],methods:{handleFileUpload(i){const t=i.target.files[0];if(!t)return;if(!t.name.toLowerCase().endsWith(".txt")){alert("Bitte wÃ¤hlen Sie eine .txt Datei aus.");return}const a=new FileReader;a.onload=e=>{const u=e.target.result;this.$emit("fileProcessed",u)},a.readAsText(t,"UTF-8")}}},aa={class:"file-upload-area"},na={class:"modal-buttons"};function ia(i,t,a,e,u,v){return a.show?(l(),d("div",{key:0,class:"modal",onClick:t[3]||(t[3]=o=>i.$emit("close"))},[s("div",{class:"modal-content",onClick:t[2]||(t[2]=ae(()=>{},["stop"]))},[t[5]||(t[5]=s("h2",null,"ðŸ“„ Import from TXT File",-1)),t[6]||(t[6]=s("p",null,"WÃ¤hlen Sie eine .txt Datei mit einer Liste von Titeln aus, um zu prÃ¼fen, welche Items in der aktuellen Kategorie fehlen.",-1)),s("div",aa,[s("input",{type:"file",id:"txtFileInput",accept:".txt",onChange:t[0]||(t[0]=(...o)=>v.handleFileUpload&&v.handleFileUpload(...o)),style:{display:"none"}},null,32),t[4]||(t[4]=s("label",{for:"txtFileInput",class:"file-upload-label"},[s("span",{class:"upload-icon"},"ðŸ“"),s("span",{class:"upload-text"},"TXT-Datei auswÃ¤hlen"),s("span",{class:"upload-hint"},"Eine .txt Datei mit einer Liste von Titeln")],-1))]),s("div",na,[s("button",{type:"button",onClick:t[1]||(t[1]=o=>i.$emit("close"))}," Cancel ")])])])):f("",!0)}const ra=X(oa,[["render",ia],["__scopeId","data-v-d761bd17"]]),la={name:"TxtImportResultsModal",props:{show:{type:Boolean,default:!1},results:{type:Object,default:null}},emits:["close"]},da={class:"results-summary"},ca={class:"summary-item"},ua={class:"summary-value"},ma={class:"summary-item"},ga={class:"summary-value"},fa={class:"summary-item"},va={class:"summary-value existing"},ya={class:"summary-item"},pa={class:"summary-value missing"},ha={key:0,class:"missing-items"},ba={class:"items-list"},wa={key:1,class:"existing-items"},Sa={class:"items-list"},Ia={class:"modal-buttons"};function _a(i,t,a,e,u,v){return a.show&&a.results?(l(),d("div",{key:0,class:"modal",onClick:t[2]||(t[2]=o=>i.$emit("close"))},[s("div",{class:"modal-content results-modal",onClick:t[1]||(t[1]=ae(()=>{},["stop"]))},[t[7]||(t[7]=s("h2",null,"ðŸ“Š TXT Import Ergebnisse",-1)),s("div",da,[s("div",ca,[t[3]||(t[3]=s("span",{class:"summary-label"},"Kategorie:",-1)),s("span",ua,c(a.results.categoryName),1)]),s("div",ma,[t[4]||(t[4]=s("span",{class:"summary-label"},"Titel in Datei:",-1)),s("span",ga,c(a.results.totalInFile),1)]),s("div",fa,[t[5]||(t[5]=s("span",{class:"summary-label"},"Bereits vorhanden:",-1)),s("span",va,c(a.results.existingItems.length),1)]),s("div",ya,[t[6]||(t[6]=s("span",{class:"summary-label"},"Fehlende Titel:",-1)),s("span",pa,c(a.results.missingItems.length),1)])]),a.results.missingItems.length>0?(l(),d("div",ha,[s("h3",null,"âŒ Fehlende Titel ("+c(a.results.missingItems.length)+"):",1),s("div",ba,[(l(!0),d(J,null,K(a.results.missingItems,(o,w)=>(l(),d("div",{key:w,class:"missing-item"},c(o),1))),128))])])):f("",!0),a.results.existingItems.length>0?(l(),d("div",wa,[s("h3",null,"âœ… Bereits vorhanden ("+c(a.results.existingItems.length)+"):",1),s("div",Sa,[(l(!0),d(J,null,K(a.results.existingItems,(o,w)=>(l(),d("div",{key:w,class:"existing-item"},c(o),1))),128))])])):f("",!0),s("div",Ia,[s("button",{type:"button",onClick:t[0]||(t[0]=o=>i.$emit("close"))}," SchlieÃŸen ")])])])):f("",!0)}const ka=X(la,[["render",_a],["__scopeId","data-v-ec385b83"]]),Ca={name:"SimpleAddItem",setup(){const i=h(!1),t=h(null),a=$e({title:"Test Game",category:"game",release:"2003-01-01",count:1});return{form:a,loading:i,result:t,addItem:async()=>{i.value=!0,t.value=null;try{const u=window.location.origin,v=await fetch(`${u}/api/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:"admin@example.com",password:"admin123"})});if(!v.ok)throw new Error("Login failed");const w=(await v.json()).token,S=await(await fetch(`${u}/api/media`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${w}`},body:JSON.stringify(a)})).json();S.success?t.value={success:!0,message:`Success! Item added with ID: ${S.data.id}`}:t.value={success:!1,message:`Error: ${JSON.stringify(S)}`}}catch(u){t.value={success:!1,message:`Error: ${u.message}`}}finally{i.value=!1}}}}},Ta={class:"simple-add-item"},Aa=["disabled"];function xa(i,t,a,e,u,v){return l(),d("div",Ta,[t[10]||(t[10]=s("h3",null,"Simple Add Item Test",-1)),s("form",{onSubmit:t[4]||(t[4]=ae((...o)=>e.addItem&&e.addItem(...o),["prevent"]))},[s("div",null,[t[5]||(t[5]=s("label",null,"Title:",-1)),M(s("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>e.form.title=o),type:"text",required:""},null,512),[[V,e.form.title]])]),s("div",null,[t[7]||(t[7]=s("label",null,"Category:",-1)),M(s("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>e.form.category=o)},[...t[6]||(t[6]=[s("option",{value:"game"},"Game",-1),s("option",{value:"movie"},"Movie",-1),s("option",{value:"series"},"Series",-1)])],512),[[we,e.form.category]])]),s("div",null,[t[8]||(t[8]=s("label",null,"Release:",-1)),M(s("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>e.form.release=o),type:"date"},null,512),[[V,e.form.release]])]),s("div",null,[t[9]||(t[9]=s("label",null,"Count:",-1)),M(s("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>e.form.count=o),type:"number",min:"0"},null,512),[[V,e.form.count]])]),s("button",{type:"submit",disabled:e.loading},c(e.loading?"Adding...":"Add Item"),9,Aa)],32),e.result?(l(),d("div",{key:0,class:ee(["result",e.result.success?"success":"error"])},c(e.result.message),3)):f("",!0)])}const Ma=X(Ca,[["render",xa],["__scopeId","data-v-642b91e0"]]),Ra={name:"LoadingSpinner",props:{loading:{type:Boolean,default:!0},message:{type:String,default:"Loading..."}}},Da={key:0,class:"loading-spinner"},Ua={key:0};function Pa(i,t,a,e,u,v){return a.loading?(l(),d("div",Da,[t[0]||(t[0]=s("div",{class:"spinner"},null,-1)),a.message?(l(),d("p",Ua,c(a.message),1)):f("",!0)])):f("",!0)}const Ea=X(Ra,[["render",Pa],["__scopeId","data-v-4221b645"]]),Fa={name:"MessageBox",props:{show:{type:Boolean,default:!1},type:{type:String,default:"info",validator:i=>["success","error","warning","info"].includes(i)},title:{type:String,default:""},message:{type:String,required:!0},details:{type:String,default:""}},emits:["close"],setup(i,{emit:t}){const a=()=>{t("close")},e=N(()=>{switch(i.type){case"success":return"âœ…";case"error":return"âŒ";case"warning":return"âš ï¸";case"info":return"â„¹ï¸";default:return"â„¹ï¸"}}),u=N(()=>`message-${i.type}`);return{closeMessage:a,icon:e,messageType:u}}},Ba={class:"message-header"},La={class:"message-icon"},Na={class:"message-title"},Va={class:"message-body"},Ga={key:0,class:"message-details"},za={class:"message-footer"};function Wa(i,t,a,e,u,v){return a.show?(l(),d("div",{key:0,class:"message-overlay",onClick:t[3]||(t[3]=(...o)=>e.closeMessage&&e.closeMessage(...o))},[s("div",{class:ee(["message-box",e.messageType]),onClick:t[2]||(t[2]=ae(()=>{},["stop"]))},[s("div",Ba,[s("span",La,c(e.icon),1),s("h3",Na,c(a.title),1),s("button",{class:"close-btn",onClick:t[0]||(t[0]=(...o)=>e.closeMessage&&e.closeMessage(...o))},"âœ•")]),s("div",Va,[s("p",null,c(a.message),1),a.details?(l(),d("div",Ga,[s("pre",null,c(a.details),1)])):f("",!0)]),s("div",za,[s("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=(...o)=>e.closeMessage&&e.closeMessage(...o))},"OK")])],2)])):f("",!0)}const ja=X(Fa,[["render",Wa],["__scopeId","data-v-8d49f52b"]]),Oa={name:"ConfirmDialog",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm Action"},message:{type:String,required:!0}},emits:["confirm","close"],setup(i,{emit:t}){const a=()=>{t("close")};return{closeDialog:a,confirmAction:()=>{t("confirm"),a()}}}},qa={class:"confirm-header"},Ha={class:"confirm-title"},Qa={class:"confirm-body"},Ja={class:"confirm-footer"};function Ka(i,t,a,e,u,v){return a.show?(l(),d("div",{key:0,class:"confirm-overlay",onClick:t[4]||(t[4]=(...o)=>e.closeDialog&&e.closeDialog(...o))},[s("div",{class:"confirm-dialog",onClick:t[3]||(t[3]=ae(()=>{},["stop"]))},[s("div",qa,[s("h3",Ha,c(a.title),1),s("button",{class:"close-btn",onClick:t[0]||(t[0]=(...o)=>e.closeDialog&&e.closeDialog(...o))},"âœ•")]),s("div",Qa,[s("p",null,c(a.message),1)]),s("div",Ja,[s("button",{class:"btn btn-secondary",onClick:t[1]||(t[1]=(...o)=>e.closeDialog&&e.closeDialog(...o))},"Cancel"),s("button",{class:"btn btn-danger",onClick:t[2]||(t[2]=(...o)=>e.confirmAction&&e.confirmAction(...o))},"Confirm")])])])):f("",!0)}const Xa=X(Oa,[["render",Ka],["__scopeId","data-v-4e196e5e"]]),Ya={name:"InputDialog",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Input Required"},message:{type:String,required:!0},placeholder:{type:String,default:""},inputType:{type:String,default:"text"},defaultValue:{type:String,default:""}},emits:["confirm","close"],setup(i,{emit:t}){const a=h(""),e=h(null),u=()=>{t("close")},v=()=>{t("confirm",a.value),u()};return Ae(()=>i.show,async o=>{o&&(a.value=i.defaultValue,await lt(),e.value&&(e.value.focus(),e.value.select()))}),{inputValue:a,inputRef:e,closeDialog:u,confirmAction:v}}},Za={class:"input-header"},$a={class:"input-title"},en={class:"input-body"},tn={class:"input-message"},sn=["type","placeholder"],on={class:"input-footer"};function an(i,t,a,e,u,v){return a.show?(l(),d("div",{key:0,class:"input-overlay",onClick:t[6]||(t[6]=(...o)=>e.closeDialog&&e.closeDialog(...o))},[s("div",{class:"input-dialog",onClick:t[5]||(t[5]=ae(()=>{},["stop"]))},[s("div",Za,[s("h3",$a,c(a.title),1),s("button",{class:"close-btn",onClick:t[0]||(t[0]=(...o)=>e.closeDialog&&e.closeDialog(...o))},"âœ•")]),s("div",en,[s("p",tn,c(a.message),1),M(s("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>e.inputValue=o),type:a.inputType,placeholder:a.placeholder,class:"input-field",onKeyup:t[2]||(t[2]=rt((...o)=>e.confirmAction&&e.confirmAction(...o),["enter"])),ref:"inputRef"},null,40,sn),[[it,e.inputValue]])]),s("div",on,[s("button",{class:"btn btn-secondary",onClick:t[3]||(t[3]=(...o)=>e.closeDialog&&e.closeDialog(...o))},"Cancel"),s("button",{class:"btn btn-primary",onClick:t[4]||(t[4]=(...o)=>e.confirmAction&&e.confirmAction(...o))},"OK")])])])):f("",!0)}const nn=X(Ya,[["render",an],["__scopeId","data-v-3713e615"]]),rn={name:"MediaLibrary",components:{MediaItem:Ft,Sidebar:ut,MainHeader:ft,FloatingActionButton:zt,LoginModal:gt,RegisterModal:mt,EditModal:Ys,BulkAddModal:sa,TxtImportModal:ra,TxtImportResultsModal:ka,SimpleAddItem:Ma,LoadingSpinner:Ea,MessageBox:ja,ConfirmDialog:Xa,InputDialog:nn},setup(){const i=Qe(),t=tt(),a=st(),e=ot(),u=Ze(),v=et(),o=h(!1),w=h(null),{showLoginModal:r,showRegisterModal:S,showEditModal:A,showFloatingMenu:C,showBulkAddModal:F,showTxtImportModal:R,showTxtImportResults:q,editingItem:B,gridColumns:Y,sortBy:Z,categories:$,txtImportResults:Q,isLoggedIn:g,isAdmin:L,userName:ce,currentCategory:O,searchQuery:ue,categoryCounts:ne,loading:D,error:U,paginatedMedia:n,platforms:y,genres:W,setCategory:p,clearSearch:P,togglePlatformFilter:te,toggleGenreFilter:se,toggleAiringFilter:xe,editItem:Me,closeEditModal:Re,closeBulkAddModal:Se,handleBulkAddItems:De,handleSaveItem:Ue,handleDeleteItem:Pe,logout:Ee,loadMedia:ie,toggleFloatingMenu:fe,addNewItem:Ie,bulkAddItems:Fe,importFromTxt:Be,importFromAPI:Le,createCollection:Ne,exportMediaCollection:Ve,exportAsCSV:ve,exportAsJSON:Ge,downloadFile:ze,deleteAllInCategory:We,getCategoryDisplayName:me,navigateToCalendar:_e,navigateToProfile:ke,processTxtContent:ye,closeTxtImportResults:Je,cleanup:Ke,router:je}=vt(),Xe=N(()=>{try{return me?me(O.value):O.value}catch(k){return console.error("Error getting category display name:",k),O.value||"Unknown"}}),m=N(()=>{const k=i.mediaData||[],G={totalItems:k.length,totalCollections:0,totalPlaytime:0,avgRating:0,categoryDistribution:{},ratingDistribution:{},platformDistribution:{},genreDistribution:{},recentActivity:[],airingSeries:[]};let Ce=0,pe=0;return k.forEach(T=>{const Te=T.category||"unknown";if(G.categoryDistribution[Te]=(G.categoryDistribution[Te]||0)+1,T.rating&&T.rating>0){const ge=Math.floor(T.rating);G.ratingDistribution[ge]=(G.ratingDistribution[ge]||0)+1,Ce+=T.rating,pe++}if(T.platforms&&T.category==="game"&&T.platforms.split(",").map(j=>j.trim()).filter(j=>j).forEach(j=>{G.platformDistribution[j]=(G.platformDistribution[j]||0)+1}),T.genre&&(T.category==="series"||T.category==="movie")&&T.genre.split(",").map(j=>j.trim()).filter(j=>j).forEach(j=>{G.genreDistribution[j]=(G.genreDistribution[j]||0)+1}),T.spielzeit&&T.spielzeit>0&&(G.totalPlaytime+=T.spielzeit),T.category==="series"&&T.isAiring===!0&&G.airingSeries.push({title:T.title,nextSeason:T.nextSeason,nextSeasonRelease:T.nextSeasonRelease}),T.discovered){const ge=new Date(T.discovered),j=new Date;j.setDate(j.getDate()-30),ge>=j&&G.recentActivity.push({title:T.title,category:T.category,discovered:T.discovered})}}),pe>0&&(G.avgRating=(Ce/pe).toFixed(1)),G.totalPlaytime=Math.round(G.totalPlaytime/60),G.recentActivity.sort((T,Te)=>new Date(Te.discovered)-new Date(T.discovered)),G}),b=k=>k?new Date(k).toLocaleDateString():"",E=k=>{const G=Math.max(0,Math.min(5,parseInt(k)||0)),Ce="â˜…".repeat(G),pe="â˜†".repeat(5-G);return Ce+pe},I=k=>{p(k),Ie()},_=()=>{r.value=!1,S.value=!0},z=()=>{r.value=!0},x=k=>{r.value=!1,ie()},re=()=>{S.value=!1,ie()},le=async()=>{o.value=!0,w.value=null;try{console.log("ðŸ”§ Starting admin setup...");const k=await u.adminSetup();k.success?(console.log("âœ… Admin setup successful:",k),w.value={type:"success",text:`âœ… Admin created and logged in! User: ${k.user.name} (${k.user.email})`},await ie(),setTimeout(()=>{w.value=null},5e3)):(console.log("â„¹ï¸ Admin already exists:",k),w.value={type:"info",text:`â„¹ï¸ ${k.message} (${k.admin_count} admin(s) exist)`},setTimeout(()=>{w.value=null},3e3))}catch(k){console.error("âŒ Admin setup failed:",k),w.value={type:"error",text:`âŒ Admin setup failed: ${k.message||"Unknown error"}`},setTimeout(()=>{w.value=null},5e3)}finally{o.value=!1}},at=()=>{console.log("ðŸ”¥ DEBUG: Direct admin navigation called!"),console.log("ðŸ”¥ DEBUG: Router object:",je);try{je.push("/admin"),console.log("ðŸ”¥ DEBUG: Successfully navigated to /admin!")}catch(k){console.error("ðŸ”¥ DEBUG: Error navigating to admin:",k)}};return dt(async()=>{try{if(await ie(),g.value)try{i.initializeRealtimeUpdates()}catch(k){console.error("Error initializing realtime updates:",k)}}catch(k){console.error("Error during initialization:",k)}}),ct(()=>{if(g.value)try{i.cleanupRealtimeUpdates()}catch(k){console.error("Error cleaning up realtime updates:",k)}Ke()}),{showLoginModal:r,showRegisterModal:S,showEditModal:A,showFloatingMenu:C,showBulkAddModal:F,showTxtImportModal:R,showTxtImportResults:q,editingItem:B,gridColumns:Y,sortBy:Z,categories:$,txtImportResults:Q,adminSetupLoading:o,adminSetupMessage:w,isLoggedIn:g,isAdmin:L,userName:ce,currentCategory:O,currentCategoryDisplayName:Xe,searchQuery:ue,categoryCounts:ne,loading:D,error:U,paginatedMedia:n,platforms:y,genres:W,setCategory:p,clearSearch:P,navigateToCalendar:_e,navigateToProfile:ke,addItemFromSidebar:I,togglePlatformFilter:te,toggleGenreFilter:se,toggleAiringFilter:xe,editItem:Me,switchToRegister:_,showAdminLogin:z,handleLoginSuccess:x,handleRegisterSuccess:re,handleAdminSetup:le,debugNavigateToAdmin:at,closeEditModal:Re,closeBulkAddModal:Se,handleBulkAddItems:De,handleSaveItem:Ue,handleDeleteItem:Pe,logout:Ee,loadMedia:ie,toggleFloatingMenu:fe,addNewItem:Ie,bulkAddItems:Fe,importFromTxt:Be,importFromAPI:Le,createCollection:Ne,exportMediaCollection:Ve,exportAsCSV:ve,exportAsJSON:Ge,downloadFile:ze,deleteAllInCategory:We,getCategoryDisplayName:me,processTxtContent:ye,closeTxtImportResults:Je,messageStore:t,confirmStore:a,inputStore:e,statistics:m,formatDate:b,getRatingStars:E,sidebarStore:v}}},ln={class:"vue-app"},dn={class:"main-content"},cn={class:"content-area"},un={key:1,class:"error"},mn={key:2},gn={key:0,class:"statistics-container"},fn={class:"statistics-header"},vn={class:"refresh-controls"},yn={class:"statistics-content"},pn={class:"stats-summary"},hn={class:"summary-card"},bn={class:"summary-number"},wn={class:"summary-card"},Sn={class:"summary-number"},In={class:"summary-card"},_n={class:"summary-number"},kn={class:"summary-card"},Cn={class:"summary-number"},Tn={class:"chart-container"},An={class:"category-stats"},xn={class:"category-name"},Mn={class:"category-bar"},Rn={class:"category-count"},Dn={class:"chart-container"},Un={class:"rating-stats"},Pn={class:"rating-stars"},En={class:"rating-bar"},Fn={class:"rating-count"},Bn={class:"chart-container"},Ln={class:"platform-stats"},Nn={class:"platform-name"},Vn={class:"platform-bar"},Gn={class:"platform-count"},zn={class:"chart-container"},Wn={class:"genre-stats"},jn={class:"genre-name"},On={class:"genre-bar"},qn={class:"genre-count"},Hn={class:"chart-container"},Qn={class:"recent-activity"},Jn={class:"activity-title"},Kn={class:"activity-category"},Xn={class:"activity-date"},Yn={class:"chart-container"},Zn={class:"airing-series"},$n={class:"airing-title"},ei={class:"airing-next"},ti={class:"airing-date"},si={key:0,class:"admin-setup-container"},oi=["disabled"],ai={key:0},ni={key:1};function ii(i,t,a,e,u,v){const o=H("Sidebar"),w=H("MainHeader"),r=H("LoadingSpinner"),S=H("MediaItem"),A=H("LoginModal"),C=H("RegisterModal"),F=H("EditModal"),R=H("BulkAddModal"),q=H("TxtImportModal"),B=H("TxtImportResultsModal"),Y=H("FloatingActionButton"),Z=H("MessageBox"),$=H("ConfirmDialog"),Q=H("InputDialog");return l(),d("div",ln,[s("div",{class:ee(["mobile-overlay",{show:e.sidebarStore.mobileOpen}]),onClick:t[0]||(t[0]=(...g)=>e.sidebarStore.closeMobileSidebar&&e.sidebarStore.closeMobileSidebar(...g))},null,2),oe(o,{collapsed:e.sidebarStore.collapsed,"mobile-open":e.sidebarStore.mobileOpen,"is-logged-in":e.isLoggedIn,"is-admin":e.isAdmin,"user-name":e.userName,"current-category":e.currentCategory,"category-counts":e.categoryCounts,platforms:e.platforms,genres:e.genres,categories:e.categories,onToggle:e.sidebarStore.toggleSidebar,onSetCategory:e.setCategory,onNavigateToCalendar:e.navigateToCalendar,onNavigateToProfile:e.navigateToProfile,onNavigateToAdmin:e.debugNavigateToAdmin,onTogglePlatformFilter:e.togglePlatformFilter,onToggleGenreFilter:e.toggleGenreFilter,onToggleAiringFilter:e.toggleAiringFilter,onAddItem:e.addItemFromSidebar,onShowLogin:t[1]||(t[1]=g=>e.showLoginModal=!0),onShowRegister:t[2]||(t[2]=g=>e.showRegisterModal=!0),onShowAdminLogin:e.showAdminLogin,onLogout:e.logout},null,8,["collapsed","mobile-open","is-logged-in","is-admin","user-name","current-category","category-counts","platforms","genres","categories","onToggle","onSetCategory","onNavigateToCalendar","onNavigateToProfile","onNavigateToAdmin","onTogglePlatformFilter","onToggleGenreFilter","onToggleAiringFilter","onAddItem","onShowAdminLogin","onLogout"]),s("div",dn,[oe(w,{"search-query":e.searchQuery,"onUpdate:searchQuery":t[3]||(t[3]=g=>e.searchQuery=g),"grid-columns":e.gridColumns,"onUpdate:gridColumns":t[4]||(t[4]=g=>e.gridColumns=g),"sort-by":e.sortBy,"onUpdate:sortBy":t[5]||(t[5]=g=>e.sortBy=g),onToggleMobileSidebar:e.sidebarStore.toggleMobileSidebar,onClearSearch:e.clearSearch},null,8,["search-query","grid-columns","sort-by","onToggleMobileSidebar","onClearSearch"]),s("main",cn,[e.loading?(l(),he(r,{key:0,message:"Loading media data..."})):e.error?(l(),d("div",un,[s("p",null,c(e.error),1),s("button",{onClick:t[6]||(t[6]=(...g)=>e.loadMedia&&e.loadMedia(...g))},"Retry")])):(l(),d("div",mn,[e.currentCategory==="statistics"?(l(),d("div",gn,[s("div",fn,[t[12]||(t[12]=s("h1",null,"ðŸ“Š Media Library Statistics",-1)),t[13]||(t[13]=s("p",null,"Ãœbersicht Ã¼ber deine Media Collection",-1)),s("div",vn,[s("button",{class:"refresh-btn",onClick:t[7]||(t[7]=(...g)=>e.loadMedia&&e.loadMedia(...g))},"ðŸ”„ Refresh Statistics")])]),s("div",yn,[s("div",pn,[s("div",hn,[s("div",bn,c(e.statistics.totalItems),1),t[14]||(t[14]=s("div",{class:"summary-label"},"Total Items",-1))]),s("div",wn,[s("div",Sn,c(e.statistics.totalCollections),1),t[15]||(t[15]=s("div",{class:"summary-label"},"Collections",-1))]),s("div",In,[s("div",_n,c(e.statistics.totalPlaytime)+"h",1),t[16]||(t[16]=s("div",{class:"summary-label"},"Total Playtime",-1))]),s("div",kn,[s("div",Cn,c(e.statistics.avgRating),1),t[17]||(t[17]=s("div",{class:"summary-label"},"Avg Rating",-1))])]),s("div",Tn,[t[18]||(t[18]=s("h3",{class:"chart-title"},"ðŸ“ˆ Category Distribution",-1)),s("div",An,[(l(!0),d(J,null,K(e.statistics.categoryDistribution,(g,L)=>(l(),d("div",{key:L,class:"category-stat"},[s("div",xn,c(L),1),s("div",Mn,[s("div",{class:"category-fill",style:de({width:`${g/e.statistics.totalItems*100}%`})},null,4)]),s("div",Rn,c(g)+" ("+c((g/e.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",Dn,[t[19]||(t[19]=s("h3",{class:"chart-title"},"â­ Rating Distribution",-1)),s("div",Un,[(l(!0),d(J,null,K(e.statistics.ratingDistribution,(g,L)=>(l(),d("div",{key:L,class:"rating-stat"},[s("div",Pn,c(e.getRatingStars(L)),1),s("div",En,[s("div",{class:"rating-fill",style:de({width:`${g/e.statistics.totalItems*100}%`})},null,4)]),s("div",Fn,c(g)+" ("+c((g/e.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",Bn,[t[20]||(t[20]=s("h3",{class:"chart-title"},"ðŸŽ® Platform Distribution",-1)),s("div",Ln,[(l(!0),d(J,null,K(e.statistics.platformDistribution,(g,L)=>(l(),d("div",{key:L,class:"platform-stat"},[s("div",Nn,c(L),1),s("div",Vn,[s("div",{class:"platform-fill",style:de({width:`${g/e.statistics.totalItems*100}%`})},null,4)]),s("div",Gn,c(g)+" ("+c((g/e.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",zn,[t[21]||(t[21]=s("h3",{class:"chart-title"},"ðŸŽ­ Top Genres",-1)),s("div",Wn,[(l(!0),d(J,null,K(e.statistics.genreDistribution,(g,L)=>(l(),d("div",{key:L,class:"genre-stat"},[s("div",jn,c(L),1),s("div",On,[s("div",{class:"genre-fill",style:de({width:`${g/e.statistics.totalItems*100}%`})},null,4)]),s("div",qn,c(g)+" ("+c((g/e.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",Hn,[t[22]||(t[22]=s("h3",{class:"chart-title"},"ðŸ“… Recent Activity",-1)),s("div",Qn,[(l(!0),d(J,null,K(e.statistics.recentActivity,g=>(l(),d("div",{key:g.title,class:"activity-item"},[s("div",Jn,c(g.title),1),s("div",Kn,c(g.category),1),s("div",Xn,c(e.formatDate(g.discovered)),1)]))),128))])]),s("div",Yn,[t[23]||(t[23]=s("h3",{class:"chart-title"},"ðŸ“º Currently Airing Series",-1)),s("div",Zn,[(l(!0),d(J,null,K(e.statistics.airingSeries,g=>(l(),d("div",{key:g.title,class:"airing-item"},[s("div",$n,c(g.title),1),s("div",ei,"Next: Season "+c(g.nextSeason),1),s("div",ti,c(g.nextSeasonRelease?e.formatDate(g.nextSeasonRelease):"TBA"),1)]))),128))])])])])):(l(),d("div",{key:1,class:"grid",style:de({gridTemplateColumns:`repeat(${e.gridColumns}, 1fr)`})},[(l(!0),d(J,null,K(e.paginatedMedia,g=>(l(),he(S,{key:g.id,item:g,onEdit:e.editItem},null,8,["item","onEdit"]))),128))],4))]))])]),e.isLoggedIn?f("",!0):(l(),d("div",si,[s("button",{onClick:t[8]||(t[8]=(...g)=>e.handleAdminSetup&&e.handleAdminSetup(...g)),disabled:e.adminSetupLoading,class:"admin-setup-btn",title:"Setup Admin Account (Creates admin account with default password)"},[e.adminSetupLoading?(l(),d("span",ai,"ðŸ”§ Setting up...")):(l(),d("span",ni,"ðŸ”§ Admin Setup"))],8,oi),e.adminSetupMessage?(l(),d("div",{key:0,class:ee(["admin-setup-message",e.adminSetupMessage.type])},c(e.adminSetupMessage.text),3)):f("",!0)])),e.showLoginModal?(l(),he(A,{key:1,onClose:t[9]||(t[9]=g=>e.showLoginModal=!1),onSuccess:e.handleLoginSuccess,onSwitchToRegister:e.switchToRegister},null,8,["onSuccess","onSwitchToRegister"])):f("",!0),e.showRegisterModal?(l(),he(C,{key:2,onClose:t[10]||(t[10]=g=>e.showRegisterModal=!1),onSuccess:e.handleRegisterSuccess},null,8,["onSuccess"])):f("",!0),e.showEditModal?(l(),he(F,{key:3,item:e.editingItem,"current-category":e.currentCategory,onClose:e.closeEditModal,onSave:e.handleSaveItem,onDelete:e.handleDeleteItem},null,8,["item","current-category","onClose","onSave","onDelete"])):f("",!0),oe(R,{show:e.showBulkAddModal,"current-category":e.currentCategory,onClose:e.closeBulkAddModal},null,8,["show","current-category","onClose"]),oe(q,{show:e.showTxtImportModal,onClose:t[11]||(t[11]=g=>e.showTxtImportModal=!1),onFileProcessed:e.processTxtContent},null,8,["show","onFileProcessed"]),oe(B,{show:e.showTxtImportResults,results:e.txtImportResults,onClose:e.closeTxtImportResults},null,8,["show","results","onClose"]),oe(Y,{"show-menu":e.showFloatingMenu,"show-delete-all":e.isLoggedIn&&e.currentCategory!=="all"&&e.categoryCounts[e.currentCategory]>0,"category-name":e.currentCategoryDisplayName,"item-count":e.categoryCounts[e.currentCategory]||0,onToggleMenu:e.toggleFloatingMenu,onAddNewItem:e.addNewItem,onBulkAddItems:e.bulkAddItems,onImportFromTxt:e.importFromTxt,onImportFromApi:e.importFromAPI,onCreateCollection:e.createCollection,onDeleteAllInCategory:e.deleteAllInCategory},null,8,["show-menu","show-delete-all","category-name","item-count","onToggleMenu","onAddNewItem","onBulkAddItems","onImportFromTxt","onImportFromApi","onCreateCollection","onDeleteAllInCategory"]),oe(Z,{show:e.messageStore.show,type:e.messageStore.type,title:e.messageStore.title,message:e.messageStore.message,details:e.messageStore.details,onClose:e.messageStore.closeMessage},null,8,["show","type","title","message","details","onClose"]),oe($,{show:e.confirmStore.show,title:e.confirmStore.title,message:e.confirmStore.message,onConfirm:e.confirmStore.confirm,onClose:e.confirmStore.cancel},null,8,["show","title","message","onConfirm","onClose"]),oe(Q,{show:e.inputStore.show,title:e.inputStore.title,message:e.inputStore.message,placeholder:e.inputStore.placeholder,"input-type":e.inputStore.inputType,"default-value":e.inputStore.defaultValue,onConfirm:e.inputStore.confirm,onClose:e.inputStore.cancel},null,8,["show","title","message","placeholder","input-type","default-value","onConfirm","onClose"])])}const ci=X(rn,[["render",ii],["__scopeId","data-v-bac26f2f"]]);export{ci as default};
