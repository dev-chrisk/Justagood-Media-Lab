import{E as u,_ as E,b as r,e as s,A as R,t as o,f as y,F as w,m as C,a as T,r as m,C as V,u as P,B as j,o as d,j as G,G as J}from"./index-CqTkvu1B.js";import{L as q}from"./LoadingSpinner-C_DR5yDh.js";const v={async getUsers(){return(await u.get("/api/admin/users")).data},async getUserDetails(i){return(await u.get(`/api/admin/users/${i}`)).data},async updateUser(i,t){return(await u.put(`/api/admin/users/${i}`,t)).data},async deleteUser(i){return(await u.delete(`/api/admin/users/${i}`)).data},async getStatistics(){return(await u.get("/api/admin/statistics")).data},async getUserActivity(i){return(await u.get(`/api/admin/user-activity/${i}`)).data},async getAllMediaItems(i={}){return(await u.get("/api/admin/media-items",{params:i})).data},async getAllCollections(){return(await u.get("/api/admin/collections")).data}},z={name:"AdminDashboard",components:{LoadingSpinner:q},setup(){const i=P();T();const t=m(!1),b=m(null),n=m({}),h=m([]),_=m([]),g=m([]),a=m([]),c=m(!1),f=m(!1),U=m(!1),k=async()=>{var e,l;t.value=!0,b.value=null;try{const[p,B]=await Promise.all([v.getStatistics(),v.getUsers()]);n.value=p,h.value=B}catch(p){b.value=((l=(e=p.response)==null?void 0:e.data)==null?void 0:l.message)||p.message||"Failed to load admin data",console.error("Admin data load error:",p)}finally{t.value=!1}},D=async e=>{a.value.push(e.id);try{await v.updateUser(e.id,{is_admin:e.is_admin}),console.log(`User ${e.name} admin status updated`)}catch(l){console.error("Failed to update user:",l),e.is_admin=!e.is_admin}finally{a.value=a.value.filter(l=>l!==e.id)}},A=async e=>{try{const l=await v.getUserDetails(e);console.log("User details:",l),alert(`User Details:
Name: ${l.name}
Email: ${l.email}
Media Items: ${l.media_items_count}
Collections: ${l.collections_count}`)}catch(l){console.error("Failed to load user details:",l)}},M=async()=>{try{const e=await v.getAllMediaItems();_.value=e.data||e}catch(e){console.error("Failed to load media items:",e)}},S=async()=>{try{const e=await v.getAllCollections();g.value=e}catch(e){console.error("Failed to load collections:",e)}},L=()=>{i.push("/")},x=()=>{},I=e=>e?new Date(e).toLocaleDateString():"N/A",F=()=>{f.value&&_.value.length===0&&M()},N=()=>{U.value&&g.value.length===0&&S()};return V(()=>{k()}),{loading:t,error:b,statistics:n,users:h,allMediaItems:_,allCollections:g,updatingUsers:a,showUsers:c,showMedia:f,showCollections:U,loadData:k,updateUser:D,viewUserDetails:A,navigateToLibrary:L,toggleSidebar:x,formatDate:I,watchShowMedia:F,watchShowCollections:N}}},H={class:"vue-app"},K={id:"sidebar",class:"sidebar"},O={class:"sidebar-content"},Q={class:"sidebar-section"},W={class:"sidebar-nav"},X={class:"sidebar-section"},Y={class:"sidebar-nav"},Z={class:"main-content"},$={class:"main-header"},ss={class:"header-right"},ts={class:"content-area"},as={key:1,class:"error"},ns={key:2},es={class:"stats-grid"},os={class:"stat-card"},is={class:"stat-content"},ls={class:"stat-number"},ds={class:"stat-subtitle"},rs={class:"stat-card"},cs={class:"stat-content"},ms={class:"stat-number"},us={class:"stat-card"},vs={class:"stat-content"},bs={class:"stat-number"},gs={class:"stat-card"},ps={class:"stat-content"},_s={class:"stat-number"},hs={key:0,class:"admin-section"},ys={class:"section-header"},ws={class:"table-container"},Cs={class:"admin-table"},fs=["onUpdate:modelValue","onChange","disabled"],Us=["onClick","disabled"],ks={key:1,class:"admin-section"},Ds={class:"section-header"},As={class:"media-grid"},Ms={class:"media-info"},Ss={class:"media-category"},Ls={class:"media-user"},xs={class:"media-date"},Is={key:2,class:"admin-section"},Fs={class:"section-header"},Ns={class:"collections-grid"},Bs={class:"collection-description"},Es={class:"collection-user"},Rs={class:"collection-count"};function Ts(i,t,b,n,h,_){const g=j("LoadingSpinner");return d(),r("div",H,[s("aside",K,[s("div",{class:"sidebar-header",onClick:t[0]||(t[0]=(...a)=>n.toggleSidebar&&n.toggleSidebar(...a))},[...t[10]||(t[10]=[s("h2",null,"Admin Panel",-1),s("button",{class:"sidebar-toggle"},"☰",-1)])]),s("div",O,[s("div",Q,[t[15]||(t[15]=s("h3",null,"Administration",-1)),s("nav",W,[t[14]||(t[14]=s("button",{class:"nav-btn active"},[s("span",{class:"nav-icon"},"👑"),s("span",{class:"nav-text"},"Dashboard")],-1)),s("button",{class:"nav-btn",onClick:t[1]||(t[1]=a=>n.showUsers=!0)},[...t[11]||(t[11]=[s("span",{class:"nav-icon"},"👥",-1),s("span",{class:"nav-text"},"Users",-1)])]),s("button",{class:"nav-btn",onClick:t[2]||(t[2]=a=>n.showMedia=!0)},[...t[12]||(t[12]=[s("span",{class:"nav-icon"},"📚",-1),s("span",{class:"nav-text"},"All Media",-1)])]),s("button",{class:"nav-btn",onClick:t[3]||(t[3]=a=>n.showCollections=!0)},[...t[13]||(t[13]=[s("span",{class:"nav-icon"},"📁",-1),s("span",{class:"nav-text"},"Collections",-1)])])])]),s("div",X,[t[17]||(t[17]=s("h3",null,"Navigation",-1)),s("nav",Y,[s("button",{class:"nav-btn",onClick:t[4]||(t[4]=(...a)=>n.navigateToLibrary&&n.navigateToLibrary(...a))},[...t[16]||(t[16]=[s("span",{class:"nav-icon"},"🏠",-1),s("span",{class:"nav-text"},"Back to Library",-1)])])])])])]),s("div",Z,[s("header",$,[t[19]||(t[19]=s("div",{class:"header-left"},[s("h1",{class:"page-title"},"Admin Dashboard")],-1)),s("div",ss,[s("button",{class:"refresh-btn",onClick:t[5]||(t[5]=(...a)=>n.loadData&&n.loadData(...a)),title:"Refresh data"},[...t[18]||(t[18]=[s("span",{class:"refresh-icon"},"🔄",-1)])])])]),s("main",ts,[n.loading?(d(),R(g,{key:0,message:"Loading admin data..."})):n.error?(d(),r("div",as,[s("p",null,o(n.error),1),s("button",{onClick:t[6]||(t[6]=(...a)=>n.loadData&&n.loadData(...a))},"Retry")])):(d(),r("div",ns,[s("div",es,[s("div",os,[t[21]||(t[21]=s("div",{class:"stat-icon"},"👥",-1)),s("div",is,[t[20]||(t[20]=s("h3",null,"Total Users",-1)),s("p",ls,o(n.statistics.total_users||0),1),s("p",ds,o(n.statistics.admin_users||0)+" admins",1)])]),s("div",rs,[t[24]||(t[24]=s("div",{class:"stat-icon"},"📚",-1)),s("div",cs,[t[22]||(t[22]=s("h3",null,"Media Items",-1)),s("p",ms,o(n.statistics.total_media_items||0),1),t[23]||(t[23]=s("p",{class:"stat-subtitle"},"across all users",-1))])]),s("div",us,[t[27]||(t[27]=s("div",{class:"stat-icon"},"📁",-1)),s("div",vs,[t[25]||(t[25]=s("h3",null,"Collections",-1)),s("p",bs,o(n.statistics.total_collections||0),1),t[26]||(t[26]=s("p",{class:"stat-subtitle"},"user collections",-1))])]),s("div",gs,[t[30]||(t[30]=s("div",{class:"stat-icon"},"📈",-1)),s("div",ps,[t[28]||(t[28]=s("h3",null,"Recent Activity",-1)),s("p",_s,o(n.statistics.recent_registrations||0),1),t[29]||(t[29]=s("p",{class:"stat-subtitle"},"new users (30 days)",-1))])])]),n.showUsers?(d(),r("div",hs,[s("div",ys,[t[31]||(t[31]=s("h2",null,"User Management",-1)),s("button",{class:"close-btn",onClick:t[7]||(t[7]=a=>n.showUsers=!1)},"×")]),s("div",ws,[s("table",Cs,[t[32]||(t[32]=s("thead",null,[s("tr",null,[s("th",null,"Name"),s("th",null,"Email"),s("th",null,"Admin"),s("th",null,"Media Items"),s("th",null,"Collections"),s("th",null,"Joined"),s("th",null,"Actions")])],-1)),s("tbody",null,[(d(!0),r(w,null,C(n.users,a=>(d(),r("tr",{key:a.id},[s("td",null,o(a.name),1),s("td",null,o(a.email),1),s("td",null,[G(s("input",{type:"checkbox","onUpdate:modelValue":c=>a.is_admin=c,onChange:c=>n.updateUser(a),disabled:n.updatingUsers.includes(a.id)},null,40,fs),[[J,a.is_admin]])]),s("td",null,o(a.media_items_count||0),1),s("td",null,o(a.collections_count||0),1),s("td",null,o(n.formatDate(a.created_at)),1),s("td",null,[s("button",{class:"btn-small",onClick:c=>n.viewUserDetails(a.id),disabled:n.loading}," Details ",8,Us)])]))),128))])])])])):y("",!0),n.showMedia?(d(),r("div",ks,[s("div",Ds,[t[33]||(t[33]=s("h2",null,"All Media Items",-1)),s("button",{class:"close-btn",onClick:t[8]||(t[8]=a=>n.showMedia=!1)},"×")]),s("div",As,[(d(!0),r(w,null,C(n.allMediaItems,a=>{var c;return d(),r("div",{key:a.id,class:"media-item-card"},[s("div",Ms,[s("h4",null,o(a.title),1),s("p",Ss,o(a.category),1),s("p",Ls,"User: "+o(((c=a.user)==null?void 0:c.name)||"Unknown"),1),s("p",xs,o(n.formatDate(a.created_at)),1)])])}),128))])])):y("",!0),n.showCollections?(d(),r("div",Is,[s("div",Fs,[t[34]||(t[34]=s("h2",null,"All Collections",-1)),s("button",{class:"close-btn",onClick:t[9]||(t[9]=a=>n.showCollections=!1)},"×")]),s("div",Ns,[(d(!0),r(w,null,C(n.allCollections,a=>{var c;return d(),r("div",{key:a.id,class:"collection-card"},[s("h4",null,o(a.name),1),s("p",Bs,o(a.description||"No description"),1),s("p",Es,"User: "+o(((c=a.user)==null?void 0:c.name)||"Unknown"),1),s("p",Rs,o(a.media_items_count||0)+" items",1)])}),128))])])):y("",!0)]))])])])}const js=E(z,[["render",Ts],["__scopeId","data-v-75b4045e"]]);export{js as default};
