import{A as zt,d as Ee,r as k,w as Ce,c as W,m as me,u as jt,a as Oe,_ as ae,b as m,e as o,f as b,t as v,n as Q,g as xe,h as de,i as Ae,o as g,j as ye,F as oe,k as se,l as ne,p as Ve,q as Te,s as x,v as L,x as lt,y as be,z as dt,B as Ue,C as Yt,D as qt,E as Ht,G as Qt}from"./index-D5jN9kmn.js";class Jt{constructor(){this.isConnected={value:!1},this.listeners=new Map,this.pollingInterval=null,this.lastUpdate=null,this.pollingIntervalMs=2e4}getApiBaseUrl(){return zt.BASE_URL}connect(){if(this.pollingInterval)return;const e=localStorage.getItem("authToken"),s=localStorage.getItem("currentUser");!e||!s||(this.isConnected.value=!0,this.lastUpdate=new Date,this.pollingInterval=setInterval(()=>{this.checkForUpdates()},this.pollingIntervalMs))}async checkForUpdates(){try{const e=localStorage.getItem("authToken"),s=localStorage.getItem("currentUser");if(!e||!s)return;const t=this.getApiBaseUrl(),a=await fetch(`${t}/api/media`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!a.ok){if(a.status===401){this.disconnect();return}throw new Error(`HTTP error! status: ${a.status}`)}const d=await a.json();d&&d.length>0&&this.listeners.forEach((r,l)=>{try{r({type:"media_updated",items:d,count:d.length,timestamp:new Date().toISOString()})}catch{}}),this.lastUpdate=new Date}catch{}}addListener(e,s){this.listeners.set(e,s)}removeListener(e){this.listeners.delete(e)}disconnect(){this.pollingInterval&&(clearInterval(this.pollingInterval),this.pollingInterval=null),this.isConnected.value=!1}destroy(){this.disconnect(),this.listeners.clear()}}const Ze=new Jt,ze=Ee("media",()=>{const i=()=>{try{return localStorage.getItem("currentCategory")||"game"}catch(n){return console.error("Failed to load current category from localStorage:",n),"game"}},e=n=>{try{localStorage.setItem("currentCategory",n)}catch(h){console.error("Failed to save current category to localStorage:",h)}},s=()=>{try{return localStorage.getItem("searchQuery")||""}catch(n){return console.error("Failed to load search query from localStorage:",n),""}},t=n=>{try{localStorage.setItem("searchQuery",n)}catch(h){console.error("Failed to save search query to localStorage:",h)}},a=k(D()),d=k(i()),r=k(s()),l=k(null),f=k([]),c=k(!1),U=k(null);Ce(d,n=>{e(n)},{immediate:!1}),Ce(r,n=>{t(n)},{immediate:!1});function D(){try{const n=localStorage.getItem("authToken"),h=localStorage.getItem("currentUser");if(!n||!h){const I=localStorage.getItem("mediaData");return I?JSON.parse(I):[]}return[]}catch(n){return console.error("Failed to load media from storage:",n),[]}}function _(){try{const n=localStorage.getItem("authToken"),h=localStorage.getItem("currentUser");(!n||!h)&&localStorage.setItem("mediaData",JSON.stringify(a.value))}catch(n){console.error("Failed to save media to storage:",n)}}const w=W(()=>a.value.length),J=W(()=>{const n={};return a.value.forEach(h=>{const I=h.category||"unknown";n[I]=(n[I]||0)+1}),n}),Z=W(()=>{let n=[...a.value];if(d.value&&d.value!=="all"&&(n=n.filter(h=>d.value==="watchlist"?h.category==="watchlist"||h.isNew===!0:h.category===d.value)),f.value&&f.value.length>0&&(n=n.filter(h=>{if(!h.genre)return!1;const I=h.genre.split(",").map(u=>u.trim().toLowerCase());return f.value.some(u=>I.some(y=>y.includes(u.toLowerCase())))})),r.value){const h=r.value.toLowerCase();n=n.filter(I=>{var u,y,A,te;return((u=I.title)==null?void 0:u.toLowerCase().includes(h))||((y=I.description)==null?void 0:y.toLowerCase().includes(h))||((A=I.genre)==null?void 0:A.toLowerCase().includes(h))||((te=I.platforms)==null?void 0:te.toLowerCase().includes(h))})}return n});async function F(){var n,h;c.value=!0,U.value=null;try{const I=localStorage.getItem("authToken"),u=localStorage.getItem("currentUser");if(I&&u)try{const y=await me.getMedia();a.value=y||[]}catch(y){console.warn("API load failed for logged in user:",y),a.value=[]}else{const y=D();if(y.length>0)a.value=y;else{const A=await me.getMedia();a.value=A||[],_()}}}catch(I){U.value=((h=(n=I.response)==null?void 0:n.data)==null?void 0:h.message)||I.message||"Failed to load media data",console.error("Failed to load media:",I)}finally{c.value=!1}}function le(n){d.value=n}function fe(n){r.value=n}function ce(n){l.value=n}function p(){l.value=null}function N(n){f.value=n}function ie(){f.value=[]}async function re(n,h=!1){var I,u,y;U.value=null;try{const A=localStorage.getItem("authToken"),te=localStorage.getItem("currentUser");if(A&&te)try{const j=await me.addMediaItem(n);if(!h)await F();else{const E={...j,__order:a.value.length};a.value.push(E)}return j}catch(j){if(((I=j.response)==null?void 0:I.status)===409&&((y=(u=j.response)==null?void 0:u.data)!=null&&y.duplicate)){const E=new Error(j.response.data.error||"Ein Eintrag mit diesem Titel und dieser Kategorie existiert bereits.");throw E.isDuplicate=!0,E}throw U.value=j.message||"Failed to add media item",console.error("API save failed for logged in user:",j),j}else{const j={id:Date.now(),...n,__order:a.value.length};return a.value.push(j),_(),j}}catch(A){throw A}}async function ke(n,h){U.value=null;try{const I=localStorage.getItem("authToken"),u=localStorage.getItem("currentUser");if(I&&u)try{const y=await me.updateMediaItem(n,h);return await F(),y}catch(y){throw console.error("API update failed for logged in user:",y),y}else{const y=a.value.findIndex(A=>A.id===n);if(y!==-1)return a.value[y]={...a.value[y],...h},_(),a.value[y];throw new Error("Media item not found")}}catch(I){throw I.isDuplicate||(U.value=I.message||"Failed to update media item"),I}}async function ue(n){var h;try{const I=localStorage.getItem("authToken"),u=localStorage.getItem("currentUser");if(I&&u)try{return await me.deleteMediaItem(n),await F(),!0}catch(y){if(((h=y.response)==null?void 0:h.status)===404||y.isNotFound)return await F(),!0;throw console.error("API delete failed for logged in user:",y),y}else{const y=a.value.findIndex(A=>A.id===n);if(y!==-1)return a.value.splice(y,1),_(),!0;throw new Error("Media item not found")}}catch(I){throw U.value=I.message||"Failed to delete media item",I}}async function we(n){try{const h=localStorage.getItem("authToken"),I=localStorage.getItem("currentUser");if(h&&I)try{const u=await me.batchAddMediaItems(n);return await F(),u}catch(u){throw console.error("API batch add failed for logged in user:",u),u}else{const u=n.map((y,A)=>({id:Date.now()+A,...y,__order:a.value.length+A}));return a.value.push(...u),_(),{success:!0,stats:{created:u.length,failed:0,errors:[]}}}}catch(h){throw U.value=h.message||"Failed to add media items",h}}async function Se(n){try{const h=localStorage.getItem("authToken"),I=localStorage.getItem("currentUser");if(h&&I)try{return await me.batchDeleteMediaItems(n),await F(),!0}catch(u){if(u.silent)return console.log("Silent batch delete error (some items may not exist):",u.message),await F(),!0;throw console.error("API batch delete failed for logged in user:",u),u}else return a.value=a.value.filter(u=>!n.includes(u.id)),_(),!0}catch(h){throw h.silent||(U.value=h.message||"Failed to delete media items"),h}}async function X(){try{const n=localStorage.getItem("authToken"),h=localStorage.getItem("currentUser");n&&h?await me.saveMedia(a.value):_()}catch(n){console.error("Failed to save media:",n)}}function V(){U.value=null}function Y(n){if(console.log("Processing real-time update:",n),n.type==="media_updated"&&n.items)n.items.forEach(h=>{const I=a.value.findIndex(u=>u.id===h.id);I!==-1?a.value[I]={...a.value[I],...h}:a.value.push(h)});else if(n.action==="created"||n.action==="updated"){const h=n.item,I=a.value.findIndex(u=>u.id===h.id);I!==-1?a.value[I]={...a.value[I],...h}:a.value.push(h)}else if(n.action==="deleted"){const h=a.value.findIndex(I=>I.id===n.id);h!==-1&&a.value.splice(h,1)}_()}function H(){const n=localStorage.getItem("authToken"),h=localStorage.getItem("currentUser");if(!n||!h){console.log("Skipping realtime initialization - user not authenticated");return}try{Ze.addListener("media-store",Y),Ze.connect()}catch(I){console.error("Failed to initialize realtime updates:",I)}}function pe(){Ze.removeListener("media-store")}return{mediaData:a,currentCategory:d,searchQuery:r,selectedGenre:l,selectedGenres:f,loading:c,error:U,totalItems:w,categoryCounts:J,filteredMedia:Z,loadMedia:F,setCategory:le,setSearchQuery:fe,setGenre:ce,clearGenre:p,setGenres:N,clearGenres:ie,addMediaItem:re,updateMediaItem:ke,deleteMediaItem:ue,batchAddMediaItems:we,batchDeleteMediaItems:Se,saveMedia:X,clearError:V,initializeRealtimeUpdates:H,cleanupRealtimeUpdates:pe,resetMediaState:()=>{d.value="game",r.value="",localStorage.removeItem("currentCategory"),localStorage.removeItem("searchQuery")}}}),ct=Ee("message",()=>{const i=k(!1),e=k("info"),s=k(""),t=k(""),a=k("");function d(D){e.value=D.type||"info",s.value=D.title||"",t.value=D.message||"",a.value=D.details||"",i.value=!0}function r(D,_="Success",w=""){d({type:"success",title:_,message:D,details:w})}function l(D,_="Error",w=""){d({type:"error",title:_,message:D,details:w})}function f(D,_="Warning",w=""){d({type:"warning",title:_,message:D,details:w})}function c(D,_="Info",w=""){d({type:"info",title:_,message:D,details:w})}function U(){i.value=!1,setTimeout(()=>{e.value="info",s.value="",t.value="",a.value=""},300)}return{show:i,type:e,title:s,message:t,details:a,showMessage:d,showSuccess:r,showError:l,showWarning:f,showInfo:c,closeMessage:U}}),ut=Ee("confirm",()=>{const i=k(!1),e=k("Confirm Action"),s=k(""),t=k(null);function a(l){return new Promise(f=>{e.value=l.title||"Confirm Action",s.value=l.message||"",i.value=!0,t.value=f})}function d(){t.value&&(t.value(!0),t.value=null),i.value=!1}function r(){t.value&&(t.value(!1),t.value=null),i.value=!1}return{show:i,title:e,message:s,showConfirm:a,confirm:d,cancel:r}}),gt=Ee("input",()=>{const i=k(!1),e=k("Input Required"),s=k(""),t=k(""),a=k("text"),d=k(""),r=k(null);function l(U){return new Promise(D=>{e.value=U.title||"Input Required",s.value=U.message||"",t.value=U.placeholder||"",a.value=U.inputType||"text",d.value=U.defaultValue||"",i.value=!0,r.value=D})}function f(U){r.value&&(r.value(U),r.value=null),i.value=!1}function c(){r.value&&(r.value(null),r.value=null),i.value=!1}return{show:i,title:e,message:s,placeholder:t,inputType:a,defaultValue:d,showInput:l,confirm:f,cancel:c}}),mt=Ee("sidebar",()=>{const i=()=>{try{const w=localStorage.getItem("sidebarState");if(w)return{collapsed:JSON.parse(w).collapsed||!1,mobileOpen:!1}}catch(w){console.error("Failed to load sidebar state from localStorage:",w)}return{collapsed:!1,mobileOpen:!1}},e=w=>{try{localStorage.setItem("sidebarState",JSON.stringify({collapsed:w.collapsed}))}catch(J){console.error("Failed to save sidebar state to localStorage:",J)}},s=i(),t=k(s.collapsed),a=k(s.mobileOpen);Ce(t,w=>{e({collapsed:w,mobileOpen:a.value})},{immediate:!1});const d=()=>{t.value=!t.value},r=()=>{a.value=!a.value},l=()=>{a.value=!1},f=w=>{t.value=w},c=w=>{a.value=w},U=()=>{t.value=!1,a.value=!1,localStorage.removeItem("sidebarState")},D=W(()=>t.value),_=W(()=>a.value);return{collapsed:t,mobileOpen:a,toggleSidebar:d,toggleMobileSidebar:r,closeMobileSidebar:l,setCollapsed:f,setMobileOpen:c,resetSidebarState:U,isCollapsed:D,isMobileOpen:_}});function Kt(){const i=jt(),e=Oe(),s=ze(),t=ct(),a=ut(),d=gt(),r=k(!1),l=k(!1),f=k(!1),c=k(!1),U=k(!1),D=k(!1),_=k(!1),w=k(null),J=()=>typeof window<"u"?window.innerWidth>768?8:3:8,Z=k(J()),F=k("order_asc"),le=k(null),fe=()=>{Z.value=J()};typeof window<"u"&&window.addEventListener("resize",fe);const ce=[{key:"game",name:"Games",icon:"🎮"},{key:"series",name:"Series",icon:"📺"},{key:"movie",name:"Movies",icon:"🎬"},{key:"buecher",name:"Bücher",icon:"📚"},{key:"watchlist",name:"Watchlist",icon:"❤️"}],p=W(()=>{try{return e.isLoggedIn}catch(C){return console.error("Error accessing authStore.isLoggedIn:",C),!1}}),N=W(()=>{try{return e.userName}catch(C){return console.error("Error accessing authStore.userName:",C),""}}),ie=W(()=>{try{return e.isAdmin}catch(C){return console.error("Error accessing authStore.isAdmin:",C),!1}}),re=W(()=>{try{return s.currentCategory}catch(C){return console.error("Error accessing mediaStore.currentCategory:",C),"game"}}),ke=W({get:()=>{try{return s.searchQuery}catch(C){return console.error("Error accessing mediaStore.searchQuery:",C),""}},set:C=>{try{s.setSearchQuery(C)}catch(M){console.error("Error setting mediaStore.searchQuery:",M)}}}),ue=W(()=>{try{return s.categoryCounts}catch(C){return console.error("Error accessing mediaStore.categoryCounts:",C),{}}}),we=W(()=>{try{return s.loading}catch(C){return console.error("Error accessing mediaStore.loading:",C),!1}}),Se=W(()=>{try{return s.error}catch(C){return console.error("Error accessing mediaStore.error:",C),null}}),X=W(()=>{try{const C=[...s.filteredMedia||[]],[M,K]=F.value.split("_");return C.sort((P,G)=>{let $=P[M],O=G[M];return M==="order"?($=P.__order||0,O=G.__order||0):M==="airing"?($=P.isAiring?1:0,O=G.isAiring?1:0):M==="api_rating"?($=P.api_rating||P.rating||0,O=G.api_rating||G.rating||0):M==="personal_rating"&&($=P.personal_rating||0,O=G.personal_rating||0),typeof $=="string"&&($=$.toLowerCase(),O=O.toLowerCase()),K==="asc"?$>O?1:-1:$<O?1:-1})}catch(C){return console.error("Error in sortedMedia computed:",C),[]}}),V=W(()=>X.value),Y=C=>{s.setCategory(C),mt().closeMobileSidebar()},H=()=>{s.setSearchQuery("")},pe=C=>{w.value=C,f.value=!0},Ie=()=>{f.value=!1,w.value=null},n=()=>{U.value=!1},h=async C=>{console.log("handleBulkAddItems called but not used in new workflow")},I=async C=>{w.value?await s.updateMediaItem(w.value.id,C):await s.addMediaItem(C),Ie()},u=async C=>{var M;try{await s.deleteMediaItem(C.id)}catch(K){((M=K.response)==null?void 0:M.status)!==404&&!K.silent&&(console.error("Delete failed:",K),t.showError("Failed to delete item: "+(K.message||"Unknown error"),"Delete Failed"))}},y=async()=>{await e.logout(),await A()},A=async()=>{try{await s.loadMedia()}catch(C){console.error("Error loading media:",C)}},te=()=>{c.value=!c.value},j=()=>{if(c.value=!1,!p.value){t.showWarning("Bitte loggen Sie sich ein, um neue Items hinzuzufügen.","Login erforderlich");return}w.value=null,f.value=!0},E=()=>{if(c.value=!1,!p.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}U.value=!0},ge=()=>{if(c.value=!1,!p.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}D.value=!0},je=()=>{if(c.value=!1,!p.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}t.showInfo("API Import feature coming soon!","Feature in Entwicklung")},Re=()=>{if(c.value=!1,!p.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}Pe()},Me=C=>{if(!C)return"Unknown";const M=ce.find(K=>K.key===C);return M?M.name:C},Ye=async()=>{const C=Me(re.value),M=ue.value[re.value]||0;if(M===0){t.showInfo("No items to delete in this category.","Nothing to Delete");return}const K=`Are you sure you want to delete ALL ${M} items in "${C}"?

This action cannot be undone!`;if(await a.showConfirm({title:"Delete All Items",message:K}))try{const $=((s==null?void 0:s.mediaData)||[]).filter(O=>re.value==="watchlist"?O.category==="watchlist"||O.isNew===!0:O.category===re.value).map(O=>O.id);await s.batchDeleteMediaItems($),await A(),t.showSuccess(`Successfully deleted ${M} items from "${C}"`,"Items Deleted")}catch(G){console.error("Error deleting items:",G),G.silent?t.showSuccess(`Items deleted from "${C}" (some items may not have existed)`,"Items Deleted"):G.isNotFound?t.showWarning("Some items were not found and could not be deleted, but the operation completed.","Partial Success"):t.showError("Error occurred while deleting items. Please try again.","Delete Failed")}},qe=C=>{const M=C.split(`
`).map(O=>O.trim()).filter(O=>O.length>0);if(M.length===0){t.showWarning("Die TXT-Datei ist leer oder enthält keine gültigen Einträge.","Leere Datei");return}const P=s.filteredMedia.map(O=>O.title.toLowerCase().trim()),G=M.filter(O=>{const De=O.toLowerCase().trim();return!P.some(ve=>ve.includes(De)||De.includes(ve))}),$=M.filter(O=>{const De=O.toLowerCase().trim();return P.some(ve=>ve.includes(De)||De.includes(ve))});le.value={totalInFile:M.length,missingItems:G,existingItems:$,currentCategory:re.value,categoryName:Me(re.value)},D.value=!1,_.value=!0},He=()=>{le.value=null,_.value=!1},Pe=async()=>{const C=(s==null?void 0:s.mediaData)||[];if(C.length===0){t.showInfo("Keine Media Items zum Exportieren gefunden.","Nichts zu exportieren");return}const M=await d.showInput({title:"Export Format wählen",message:`1 = CSV
2 = JSON
3 = Beide

Geben Sie die Nummer ein:`,placeholder:"1",defaultValue:"1"});if(!M||!["1","2","3"].includes(M))return;const K=new Date().toISOString().split("T")[0];(M==="1"||M==="3")&&Le(C,K),(M==="2"||M==="3")&&Ge(C,K),t.showSuccess(`Collection mit ${C.length} Items wurde erfolgreich exportiert!`,"Export erfolgreich")},Le=(C,M)=>{const P=[["Titel","Kategorie","Release","Rating","Platforms","Genre","Spielzeit","Status","Beschreibung"].join(","),...C.map(G=>[`"${(G.title||"").replace(/"/g,'""')}"`,`"${(G.category||G.category_name||"Unbekannt").replace(/"/g,'""')}"`,`"${G.release||""}"`,`"${G.rating||""}"`,`"${(G.platforms||"").replace(/"/g,'""')}"`,`"${(G.genre||"").replace(/"/g,'""')}"`,`"${G.spielzeit||""}"`,`"${G.isAiring?"Airing":"Abgeschlossen"}"`,`"${(G.description||"").replace(/"/g,'""')}"`].join(","))].join(`
`);Be(P,`media_collection_${M}.csv`,"text/csv;charset=utf-8;")},Ge=(C,M)=>{const K={exportDate:new Date().toISOString(),totalItems:C.length,categories:[...new Set(C.map(P=>P.category||P.category_name||"Unbekannt"))],items:C.map(P=>({id:P.id,title:P.title||"",category:P.category||P.category_name||"Unbekannt",release:P.release||"",rating:P.rating||null,platforms:P.platforms||"",genre:P.genre||"",spielzeit:P.spielzeit||null,status:P.isAiring?"Airing":"Abgeschlossen",description:P.description||"",isNew:P.isNew||!1,nextSeason:P.nextSeason||null,discovered:P.discovered||null}))};Be(JSON.stringify(K,null,2),`media_collection_${M}.json`,"application/json;charset=utf-8;")},Be=(C,M,K)=>{const P=new Blob([C],{type:K}),G=document.createElement("a"),$=URL.createObjectURL(P);G.setAttribute("href",$),G.setAttribute("download",M),G.style.visibility="hidden",document.body.appendChild(G),G.click(),document.body.removeChild(G),URL.revokeObjectURL($)};return{showLoginModal:r,showRegisterModal:l,showEditModal:f,showFloatingMenu:c,showBulkAddModal:U,showTxtImportModal:D,showTxtImportResults:_,editingItem:w,gridColumns:Z,sortBy:F,categories:ce,txtImportResults:le,isLoggedIn:p,isAdmin:ie,userName:N,currentCategory:re,searchQuery:ke,categoryCounts:ue,loading:we,error:Se,paginatedMedia:V,setCategory:Y,clearSearch:H,editItem:pe,closeEditModal:Ie,closeBulkAddModal:n,handleBulkAddItems:h,handleSaveItem:I,handleDeleteItem:u,logout:y,loadMedia:A,toggleFloatingMenu:te,addNewItem:j,bulkAddItems:E,importFromTxt:ge,importFromAPI:je,createCollection:Re,exportMediaCollection:Pe,exportAsCSV:Le,exportAsJSON:Ge,downloadFile:Be,deleteAllInCategory:Ye,getCategoryDisplayName:Me,navigateToCalendar:()=>{Y("calendar")},navigateToProfile:()=>{Y("profile")},navigateToAdmin:()=>{console.log("🔥 navigateToAdmin function called!"),console.log("🔥 Router object:",i),console.log("🔥 Pushing to /admin...");try{i.push("/admin"),console.log("🔥 Successfully navigated to /admin!")}catch(C){console.error("🔥 Error navigating to admin:",C)}},processTxtContent:qe,closeTxtImportResults:He,cleanup:()=>{typeof window<"u"&&window.removeEventListener("resize",fe)},router:i}}const Zt={name:"MediaItem",props:{item:{type:Object,required:!0}},emits:["edit"],computed:{showWatchlistTag(){return this.item.category==="watchlist"||this.item.isNew===!0},isWatchlistItem(){return this.item.category==="watchlist"||this.item.isNew===!0},isSeries(){return this.item.category==="series"||this.item.watchlist_type==="series"}},methods:{getImageUrl(i){return i?i.startsWith("http")?i.startsWith("http://")?i.replace("http://","https://"):i:i.startsWith("/")?i:i.startsWith("storage/")?`/${i}`:`/${i}`:""},handleImageError(i){var e;i.target.style.display="none",(e=i.target.nextElementSibling)==null||e.classList.add("show")},formatDate(i){return i?new Date(i).toLocaleDateString():""},editItem(){this.$emit("edit",this.item)},openExtraLink(){this.item.extra_link&&window.open(this.item.extra_link,"_blank","noopener,noreferrer")},getWatchlistReleaseStatus(){if(!this.item.release)return"";const i=new Date(this.item.release),e=new Date;e.setHours(0,0,0,0),i.setHours(0,0,0,0);const s=i.getTime()-e.getTime(),t=Math.ceil(s/(1e3*3600*24));if(t>0)return t===1?"Tomorrow!":t<=7?`${t} days left`:t<=30?`${t} days left`:`${Math.ceil(t/30)} months left`;if(t===0)return"Released today!";{const a=this.getTypeTagText().toLowerCase();return a==="game"?"Unplayed yet":a==="series"||a==="movie"?"Unwatched yet":a==="buecher"?"Unread yet":"Unconsumed yet"}},getWatchlistReleaseStatusClass(){if(!this.item.release)return"";const i=new Date(this.item.release),e=new Date;e.setHours(0,0,0,0),i.setHours(0,0,0,0);const s=i.getTime()-e.getTime(),t=Math.ceil(s/(1e3*3600*24));return t>0?"countdown":t===0?"released-today":"unconsumed"},getTypeTagText(){var e,s,t;const i=this.item.watchlistType||this.item.watchlist_type;if(i)return i.charAt(0).toUpperCase()+i.slice(1);if(this.item.genre){const a=this.item.genre.toLowerCase();if(a.includes("game")||a.includes("gaming")||(e=this.item.platforms)!=null&&e.toLowerCase().includes("steam")||(s=this.item.platforms)!=null&&s.toLowerCase().includes("ps")||(t=this.item.platforms)!=null&&t.toLowerCase().includes("xbox"))return"Game";if(a.includes("series")||a.includes("tv")||a.includes("episode")||this.item.isAiring)return"Series";if(a.includes("movie")||a.includes("film")||a.includes("cinema"))return"Movie";if(a.includes("book")||a.includes("literature")||a.includes("novel")||a.includes("author"))return"Bücher"}if(this.item.platforms){const a=this.item.platforms.toLowerCase();if(a.includes("steam")||a.includes("ps")||a.includes("xbox")||a.includes("nintendo")||a.includes("pc"))return"Game";if(a.includes("netflix")||a.includes("hulu")||a.includes("disney")||a.includes("hbo"))return"Series";if(a.includes("cinema")||a.includes("theater"))return"Movie";if(a.includes("book")||a.includes("kindle")||a.includes("audible")||a.includes("author"))return"Bücher"}return"Media"},getTypeTagClass(){return`type-${this.getTypeTagText().toLowerCase()}`},getNextSeasonCountdown(){if(!this.item.nextSeasonRelease)return"";const i=new Date(this.item.nextSeasonRelease),e=new Date;e.setHours(0,0,0,0),i.setHours(0,0,0,0);const s=i.getTime()-e.getTime(),t=Math.ceil(s/(1e3*3600*24));return t>0?t===1?"Tomorrow!":t<=7?`${t} days`:t<=30?`${t} days`:`${Math.ceil(t/30)} months`:t===0?"Today!":"Released"},getCategoryClass(){var e,s;const i=((e=this.item.category)==null?void 0:e.toLowerCase())||((s=this.item.category_name)==null?void 0:s.toLowerCase());return i==="movies"||i==="movie"?"category-movies":i==="books"||i==="buecher"||i==="book"?"category-books":i==="series"||i==="tv"||i==="serie"?"category-series":i==="games"||i==="game"||i==="spiele"?"category-games":i==="watchlist"?"category-watchlist":"category-default"},getCategoryIcon(){var e;const i=(e=this.item.category)==null?void 0:e.toLowerCase();return i==="movies"||i==="movie"?"🎬":i==="books"||i==="buecher"?"📚":i==="series"||i==="tv"?"📺":i==="games"||i==="game"?"🎮":"📁"},getCategoryStyle(){var e;const i=(e=this.item.category)==null?void 0:e.toLowerCase();if(i==="games"||i==="game"){const s=this.item.rating||0;return this.getGameStyleByRating(s)}return{}},getGameStyleByRating(i){return i>=4.5?{"--game-primary":"#ffd700","--game-secondary":"#ffed4e","--game-accent":"#ff6b35","--game-glow":"0 0 20px rgba(255, 215, 0, 0.6)","--game-border":"3px solid #ffd700"}:i>=4?{"--game-primary":"#00d4ff","--game-secondary":"#e8f4fd","--game-accent":"#00ff88","--game-glow":"0 0 15px rgba(0, 212, 255, 0.5)","--game-border":"3px solid #00d4ff"}:i>=3.5?{"--game-primary":"#00ff88","--game-secondary":"#4caf50","--game-accent":"#8bc34a","--game-glow":"0 0 12px rgba(0, 255, 136, 0.4)","--game-border":"3px solid #00ff88"}:i>=3?{"--game-primary":"#ff9800","--game-secondary":"#ffc107","--game-accent":"#ff5722","--game-glow":"0 0 10px rgba(255, 152, 0, 0.3)","--game-border":"3px solid #ff9800"}:i>=2?{"--game-primary":"#ff5722","--game-secondary":"#f44336","--game-accent":"#d32f2f","--game-glow":"0 0 8px rgba(255, 87, 34, 0.3)","--game-border":"3px solid #ff5722"}:{"--game-primary":"#9e9e9e","--game-secondary":"#757575","--game-accent":"#616161","--game-glow":"0 0 5px rgba(158, 158, 158, 0.2)","--game-border":"3px solid #9e9e9e"}}}},Xt={class:"media-image"},$t=["src","alt"],eo={key:1,class:"no-image"},to={class:"no-image-icon"},oo={class:"media-info"},so={class:"media-title"},ao={class:"media-meta"},no={key:0,class:"media-release"},io={key:1},ro={key:1,class:"media-rating"},lo={key:0,class:"media-platforms"},co={key:1,class:"media-genre"},uo={key:2,class:"media-description"},go={key:3,class:"media-airing"},mo={key:0,class:"next-season"},fo={key:1,class:"countdown"},po={key:4,class:"watchlist-type-tag"};function vo(i,e,s,t,a,d){return g(),m("div",{class:Q(["media-item",d.getCategoryClass()]),style:Ae(d.getCategoryStyle()),onClick:e[2]||(e[2]=(...r)=>d.editItem&&d.editItem(...r))},[o("div",Xt,[s.item.image_url||s.item.path?(g(),m("img",{key:0,src:d.getImageUrl(s.item.image_url||s.item.path),alt:s.item.title,onError:e[0]||(e[0]=(...r)=>d.handleImageError&&d.handleImageError(...r))},null,40,$t)):(g(),m("div",eo,[o("span",to,v(d.getCategoryIcon()),1)]))]),o("div",oo,[o("h3",so,v(s.item.title),1),o("div",ao,[s.item.release?(g(),m("span",no,[d.isWatchlistItem&&s.item.release?(g(),m("span",{key:0,class:Q(d.getWatchlistReleaseStatusClass())},v(d.getWatchlistReleaseStatus()),3)):(g(),m("span",io,v(d.formatDate(s.item.release)),1))])):b("",!0),s.item.rating?(g(),m("span",ro,v("★".repeat(Math.max(0,Math.min(5,Math.floor(s.item.rating)))))+v("☆".repeat(Math.max(0,5-Math.max(0,Math.min(5,Math.floor(s.item.rating)))))),1)):b("",!0)]),s.item.platforms?(g(),m("div",lo,v(s.item.platforms),1)):b("",!0),s.item.genre?(g(),m("div",co,v(s.item.genre),1)):b("",!0),s.item.description?(g(),m("div",uo,v(s.item.description),1)):b("",!0),s.item.isAiring?(g(),m("div",go,[e[3]||(e[3]=o("span",{class:"airing-badge"},[o("span",{class:"airing-dot"}),xe(" Airing ")],-1)),s.item.nextSeason?(g(),m("span",mo,"S"+v(s.item.nextSeason),1)):b("",!0),s.item.nextSeasonRelease?(g(),m("span",fo,v(d.getNextSeasonCountdown()),1)):b("",!0)])):b("",!0),d.showWatchlistTag?(g(),m("div",po,[o("span",{class:Q(["type-tag",d.getTypeTagClass()])},v(d.getTypeTagText()),3)])):b("",!0)]),d.isSeries&&s.item.extra_link?(g(),m("div",{key:0,class:"series-extra-button",onClick:e[1]||(e[1]=de((...r)=>d.openExtraLink&&d.openExtraLink(...r),["stop"]))},[...e[4]||(e[4]=[o("span",{class:"extra-link-icon"},"🔗",-1),o("span",{class:"extra-link-text"},"Extra Link",-1)])])):b("",!0),e[5]||(e[5]=o("div",{class:"edit-indicator"},[o("span",{class:"edit-icon"},"✏️")],-1))],6)}const ho=ae(Zt,[["render",vo],["__scopeId","data-v-d7f53299"]]),yo={name:"VersionInfo",data(){return{version:"1.0.0"}}},bo={class:"version-info"},ko={class:"version-label"};function wo(i,e,s,t,a,d){return g(),m("div",bo,[o("span",ko,"Build #"+v(a.version),1)])}const So=ae(yo,[["render",wo],["__scopeId","data-v-2d54e3c7"]]),Io={name:"Sidebar",components:{VersionInfo:So},props:{collapsed:{type:Boolean,default:!1},mobileOpen:{type:Boolean,default:!1},isLoggedIn:{type:Boolean,default:!1},userName:{type:String,default:""},currentCategory:{type:String,default:"watchlist"},categoryCounts:{type:Object,default:()=>({})},categories:{type:Array,default:()=>[{key:"game",name:"Games",icon:"🎮"},{key:"series",name:"Series",icon:"📺"},{key:"movie",name:"Movies",icon:"🎬"},{key:"buecher",name:"Bücher",icon:"📚"},{key:"watchlist",name:"Watchlist",icon:"❤️"}]},selectedGenres:{type:Array,default:()=>[]},genres:{type:Array,default:()=>[]},genreLoading:{type:Boolean,default:!1},genreError:{type:String,default:null}},emits:["toggle","setCategory","addItem","navigateToCalendar","navigateToProfile","showLogin","showRegister","logout","genres-updated","genres-cleared","load-genres"],computed:{showGenreSection(){return this.currentCategory&&this.currentCategory!=="statistics"&&this.currentCategory!=="calendar"&&this.currentCategory!=="profile"}},methods:{toggleGenre(i){const e=[...this.selectedGenres],s=e.indexOf(i);s>-1?e.splice(s,1):e.push(i),this.$emit("genres-updated",e)},clearGenreFilter(){this.$emit("genres-cleared")},loadGenres(){this.$emit("load-genres")}}},_o={class:"sidebar-content"},Co={class:"sidebar-section"},Do={class:"sidebar-nav"},Uo=["onClick"],xo={class:"nav-icon"},Ao={class:"nav-text"},To={class:"nav-count"},Mo=["onClick","title"],Bo={key:0,class:"sidebar-section"},Eo={key:0,class:"genre-loading"},Ro={key:1,class:"genre-error"},Po={key:2,class:"genre-empty"},Lo={key:3,class:"genre-list"},Go=["title"],Fo={class:"genre-checkbox-label"},No=["value","checked","onChange"],Wo={class:"genre-checkbox-text"},Vo={class:"genre-name"},Oo={class:"genre-count"},zo={class:"sidebar-section"},jo={key:0,class:"auth-buttons"},Yo={key:1,class:"user-info"},qo={class:"user-profile"},Ho={class:"profile-details"},Qo={class:"user-name"};function Jo(i,e,s,t,a,d){const r=ne("VersionInfo");return g(),m("aside",{id:"sidebar",class:Q(["sidebar",{collapsed:s.collapsed,open:s.mobileOpen}])},[o("div",{class:"sidebar-header",onClick:e[0]||(e[0]=l=>i.$emit("toggle"))},[...e[10]||(e[10]=[o("h2",null,"Media Library",-1),o("button",{class:"sidebar-toggle"},"☰",-1)])]),o("div",_o,[o("div",Co,[e[15]||(e[15]=o("h3",null,"Browse",-1)),o("nav",Do,[(g(!0),m(oe,null,se(s.categories,l=>(g(),m("div",{key:l.key,class:"nav-item"},[o("button",{class:Q(["nav-btn",{active:s.currentCategory===l.key}]),onClick:f=>i.$emit("setCategory",l.key)},[o("span",xo,v(l.icon),1),o("span",Ao,v(l.name),1),o("span",To,v(s.categoryCounts[l.key]||0),1)],10,Uo),o("button",{class:"add-btn",onClick:f=>i.$emit("addItem",l.key),title:`Add ${l.name}`},[...e[11]||(e[11]=[o("span",{class:"add-icon"},"+",-1)])],8,Mo)]))),128)),o("button",{class:Q(["nav-btn",{active:s.currentCategory==="statistics"}]),onClick:e[1]||(e[1]=l=>i.$emit("setCategory","statistics"))},[...e[12]||(e[12]=[o("span",{class:"nav-icon"},"📊",-1),o("span",{class:"nav-text"},"Statistics",-1)])],2),o("button",{class:Q(["nav-btn",{active:s.currentCategory==="calendar"}]),onClick:e[2]||(e[2]=l=>i.$emit("setCategory","calendar"))},[...e[13]||(e[13]=[o("span",{class:"nav-icon"},"📅",-1),o("span",{class:"nav-text"},"Calendar",-1)])],2),o("button",{class:Q(["nav-btn",{active:s.currentCategory==="profile"}]),onClick:e[3]||(e[3]=l=>i.$emit("setCategory","profile"))},[...e[14]||(e[14]=[o("span",{class:"nav-icon"},"👤",-1),o("span",{class:"nav-text"},"Profile",-1)])],2)])]),d.showGenreSection?(g(),m("div",Bo,[e[19]||(e[19]=o("h3",null,"Genres",-1)),s.genreLoading?(g(),m("div",Eo,[...e[16]||(e[16]=[o("div",{class:"loading-spinner"},null,-1),o("span",null,"Loading genres...",-1)])])):s.genreError?(g(),m("div",Ro,[e[17]||(e[17]=o("span",null,"Failed to load genres",-1)),o("button",{onClick:e[4]||(e[4]=(...l)=>d.loadGenres&&d.loadGenres(...l)),class:"retry-btn"},"Retry")])):s.genres.length===0?(g(),m("div",Po,[...e[18]||(e[18]=[o("span",null,"No genres available",-1)])])):(g(),m("div",Lo,[(g(!0),m(oe,null,se(s.genres,l=>(g(),m("div",{key:l.name,class:"genre-checkbox-item",title:`${l.name} (${l.count} items)`},[o("label",Fo,[o("input",{type:"checkbox",value:l.name,checked:s.selectedGenres.includes(l.name),onChange:f=>d.toggleGenre(l.name),class:"genre-checkbox"},null,40,No),o("span",Wo,[o("span",Vo,v(l.name),1),o("span",Oo,v(l.count),1)])])],8,Go))),128)),s.selectedGenres.length>0?(g(),m("button",{key:0,class:"clear-genre-btn",onClick:e[5]||(e[5]=(...l)=>d.clearGenreFilter&&d.clearGenreFilter(...l)),title:"Clear all genre filters"}," Clear All Filters ("+v(s.selectedGenres.length)+") ",1)):b("",!0)]))])):b("",!0),o("div",zo,[e[21]||(e[21]=o("h3",null,"Account",-1)),s.isLoggedIn?(g(),m("div",Yo,[o("div",qo,[e[20]||(e[20]=o("div",{class:"profile-avatar"},[o("span",{class:"avatar-text"},"👤")],-1)),o("div",Ho,[o("span",Qo,v(s.userName),1)]),o("button",{class:"account-btn",onClick:e[8]||(e[8]=l=>i.$emit("navigateToProfile"))},"⚙️")]),o("button",{class:"auth-btn",onClick:e[9]||(e[9]=l=>i.$emit("logout"))},"Logout")])):(g(),m("div",jo,[o("button",{class:"auth-btn",onClick:e[6]||(e[6]=l=>i.$emit("showLogin"))},"Login"),o("button",{class:"auth-btn",onClick:e[7]||(e[7]=l=>i.$emit("showRegister"))},"Register")]))])]),ye(r)],2)}const Ko=ae(Io,[["render",Jo],["__scopeId","data-v-23b04853"]]),Zo={name:"MainHeader",props:{searchQuery:{type:String,default:""},sortBy:{type:String,default:"order_asc"}},emits:["update:searchQuery","update:sortBy","toggleMobileSidebar","clearSearch"]},Xo={class:"main-header"},$o={class:"header-left"},es={class:"header-center"},ts={class:"search-container"},os=["value"],ss={class:"header-right"},as={class:"sort-container"},ns=["value"];function is(i,e,s,t,a,d){return g(),m("header",Xo,[o("div",$o,[o("button",{class:"mobile-sidebar-toggle",onClick:e[0]||(e[0]=r=>i.$emit("toggleMobileSidebar"))},"☰")]),o("div",es,[o("div",ts,[o("input",{type:"text",value:s.searchQuery,onInput:e[1]||(e[1]=r=>i.$emit("update:searchQuery",r.target.value)),placeholder:"Search..."},null,40,os),o("button",{class:"search-clear",onClick:e[2]||(e[2]=r=>i.$emit("clearSearch"))},"×")])]),o("div",ss,[o("div",as,[o("select",{value:s.sortBy,onChange:e[3]||(e[3]=r=>i.$emit("update:sortBy",r.target.value))},[...e[4]||(e[4]=[Ve('<option value="order_asc" data-v-8aca1f2e>Original order ↑</option><option value="order_desc" data-v-8aca1f2e>Original order ↓</option><option value="title_asc" data-v-8aca1f2e>Title A-Z</option><option value="title_desc" data-v-8aca1f2e>Title Z-A</option><option value="release_asc" data-v-8aca1f2e>Release ↑</option><option value="release_desc" data-v-8aca1f2e>Release ↓</option><option value="api_rating_asc" data-v-8aca1f2e>API Rating ↑</option><option value="api_rating_desc" data-v-8aca1f2e>API Rating ↓</option><option value="personal_rating_asc" data-v-8aca1f2e>Personal Rating ↑</option><option value="personal_rating_desc" data-v-8aca1f2e>Personal Rating ↓</option><option value="airing_desc" data-v-8aca1f2e>Airing first</option><option value="airing_asc" data-v-8aca1f2e>Finished first</option>',12)])],40,ns)])])])}const rs=ae(Zo,[["render",is],["__scopeId","data-v-8aca1f2e"]]),ls={name:"FloatingActionButton",props:{showMenu:{type:Boolean,default:!1},showDeleteAll:{type:Boolean,default:!1},categoryName:{type:String,default:""},itemCount:{type:Number,default:0}},emits:["toggleMenu","addNewItem","bulkAddItems","importFromTxt","importFromAPI","createCollection","deleteAllInCategory"]},ds={class:"floating-actions"},cs={class:"menu-text"},us={class:"item-count-badge"};function gs(i,e,s,t,a,d){return g(),m("div",ds,[o("div",{class:Q(["floating-menu",{show:s.showMenu}])},[o("button",{class:"floating-menu-item",onClick:e[0]||(e[0]=r=>i.$emit("addNewItem"))},[...e[7]||(e[7]=[o("span",{class:"menu-icon"},"➕",-1),o("span",{class:"menu-text"},"Add Item",-1)])]),o("button",{class:"floating-menu-item",onClick:e[1]||(e[1]=r=>i.$emit("bulkAddItems"))},[...e[8]||(e[8]=[o("span",{class:"menu-icon"},"📦",-1),o("span",{class:"menu-text"},"Bulk Add",-1)])]),o("button",{class:"floating-menu-item",onClick:e[2]||(e[2]=r=>i.$emit("importFromTxt"))},[...e[9]||(e[9]=[o("span",{class:"menu-icon"},"📄",-1),o("span",{class:"menu-text"},"Import from TXT",-1)])]),o("button",{class:"floating-menu-item",onClick:e[3]||(e[3]=r=>i.$emit("importFromAPI"))},[...e[10]||(e[10]=[o("span",{class:"menu-icon"},"🌐",-1),o("span",{class:"menu-text"},"Import from API",-1)])]),o("button",{class:"floating-menu-item",onClick:e[4]||(e[4]=r=>i.$emit("createCollection"))},[...e[11]||(e[11]=[o("span",{class:"menu-icon"},"📚",-1),o("span",{class:"menu-text"},"Create Collection",-1)])]),s.showDeleteAll&&s.itemCount>0?(g(),m("button",{key:0,class:"floating-menu-item delete-all-item",onClick:e[5]||(e[5]=r=>i.$emit("deleteAllInCategory"))},[e[12]||(e[12]=o("span",{class:"menu-icon"},"🗑️",-1)),o("span",cs,"Delete All "+v(s.categoryName),1),o("span",us,"("+v(s.itemCount)+")",1)])):b("",!0)],2),o("button",{class:"floating-add-btn",onClick:e[6]||(e[6]=r=>i.$emit("toggleMenu"))},v(s.showMenu?"✕":"+"),1)])}const ms=ae(ls,[["render",gs],["__scopeId","data-v-f77e6366"]]),fs={name:"LoginModal",emits:["close","success"],setup(i,{emit:e}){const s=Oe(),t=Te({email:"",password:""}),a=k(!1),d=k("");return{form:t,loading:a,error:d,handleLogin:async()=>{a.value=!0,d.value="";try{const D=await s.login(t.email,t.password);D.success?e("success",D):d.value=D.error}catch(D){d.value=D.message||"Login failed"}finally{a.value=!1}},closeModal:()=>{e("close")},checkLocalDB:async()=>{try{const _=await(await fetch("http://127.0.0.1:8000/api/check-db")).json();alert(`Local DB: ${_.success?"✅ Connected":"❌ Error"}
Users: ${_.user_count}
Error: ${_.error||"None"}`)}catch(D){alert(`Local DB Check Failed: ${D.message}`)}},checkProdDB:async()=>{try{const D=window.location.origin,w=await(await fetch(`${D}/api/check-db`)).json();alert(`Prod DB: ${w.success?"✅ Connected":"❌ Error"}
Users: ${w.user_count}
Error: ${w.error||"None"}`)}catch(D){alert(`Prod DB Check Failed: ${D.message}`)}},deleteAllUsers:async()=>{if(confirm("⚠️ WARNING: This will delete ALL users! Are you sure?"))try{const D=window.location.origin,w=await(await fetch(`${D}/api/delete-all-users`,{method:"POST",headers:{"Content-Type":"application/json"}})).json();alert(`Delete Result: ${w.success?"✅ Success":"❌ Error"}
Deleted: ${w.deleted_count} users
Error: ${w.error||"None"}`)}catch(D){alert(`Delete Failed: ${D.message}`)}}}}},ps={class:"form-group"},vs=["disabled"],hs={class:"form-group"},ys=["disabled"],bs={key:0,class:"error-message"},ks={class:"modal-buttons"},ws=["disabled"],Ss=["disabled"];function Is(i,e,s,t,a,d){return g(),m("div",{class:"modal",onClick:e[5]||(e[5]=(...r)=>t.closeModal&&t.closeModal(...r))},[o("div",{class:"modal-content auth-modal",onClick:e[4]||(e[4]=de(()=>{},["stop"]))},[e[8]||(e[8]=o("h2",null,"Login",-1)),o("form",{onSubmit:e[3]||(e[3]=de((...r)=>t.handleLogin&&t.handleLogin(...r),["prevent"]))},[o("div",ps,[e[6]||(e[6]=o("label",{for:"email"},"Email:",-1)),x(o("input",{type:"email",id:"email","onUpdate:modelValue":e[0]||(e[0]=r=>t.form.email=r),required:"",disabled:t.loading},null,8,vs),[[L,t.form.email]])]),o("div",hs,[e[7]||(e[7]=o("label",{for:"password"},"Password:",-1)),x(o("input",{type:"password",id:"password","onUpdate:modelValue":e[1]||(e[1]=r=>t.form.password=r),required:"",disabled:t.loading},null,8,ys),[[L,t.form.password]])]),t.error?(g(),m("div",bs,v(t.error),1)):b("",!0),o("div",ks,[o("button",{type:"submit",disabled:t.loading},v(t.loading?"Logging in...":"Login"),9,ws),o("button",{type:"button",onClick:e[2]||(e[2]=(...r)=>t.closeModal&&t.closeModal(...r)),disabled:t.loading}," Cancel ",8,Ss)])],32)])])}const _s=ae(fs,[["render",Is],["__scopeId","data-v-64f3b00b"]]),Cs={name:"RegisterModal",emits:["close","success"],setup(i,{emit:e}){const s=Oe(),t=Te({name:"",username:"",email:"",password:"",passwordConfirm:""}),a=k(!1),d=k(""),r=W(()=>t.name&&t.username&&t.email&&t.password&&t.passwordConfirm&&t.password===t.passwordConfirm&&t.password.length>=8);return{form:t,loading:a,error:d,isFormValid:r,handleRegister:async()=>{if(!r.value){d.value="Please fill in all fields and ensure passwords match";return}a.value=!0,d.value="";try{const c=await s.register(t.name,t.username,t.email,t.password,t.passwordConfirm);c.success?e("success"):d.value=c.error}catch(c){d.value=c.message||"Registration failed"}finally{a.value=!1}},closeModal:()=>{e("close")}}}},Ds={class:"form-group"},Us=["disabled"],xs={class:"form-group"},As=["disabled"],Ts={class:"form-group"},Ms=["disabled"],Bs={class:"form-group"},Es=["disabled"],Rs={class:"form-group"},Ps=["disabled"],Ls={key:0,class:"error-message"},Gs={class:"modal-buttons"},Fs=["disabled"],Ns=["disabled"];function Ws(i,e,s,t,a,d){return g(),m("div",{class:"modal",onClick:e[8]||(e[8]=(...r)=>t.closeModal&&t.closeModal(...r))},[o("div",{class:"modal-content auth-modal",onClick:e[7]||(e[7]=de(()=>{},["stop"]))},[e[14]||(e[14]=o("h2",null,"Register",-1)),o("form",{onSubmit:e[6]||(e[6]=de((...r)=>t.handleRegister&&t.handleRegister(...r),["prevent"]))},[o("div",Ds,[e[9]||(e[9]=o("label",{for:"name"},"Name:",-1)),x(o("input",{type:"text",id:"name","onUpdate:modelValue":e[0]||(e[0]=r=>t.form.name=r),required:"",disabled:t.loading},null,8,Us),[[L,t.form.name]])]),o("div",xs,[e[10]||(e[10]=o("label",{for:"username"},"Username:",-1)),x(o("input",{type:"text",id:"username","onUpdate:modelValue":e[1]||(e[1]=r=>t.form.username=r),required:"",disabled:t.loading},null,8,As),[[L,t.form.username]])]),o("div",Ts,[e[11]||(e[11]=o("label",{for:"email"},"Email:",-1)),x(o("input",{type:"email",id:"email","onUpdate:modelValue":e[2]||(e[2]=r=>t.form.email=r),required:"",disabled:t.loading},null,8,Ms),[[L,t.form.email]])]),o("div",Bs,[e[12]||(e[12]=o("label",{for:"password"},"Password:",-1)),x(o("input",{type:"password",id:"password","onUpdate:modelValue":e[3]||(e[3]=r=>t.form.password=r),required:"",minlength:"8",disabled:t.loading},null,8,Es),[[L,t.form.password]])]),o("div",Rs,[e[13]||(e[13]=o("label",{for:"passwordConfirm"},"Confirm Password:",-1)),x(o("input",{type:"password",id:"passwordConfirm","onUpdate:modelValue":e[4]||(e[4]=r=>t.form.passwordConfirm=r),required:"",minlength:"8",disabled:t.loading},null,8,Ps),[[L,t.form.passwordConfirm]])]),t.error?(g(),m("div",Ls,v(t.error),1)):b("",!0),o("div",Gs,[o("button",{type:"submit",disabled:t.loading||!t.isFormValid},v(t.loading?"Registering...":"Register"),9,Fs),o("button",{type:"button",onClick:e[5]||(e[5]=(...r)=>t.closeModal&&t.closeModal(...r)),disabled:t.loading}," Cancel ",8,Ns)])],32)])])}const Vs=ae(Cs,[["render",Ws],["__scopeId","data-v-eec5201a"]]),rt="http://127.0.0.1:8000/api",Os={async getConfig(){try{const i=await fetch(`${rt}/google-books-config`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);return await i.json()}catch(i){throw console.error("Simple Google Books - Config failed:",i),i}},async searchBooks(i,e=10){try{const s=await fetch(`${rt}/google-books/search?q=${encodeURIComponent(i)}&maxResults=${e}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);return await s.json()}catch(s){throw console.error("Simple Google Books - Search failed:",s),s}}},zs=!1,js=!0,Ys="production",qs={production:{apiUrl:"https://teabubble.attrebi.ch",apiBaseUrl:"https://teabubble.attrebi.ch/api",googleBooksUrl:"https://teabubble.attrebi.ch/api/google-books",debug:!1}};function Hs(){return qs.production}const We=Hs();We.debug&&console.log("🔧 Environment Configuration:",{mode:Ys,isDevelopment:zs,isProduction:js,apiUrl:We.apiUrl,apiBaseUrl:We.apiBaseUrl,googleBooksUrl:We.googleBooksUrl});class Qs{constructor(){this.baseUrl="https://en.wikipedia.org/w/api.php",this.timeout=1e4,this.maxResults=10}async searchBooks(e,s=10){if(!e||typeof e!="string"||e.trim().length===0)return console.warn("📚 [Wikipedia] Invalid query provided"),{success:!1,error:"Search query is required",data:[]};try{const t=await this.searchPages(e,s);if(!t.success||t.data.length===0)return{success:!1,error:"No results found",data:[]};const a=await this.getPageDetails(t.data),d=this.filterAndFormatBookResults(a);return console.log("📚 [Wikipedia] Search completed:",{totalResults:a.length,bookResults:d.length}),{success:!0,data:d,source:"wikipedia"}}catch(t){return console.error("📚 [Wikipedia] Search failed:",t),{success:!1,error:`Search failed: ${t.message}`,data:[]}}}async searchPages(e,s){var a;const t=new URLSearchParams({action:"query",format:"json",list:"search",srsearch:`${e} book novel`,srnamespace:0,srlimit:s,srprop:"snippet|timestamp",origin:"*"});try{const d=await fetch(`${this.baseUrl}?${t}`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout)});if(!d.ok)throw new Error(`HTTP ${d.status}: ${d.statusText}`);const r=await d.json();if(r.error)throw new Error(r.error.info||"Wikipedia API error");return{success:!0,data:(((a=r.query)==null?void 0:a.search)||[]).map(f=>({pageid:f.pageid,title:f.title,snippet:f.snippet,timestamp:f.timestamp}))}}catch(d){return console.error("📚 [Wikipedia] Page search failed:",d),{success:!1,error:d.message,data:[]}}}async getPageDetails(e){var a;if(!e||e.length===0)return[];const s=e.map(d=>d.pageid).join("|"),t=new URLSearchParams({action:"query",format:"json",pageids:s,prop:"extracts|pageimages|info",exintro:"true",explaintext:"true",exsectionformat:"plain",piprop:"thumbnail|original",pithumbsize:300,pilimit:1,inprop:"url",origin:"*"});try{const d=await fetch(`${this.baseUrl}?${t}`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout)});if(!d.ok)throw new Error(`HTTP ${d.status}: ${d.statusText}`);const r=await d.json();if(r.error)throw new Error(r.error.info||"Wikipedia API error");const l=((a=r.query)==null?void 0:a.pages)||{};return Object.values(l).map(f=>{var c;return{pageid:f.pageid,title:f.title,extract:f.extract||"",thumbnail:((c=f.thumbnail)==null?void 0:c.source)||null,fullurl:f.fullurl||null,canonicalurl:f.canonicalurl||null}})}catch(d){return console.error("📚 [Wikipedia] Page details failed:",d),[]}}filterAndFormatBookResults(e){const s=["book","novel","fiction","non-fiction","author","published","publisher","isbn","literature","story","chapter","edition","written by","series","trilogy","saga","collection","anthology"];return e.filter(t=>{const a=(t.extract||"").toLowerCase(),d=(t.title||"").toLowerCase(),r=s.some(c=>a.includes(c)||d.includes(c)),f=["book","novel","story","tale","chronicles","saga","trilogy"].some(c=>d.includes(c));return r||f}).map(t=>{const a=t.extract||"",d=t.title||"",r=a.match(/written by[^,.\n]*?([A-Z][^,.\n]*?[A-Z][^,.\n]*?)(?:\s|\.|,|$)/i),l=a.match(/(\d{4})/),f=a.match(/(?:published by|publisher)\s+([^,.\n]+)/i);let c="";if(r&&(c=r[1].trim().replace(/^(British|American|German|French|Spanish|Italian)\s+(?:author|writer|novelist)?\s*/i,""),c.includes("author")||c.includes("writer"))){const D=c.match(/([A-Z][^,.\n]*?[A-Z][^,.\n]*?)(?:\s|\.|,|$)/);c=D?D[1].trim():c}if(!c){const U=a.match(/(?:by|author|written by)\s+([A-Z][^,.\n]*?[A-Z][^,.\n]*?)(?:\s|\.|,|$)/i);U&&(c=U[1].trim().replace(/^(British|American|German|French|Spanish|Italian)\s+(?:author|writer|novelist)?\s*/i,""))}return{id:`wikipedia_${t.pageid}`,title:d,author:c,description:a.substring(0,300)+(a.length>300?"...":""),publishedDate:l?l[1]:"",publisher:f?f[1].trim():"",imageUrl:t.thumbnail||null,link:t.fullurl||t.canonicalurl||"",apiSource:"wikipedia",snippet:a.substring(0,150)+(a.length>150?"...":""),categories:this.extractCategories(a)}}).slice(0,this.maxResults)}extractCategories(e){const s=[],t=e.toLowerCase();return t.includes("fiction")&&s.push("Fiction"),(t.includes("non-fiction")||t.includes("nonfiction"))&&s.push("Non-Fiction"),t.includes("novel")&&s.push("Novel"),t.includes("biography")&&s.push("Biography"),t.includes("history")&&s.push("History"),t.includes("science")&&s.push("Science"),t.includes("philosophy")&&s.push("Philosophy"),t.includes("poetry")&&s.push("Poetry"),t.includes("drama")&&s.push("Drama"),t.includes("mystery")&&s.push("Mystery"),t.includes("romance")&&s.push("Romance"),t.includes("fantasy")&&s.push("Fantasy"),(t.includes("science fiction")||t.includes("sci-fi"))&&s.push("Science Fiction"),t.includes("thriller")&&s.push("Thriller"),t.includes("horror")&&s.push("Horror"),s}async getBookById(e){var s,t;try{const a=new URLSearchParams({action:"query",format:"json",pageids:e,prop:"extracts|pageimages|info",exintro:"true",explaintext:"true",piprop:"thumbnail",pithumbsize:300,inprop:"url",origin:"*"}),d=await fetch(`${this.baseUrl}?${a}`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout)});if(!d.ok)throw new Error(`HTTP ${d.status}: ${d.statusText}`);const r=await d.json(),l=Object.values(((s=r.query)==null?void 0:s.pages)||{})[0];if(!l)throw new Error("Page not found");return{success:!0,data:{id:`wikipedia_${l.pageid}`,title:l.title,description:l.extract||"",imageUrl:((t=l.thumbnail)==null?void 0:t.source)||null,link:l.fullurl||l.canonicalurl||"",apiSource:"wikipedia"}}}catch(a){return console.error("📚 [Wikipedia] Get book by ID failed:",a),{success:!1,error:a.message,data:null}}}}const Js=new Qs;class Ks{constructor(){this.wikipediaService=Js,this.googleBooksService=Os}getUserPreferences(){try{const e=localStorage.getItem("profileData");if(e){const s=JSON.parse(e);return{booksApiProvider:s.booksApiProvider||"wikipedia",enableGoogleBooksFallback:s.enableGoogleBooksFallback!==!1}}}catch(e){console.warn("Failed to load user preferences:",e)}return{booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}}async searchBooks(e,s=10){const t=this.getUserPreferences();if(!e||typeof e!="string"||e.trim().length===0)return{success:!1,error:"Search query is required",data:[]};try{let a=[],d="",r=!1;switch(t.booksApiProvider){case"wikipedia":a=await this.searchWithWikipediaFirst(e,s,t),d="wikipedia";break;case"google_books":a=await this.searchWithGoogleBooksFirst(e,s,t),d="google_books";break;case"both":a=await this.searchWithBothApis(e,s,t),d="both";break;default:a=await this.searchWithWikipediaFirst(e,s,t),d="wikipedia"}return{success:!0,data:a,source:d,fallbackUsed:r}}catch(a){return console.error("📚 [UnifiedBooks] Search failed:",a),{success:!1,error:`Search failed: ${a.message}`,data:[]}}}async searchWithWikipediaFirst(e,s,t){const a=await this.wikipediaService.searchBooks(e,s);if(a.success&&a.data.length>0)return a.data;if(t.enableGoogleBooksFallback){const d=await this.googleBooksService.searchBooks(e,s);if(d.success&&d.data.length>0)return d.data}return[]}async searchWithGoogleBooksFirst(e,s,t){const a=await this.googleBooksService.searchBooks(e,s);if(a.success&&a.data.length>0)return a.data;if(t.enableGoogleBooksFallback){const d=await this.wikipediaService.searchBooks(e,s);if(d.success&&d.data.length>0)return d.data}return[]}async searchWithBothApis(e,s,t){const[a,d]=await Promise.allSettled([this.wikipediaService.searchBooks(e,Math.ceil(s/2)),this.googleBooksService.searchBooks(e,Math.ceil(s/2))]);let r=[];return a.status==="fulfilled"&&a.value.success&&(r=r.concat(a.value.data)),d.status==="fulfilled"&&d.value.success&&(r=r.concat(d.value.data)),r=this.removeDuplicateResults(r),r=r.slice(0,s),r}removeDuplicateResults(e){const s=new Set,t=[];for(const a of e){const d=a.title.toLowerCase().replace(/[^\w\s]/g,"").trim();s.has(d)||(s.add(d),t.push(a))}return t}async getBookById(e){if(e.startsWith("wikipedia_")){const s=e.replace("wikipedia_","");return await this.wikipediaService.getBookById(s)}else return await this.googleBooksService.getBookById(e)}getApiStatus(){const e=this.getUserPreferences();return{primaryProvider:e.booksApiProvider,fallbackEnabled:e.enableGoogleBooksFallback,availableProviders:["wikipedia","google_books"],wikipediaAvailable:!0,googleBooksAvailable:!0}}}const Xe=new Ks,Zs={name:"BooksApiControlPanel",props:{expanded:{type:Boolean,default:!1}},emits:["preferences-changed"],setup(i,{emit:e}){const s=k(i.expanded),t=k(!1),a=k(null),d=k("checking"),r=Te({booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}),l=()=>{s.value=!s.value},f=()=>{try{const _=localStorage.getItem("profileData");if(_){const w=JSON.parse(_);r.booksApiProvider=w.booksApiProvider||"wikipedia",r.enableGoogleBooksFallback=w.enableGoogleBooksFallback!==!1}}catch(_){console.warn("Failed to load preferences:",_)}},c=()=>{try{const _=localStorage.getItem("profileData"),w=_?JSON.parse(_):{};w.booksApiProvider=r.booksApiProvider,w.enableGoogleBooksFallback=r.enableGoogleBooksFallback,localStorage.setItem("profileData",JSON.stringify(w)),e("preferences-changed",{...r})}catch(_){console.error("Failed to save preferences:",_)}},U=async()=>{t.value=!0,a.value=null;try{const _=await Xe.searchBooks("Harry Potter",3);_.success&&_.data.length>0?a.value={success:!0,message:`✅ Found ${_.data.length} results using ${_.source}`}:a.value={success:!1,message:`❌ No results found: ${_.error||"Unknown error"}`}}catch(_){a.value={success:!1,message:`❌ Test failed: ${_.message}`}}finally{t.value=!1}},D=async()=>{try{const _=await Xe.getApiStatus();d.value=_.googleBooksAvailable?"available":"unavailable"}catch{d.value="unavailable"}};return lt(()=>{f(),D()}),{isExpanded:s,localPreferences:r,testing:t,testResult:a,googleBooksStatus:d,toggleExpanded:l,updatePreferences:c,testSearch:U}}},Xs={class:"books-api-control-panel"},$s={class:"control-header"},ea={key:0,class:"control-content"},ta={class:"form-group"},oa={class:"form-group"},sa={class:"checkbox-container"},aa={class:"api-status"},na={class:"status-item"},ia={class:"search-preview"},ra=["disabled"];function la(i,e,s,t,a,d){return g(),m("div",Xs,[o("div",$s,[e[6]||(e[6]=o("h4",null,"📚 Books API Settings",-1)),o("button",{class:Q(["toggle-btn",{expanded:t.isExpanded}]),onClick:e[0]||(e[0]=(...r)=>t.toggleExpanded&&t.toggleExpanded(...r))},v(t.isExpanded?"▼":"▶"),3)]),t.isExpanded?(g(),m("div",ea,[o("div",ta,[e[8]||(e[8]=o("label",{for:"apiProvider"},"Primary API Provider:",-1)),x(o("select",{id:"apiProvider","onUpdate:modelValue":e[1]||(e[1]=r=>t.localPreferences.booksApiProvider=r),onChange:e[2]||(e[2]=(...r)=>t.updatePreferences&&t.updatePreferences(...r))},[...e[7]||(e[7]=[o("option",{value:"wikipedia"},"Wikipedia (Recommended)",-1),o("option",{value:"google_books"},"Google Books",-1),o("option",{value:"both"},"Both APIs",-1)])],544),[[be,t.localPreferences.booksApiProvider]]),e[9]||(e[9]=o("div",{class:"field-hint"}," Choose your primary source for book information ",-1))]),o("div",oa,[o("div",sa,[x(o("input",{type:"checkbox",id:"enableFallback","onUpdate:modelValue":e[3]||(e[3]=r=>t.localPreferences.enableGoogleBooksFallback=r),onChange:e[4]||(e[4]=(...r)=>t.updatePreferences&&t.updatePreferences(...r))},null,544),[[dt,t.localPreferences.enableGoogleBooksFallback]]),e[10]||(e[10]=o("label",{for:"enableFallback",class:"checkbox-label"}," Enable Google Books Fallback ",-1))]),e[11]||(e[11]=o("div",{class:"field-hint"}," Use Google Books when primary API fails ",-1))]),o("div",aa,[e[13]||(e[13]=o("div",{class:"status-item"},[o("span",{class:"status-label"},"Wikipedia:"),o("span",{class:"status-value available"},"✅ Available")],-1)),o("div",na,[e[12]||(e[12]=o("span",{class:"status-label"},"Google Books:",-1)),o("span",{class:Q(["status-value",t.googleBooksStatus])},v(t.googleBooksStatus==="available"?"✅ Available":"⚠️ Check API Key"),3)])]),o("div",ia,[o("button",{class:"test-search-btn",onClick:e[5]||(e[5]=(...r)=>t.testSearch&&t.testSearch(...r)),disabled:t.testing},v(t.testing?"Testing...":"Test Search"),9,ra),t.testResult?(g(),m("div",{key:0,class:Q(["test-result",t.testResult.success?"success":"error"])},v(t.testResult.message),3)):b("",!0)])])):b("",!0)])}const da=ae(Zs,[["render",la],["__scopeId","data-v-09652cba"]]),ca={name:"EditModal",components:{BooksApiControlPanel:da},props:{item:{type:Object,default:null},currentCategory:{type:String,default:"watchlist"}},emits:["close","save","delete"],setup(i,{emit:e}){const s=ze(),t=k(!1),a=k(""),d=k([]),r=k(null),l=k(null),f=k(""),c=Te({category:"watchlist",title:"",release:"",apiRating:"",personalRating:"",count:"",platforms:"",genre:"",description:"",link:"",extraLink:"",path:"",discovered:"",spielzeit:"",isAiring:!1,nextSeason:"",nextSeasonRelease:"",imageUrl:"",watchlistType:"",imageCleared:!1}),U=W(()=>!!i.item),D=W(()=>c.category==="game"),_=W(()=>c.category==="series"),w=W(()=>c.category==="watchlist");Ce(()=>i.item,n=>{n?(console.log("🔄 [DEBUG] Initializing form with item data:",n),n.watchlist_type!==void 0?c.watchlistType=n.watchlist_type||"":n.watchlistType!==void 0?c.watchlistType=n.watchlistType||"":c.watchlistType="",Object.keys(c).forEach(h=>{h!=="watchlistType"&&(c[h]=n[h]||"")}),n.is_airing!==void 0&&(c.isAiring=n.is_airing),n.next_season!==void 0&&(c.nextSeason=n.next_season),n.next_season_release!==void 0&&(c.nextSeasonRelease=n.next_season_release),n.api_rating!==void 0&&(c.apiRating=n.api_rating),n.personal_rating!==void 0&&(c.personalRating=n.personal_rating),n.description!==void 0&&(c.description=n.description),n.image_url!==void 0&&(c.imageUrl=n.image_url,console.log("🖼️ [DEBUG] Set form.imageUrl from item:",n.image_url)),n.path!==void 0&&(c.path=n.path,console.log("🖼️ [DEBUG] Set form.path from item:",n.path)),n.extra_link!==void 0&&(c.extraLink=n.extra_link),n.rating!==void 0&&!c.personalRating&&(c.personalRating=n.rating),console.log("🔄 [DEBUG] Form initialization completed:"),console.log("🔄 [DEBUG] - form.imageUrl:",c.imageUrl),console.log("🔄 [DEBUG] - form.path:",c.path),console.log("🔄 [DEBUG] - uploadedImagePath.value:",f.value)):(console.log("🔄 [DEBUG] Initializing new item form"),Object.keys(c).forEach(h=>{h==="category"?c[h]=i.currentCategory||"watchlist":h==="release"?c[h]=new Date().toISOString().split("T")[0]:h==="watchlistType"?c[h]=i.currentCategory==="watchlist"?"series":"":c[h]=""}),console.log("🔄 [DEBUG] New item form initialized:"),console.log("🔄 [DEBUG] - form.imageUrl:",c.imageUrl),console.log("🔄 [DEBUG] - form.path:",c.path),console.log("🔄 [DEBUG] - uploadedImagePath.value:",f.value))},{immediate:!0}),Ce(()=>i.currentCategory,n=>{!i.item&&n&&(c.category=n)});const J=async()=>{var n,h,I;if(!c.title){a.value="Title is required";return}if(c.category==="watchlist"&&!c.watchlistType){a.value="Please select a type for watchlist items";return}if(c.category==="watchlist"&&!c.release){a.value="Release date is required for watchlist items";return}t.value=!0,a.value="";try{const u={...c};Object.keys(u).forEach(y=>{u[y]===""&&y!=="watchlistType"&&y!=="imageUrl"&&y!=="path"&&y!=="extraLink"&&(u[y]=null)}),f.value?(u.path=f.value,u.imageUrl=f.value):u.imageUrl&&u.imageUrl.trim()?u.path=u.imageUrl:U.value&&i.item?i.item.image_url?(u.imageUrl=i.item.image_url,u.path=i.item.path||i.item.image_url):i.item.path&&(u.path=i.item.path,u.imageUrl=i.item.path):(u.imageUrl=null,u.path=null),u.apiRating!==void 0&&u.apiRating!==null&&u.apiRating!==""&&(u.apiRating=parseFloat(u.apiRating)),u.personalRating!==void 0&&u.personalRating!==null&&u.personalRating!==""&&(u.personalRating=parseFloat(u.personalRating)),u.count!==void 0&&u.count!==null&&u.count!==""&&(u.count=parseInt(u.count)),u.spielzeit!==void 0&&u.spielzeit!==null&&u.spielzeit!==""&&(u.spielzeit=parseInt(u.spielzeit)),u.nextSeason!==void 0&&u.nextSeason!==null&&u.nextSeason!==""&&(u.nextSeason=parseInt(u.nextSeason)),u.watchlistType!==void 0&&(u.watchlist_type=u.watchlistType||null,delete u.watchlistType),u.isAiring!==void 0&&(u.is_airing=u.isAiring,delete u.isAiring),u.nextSeason&&(u.next_season=u.nextSeason,delete u.nextSeason),u.nextSeasonRelease&&(u.next_season_release=u.nextSeasonRelease,delete u.nextSeasonRelease),u.personalRating!==void 0?(u.rating=u.personalRating,delete u.personalRating):u.apiRating!==void 0&&(u.rating=u.apiRating,delete u.apiRating),u.imageUrl&&(u.image_url=u.imageUrl,delete u.imageUrl),u.extraLink!==void 0&&(u.extra_link=u.extraLink,delete u.extraLink),U.value&&i.item?await s.updateMediaItem(i.item.id,u):await s.addMediaItem(u),Z()}catch(u){u.isDuplicate||((n=u.response)==null?void 0:n.status)===409&&((I=(h=u.response)==null?void 0:h.data)!=null&&I.duplicate)?a.value="Ein Eintrag mit diesem Titel und dieser Kategorie existiert bereits. Bitte wählen Sie einen anderen Titel oder bearbeiten Sie den bestehenden Eintrag.":a.value=u.message||"Failed to save item"}finally{t.value=!1}},Z=()=>{a.value="",e("close")},F=()=>{e("delete",i.item),Z()},le=async()=>{if(f.value){d.value=[];return}if(r.value&&clearTimeout(r.value),!c.title||c.title.length<3){d.value=[];return}r.value=setTimeout(async()=>{try{const n=c.category==="watchlist"?c.watchlistType:c.category;if(c.category==="watchlist"&&!c.watchlistType){d.value=[];return}let h=[],I=[];if(n==="buecher"){const u=await Xe.searchBooks(c.title,10);u.success&&u.data&&(I=u.data.map(y=>({title:y.title,release:y.publishedDate?p(y.publishedDate):"",genre:y.categories?y.categories.join(", "):"",platforms:y.author||"",link:y.link||"",imageUrl:y.imageUrl||"",rating:"",apiSource:y.apiSource||u.source,id:y.id,author:y.author,description:y.description,publisher:y.publisher,isbn10:y.isbn10,isbn13:y.isbn13})))}else h=await me.searchApi(c.title,n,10),h&&h.length>0&&(I=h.map(u=>({title:u.title,release:u.release,genre:u.genre||"",description:u.overview||"",platforms:u.platforms||"",link:u.link||"",imageUrl:u.image||"",rating:u.rating||"",apiSource:u.api_source||"",id:u.id||""})));I.length>0?d.value=I:d.value=[{title:`"${c.title}" - Keine Ergebnisse gefunden`,release:"",genre:"Bitte manuell ausfüllen",isPlaceholder:!0}]}catch{d.value=[{title:`"${c.title}" - API nicht verfügbar`,release:"",genre:"Bitte manuell ausfüllen",isPlaceholder:!0}]}},500)},fe=async n=>{if(n.isPlaceholder){d.value=[];return}if(c.title=n.title,n.release&&(c.release=n.release),n.platforms&&(c.platforms=n.platforms),n.genre&&(c.genre=n.genre),n.description&&(c.description=n.description),n.link&&(c.link=n.link),n.rating&&(c.apiRating=n.rating),(n.apiSource==="google_books"||n.apiSource==="wikipedia")&&(n.author&&(c.platforms=n.author),n.publisher)){const h=c.link||"";c.link=h||`Publisher: ${n.publisher}`}n.imageUrl?(c.imageUrl=n.imageUrl,c.path=n.imageUrl):(c.imageUrl="",c.path=""),d.value=[]},ce=n=>n?new Date(n).toLocaleDateString():"",p=n=>{if(!n)return"";let h;if(typeof n=="string"){if(/^\d{4}$/.test(n))return`${n}-01-01`;if(/^\d{4}-\d{2}$/.test(n))return`${n}-01`;if(/^\d{4}-\d{2}-\d{2}$/.test(n))return n;h=new Date(n)}else h=new Date(n);return isNaN(h.getTime())?"":h.toISOString().split("T")[0]},N=n=>n&&(n.startsWith("http://")?n.replace("http://","https://"):n),ie=()=>{var y;if(!c.release)return"";const n=new Date(c.release),h=new Date;h.setHours(0,0,0,0),n.setHours(0,0,0,0);const I=n.getTime()-h.getTime(),u=Math.ceil(I/(1e3*3600*24));if(u>0)return u===1?"Tomorrow!":u<=7?`${u} days left`:u<=30?`${u} days left`:`${Math.ceil(u/30)} months left`;if(u===0)return"Released today!";{const A=((y=c.watchlistType)==null?void 0:y.toLowerCase())||"media";return A==="game"?"Unplayed yet":A==="series"||A==="movie"?"Unwatched yet":"Unconsumed yet"}},re=()=>{var n;(n=l.value)==null||n.click()},ke=async n=>{var I;console.log("🖼️ [DEBUG] Image upload started");const h=n.target.files[0];if(!h){console.log("❌ [DEBUG] No file selected");return}if(console.log("📁 [DEBUG] File details:",{name:h.name,size:h.size,type:h.type,lastModified:h.lastModified}),!h.type.startsWith("image/")){console.log("❌ [DEBUG] Invalid file type:",h.type),a.value="Please select a valid image file";return}if(h.size>10*1024*1024){console.log("❌ [DEBUG] File too large:",h.size,"bytes"),a.value="Image file too large. Maximum size is 10MB";return}console.log("✅ [DEBUG] File validation passed"),t.value=!0,a.value="";try{const u=c.title.replace(/[^a-zA-Z0-9\s\-_\.]/g,"").trim()||"item",y=Date.now(),A=h.name.split(".").pop()||"jpg",te=`images_downloads/uploads/${u}_${y}.${A}`;console.log("🛤️ [DEBUG] Generated path:",te),console.log("📤 [DEBUG] Starting upload to API...");const j=await me.uploadImage(h,te);console.log("📥 [DEBUG] Upload response:",j),j.success?(console.log("✅ [DEBUG] Upload successful, saved path:",j.saved),f.value=j.saved,c.path=j.saved,c.imageUrl=j.saved,console.log("🔗 [DEBUG] Image URL set to:",c.imageUrl)):(console.log("❌ [DEBUG] Upload failed:",j.error),a.value=j.error||"Failed to upload image")}catch(u){console.log("💥 [DEBUG] Upload error:",u),console.log("💥 [DEBUG] Error details:",{message:u.message,stack:u.stack,response:(I=u.response)==null?void 0:I.data}),a.value=u.message||"Failed to upload image"}finally{t.value=!1,console.log("🏁 [DEBUG] Upload process completed")}},ue=()=>{if(console.log("🔍 [DEBUG] Getting image preview URL..."),console.log("🔍 [DEBUG] uploadedImagePath.value:",f.value),console.log("🔍 [DEBUG] form.imageUrl:",c.imageUrl),console.log("🔍 [DEBUG] Template condition (form.imageUrl || uploadedImagePath):",!!(c.imageUrl||f.value)),f.value){if(console.log("🔍 [DEBUG] Using uploadedImagePath.value for URL generation"),f.value.startsWith("storage/")){const h=`/${f.value}`;return console.log("🔗 [DEBUG] Generated URL (starts with storage/):",h),h}const n=`/${f.value}`;return console.log("🔗 [DEBUG] Generated URL (using API route):",n),n}if(c.imageUrl){if(console.log("🔍 [DEBUG] Using form.imageUrl for URL generation"),c.imageUrl.startsWith("http"))return console.log("🔗 [DEBUG] Using external URL:",c.imageUrl),c.imageUrl;if(c.imageUrl.startsWith("storage/")){const h=`/${c.imageUrl}`;return console.log("🔗 [DEBUG] Generated URL from form.imageUrl (starts with storage/):",h),h}const n=`/${c.imageUrl}`;return console.log("🔗 [DEBUG] Generated URL from form.imageUrl (using API route):",n),n}return console.log("❌ [DEBUG] No image URL available"),""},we=n=>{console.log("❌ [DEBUG] Image load error occurred"),console.log("❌ [DEBUG] Error event:",n),console.log("❌ [DEBUG] Error target:",n.target),console.log("❌ [DEBUG] Error target src:",n.target.src),console.log("❌ [DEBUG] Error target alt:",n.target.alt),console.log("❌ [DEBUG] Current image URL:",ue()),console.log("❌ [DEBUG] uploadedImagePath.value:",f.value),console.log("❌ [DEBUG] form.imageUrl:",c.imageUrl),n.target.style.display="none",a.value="Failed to load image: "+n.target.src},Se=n=>{console.log("✅ [DEBUG] Image loaded successfully"),console.log("✅ [DEBUG] Load event:",n),console.log("✅ [DEBUG] Load target:",n.target),console.log("✅ [DEBUG] Load target src:",n.target.src),console.log("✅ [DEBUG] Load target naturalWidth:",n.target.naturalWidth),console.log("✅ [DEBUG] Load target naturalHeight:",n.target.naturalHeight),console.log("✅ [DEBUG] Load target complete:",n.target.complete),a.value&&a.value.includes("Failed to load image")&&(a.value="")},X=n=>{console.log("🔄 [DEBUG] Image load started"),console.log("🔄 [DEBUG] Load start event:",n),console.log("🔄 [DEBUG] Load start target src:",n.target.src),console.log("🔄 [DEBUG] Current time:",new Date().toISOString())},V=n=>{console.log("🏁 [DEBUG] Image load ended"),console.log("🏁 [DEBUG] Load end event:",n),console.log("🏁 [DEBUG] Load end target src:",n.target.src),console.log("🏁 [DEBUG] Load end target complete:",n.target.complete),console.log("🏁 [DEBUG] Current time:",new Date().toISOString())},Y=()=>{c.imageUrl="",c.path="",f.value="",l.value&&(l.value.value="")},H=()=>{console.log("🗑️ [DEBUG] Removing uploaded image"),console.log("🗑️ [DEBUG] Before removal - uploadedImagePath.value:",f.value),console.log("🗑️ [DEBUG] Before removal - form.imageUrl:",c.imageUrl),console.log("🗑️ [DEBUG] Before removal - form.path:",c.path),f.value="",c.imageUrl===f.value&&(c.imageUrl=""),c.path===f.value&&(c.path=""),l.value&&(l.value.value=""),console.log("🗑️ [DEBUG] After removal - uploadedImagePath.value:",f.value),console.log("🗑️ [DEBUG] After removal - form.imageUrl:",c.imageUrl),console.log("🗑️ [DEBUG] After removal - form.path:",c.path)},pe=W(()=>{const n=!!(c.imageUrl||f.value);return console.log("🎭 [DEBUG] Template condition check:"),console.log("🎭 [DEBUG] - form.imageUrl:",c.imageUrl),console.log("🎭 [DEBUG] - uploadedImagePath.value:",f.value),console.log("🎭 [DEBUG] - shouldShowImagePreview:",n),n});return{form:c,loading:t,error:a,apiResults:d,isEditing:U,isGame:D,isSeries:_,isWatchlist:w,imageUploadRef:l,uploadedImagePath:f,handleSave:J,closeModal:Z,deleteItem:F,searchApi:le,selectApiResult:fe,formatDate:ce,formatDateForInput:p,ensureHttpsUrl:N,getReleasePreview:ie,triggerImageUpload:re,handleImageUpload:ke,getImagePreviewUrl:ue,handleImageError:we,handleImageLoad:Se,handleImageLoadStart:X,handleImageLoadEnd:V,clearImage:Y,removeUploadedImage:H,shouldShowImagePreview:pe,handlePreferencesChanged:n=>{d.value=[]}}}},ua={class:"form-header"},ga={class:"form-group category-group"},ma={class:"form-group title-group"},fa={class:"search-container"},pa=["placeholder","disabled"],va={key:0,class:"search-results"},ha=["onClick"],ya={class:"result-thumbnail"},ba=["src","alt"],ka={key:1,class:"no-image"},wa={class:"result-content"},Sa={class:"result-title"},Ia={class:"result-meta"},_a={key:0},Ca={key:1},Da={key:2,class:"rating"},Ua={class:"form-row"},xa={class:"form-group"},Aa={for:"release"},Ta={key:0,class:"required"},Ma=["required"],Ba={key:0,class:"field-hint"},Ea={key:1,class:"release-preview"},Ra={class:"form-group"},Pa={class:"form-group"},La={class:"form-row"},Ga={class:"form-group"},Fa={class:"form-group"},Na={class:"form-row"},Wa={class:"form-group"},Va={class:"form-group"},Oa={class:"form-row"},za={class:"form-group full-width"},ja={key:0,class:"form-row"},Ya={class:"form-group"},qa={key:0,class:"field-error"},Ha={class:"form-row"},Qa={class:"form-group"},Ja={class:"form-group"},Ka={key:2,class:"form-row"},Za={class:"form-group"},Xa={key:3,class:"form-row"},$a={class:"form-group"},en={key:0,class:"form-group"},tn={key:4,class:"form-row"},on={class:"form-group full-width"},sn={key:5,class:"form-row"},an={class:"form-group"},nn={class:"form-row"},rn={class:"form-group"},ln={class:"form-group"},dn={class:"image-upload-container"},cn=["disabled"],un={key:0,class:"upload-success"},gn={key:6,class:"form-row"},mn={class:"form-group image-preview-group"},fn={class:"image-preview"},pn=["src","alt"],vn={key:7,class:"error-message"},hn={class:"modal-buttons"},yn=["disabled"],bn=["disabled"],kn=["disabled"],wn=["disabled"];function Sn(i,e,s,t,a,d){const r=ne("BooksApiControlPanel");return g(),m("div",{class:"modal",onClick:e[33]||(e[33]=(...l)=>t.closeModal&&t.closeModal(...l))},[o("div",{class:"modal-content",onClick:e[32]||(e[32]=de(()=>{},["stop"]))},[o("h2",null,v(t.isEditing?"Edit Item":"Add Item"),1),o("form",{onSubmit:e[31]||(e[31]=de((...l)=>t.handleSave&&t.handleSave(...l),["prevent"]))},[o("div",ua,[o("div",ga,[e[35]||(e[35]=o("label",{for:"category"},"Category:",-1)),x(o("select",{id:"category","onUpdate:modelValue":e[0]||(e[0]=l=>t.form.category=l),required:""},[...e[34]||(e[34]=[Ve('<option value="watchlist" data-v-1689085a>Watchlist</option><option value="game" data-v-1689085a>Game</option><option value="series" data-v-1689085a>Series</option><option value="movie" data-v-1689085a>Movie</option><option value="buecher" data-v-1689085a>Bücher</option>',5)])],512),[[be,t.form.category]])]),o("div",ma,[e[36]||(e[36]=o("label",{for:"title"},"Title:",-1)),o("div",fa,[x(o("input",{type:"text",id:"title","onUpdate:modelValue":e[1]||(e[1]=l=>t.form.title=l),onInput:e[2]||(e[2]=(...l)=>t.searchApi&&t.searchApi(...l)),required:"",placeholder:t.isWatchlist?"Enter title (API search + manual input available)":"Enter title",disabled:t.loading},null,40,pa),[[L,t.form.title]]),t.apiResults.length>0?(g(),m("div",va,[(g(!0),m(oe,null,se(t.apiResults,l=>(g(),m("div",{key:l.title,class:"search-result-item",onClick:f=>t.selectApiResult(l)},[o("div",ya,[l.imageUrl?(g(),m("img",{key:0,src:t.ensureHttpsUrl(l.imageUrl),alt:l.title},null,8,ba)):(g(),m("div",ka,[o("span",null,v(l.title.charAt(0).toUpperCase()),1)]))]),o("div",wa,[o("div",Sa,v(l.title),1),o("div",Ia,[l.release?(g(),m("span",_a,v(t.formatDate(l.release)),1)):b("",!0),l.genre?(g(),m("span",Ca,v(l.genre),1)):b("",!0),l.rating?(g(),m("span",Da,"⭐ "+v(l.rating),1)):b("",!0)])])],8,ha))),128))])):b("",!0)])])]),o("div",Ua,[o("div",xa,[o("label",Aa,[xe(v(t.isWatchlist?"Release Date:":"Release:")+" ",1),t.isWatchlist?(g(),m("span",Ta,"*")):b("",!0)]),x(o("input",{type:"date",id:"release","onUpdate:modelValue":e[3]||(e[3]=l=>t.form.release=l),required:t.isWatchlist},null,8,Ma),[[L,t.form.release]]),t.isWatchlist?(g(),m("div",Ba," 📅 Set the release date to track countdown or status ")):b("",!0),t.isWatchlist&&t.form.release?(g(),m("div",Ea,[e[37]||(e[37]=o("strong",null,"Preview:",-1)),xe(" "+v(t.getReleasePreview()),1)])):b("",!0)]),o("div",Ra,[e[38]||(e[38]=o("label",{for:"apiRating"},"API Rating:",-1)),x(o("input",{type:"number",id:"apiRating","onUpdate:modelValue":e[4]||(e[4]=l=>t.form.apiRating=l),step:"0.1",min:"0",max:"10",placeholder:"0-10",readonly:""},null,512),[[L,t.form.apiRating]]),e[39]||(e[39]=o("div",{class:"field-hint"},"From API - read only",-1))]),o("div",Pa,[e[40]||(e[40]=o("label",{for:"personalRating"},"Personal Rating:",-1)),x(o("input",{type:"number",id:"personalRating","onUpdate:modelValue":e[5]||(e[5]=l=>t.form.personalRating=l),step:"0.1",min:"0",max:"10",placeholder:"0-10"},null,512),[[L,t.form.personalRating]]),e[41]||(e[41]=o("div",{class:"field-hint"},"Your personal rating",-1))])]),o("div",La,[o("div",Ga,[e[42]||(e[42]=o("label",{for:"views"},"Views:",-1)),x(o("input",{type:"number",id:"views","onUpdate:modelValue":e[6]||(e[6]=l=>t.form.count=l),min:"0",placeholder:"0"},null,512),[[L,t.form.count]])]),o("div",Fa,[e[43]||(e[43]=o("label",{for:"discovered"},"Discovered:",-1)),x(o("input",{type:"date",id:"discovered","onUpdate:modelValue":e[7]||(e[7]=l=>t.form.discovered=l)},null,512),[[L,t.form.discovered]])])]),o("div",Na,[o("div",Wa,[e[44]||(e[44]=o("label",{for:"platforms"},"Platforms:",-1)),x(o("input",{type:"text",id:"platforms","onUpdate:modelValue":e[8]||(e[8]=l=>t.form.platforms=l),placeholder:"PC, PS5, Xbox"},null,512),[[L,t.form.platforms]])]),o("div",Va,[e[45]||(e[45]=o("label",{for:"genre"},"Genre:",-1)),x(o("input",{type:"text",id:"genre","onUpdate:modelValue":e[9]||(e[9]=l=>t.form.genre=l),placeholder:"Action, Adventure, RPG"},null,512),[[L,t.form.genre]])])]),o("div",Oa,[o("div",za,[e[46]||(e[46]=o("label",{for:"description"},"Description:",-1)),x(o("textarea",{id:"description","onUpdate:modelValue":e[10]||(e[10]=l=>t.form.description=l),placeholder:"Enter description...",rows:"3"},null,512),[[L,t.form.description]])])]),t.form.category==="watchlist"?(g(),m("div",ja,[o("div",Ya,[e[48]||(e[48]=o("label",{for:"watchlistType"},[xe("Type: "),o("span",{class:"required"},"*")],-1)),x(o("select",{id:"watchlistType","onUpdate:modelValue":e[11]||(e[11]=l=>t.form.watchlistType=l)},[...e[47]||(e[47]=[Ve('<option value="" data-v-1689085a>Select Type</option><option value="game" data-v-1689085a>Game</option><option value="series" data-v-1689085a>Series</option><option value="movie" data-v-1689085a>Movie</option><option value="buecher" data-v-1689085a>Bücher</option>',5)])],512),[[be,t.form.watchlistType]]),t.form.category==="watchlist"&&!t.form.watchlistType?(g(),m("div",qa," Please select a type for watchlist items ")):b("",!0)])])):b("",!0),t.form.category==="buecher"||t.form.watchlistType==="buecher"?(g(),Ue(r,{key:1,expanded:!1,onPreferencesChanged:t.handlePreferencesChanged},null,8,["onPreferencesChanged"])):b("",!0),o("div",Ha,[o("div",Qa,[e[49]||(e[49]=o("label",{for:"link"},"Link:",-1)),x(o("input",{type:"url",id:"link","onUpdate:modelValue":e[12]||(e[12]=l=>t.form.link=l),placeholder:"https://..."},null,512),[[L,t.form.link]])]),o("div",Ja,[e[50]||(e[50]=o("label",{for:"path"},"Image Path:",-1)),x(o("input",{type:"text",id:"path","onUpdate:modelValue":e[13]||(e[13]=l=>t.form.path=l),placeholder:"images/movies/filename.jpg"},null,512),[[L,t.form.path]])])]),t.isGame?(g(),m("div",Ka,[o("div",Za,[e[51]||(e[51]=o("label",{for:"playtime"},"Playtime (Minutes):",-1)),x(o("input",{type:"number",id:"playtime","onUpdate:modelValue":e[14]||(e[14]=l=>t.form.spielzeit=l),min:"0",placeholder:"0"},null,512),[[L,t.form.spielzeit]])])])):b("",!0),t.isSeries?(g(),m("div",Xa,[o("div",$a,[e[53]||(e[53]=o("label",{for:"isAiring"},"Status:",-1)),x(o("select",{id:"isAiring","onUpdate:modelValue":e[15]||(e[15]=l=>t.form.isAiring=l)},[...e[52]||(e[52]=[o("option",{value:!1},"Finished",-1),o("option",{value:!0},"Airing",-1)])],512),[[be,t.form.isAiring]])]),t.form.isAiring?(g(),m("div",en,[e[54]||(e[54]=o("label",{for:"nextSeason"},"Next Season:",-1)),x(o("input",{type:"number",id:"nextSeason","onUpdate:modelValue":e[16]||(e[16]=l=>t.form.nextSeason=l),min:"1",placeholder:"1"},null,512),[[L,t.form.nextSeason]])])):b("",!0)])):b("",!0),t.isSeries?(g(),m("div",tn,[o("div",on,[e[55]||(e[55]=o("label",{for:"extraLink"},"Extra Link:",-1)),x(o("input",{type:"url",id:"extraLink","onUpdate:modelValue":e[17]||(e[17]=l=>t.form.extraLink=l),placeholder:"https://... (e.g., streaming platform, official website)"},null,512),[[L,t.form.extraLink]]),e[56]||(e[56]=o("div",{class:"field-hint"},"Optional: Additional link for series (e.g., streaming platform, official website)",-1))])])):b("",!0),t.form.isAiring?(g(),m("div",sn,[o("div",an,[e[57]||(e[57]=o("label",{for:"nextSeasonRelease"},"Next Season Release:",-1)),x(o("input",{type:"date",id:"nextSeasonRelease","onUpdate:modelValue":e[18]||(e[18]=l=>t.form.nextSeasonRelease=l)},null,512),[[L,t.form.nextSeasonRelease]])])])):b("",!0),o("div",nn,[o("div",rn,[e[58]||(e[58]=o("label",{for:"imageUrl"},"Image URL (optional):",-1)),x(o("input",{type:"text",id:"imageUrl","onUpdate:modelValue":e[19]||(e[19]=l=>t.form.imageUrl=l),placeholder:"https://... or leave empty for API images"},null,512),[[L,t.form.imageUrl]])]),o("div",ln,[e[59]||(e[59]=o("label",{for:"imageUpload"},"Upload Image:",-1)),o("div",dn,[o("input",{type:"file",id:"imageUpload",ref:"imageUploadRef",onChange:e[20]||(e[20]=(...l)=>t.handleImageUpload&&t.handleImageUpload(...l)),accept:"image/*",style:{display:"none"}},null,544),o("button",{type:"button",onClick:e[21]||(e[21]=(...l)=>t.triggerImageUpload&&t.triggerImageUpload(...l)),class:"upload-btn",disabled:t.loading}," 📁 Choose Image ",8,cn),t.uploadedImagePath?(g(),m("div",un,[xe(" ✅ Image uploaded: "+v(t.uploadedImagePath)+" ",1),o("button",{type:"button",onClick:e[22]||(e[22]=(...l)=>t.removeUploadedImage&&t.removeUploadedImage(...l)),class:"remove-uploaded-btn",title:"Remove uploaded image to enable API search"}," ✕ Remove ")])):b("",!0)])])]),t.shouldShowImagePreview?(g(),m("div",gn,[o("div",mn,[e[60]||(e[60]=o("label",null,"Image Preview:",-1)),o("div",fn,[o("img",{src:t.getImagePreviewUrl(),alt:t.form.title,onError:e[23]||(e[23]=(...l)=>t.handleImageError&&t.handleImageError(...l)),onLoad:e[24]||(e[24]=(...l)=>t.handleImageLoad&&t.handleImageLoad(...l)),onLoadstart:e[25]||(e[25]=(...l)=>t.handleImageLoadStart&&t.handleImageLoadStart(...l)),onLoadend:e[26]||(e[26]=(...l)=>t.handleImageLoadEnd&&t.handleImageLoadEnd(...l))},null,40,pn),o("button",{type:"button",onClick:e[27]||(e[27]=(...l)=>t.clearImage&&t.clearImage(...l)),class:"clear-image-btn",title:"Remove image"}," ✕ ")])])])):b("",!0),t.error?(g(),m("div",vn,v(t.error),1)):b("",!0),o("div",hn,[o("button",{type:"submit",disabled:t.loading},v(t.loading?"Saving...":"Save"),9,yn),o("button",{type:"button",onClick:e[28]||(e[28]=(...l)=>t.closeModal&&t.closeModal(...l)),disabled:t.loading}," Cancel ",8,bn),t.isEditing?(g(),m("button",{key:0,type:"button",onClick:e[29]||(e[29]=(...l)=>t.deleteItem&&t.deleteItem(...l)),disabled:t.loading,class:"delete-btn"}," Delete ",8,kn)):b("",!0),o("button",{type:"button",onClick:e[30]||(e[30]=(...l)=>t.handleSave&&t.handleSave(...l)),disabled:t.loading,class:"check-btn",title:"Add to list"}," ✓ ",8,wn)])],32)])])}const In=ae(ca,[["render",Sn],["__scopeId","data-v-1689085a"]]),_n={name:"BulkAddModal",props:{show:{type:Boolean,default:!1},currentCategory:{type:String,default:""}},emits:["close"],setup(i,{emit:e}){const s=ze(),t=k(1),a=k(!1),d=k(!0),r=k(!1),l=k(0),f=k(0),c=k(0),U=k(0),D=k(null),_=k(""),w=k(""),J=k([]),Z=k([]),F=k({category:"",itemsText:"",defaultRating:null}),le=W(()=>F.value.category&&F.value.itemsText.trim()&&!a.value),fe=W(()=>{const V=ce().length;return V>0?Math.round(l.value/V*100):0}),ce=()=>!F.value.itemsText||!F.value.itemsText.trim()?[]:F.value.itemsText.split(`
`).map(V=>V.trim()).filter(V=>V.length>0).map(V=>{const Y=V.split("|").map(H=>H.trim());return{searchTerm:Y[0]||"",additionalInfo:Y[1]||null}}),p=()=>{l.value=0,f.value=0,c.value=0,U.value=0,D.value=null,_.value="",w.value="",J.value=[],Z.value=[]},N=(V,Y,H)=>{D.value=V,_.value=Y,w.value=H},ie=(V,Y,H="")=>{const pe={searching:"Searching...",found:"Found",adding:"Adding...",added:"Added",skipped:"Skipped",error:"Error"}[Y]||Y;J.value.push({title:V,status:Y,statusText:pe,message:H})},re=async()=>{var H,pe,Ie;if(!le.value)return;t.value=2,a.value=!0,d.value=!0,p();const V=ce();let Y=0;try{let n=[];const h=localStorage.getItem("authToken"),I=localStorage.getItem("currentUser");if(h&&I)try{N({title:"Checking all items..."},"searching","Checking profile for duplicates..."),n=(await me.checkExistingItems(V.map(y=>({title:y.searchTerm,category:F.value.category})))).existing_items||[]}catch(u){console.warn("Failed to check existing items, falling back to individual checks:",u)}for(let u=0;u<V.length;u++){const y=V[u];l.value=u+1,N({title:y.searchTerm,description:y.additionalInfo},"searching","Processing...");try{let A=!1;if(h&&I&&n.length>0?A=n.some(E=>E.title.toLowerCase().trim()===y.searchTerm.toLowerCase().trim()):A=(s.mediaData||[]).some(ge=>ge.title&&ge.title.toLowerCase().trim()===y.searchTerm.toLowerCase().trim()&&ge.category===F.value.category),A){console.log(`✅ Found exact match in profile for "${y.searchTerm}"`),N({title:y.searchTerm},"skipped","Already exists in profile - skipped"),Z.value.push({searchTerm:y.searchTerm,additionalInfo:y.additionalInfo,reason:"duplicate"}),c.value++,ie(y.searchTerm,"skipped","Already exists in profile - skipped");continue}N({title:y.searchTerm,description:y.additionalInfo},"searching","Searching API..."),ie(y.searchTerm,"searching","Searching API...");const te=await me.searchApi(y.searchTerm,F.value.category,1);if(te&&te.length>0&&te[0]&&te[0].api_source&&te[0].image){const E=te[0];console.log(`✅ Found real API data for "${y.searchTerm}":`,{title:E.title,api_source:E.api_source,has_image:!!E.image,has_genre:!!E.genre,has_release:!!E.release}),N({title:E.title,description:`Found: ${E.genre||"Unknown genre"} • ${E.release||"Unknown year"} • ${E.api_source}`},"found","Found in API with data"),ie(y.searchTerm,"found",`Found: ${E.title} (${E.api_source})`),N({title:E.title},"adding","Adding to library...");const ge={title:E.title,category:F.value.category,release:E.release||null,rating:E.rating?Math.round(E.rating):F.value.defaultRating||null,platforms:E.platforms||null,genre:E.genre||null,link:E.link||null,path:E.image||null,external_id:E.id||null,count:1,is_airing:!1,spielzeit:0,description:E.overview||y.additionalInfo||null};await s.addMediaItem(ge,!0),f.value++,N({title:E.title},"added","Successfully added with API data"),ie(y.searchTerm,"added",`Added: ${E.title} with API data`)}else console.log(`❌ No real API data found for "${y.searchTerm}"`),N({title:y.searchTerm},"skipped","No API data found - will retry"),Z.value.push({searchTerm:y.searchTerm,additionalInfo:y.additionalInfo,reason:"no_api_data"}),c.value++,ie(y.searchTerm,"skipped","No API data found - ready for retry")}catch(A){console.error(`Error processing "${y.searchTerm}":`,A),A.isDuplicate||((H=A.response)==null?void 0:H.status)===409&&((Ie=(pe=A.response)==null?void 0:pe.data)!=null&&Ie.duplicate)?(N({title:y.searchTerm},"skipped","Already exists - skipped"),c.value++,ie(y.searchTerm,"skipped","Item already exists in library")):(N({title:y.searchTerm},"error","Error occurred"),U.value++,ie(y.searchTerm,"error",A.message||"Unknown error"))}if(Y++,Y>=5){console.log("🔄 Reloading media data after 5 items...");try{await s.loadMedia(),Y=0}catch(A){console.warn("Failed to reload media data:",A)}}if(!a.value)break;for(;r.value&&a.value;)await new Promise(A=>setTimeout(A,100));await new Promise(A=>setTimeout(A,1e3))}console.log("🔄 Final media data reload...");try{await s.loadMedia()}catch(u){console.warn("Failed to reload media data at end:",u)}t.value=3,N(null,"","")}catch(n){console.error("Bulk processing error:",n),U.value++}finally{a.value=!1,d.value=!1}},ke=()=>{a.value=!1,d.value=!1,r.value=!1,t.value=1,p()},ue=()=>{r.value=!0},we=()=>{r.value=!1},Se=()=>{const V=Z.value.filter(H=>H.reason!=="duplicate");if(V.length===0){X();return}const Y=V.map(H=>H.additionalInfo?`${H.searchTerm} | ${H.additionalInfo}`:H.searchTerm).join(`
`);F.value.itemsText=Y,l.value=0,f.value=0,U.value=0,D.value=null,_.value="",w.value="",J.value=[],t.value=1},X=()=>{t.value=1,a.value=!1,d.value=!0,p(),F.value={category:"",itemsText:"",defaultRating:null},e("close")};return Ce(()=>i.show,V=>{V&&i.currentCategory?F.value.category=i.currentCategory:V||X()}),{currentStep:t,isProcessing:a,canCancel:d,isPaused:r,processedCount:l,addedCount:f,skippedCount:c,errorCount:U,currentItem:D,currentItemStatus:_,currentItemStatusText:w,processingResults:J,skippedItems:Z,bulkData:F,canStart:le,progressPercentage:fe,startProcessing:re,cancelProcessing:ke,pauseProcessing:ue,resumeProcessing:we,retrySkippedItems:Se,closeModal:X}}},Cn={class:"modal-header"},Dn={class:"modal-body"},Un={key:0,class:"step-container"},xn={class:"bulk-add-form"},An={class:"form-group"},Tn={class:"form-group"},Mn={class:"form-group"},Bn={key:1,class:"step-container"},En={class:"processing-container"},Rn={class:"progress-overview"},Pn={class:"progress-stats"},Ln={class:"stat"},Gn={class:"stat-number"},Fn={class:"stat"},Nn={class:"stat-number"},Wn={class:"stat"},Vn={class:"stat-number"},On={class:"stat"},zn={class:"stat-number"},jn={class:"progress-bar"},Yn={class:"progress-text"},qn={class:"current-item"},Hn={class:"current-item-header"},Qn={class:"current-item-title"},Jn={key:0,class:"paused-indicator"},Kn={key:0,class:"current-item-description"},Zn={key:1,class:"api-data-indicator"},Xn={key:2,class:"no-api-indicator"},$n={class:"results-list"},ei={class:"result-header"},ti={class:"result-title"},oi={class:"result-status"},si={key:0,class:"result-message"},ai={key:2,class:"step-container"},ni={class:"results-summary"},ii={class:"summary-stats"},ri={class:"summary-stat success"},li={class:"stat-number"},di={class:"summary-stat warning"},ci={class:"stat-number"},ui={class:"summary-stat info"},gi={class:"stat-number"},mi={class:"summary-stat error"},fi={class:"stat-number"},pi={key:0,class:"retry-section"},vi={class:"retry-list"},hi=["onUpdate:modelValue","disabled"],yi={key:0,class:"retry-additional"},bi={key:1,class:"duplicate-badge"},ki={key:2,class:"retry-badge"},wi={key:1,class:"detailed-results"},Si={class:"results-list"},Ii={class:"result-header"},_i={class:"result-title"},Ci={class:"result-status"},Di={key:0,class:"result-message"},Ui={class:"modal-footer"},xi=["disabled"],Ai={key:2,class:"processing-controls"},Ti=["disabled"],Mi=["disabled"],Bi={key:3,class:"footer-buttons"};function Ei(i,e,s,t,a,d){var r,l;return s.show?(g(),m("div",{key:0,class:"modal-overlay",onClick:e[12]||(e[12]=(...f)=>t.closeModal&&t.closeModal(...f))},[o("div",{class:"modal-content",onClick:e[11]||(e[11]=de(()=>{},["stop"]))},[o("div",Cn,[e[13]||(e[13]=o("h2",null,"Bulk Add Items",-1)),o("button",{class:"close-btn",onClick:e[0]||(e[0]=(...f)=>t.closeModal&&t.closeModal(...f))},"✕")]),o("div",Dn,[t.currentStep===1?(g(),m("div",Un,[e[19]||(e[19]=o("div",{class:"step-header"},[o("div",{class:"step-number"},"1"),o("h3",null,"Enter Your List")],-1)),o("div",xn,[o("div",An,[e[15]||(e[15]=o("label",{for:"category"},"Category *",-1)),x(o("select",{id:"category","onUpdate:modelValue":e[1]||(e[1]=f=>t.bulkData.category=f),required:""},[...e[14]||(e[14]=[Ve('<option value="" data-v-007de140>Select Category</option><option value="game" data-v-007de140>Game</option><option value="series" data-v-007de140>Series</option><option value="movie" data-v-007de140>Movie</option><option value="buecher" data-v-007de140>Bücher</option><option value="watchlist" data-v-007de140>Watchlist</option>',6)])],512),[[be,t.bulkData.category]])]),o("div",Tn,[e[16]||(e[16]=o("label",{for:"items-text"},"Items (one per line) *",-1)),x(o("textarea",{id:"items-text","onUpdate:modelValue":e[2]||(e[2]=f=>t.bulkData.itemsText=f),placeholder:`Enter items one per line, for example:
The Witcher 3
Cyberpunk 2077
Red Dead Redemption 2`,rows:"10",required:""},null,512),[[L,t.bulkData.itemsText]]),e[17]||(e[17]=o("small",{class:"help-text"},"Enter one item per line. The system will automatically search and add each item individually.",-1))]),o("div",Mn,[e[18]||(e[18]=o("label",{for:"default-rating"},"Default Rating",-1)),x(o("input",{id:"default-rating","onUpdate:modelValue":e[3]||(e[3]=f=>t.bulkData.defaultRating=f),type:"number",min:"0",max:"10",step:"0.1",placeholder:"Optional rating for all items"},null,512),[[L,t.bulkData.defaultRating,void 0,{number:!0}]])])])])):b("",!0),t.currentStep===2?(g(),m("div",Bn,[e[24]||(e[24]=o("div",{class:"step-header"},[o("div",{class:"step-number"},"2"),o("h3",null,"Processing Items")],-1)),o("div",En,[o("div",Rn,[o("div",Pn,[o("span",Ln,[o("span",Gn,v(t.processedCount),1),e[20]||(e[20]=o("span",{class:"stat-label"},"Processed",-1))]),o("span",Fn,[o("span",Nn,v(t.addedCount),1),e[21]||(e[21]=o("span",{class:"stat-label"},"Added",-1))]),o("span",Wn,[o("span",Vn,v(t.skippedCount),1),e[22]||(e[22]=o("span",{class:"stat-label"},"Skipped",-1))]),o("span",On,[o("span",zn,v(t.errorCount),1),e[23]||(e[23]=o("span",{class:"stat-label"},"Errors",-1))])]),o("div",jn,[o("div",{class:"progress-fill",style:Ae({width:t.progressPercentage+"%"})},null,4)]),o("div",Yn,v(t.progressPercentage)+"% Complete",1)]),o("div",qn,[o("div",Hn,[o("span",Qn,"Processing: "+v(((r=t.currentItem)==null?void 0:r.title)||"..."),1),o("span",{class:Q(["current-item-status",t.currentItemStatus])},[t.isPaused?(g(),m("span",Jn,"⏸️ PAUSED - ")):b("",!0),xe(v(t.currentItemStatusText),1)],2)]),(l=t.currentItem)!=null&&l.description?(g(),m("div",Kn,v(t.currentItem.description),1)):b("",!0),t.currentItemStatus==="found"?(g(),m("div",Zn," ✅ Real API data found with image and metadata ")):b("",!0),t.currentItemStatus==="skipped"?(g(),m("div",Xn," ❌ No API data found - will be retried ")):b("",!0)]),o("div",$n,[(g(!0),m(oe,null,se(t.processingResults,(f,c)=>(g(),m("div",{key:c,class:Q(["result-item",f.status])},[o("div",ei,[o("span",ti,v(f.title),1),o("span",oi,v(f.statusText),1)]),f.message?(g(),m("div",si,v(f.message),1)):b("",!0)],2))),128))])])])):b("",!0),t.currentStep===3?(g(),m("div",ai,[e[32]||(e[32]=o("div",{class:"step-header"},[o("div",{class:"step-number"},"3"),o("h3",null,"Results")],-1)),o("div",ni,[o("div",ii,[o("div",ri,[o("span",li,v(t.addedCount),1),e[25]||(e[25]=o("span",{class:"stat-label"},"Successfully Added",-1))]),o("div",di,[o("span",ci,v(t.skippedItems.filter(f=>f.reason!=="duplicate").length),1),e[26]||(e[26]=o("span",{class:"stat-label"},"Not Found (Ready for Retry)",-1))]),o("div",ui,[o("span",gi,v(t.skippedItems.filter(f=>f.reason==="duplicate").length),1),e[27]||(e[27]=o("span",{class:"stat-label"},"Already in Profile",-1))]),o("div",mi,[o("span",fi,v(t.errorCount),1),e[28]||(e[28]=o("span",{class:"stat-label"},"Errors",-1))])]),t.skippedItems.length>0?(g(),m("div",pi,[e[29]||(e[29]=o("h4",null,"Items Ready for Retry",-1)),e[30]||(e[30]=o("p",{class:"retry-description"}," The following items can be edited and tried again: ",-1)),o("div",vi,[(g(!0),m(oe,null,se(t.skippedItems,(f,c)=>(g(),m("div",{key:c,class:Q(["retry-item",{"duplicate-item":f.reason==="duplicate"}])},[x(o("input",{"onUpdate:modelValue":U=>f.searchTerm=U,class:"retry-input",placeholder:"Edit search term...",disabled:f.reason==="duplicate"},null,8,hi),[[L,f.searchTerm]]),f.additionalInfo?(g(),m("span",yi," | "+v(f.additionalInfo),1)):b("",!0),f.reason==="duplicate"?(g(),m("span",bi," Already in profile ")):(g(),m("span",ki," No API data "))],2))),128))])])):b("",!0),t.processingResults.length>0?(g(),m("div",wi,[e[31]||(e[31]=o("h4",null,"Detailed Results",-1)),o("div",Si,[(g(!0),m(oe,null,se(t.processingResults,(f,c)=>(g(),m("div",{key:c,class:Q(["result-item",f.status])},[o("div",Ii,[o("span",_i,v(f.title),1),o("span",Ci,v(f.statusText),1)]),f.message?(g(),m("div",Di,v(f.message),1)):b("",!0)],2))),128))])])):b("",!0)])])):b("",!0)]),o("div",Ui,[t.currentStep===1?(g(),m("button",{key:0,class:"btn btn-secondary",onClick:e[4]||(e[4]=(...f)=>t.closeModal&&t.closeModal(...f))}," Cancel ")):b("",!0),t.currentStep===1?(g(),m("button",{key:1,class:"btn btn-primary",onClick:e[5]||(e[5]=(...f)=>t.startProcessing&&t.startProcessing(...f)),disabled:!t.canStart}," Check All and Add ",8,xi)):b("",!0),t.currentStep===2?(g(),m("div",Ai,[o("button",{class:"btn btn-secondary",onClick:e[6]||(e[6]=(...f)=>t.cancelProcessing&&t.cancelProcessing(...f)),disabled:!t.canCancel}," Cancel ",8,Ti),t.isPaused?b("",!0):(g(),m("button",{key:0,class:"btn btn-warning",onClick:e[7]||(e[7]=(...f)=>t.pauseProcessing&&t.pauseProcessing(...f)),disabled:!t.isProcessing}," Pause ",8,Mi)),t.isPaused?(g(),m("button",{key:1,class:"btn btn-primary",onClick:e[8]||(e[8]=(...f)=>t.resumeProcessing&&t.resumeProcessing(...f))}," Resume ")):b("",!0)])):b("",!0),t.currentStep===3?(g(),m("div",Bi,[t.skippedItems.filter(f=>f.reason!=="duplicate").length>0?(g(),m("button",{key:0,class:"btn btn-warning",onClick:e[9]||(e[9]=(...f)=>t.retrySkippedItems&&t.retrySkippedItems(...f))}," Retry "+v(t.skippedItems.filter(f=>f.reason!=="duplicate").length)+" Items ",1)):b("",!0),o("button",{class:"btn btn-primary",onClick:e[10]||(e[10]=(...f)=>t.closeModal&&t.closeModal(...f))}," Done ")])):b("",!0)])])])):b("",!0)}const Ri=ae(_n,[["render",Ei],["__scopeId","data-v-007de140"]]),Pi={name:"TxtImportModal",props:{show:{type:Boolean,default:!1}},emits:["close","fileProcessed"],methods:{handleFileUpload(i){const e=i.target.files[0];if(!e)return;if(!e.name.toLowerCase().endsWith(".txt")){alert("Bitte wählen Sie eine .txt Datei aus.");return}const s=new FileReader;s.onload=t=>{const a=t.target.result;this.$emit("fileProcessed",a)},s.readAsText(e,"UTF-8")}}},Li={class:"file-upload-area"},Gi={class:"modal-buttons"};function Fi(i,e,s,t,a,d){return s.show?(g(),m("div",{key:0,class:"modal",onClick:e[3]||(e[3]=r=>i.$emit("close"))},[o("div",{class:"modal-content",onClick:e[2]||(e[2]=de(()=>{},["stop"]))},[e[5]||(e[5]=o("h2",null,"📄 Import from TXT File",-1)),e[6]||(e[6]=o("p",null,"Wählen Sie eine .txt Datei mit einer Liste von Titeln aus, um zu prüfen, welche Items in der aktuellen Kategorie fehlen.",-1)),o("div",Li,[o("input",{type:"file",id:"txtFileInput",accept:".txt",onChange:e[0]||(e[0]=(...r)=>d.handleFileUpload&&d.handleFileUpload(...r)),style:{display:"none"}},null,32),e[4]||(e[4]=o("label",{for:"txtFileInput",class:"file-upload-label"},[o("span",{class:"upload-icon"},"📁"),o("span",{class:"upload-text"},"TXT-Datei auswählen"),o("span",{class:"upload-hint"},"Eine .txt Datei mit einer Liste von Titeln")],-1))]),o("div",Gi,[o("button",{type:"button",onClick:e[1]||(e[1]=r=>i.$emit("close"))}," Cancel ")])])])):b("",!0)}const Ni=ae(Pi,[["render",Fi],["__scopeId","data-v-e20860d6"]]),Wi={name:"TxtImportResultsModal",props:{show:{type:Boolean,default:!1},results:{type:Object,default:null}},emits:["close"]},Vi={class:"results-summary"},Oi={class:"summary-item"},zi={class:"summary-value"},ji={class:"summary-item"},Yi={class:"summary-value"},qi={class:"summary-item"},Hi={class:"summary-value existing"},Qi={class:"summary-item"},Ji={class:"summary-value missing"},Ki={key:0,class:"missing-items"},Zi={class:"items-list"},Xi={key:1,class:"existing-items"},$i={class:"items-list"},er={class:"modal-buttons"};function tr(i,e,s,t,a,d){return s.show&&s.results?(g(),m("div",{key:0,class:"modal",onClick:e[2]||(e[2]=r=>i.$emit("close"))},[o("div",{class:"modal-content results-modal",onClick:e[1]||(e[1]=de(()=>{},["stop"]))},[e[7]||(e[7]=o("h2",null,"📊 TXT Import Ergebnisse",-1)),o("div",Vi,[o("div",Oi,[e[3]||(e[3]=o("span",{class:"summary-label"},"Kategorie:",-1)),o("span",zi,v(s.results.categoryName),1)]),o("div",ji,[e[4]||(e[4]=o("span",{class:"summary-label"},"Titel in Datei:",-1)),o("span",Yi,v(s.results.totalInFile),1)]),o("div",qi,[e[5]||(e[5]=o("span",{class:"summary-label"},"Bereits vorhanden:",-1)),o("span",Hi,v(s.results.existingItems.length),1)]),o("div",Qi,[e[6]||(e[6]=o("span",{class:"summary-label"},"Fehlende Titel:",-1)),o("span",Ji,v(s.results.missingItems.length),1)])]),s.results.missingItems.length>0?(g(),m("div",Ki,[o("h3",null,"❌ Fehlende Titel ("+v(s.results.missingItems.length)+"):",1),o("div",Zi,[(g(!0),m(oe,null,se(s.results.missingItems,(r,l)=>(g(),m("div",{key:l,class:"missing-item"},v(r),1))),128))])])):b("",!0),s.results.existingItems.length>0?(g(),m("div",Xi,[o("h3",null,"✅ Bereits vorhanden ("+v(s.results.existingItems.length)+"):",1),o("div",$i,[(g(!0),m(oe,null,se(s.results.existingItems,(r,l)=>(g(),m("div",{key:l,class:"existing-item"},v(r),1))),128))])])):b("",!0),o("div",er,[o("button",{type:"button",onClick:e[0]||(e[0]=r=>i.$emit("close"))}," Schließen ")])])])):b("",!0)}const or=ae(Wi,[["render",tr],["__scopeId","data-v-ec385b83"]]),sr={name:"SimpleAddItem",setup(){const i=k(!1),e=k(null),s=Te({title:"Test Game",category:"game",release:"2003-01-01",count:1});return{form:s,loading:i,result:e,addItem:async()=>{i.value=!0,e.value=null;try{const a=window.location.origin,d=await fetch(`${a}/api/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:"admin@example.com",password:"admin123"})});if(!d.ok)throw new Error("Login failed");const l=(await d.json()).token,c=await(await fetch(`${a}/api/media`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify(s)})).json();c.success?e.value={success:!0,message:`Success! Item added with ID: ${c.data.id}`}:e.value={success:!1,message:`Error: ${JSON.stringify(c)}`}}catch(a){e.value={success:!1,message:`Error: ${a.message}`}}finally{i.value=!1}}}}},ar={class:"simple-add-item"},nr=["disabled"];function ir(i,e,s,t,a,d){return g(),m("div",ar,[e[10]||(e[10]=o("h3",null,"Simple Add Item Test",-1)),o("form",{onSubmit:e[4]||(e[4]=de((...r)=>t.addItem&&t.addItem(...r),["prevent"]))},[o("div",null,[e[5]||(e[5]=o("label",null,"Title:",-1)),x(o("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>t.form.title=r),type:"text",required:""},null,512),[[L,t.form.title]])]),o("div",null,[e[7]||(e[7]=o("label",null,"Category:",-1)),x(o("select",{"onUpdate:modelValue":e[1]||(e[1]=r=>t.form.category=r)},[...e[6]||(e[6]=[o("option",{value:"game"},"Game",-1),o("option",{value:"movie"},"Movie",-1),o("option",{value:"series"},"Series",-1)])],512),[[be,t.form.category]])]),o("div",null,[e[8]||(e[8]=o("label",null,"Release:",-1)),x(o("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>t.form.release=r),type:"date"},null,512),[[L,t.form.release]])]),o("div",null,[e[9]||(e[9]=o("label",null,"Count:",-1)),x(o("input",{"onUpdate:modelValue":e[3]||(e[3]=r=>t.form.count=r),type:"number",min:"0"},null,512),[[L,t.form.count]])]),o("button",{type:"submit",disabled:t.loading},v(t.loading?"Adding...":"Add Item"),9,nr)],32),t.result?(g(),m("div",{key:0,class:Q(["result",t.result.success?"success":"error"])},v(t.result.message),3)):b("",!0)])}const rr=ae(sr,[["render",ir],["__scopeId","data-v-4298065b"]]),lr={name:"LoadingSpinner",props:{loading:{type:Boolean,default:!0},message:{type:String,default:"Loading..."}}},dr={key:0,class:"loading-spinner"},cr={key:0};function ur(i,e,s,t,a,d){return s.loading?(g(),m("div",dr,[e[0]||(e[0]=o("div",{class:"spinner"},null,-1)),s.message?(g(),m("p",cr,v(s.message),1)):b("",!0)])):b("",!0)}const gr=ae(lr,[["render",ur],["__scopeId","data-v-0e82c46a"]]),mr={name:"MessageBox",props:{show:{type:Boolean,default:!1},type:{type:String,default:"info",validator:i=>["success","error","warning","info"].includes(i)},title:{type:String,default:""},message:{type:String,required:!0},details:{type:String,default:""}},emits:["close"],setup(i,{emit:e}){const s=()=>{e("close")},t=W(()=>{switch(i.type){case"success":return"✅";case"error":return"❌";case"warning":return"⚠️";case"info":return"ℹ️";default:return"ℹ️"}}),a=W(()=>`message-${i.type}`);return{closeMessage:s,icon:t,messageType:a}}},fr={class:"message-header"},pr={class:"message-icon"},vr={class:"message-title"},hr={class:"message-body"},yr={key:0,class:"message-details"},br={class:"message-footer"};function kr(i,e,s,t,a,d){return s.show?(g(),m("div",{key:0,class:"message-overlay",onClick:e[3]||(e[3]=(...r)=>t.closeMessage&&t.closeMessage(...r))},[o("div",{class:Q(["message-box",t.messageType]),onClick:e[2]||(e[2]=de(()=>{},["stop"]))},[o("div",fr,[o("span",pr,v(t.icon),1),o("h3",vr,v(s.title),1),o("button",{class:"close-btn",onClick:e[0]||(e[0]=(...r)=>t.closeMessage&&t.closeMessage(...r))},"✕")]),o("div",hr,[o("p",null,v(s.message),1),s.details?(g(),m("div",yr,[o("pre",null,v(s.details),1)])):b("",!0)]),o("div",br,[o("button",{class:"btn btn-primary",onClick:e[1]||(e[1]=(...r)=>t.closeMessage&&t.closeMessage(...r))},"OK")])],2)])):b("",!0)}const wr=ae(mr,[["render",kr],["__scopeId","data-v-198ec3cc"]]),Sr={name:"ConfirmDialog",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm Action"},message:{type:String,required:!0}},emits:["confirm","close"],setup(i,{emit:e}){const s=()=>{e("close")};return{closeDialog:s,confirmAction:()=>{e("confirm"),s()}}}},Ir={class:"confirm-header"},_r={class:"confirm-title"},Cr={class:"confirm-body"},Dr={class:"confirm-footer"};function Ur(i,e,s,t,a,d){return s.show?(g(),m("div",{key:0,class:"confirm-overlay",onClick:e[4]||(e[4]=(...r)=>t.closeDialog&&t.closeDialog(...r))},[o("div",{class:"confirm-dialog",onClick:e[3]||(e[3]=de(()=>{},["stop"]))},[o("div",Ir,[o("h3",_r,v(s.title),1),o("button",{class:"close-btn",onClick:e[0]||(e[0]=(...r)=>t.closeDialog&&t.closeDialog(...r))},"✕")]),o("div",Cr,[o("p",null,v(s.message),1)]),o("div",Dr,[o("button",{class:"btn btn-secondary",onClick:e[1]||(e[1]=(...r)=>t.closeDialog&&t.closeDialog(...r))},"Cancel"),o("button",{class:"btn btn-danger",onClick:e[2]||(e[2]=(...r)=>t.confirmAction&&t.confirmAction(...r))},"Confirm")])])])):b("",!0)}const xr=ae(Sr,[["render",Ur],["__scopeId","data-v-fd570f57"]]),Ar={name:"InputDialog",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Input Required"},message:{type:String,required:!0},placeholder:{type:String,default:""},inputType:{type:String,default:"text"},defaultValue:{type:String,default:""}},emits:["confirm","close"],setup(i,{emit:e}){const s=k(""),t=k(null),a=()=>{e("close")},d=()=>{e("confirm",s.value),a()};return Ce(()=>i.show,async r=>{r&&(s.value=i.defaultValue,await Ht(),t.value&&(t.value.focus(),t.value.select()))}),{inputValue:s,inputRef:t,closeDialog:a,confirmAction:d}}},Tr={class:"input-header"},Mr={class:"input-title"},Br={class:"input-body"},Er={class:"input-message"},Rr=["type","placeholder"],Pr={class:"input-footer"};function Lr(i,e,s,t,a,d){return s.show?(g(),m("div",{key:0,class:"input-overlay",onClick:e[6]||(e[6]=(...r)=>t.closeDialog&&t.closeDialog(...r))},[o("div",{class:"input-dialog",onClick:e[5]||(e[5]=de(()=>{},["stop"]))},[o("div",Tr,[o("h3",Mr,v(s.title),1),o("button",{class:"close-btn",onClick:e[0]||(e[0]=(...r)=>t.closeDialog&&t.closeDialog(...r))},"✕")]),o("div",Br,[o("p",Er,v(s.message),1),x(o("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>t.inputValue=r),type:s.inputType,placeholder:s.placeholder,class:"input-field",onKeyup:e[2]||(e[2]=qt((...r)=>t.confirmAction&&t.confirmAction(...r),["enter"])),ref:"inputRef"},null,40,Rr),[[Yt,t.inputValue]])]),o("div",Pr,[o("button",{class:"btn btn-secondary",onClick:e[3]||(e[3]=(...r)=>t.closeDialog&&t.closeDialog(...r))},"Cancel"),o("button",{class:"btn btn-primary",onClick:e[4]||(e[4]=(...r)=>t.confirmAction&&t.confirmAction(...r))},"OK")])])])):b("",!0)}const Gr=ae(Ar,[["render",Lr],["__scopeId","data-v-0ee78a4d"]]),Fr={name:"MediaLibrary",components:{MediaItem:ho,Sidebar:Ko,MainHeader:rs,FloatingActionButton:ms,LoginModal:_s,RegisterModal:Vs,EditModal:In,BulkAddModal:Ri,TxtImportModal:Ni,TxtImportResultsModal:or,SimpleAddItem:rr,LoadingSpinner:gr,MessageBox:wr,ConfirmDialog:xr,InputDialog:Gr},setup(){const i=ze(),e=ct(),s=ut(),t=gt(),a=Oe(),d=mt(),r=W(()=>!d||typeof d!="object"?(console.warn("SidebarStore not properly initialized, using fallback values"),{collapsed:!1,mobileOpen:!1,toggleSidebar:()=>{},toggleMobileSidebar:()=>{},closeMobileSidebar:()=>{}}):d),l=k(!1),f=k(null),c=k(new Date),U=k(null),D=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],_=k(null),w=Te({firstName:"",lastName:"",displayName:"",email:"",bio:"",avatar:"",language:"en",timezone:"UTC",dateFormat:"MM/DD/YYYY",booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}),{showLoginModal:J,showRegisterModal:Z,showEditModal:F,showFloatingMenu:le,showBulkAddModal:fe,showTxtImportModal:ce,showTxtImportResults:p,editingItem:N,sortBy:ie,categories:re,txtImportResults:ke,isLoggedIn:ue,isAdmin:we,userName:Se,currentCategory:X,searchQuery:V,categoryCounts:Y,loading:H,error:pe,paginatedMedia:Ie,setCategory:n,clearSearch:h,editItem:I,closeEditModal:u,closeBulkAddModal:y,handleBulkAddItems:A,handleSaveItem:te,handleDeleteItem:j,logout:E,loadMedia:ge,toggleFloatingMenu:je,addNewItem:Re,bulkAddItems:Me,importFromTxt:Ye,importFromAPI:qe,createCollection:He,exportMediaCollection:Pe,exportAsCSV:Le,exportAsJSON:Ge,downloadFile:Be,deleteAllInCategory:$e,getCategoryDisplayName:Fe,navigateToCalendar:et,navigateToProfile:tt,processTxtContent:C,closeTxtImportResults:M,cleanup:K,router:P}=Kt(),G=W(()=>{try{return Fe?Fe(X.value):X.value}catch(S){return console.error("Error getting category display name:",S),X.value||"Unknown"}}),$=W(()=>c.value.getFullYear()),O=W(()=>c.value.getMonth()),De=W(()=>c.value.toLocaleDateString("en-US",{month:"long"})),ve=k([]),Qe=k(!1),Je=k(null),ot=W(()=>{const S=$.value,T=O.value,R=new Date(S,T,1),z=new Date(R),B=R.getDay(),q=B===0?6:B-1;z.setDate(z.getDate()-q);const _e=[],ee=new Date;for(let Ke=0;Ke<42;Ke++){const he=new Date(z);he.setDate(z.getDate()+Ke);const Wt=he.getMonth()===T,Vt=he.toDateString()===ee.toDateString(),Ot=he.getDay()===0||he.getDay()===6;_e.push({date:he.getDate(),month:he.getMonth(),year:he.getFullYear(),fullDate:new Date(he),isCurrentMonth:Wt,isToday:Vt,isWeekend:Ot,hasEvents:st(he),events:at(he)})}return _e}),ft=W(()=>{const S=i.mediaData||[],T={totalItems:S.length,totalCollections:0,totalPlaytime:0,avgRating:0,categoryDistribution:{},ratingDistribution:{},platformDistribution:{},genreDistribution:{},recentActivity:[],airingSeries:[]};let R=0,z=0;return S.forEach(B=>{const q=B.category||"unknown";if(T.categoryDistribution[q]=(T.categoryDistribution[q]||0)+1,B.rating&&B.rating>0){const _e=Math.floor(B.rating);T.ratingDistribution[_e]=(T.ratingDistribution[_e]||0)+1,R+=B.rating,z++}if(B.platforms&&B.category==="game"&&B.platforms.split(",").map(ee=>ee.trim()).filter(ee=>ee).forEach(ee=>{T.platformDistribution[ee]=(T.platformDistribution[ee]||0)+1}),B.genre&&(B.category==="series"||B.category==="movie")&&B.genre.split(",").map(ee=>ee.trim()).filter(ee=>ee).forEach(ee=>{T.genreDistribution[ee]=(T.genreDistribution[ee]||0)+1}),B.spielzeit&&B.spielzeit>0&&(T.totalPlaytime+=B.spielzeit),B.category==="series"&&B.isAiring===!0&&T.airingSeries.push({title:B.title,nextSeason:B.nextSeason,nextSeasonRelease:B.nextSeasonRelease}),B.discovered){const _e=new Date(B.discovered),ee=new Date;ee.setDate(ee.getDate()-30),_e>=ee&&T.recentActivity.push({title:B.title,category:B.category,discovered:B.discovered})}}),z>0&&(T.avgRating=(R/z).toFixed(1)),T.totalPlaytime=Math.round(T.totalPlaytime/60),T.recentActivity.sort((B,q)=>new Date(q.discovered)-new Date(B.discovered)),T}),pt=S=>S?new Date(S).toLocaleDateString():"",vt=S=>{const T=Math.max(0,Math.min(5,parseInt(S)||0)),R="★".repeat(T),z="☆".repeat(5-T);return R+z},ht=S=>{n(S),Re()},yt=()=>{J.value=!1,Z.value=!0},bt=()=>{J.value=!0},kt=S=>{J.value=!1,ge()},wt=()=>{Z.value=!1,ge()},St=async()=>{l.value=!0,f.value=null;try{const S=await a.adminSetup();S.success?(console.log("✅ Admin setup successful:",S),f.value={type:"success",text:`✅ Admin created and logged in! User: ${S.user.name} (${S.user.email})`},await ge(),setTimeout(()=>{f.value=null},5e3)):(console.log("ℹ️ Admin already exists:",S),f.value={type:"info",text:`ℹ️ ${S.message} (${S.admin_count} admin(s) exist)`},setTimeout(()=>{f.value=null},3e3))}catch(S){console.error("❌ Admin setup failed:",S),f.value={type:"error",text:`❌ Admin setup failed: ${S.message||"Unknown error"}`},setTimeout(()=>{f.value=null},5e3)}finally{l.value=!1}},It=()=>{console.log("🔥 DEBUG: Direct admin navigation called!"),console.log("🔥 DEBUG: Router object:",P);try{P.push("/admin"),console.log("🔥 DEBUG: Successfully navigated to /admin!")}catch(S){console.error("🔥 DEBUG: Error navigating to admin:",S)}},_t=()=>{c.value=new Date(c.value.getFullYear(),c.value.getMonth()-1,1),U.value=null},Ct=()=>{c.value=new Date(c.value.getFullYear(),c.value.getMonth()+1,1),U.value=null},Dt=S=>{S.isCurrentMonth&&(U.value=S)},Ut=S=>S.fullDate.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),st=S=>nt(S).length>0,at=S=>nt(S).map(R=>({id:R.id,title:R.title,time:"Release",type:R.watchlistType||R.watchlist_type||"unknown",item:R})),nt=S=>i.mediaData.filter(R=>R.category==="watchlist"&&R.release).filter(R=>{if(!R.release)return!1;const z=new Date(R.release),B=new Date(S);return z.getFullYear()===B.getFullYear()&&z.getMonth()===B.getMonth()&&z.getDate()===B.getDate()}),xt=()=>{var R,z;const S=((R=w.firstName)==null?void 0:R.charAt(0))||"U",T=((z=w.lastName)==null?void 0:z.charAt(0))||"S";return(S+T).toUpperCase()},At=()=>{var S;(S=_.value)==null||S.click()},Tt=S=>{const T=S.target.files[0];if(T){const R=new FileReader;R.onload=z=>{w.avatar=z.target.result},R.readAsDataURL(T)}},it=async()=>{if(!X.value||X.value==="statistics"||X.value==="calendar"||X.value==="profile"){ve.value=[];return}Qe.value=!0,Je.value=null;try{const S=await me.getGenres(X.value);if(S.success)ve.value=S.genres||[];else throw new Error(S.error||"Failed to load genres")}catch(S){console.error("Failed to load genres:",S),Je.value=S.message||"Failed to load genres",ve.value=[]}finally{Qe.value=!1}},Mt=S=>{i.setGenres(S)},Bt=()=>{i.clearGenres()};Ce(X,S=>{S&&S!=="statistics"&&S!=="calendar"&&S!=="profile"?(it(),i.clearGenres()):(ve.value=[],i.clearGenres())},{immediate:!0});const Et=()=>{const S={profile:w,media:i.mediaData,settings:{language:w.language,timezone:w.timezone,dateFormat:w.dateFormat},exportDate:new Date().toISOString()},T=new Blob([JSON.stringify(S,null,2)],{type:"application/json"}),R=URL.createObjectURL(T),z=document.createElement("a");z.href=R,z.download=`media-library-backup-${new Date().toISOString().split("T")[0]}.json`,z.click(),URL.revokeObjectURL(R)},Rt=()=>{const S=document.createElement("input");S.type="file",S.accept=".json",S.onchange=T=>{const R=T.target.files[0];if(R){const z=new FileReader;z.onload=B=>{try{const q=JSON.parse(B.target.result);q.profile&&Object.assign(w,q.profile),q.media&&(i.mediaData=q.media,i.saveMedia()),q.settings&&Object.assign(w,q.settings),Ne()}catch(q){console.error("Failed to import data:",q)}},z.readAsText(R)}},S.click()},Pt=()=>{const S={profile:w,media:i.mediaData,settings:{language:w.language,timezone:w.timezone,dateFormat:w.dateFormat},backupDate:new Date().toISOString()},T=`backup_${Date.now()}`;localStorage.setItem(T,JSON.stringify(S)),alert("Backup created successfully!")},Lt=()=>{alert("Cache cleared successfully!")},Gt=()=>{confirm("Are you sure you want to reset all settings?")&&(Object.assign(w,{firstName:"",lastName:"",displayName:"",email:"",bio:"",avatar:"",language:"en",timezone:"UTC",dateFormat:"MM/DD/YYYY",booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}),Ne())},Ft=()=>{confirm("Are you sure you want to clear all data? This cannot be undone!")&&(localStorage.clear(),window.location.reload())},Ne=()=>{localStorage.setItem("profileData",JSON.stringify(w))},Nt=()=>{Ne(),alert("All changes saved successfully!")};return lt(async()=>{var S,T;try{await ge();const R=localStorage.getItem("profileData");if(R)try{const q=JSON.parse(R);Object.assign(w,q)}catch(q){console.error("Failed to load profile data:",q)}a.user&&(w.firstName=((S=a.user.name)==null?void 0:S.split(" ")[0])||"",w.lastName=((T=a.user.name)==null?void 0:T.split(" ").slice(1).join(" "))||"",w.email=a.user.email||"");const z=new Date,B=ot.value.find(q=>q.isToday&&q.isCurrentMonth);if(B&&(U.value=B),ue.value)try{i.initializeRealtimeUpdates()}catch(q){console.error("Error initializing realtime updates:",q)}}catch(R){console.error("Error during initialization:",R)}}),Qt(()=>{if(ue.value)try{i.cleanupRealtimeUpdates()}catch(S){console.error("Error cleaning up realtime updates:",S)}K()}),{showLoginModal:J,showRegisterModal:Z,showEditModal:F,showFloatingMenu:le,showBulkAddModal:fe,showTxtImportModal:ce,showTxtImportResults:p,editingItem:N,sortBy:ie,categories:re,txtImportResults:ke,adminSetupLoading:l,adminSetupMessage:f,currentDate:c,selectedDay:U,weekdays:D,avatarInput:_,profileData:w,isLoggedIn:ue,isAdmin:we,userName:Se,currentCategory:X,currentCategoryDisplayName:G,searchQuery:V,categoryCounts:Y,loading:H,error:pe,paginatedMedia:Ie,selectedGenres:i.selectedGenres,genres:ve,genreLoading:Qe,genreError:Je,currentYear:$,currentMonth:O,currentMonthName:De,calendarDays:ot,setCategory:n,clearSearch:h,navigateToCalendar:et,navigateToProfile:tt,addItemFromSidebar:ht,editItem:I,switchToRegister:yt,showAdminLogin:bt,handleLoginSuccess:kt,handleRegisterSuccess:wt,handleAdminSetup:St,debugNavigateToAdmin:It,closeEditModal:u,closeBulkAddModal:y,handleBulkAddItems:A,handleSaveItem:te,handleDeleteItem:j,logout:E,loadMedia:ge,toggleFloatingMenu:je,addNewItem:Re,bulkAddItems:Me,importFromTxt:Ye,importFromAPI:qe,createCollection:He,exportMediaCollection:Pe,exportAsCSV:Le,exportAsJSON:Ge,downloadFile:Be,deleteAllInCategory:$e,getCategoryDisplayName:Fe,processTxtContent:C,closeTxtImportResults:M,handleGenresUpdated:Mt,handleGenresCleared:Bt,loadGenres:it,previousMonth:_t,nextMonth:Ct,selectDay:Dt,formatSelectedDay:Ut,hasEventsForDate:st,getEventsForDate:at,getInitials:xt,changeAvatar:At,handleAvatarChange:Tt,exportData:Et,importData:Rt,createBackup:Pt,clearCache:Lt,resetSettings:Gt,clearAllData:Ft,saveProfileData:Ne,saveAllChanges:Nt,messageStore:e,confirmStore:s,inputStore:t,statistics:ft,formatDate:pt,getRatingStars:vt,sidebarStore:d,safeSidebarStore:r}}},Nr={class:"vue-app"},Wr={class:"main-content"},Vr={class:"content-area"},Or={key:1,class:"error"},zr={key:2},jr={key:0,class:"calendar-view"},Yr={class:"calendar-header"},qr=["disabled"],Hr={class:"month-year-display"},Qr={class:"month-name"},Jr={class:"year"},Kr=["disabled"],Zr={class:"calendar-container"},Xr={class:"calendar-grid"},$r=["onClick"],el={class:"day-number"},tl={key:0,class:"event-indicator"},ol={key:0,class:"event-count"},sl={key:0,class:"selected-day-info"},al={class:"day-events"},nl={key:0,class:"no-events"},il={key:1,class:"events-list"},rl={class:"event-header"},ll={class:"event-time"},dl={class:"event-type-badge"},cl={class:"event-title"},ul={key:0,class:"event-platforms"},gl={key:1,class:"event-genre"},ml={key:1,class:"profile-container"},fl={class:"profile-header"},pl={class:"profile-avatar-section"},vl=["src"],hl={key:1,class:"avatar-initials"},yl={class:"profile-info-header"},bl={class:"profile-stats"},kl={class:"stat-item"},wl={class:"stat-number"},Sl={class:"stat-item"},Il={class:"stat-number"},_l={class:"settings-sections"},Cl={class:"settings-section"},Dl={class:"section-content"},Ul={class:"form-row"},xl={class:"form-group"},Al={class:"form-group"},Tl={class:"form-group"},Ml={class:"form-group"},Bl={class:"form-group"},El={class:"settings-section"},Rl={class:"section-content"},Pl={class:"form-row"},Ll={class:"form-group"},Gl={class:"form-group"},Fl={class:"form-row"},Nl={class:"form-group"},Wl={class:"form-group"},Vl={class:"form-row"},Ol={class:"form-group"},zl={class:"checkbox-container"},jl={class:"settings-section"},Yl={class:"section-content"},ql={class:"data-actions"},Hl={class:"settings-section danger-zone"},Ql={class:"section-content"},Jl={class:"danger-actions"},Kl={key:2,class:"statistics-container"},Zl={class:"statistics-header"},Xl={class:"refresh-controls"},$l={class:"statistics-content"},ed={class:"stats-summary"},td={class:"summary-card"},od={class:"summary-number"},sd={class:"summary-card"},ad={class:"summary-number"},nd={class:"summary-card"},id={class:"summary-number"},rd={class:"summary-card"},ld={class:"summary-number"},dd={class:"chart-container"},cd={class:"category-stats"},ud={class:"category-name"},gd={class:"category-bar"},md={class:"category-count"},fd={class:"chart-container"},pd={class:"rating-stats"},vd={class:"rating-stars"},hd={class:"rating-bar"},yd={class:"rating-count"},bd={class:"chart-container"},kd={class:"platform-stats"},wd={class:"platform-name"},Sd={class:"platform-bar"},Id={class:"platform-count"},_d={class:"chart-container"},Cd={class:"genre-stats"},Dd={class:"genre-name"},Ud={class:"genre-bar"},xd={class:"genre-count"},Ad={class:"chart-container"},Td={class:"recent-activity"},Md={class:"activity-title"},Bd={class:"activity-category"},Ed={class:"activity-date"},Rd={class:"chart-container"},Pd={class:"airing-series"},Ld={class:"airing-title"},Gd={class:"airing-next"},Fd={class:"airing-date"},Nd={key:3,class:"grid"},Wd={key:0,class:"admin-setup-container"},Vd=["disabled"],Od={key:0},zd={key:1};function jd(i,e,s,t,a,d){const r=ne("Sidebar"),l=ne("MainHeader"),f=ne("LoadingSpinner"),c=ne("MediaItem"),U=ne("LoginModal"),D=ne("RegisterModal"),_=ne("EditModal"),w=ne("BulkAddModal"),J=ne("TxtImportModal"),Z=ne("TxtImportResultsModal"),F=ne("FloatingActionButton"),le=ne("MessageBox"),fe=ne("ConfirmDialog"),ce=ne("InputDialog");return g(),m("div",Nr,[o("div",{class:Q(["mobile-overlay",{show:t.safeSidebarStore.mobileOpen}]),onClick:e[0]||(e[0]=(...p)=>t.safeSidebarStore.closeMobileSidebar&&t.safeSidebarStore.closeMobileSidebar(...p))},null,2),ye(r,{collapsed:t.safeSidebarStore.collapsed,"mobile-open":t.safeSidebarStore.mobileOpen,"is-logged-in":t.isLoggedIn,"is-admin":t.isAdmin,"user-name":t.userName,"current-category":t.currentCategory,"category-counts":t.categoryCounts,categories:t.categories,"selected-genres":t.selectedGenres,genres:t.genres,"genre-loading":t.genreLoading,"genre-error":t.genreError,onToggle:t.safeSidebarStore.toggleSidebar,onSetCategory:t.setCategory,onNavigateToCalendar:t.navigateToCalendar,onNavigateToProfile:t.navigateToProfile,onNavigateToAdmin:t.debugNavigateToAdmin,onAddItem:t.addItemFromSidebar,onShowLogin:e[1]||(e[1]=p=>t.showLoginModal=!0),onShowRegister:e[2]||(e[2]=p=>t.showRegisterModal=!0),onShowAdminLogin:t.showAdminLogin,onLogout:t.logout,onGenresUpdated:t.handleGenresUpdated,onGenresCleared:t.handleGenresCleared,onLoadGenres:t.loadGenres},null,8,["collapsed","mobile-open","is-logged-in","is-admin","user-name","current-category","category-counts","categories","selected-genres","genres","genre-loading","genre-error","onToggle","onSetCategory","onNavigateToCalendar","onNavigateToProfile","onNavigateToAdmin","onAddItem","onShowAdminLogin","onLogout","onGenresUpdated","onGenresCleared","onLoadGenres"]),o("div",Wr,[ye(l,{"search-query":t.searchQuery,"onUpdate:searchQuery":e[3]||(e[3]=p=>t.searchQuery=p),"sort-by":t.sortBy,"onUpdate:sortBy":e[4]||(e[4]=p=>t.sortBy=p),onToggleMobileSidebar:t.safeSidebarStore.toggleMobileSidebar,onClearSearch:t.clearSearch},null,8,["search-query","sort-by","onToggleMobileSidebar","onClearSearch"]),o("main",Vr,[t.loading?(g(),Ue(f,{key:0,message:"Loading media data..."})):t.error?(g(),m("div",Or,[o("p",null,v(t.error),1),o("button",{onClick:e[5]||(e[5]=(...p)=>t.loadMedia&&t.loadMedia(...p))},"Retry")])):(g(),m("div",zr,[t.currentCategory==="calendar"?(g(),m("div",jr,[o("div",Yr,[o("button",{class:"month-nav-btn",onClick:e[6]||(e[6]=(...p)=>t.previousMonth&&t.previousMonth(...p)),disabled:i.isLoading},[...e[31]||(e[31]=[o("span",{class:"nav-icon"},"‹",-1)])],8,qr),o("div",Hr,[o("h2",Qr,v(t.currentMonthName),1),o("span",Jr,v(t.currentYear),1)]),o("button",{class:"month-nav-btn",onClick:e[7]||(e[7]=(...p)=>t.nextMonth&&t.nextMonth(...p)),disabled:i.isLoading},[...e[32]||(e[32]=[o("span",{class:"nav-icon"},"›",-1)])],8,Kr)]),o("div",Zr,[o("div",Xr,[(g(!0),m(oe,null,se(t.weekdays,p=>(g(),m("div",{class:"weekday-header",key:p},v(p),1))),128)),(g(!0),m(oe,null,se(t.calendarDays,p=>(g(),m("div",{key:`${p.date}-${p.month}`,class:Q(["calendar-day",{"other-month":!p.isCurrentMonth,today:p.isToday,weekend:p.isWeekend,"has-events":p.hasEvents}]),onClick:N=>t.selectDay(p)},[o("span",el,v(p.day),1),p.hasEvents?(g(),m("div",tl,[e[33]||(e[33]=o("div",{class:"event-dot"},null,-1)),p.events&&p.events.length>1?(g(),m("span",ol,v(p.events.length),1)):b("",!0)])):b("",!0)],10,$r))),128))])]),t.selectedDay?(g(),m("div",sl,[o("h3",null,v(t.formatSelectedDay(t.selectedDay)),1),o("div",al,[!t.selectedDay.events||t.selectedDay.events.length===0?(g(),m("p",nl," No watchlist releases scheduled for this day ")):(g(),m("div",il,[(g(!0),m(oe,null,se(t.selectedDay.events,p=>(g(),m("div",{key:p.id,class:Q(["event-item",`event-${p.type}`])},[o("div",rl,[o("span",ll,v(p.time),1),o("span",dl,v(p.type),1)]),o("span",cl,v(p.title),1),p.item.platforms?(g(),m("div",ul,v(p.item.platforms),1)):b("",!0),p.item.genre?(g(),m("div",gl,v(p.item.genre),1)):b("",!0)],2))),128))]))])])):b("",!0)])):t.currentCategory==="profile"?(g(),m("div",ml,[o("div",fl,[o("div",pl,[o("div",{class:"profile-avatar-large",onClick:e[8]||(e[8]=(...p)=>t.changeAvatar&&t.changeAvatar(...p))},[t.profileData.avatar?(g(),m("img",{key:0,src:t.profileData.avatar,alt:"Profile Picture"},null,8,vl)):(g(),m("span",hl,v(t.getInitials()),1))]),o("input",{type:"file",ref:"avatarInput",accept:"image/*",onChange:e[9]||(e[9]=(...p)=>t.handleAvatarChange&&t.handleAvatarChange(...p)),style:{display:"none"}},null,544)]),o("div",yl,[o("h2",null,v(t.profileData.displayName||t.profileData.firstName+" "+t.profileData.lastName||"User"),1),o("p",null,v(t.profileData.email||"user@example.com"),1),o("div",bl,[o("div",kl,[o("span",wl,v(i.totalItems),1),e[34]||(e[34]=o("span",{class:"stat-label"},"Total Items",-1))]),o("div",Sl,[o("span",Il,v(new Date().getFullYear()),1),e[35]||(e[35]=o("span",{class:"stat-label"},"Member Since",-1))])])])]),o("div",_l,[o("div",Cl,[e[41]||(e[41]=o("div",{class:"section-header"},[o("h3",null,"Personal Information"),o("p",null,"Manage your personal details and account information")],-1)),o("div",Dl,[o("div",Ul,[o("div",xl,[e[36]||(e[36]=o("label",{for:"firstName"},"First Name",-1)),x(o("input",{type:"text",id:"firstName","onUpdate:modelValue":e[10]||(e[10]=p=>t.profileData.firstName=p),placeholder:"Enter your first name"},null,512),[[L,t.profileData.firstName]])]),o("div",Al,[e[37]||(e[37]=o("label",{for:"lastName"},"Last Name",-1)),x(o("input",{type:"text",id:"lastName","onUpdate:modelValue":e[11]||(e[11]=p=>t.profileData.lastName=p),placeholder:"Enter your last name"},null,512),[[L,t.profileData.lastName]])])]),o("div",Tl,[e[38]||(e[38]=o("label",{for:"displayName"},"Display Name",-1)),x(o("input",{type:"text",id:"displayName","onUpdate:modelValue":e[12]||(e[12]=p=>t.profileData.displayName=p),placeholder:"How others see your name"},null,512),[[L,t.profileData.displayName]])]),o("div",Ml,[e[39]||(e[39]=o("label",{for:"email"},"Email Address",-1)),x(o("input",{type:"email",id:"email","onUpdate:modelValue":e[13]||(e[13]=p=>t.profileData.email=p),placeholder:"your.email@example.com"},null,512),[[L,t.profileData.email]])]),o("div",Bl,[e[40]||(e[40]=o("label",{for:"bio"},"Bio",-1)),x(o("textarea",{id:"bio","onUpdate:modelValue":e[14]||(e[14]=p=>t.profileData.bio=p),placeholder:"Tell us about yourself...",rows:"4"},null,512),[[L,t.profileData.bio]])])])]),o("div",El,[e[53]||(e[53]=o("div",{class:"section-header"},[o("h3",null,"Preferences"),o("p",null,"Customize your application experience")],-1)),o("div",Rl,[o("div",Pl,[o("div",Ll,[e[43]||(e[43]=o("label",{for:"language"},"Language",-1)),x(o("select",{id:"language","onUpdate:modelValue":e[15]||(e[15]=p=>t.profileData.language=p)},[...e[42]||(e[42]=[o("option",{value:"en"},"English",-1),o("option",{value:"de"},"Deutsch",-1),o("option",{value:"fr"},"Français",-1),o("option",{value:"es"},"Español",-1)])],512),[[be,t.profileData.language]])]),o("div",Gl,[e[45]||(e[45]=o("label",{for:"timezone"},"Timezone",-1)),x(o("select",{id:"timezone","onUpdate:modelValue":e[16]||(e[16]=p=>t.profileData.timezone=p)},[...e[44]||(e[44]=[o("option",{value:"UTC"},"UTC",-1),o("option",{value:"Europe/Berlin"},"Europe/Berlin",-1),o("option",{value:"America/New_York"},"America/New_York",-1),o("option",{value:"America/Los_Angeles"},"America/Los_Angeles",-1)])],512),[[be,t.profileData.timezone]])])]),o("div",Fl,[o("div",Nl,[e[47]||(e[47]=o("label",{for:"dateFormat"},"Date Format",-1)),x(o("select",{id:"dateFormat","onUpdate:modelValue":e[17]||(e[17]=p=>t.profileData.dateFormat=p)},[...e[46]||(e[46]=[o("option",{value:"MM/DD/YYYY"},"MM/DD/YYYY",-1),o("option",{value:"DD/MM/YYYY"},"DD/MM/YYYY",-1),o("option",{value:"YYYY-MM-DD"},"YYYY-MM-DD",-1)])],512),[[be,t.profileData.dateFormat]])]),o("div",Wl,[e[49]||(e[49]=o("label",{for:"booksApiProvider"},"Books API Provider",-1)),x(o("select",{id:"booksApiProvider","onUpdate:modelValue":e[18]||(e[18]=p=>t.profileData.booksApiProvider=p)},[...e[48]||(e[48]=[o("option",{value:"wikipedia"},"Wikipedia (Primary)",-1),o("option",{value:"google_books"},"Google Books (Fallback)",-1),o("option",{value:"both"},"Both (Wikipedia + Google Books)",-1)])],512),[[be,t.profileData.booksApiProvider]])])]),o("div",Vl,[o("div",Ol,[e[51]||(e[51]=o("label",{for:"enableGoogleBooksFallback"},"Enable Google Books Fallback",-1)),o("div",zl,[x(o("input",{type:"checkbox",id:"enableGoogleBooksFallback","onUpdate:modelValue":e[19]||(e[19]=p=>t.profileData.enableGoogleBooksFallback=p)},null,512),[[dt,t.profileData.enableGoogleBooksFallback]]),e[50]||(e[50]=o("label",{for:"enableGoogleBooksFallback",class:"checkbox-label"}," Use Google Books as fallback when Wikipedia search fails ",-1))])]),e[52]||(e[52]=o("div",{class:"form-group"},null,-1))])])]),o("div",jl,[e[58]||(e[58]=o("div",{class:"section-header"},[o("h3",null,"Data Management"),o("p",null,"Manage your data and account")],-1)),o("div",Yl,[o("div",ql,[o("button",{class:"data-btn export-btn",onClick:e[20]||(e[20]=(...p)=>t.exportData&&t.exportData(...p))},[...e[54]||(e[54]=[o("span",{class:"btn-icon"},"📦",-1),o("span",{class:"btn-text"},"Export All Data",-1),o("span",{class:"btn-description"},"Download your complete media library",-1)])]),o("button",{class:"data-btn import-btn",onClick:e[21]||(e[21]=(...p)=>t.importData&&t.importData(...p))},[...e[55]||(e[55]=[o("span",{class:"btn-icon"},"📥",-1),o("span",{class:"btn-text"},"Import Data",-1),o("span",{class:"btn-description"},"Import data from a backup file",-1)])]),o("button",{class:"data-btn backup-btn",onClick:e[22]||(e[22]=(...p)=>t.createBackup&&t.createBackup(...p))},[...e[56]||(e[56]=[o("span",{class:"btn-icon"},"💾",-1),o("span",{class:"btn-text"},"Create Backup",-1),o("span",{class:"btn-description"},"Create a local backup of your data",-1)])]),o("button",{class:"data-btn cache-btn",onClick:e[23]||(e[23]=(...p)=>t.clearCache&&t.clearCache(...p))},[...e[57]||(e[57]=[o("span",{class:"btn-icon"},"🗑️",-1),o("span",{class:"btn-text"},"Clear Cache",-1),o("span",{class:"btn-description"},"Clear temporary files and cache",-1)])])])])]),o("div",Hl,[e[61]||(e[61]=o("div",{class:"section-header"},[o("h3",null,"Danger Zone"),o("p",null,"Irreversible and destructive actions")],-1)),o("div",Ql,[o("div",Jl,[o("button",{class:"danger-btn reset-btn",onClick:e[24]||(e[24]=(...p)=>t.resetSettings&&t.resetSettings(...p))},[...e[59]||(e[59]=[o("span",{class:"btn-icon"},"🔄",-1),o("span",{class:"btn-text"},"Reset All Settings",-1),o("span",{class:"btn-description"},"Reset all settings to default values",-1)])]),o("button",{class:"danger-btn clear-btn",onClick:e[25]||(e[25]=(...p)=>t.clearAllData&&t.clearAllData(...p))},[...e[60]||(e[60]=[o("span",{class:"btn-icon"},"🗑️",-1),o("span",{class:"btn-text"},"Clear All Data",-1),o("span",{class:"btn-description"},"Permanently delete all your data",-1)])])])])])])])):t.currentCategory==="statistics"?(g(),m("div",Kl,[o("div",Zl,[e[62]||(e[62]=o("h1",null,"📊 Media Library Statistics",-1)),e[63]||(e[63]=o("p",null,"Übersicht über deine Media Collection",-1)),o("div",Xl,[o("button",{class:"refresh-btn",onClick:e[26]||(e[26]=(...p)=>t.loadMedia&&t.loadMedia(...p))},"🔄 Refresh Statistics")])]),o("div",$l,[o("div",ed,[o("div",td,[o("div",od,v(t.statistics.totalItems),1),e[64]||(e[64]=o("div",{class:"summary-label"},"Total Items",-1))]),o("div",sd,[o("div",ad,v(t.statistics.totalCollections),1),e[65]||(e[65]=o("div",{class:"summary-label"},"Collections",-1))]),o("div",nd,[o("div",id,v(t.statistics.totalPlaytime)+"h",1),e[66]||(e[66]=o("div",{class:"summary-label"},"Total Playtime",-1))]),o("div",rd,[o("div",ld,v(t.statistics.avgRating),1),e[67]||(e[67]=o("div",{class:"summary-label"},"Avg Rating",-1))])]),o("div",dd,[e[68]||(e[68]=o("h3",{class:"chart-title"},"📈 Category Distribution",-1)),o("div",cd,[(g(!0),m(oe,null,se(t.statistics.categoryDistribution,(p,N)=>(g(),m("div",{key:N,class:"category-stat"},[o("div",ud,v(N),1),o("div",gd,[o("div",{class:"category-fill",style:Ae({width:`${p/t.statistics.totalItems*100}%`})},null,4)]),o("div",md,v(p)+" ("+v((p/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),o("div",fd,[e[69]||(e[69]=o("h3",{class:"chart-title"},"⭐ Rating Distribution",-1)),o("div",pd,[(g(!0),m(oe,null,se(t.statistics.ratingDistribution,(p,N)=>(g(),m("div",{key:N,class:"rating-stat"},[o("div",vd,v(t.getRatingStars(N)),1),o("div",hd,[o("div",{class:"rating-fill",style:Ae({width:`${p/t.statistics.totalItems*100}%`})},null,4)]),o("div",yd,v(p)+" ("+v((p/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),o("div",bd,[e[70]||(e[70]=o("h3",{class:"chart-title"},"🎮 Platform Distribution",-1)),o("div",kd,[(g(!0),m(oe,null,se(t.statistics.platformDistribution,(p,N)=>(g(),m("div",{key:N,class:"platform-stat"},[o("div",wd,v(N),1),o("div",Sd,[o("div",{class:"platform-fill",style:Ae({width:`${p/t.statistics.totalItems*100}%`})},null,4)]),o("div",Id,v(p)+" ("+v((p/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),o("div",_d,[e[71]||(e[71]=o("h3",{class:"chart-title"},"🎭 Top Genres",-1)),o("div",Cd,[(g(!0),m(oe,null,se(t.statistics.genreDistribution,(p,N)=>(g(),m("div",{key:N,class:"genre-stat"},[o("div",Dd,v(N),1),o("div",Ud,[o("div",{class:"genre-fill",style:Ae({width:`${p/t.statistics.totalItems*100}%`})},null,4)]),o("div",xd,v(p)+" ("+v((p/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),o("div",Ad,[e[72]||(e[72]=o("h3",{class:"chart-title"},"📅 Recent Activity",-1)),o("div",Td,[(g(!0),m(oe,null,se(t.statistics.recentActivity,p=>(g(),m("div",{key:p.title,class:"activity-item"},[o("div",Md,v(p.title),1),o("div",Bd,v(p.category),1),o("div",Ed,v(t.formatDate(p.discovered)),1)]))),128))])]),o("div",Rd,[e[73]||(e[73]=o("h3",{class:"chart-title"},"📺 Currently Airing Series",-1)),o("div",Pd,[(g(!0),m(oe,null,se(t.statistics.airingSeries,p=>(g(),m("div",{key:p.title,class:"airing-item"},[o("div",Ld,v(p.title),1),o("div",Gd,"Next: Season "+v(p.nextSeason),1),o("div",Fd,v(p.nextSeasonRelease?t.formatDate(p.nextSeasonRelease):"TBA"),1)]))),128))])])])])):(g(),m("div",Nd,[(g(!0),m(oe,null,se(t.paginatedMedia,p=>(g(),Ue(c,{key:p.id,item:p,onEdit:t.editItem},null,8,["item","onEdit"]))),128))]))]))])]),t.isLoggedIn?b("",!0):(g(),m("div",Wd,[o("button",{onClick:e[27]||(e[27]=(...p)=>t.handleAdminSetup&&t.handleAdminSetup(...p)),disabled:t.adminSetupLoading,class:"admin-setup-btn",title:"Setup Admin Account (Creates admin account with default password)"},[t.adminSetupLoading?(g(),m("span",Od,"🔧 Setting up...")):(g(),m("span",zd,"🔧 Admin Setup"))],8,Vd),t.adminSetupMessage?(g(),m("div",{key:0,class:Q(["admin-setup-message",t.adminSetupMessage.type])},v(t.adminSetupMessage.text),3)):b("",!0)])),t.showLoginModal?(g(),Ue(U,{key:1,onClose:e[28]||(e[28]=p=>t.showLoginModal=!1),onSuccess:t.handleLoginSuccess,onSwitchToRegister:t.switchToRegister},null,8,["onSuccess","onSwitchToRegister"])):b("",!0),t.showRegisterModal?(g(),Ue(D,{key:2,onClose:e[29]||(e[29]=p=>t.showRegisterModal=!1),onSuccess:t.handleRegisterSuccess},null,8,["onSuccess"])):b("",!0),t.showEditModal?(g(),Ue(_,{key:3,item:t.editingItem,"current-category":t.currentCategory,onClose:t.closeEditModal,onSave:t.handleSaveItem,onDelete:t.handleDeleteItem},null,8,["item","current-category","onClose","onSave","onDelete"])):b("",!0),ye(w,{show:t.showBulkAddModal,"current-category":t.currentCategory,onClose:t.closeBulkAddModal},null,8,["show","current-category","onClose"]),ye(J,{show:t.showTxtImportModal,onClose:e[30]||(e[30]=p=>t.showTxtImportModal=!1),onFileProcessed:t.processTxtContent},null,8,["show","onFileProcessed"]),ye(Z,{show:t.showTxtImportResults,results:t.txtImportResults,onClose:t.closeTxtImportResults},null,8,["show","results","onClose"]),ye(F,{"show-menu":t.showFloatingMenu,"show-delete-all":t.isLoggedIn&&t.currentCategory!=="all"&&t.categoryCounts[t.currentCategory]>0,"category-name":t.currentCategoryDisplayName,"item-count":t.categoryCounts[t.currentCategory]||0,onToggleMenu:t.toggleFloatingMenu,onAddNewItem:t.addNewItem,onBulkAddItems:t.bulkAddItems,onImportFromTxt:t.importFromTxt,onImportFromApi:t.importFromAPI,onCreateCollection:t.createCollection,onDeleteAllInCategory:t.deleteAllInCategory},null,8,["show-menu","show-delete-all","category-name","item-count","onToggleMenu","onAddNewItem","onBulkAddItems","onImportFromTxt","onImportFromApi","onCreateCollection","onDeleteAllInCategory"]),ye(le,{show:t.messageStore.show,type:t.messageStore.type,title:t.messageStore.title,message:t.messageStore.message,details:t.messageStore.details,onClose:t.messageStore.closeMessage},null,8,["show","type","title","message","details","onClose"]),ye(fe,{show:t.confirmStore.show,title:t.confirmStore.title,message:t.confirmStore.message,onConfirm:t.confirmStore.confirm,onClose:t.confirmStore.cancel},null,8,["show","title","message","onConfirm","onClose"]),ye(ce,{show:t.inputStore.show,title:t.inputStore.title,message:t.inputStore.message,placeholder:t.inputStore.placeholder,"input-type":t.inputStore.inputType,"default-value":t.inputStore.defaultValue,onConfirm:t.inputStore.confirm,onClose:t.inputStore.cancel},null,8,["show","title","message","placeholder","input-type","default-value","onConfirm","onClose"])])}const qd=ae(Fr,[["render",jd],["__scopeId","data-v-fe065bdb"]]);export{qd as default};
