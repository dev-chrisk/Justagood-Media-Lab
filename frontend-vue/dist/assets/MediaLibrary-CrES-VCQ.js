import{A as Qt,d as We,r as k,w as Ue,c as G,m as re,u as Jt,a as Qe,_ as oe,b as m,e as s,f as S,F as se,g as ae,t as p,n as H,o as u,h as de,i as be,j as le,k as Le,l as Kt,T as Zt,p as Ge,q as Pe,s as M,v as L,x as ut,y as ke,z as mt,B as Be,C as qe,D as Xt,E as $t,G as es,H as ts}from"./index-D06qrxvp.js";class ss{constructor(){this.isConnected={value:!1},this.listeners=new Map,this.pollingInterval=null,this.lastUpdate=null,this.pollingIntervalMs=2e4}getApiBaseUrl(){return Qt.BASE_URL}connect(){if(this.pollingInterval)return;const e=localStorage.getItem("authToken"),o=localStorage.getItem("currentUser");!e||!o||(this.isConnected.value=!0,this.lastUpdate=new Date,this.pollingInterval=setInterval(()=>{this.checkForUpdates()},this.pollingIntervalMs))}async checkForUpdates(){try{const e=localStorage.getItem("authToken"),o=localStorage.getItem("currentUser");if(!e||!o)return;const t=this.getApiBaseUrl(),i=await fetch(`${t}/api/media`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!i.ok){if(i.status===401){this.disconnect();return}throw new Error(`HTTP error! status: ${i.status}`)}const d=await i.json();d&&d.length>0&&this.listeners.forEach((l,c)=>{try{l({type:"media_updated",items:d,count:d.length,timestamp:new Date().toISOString()})}catch{}}),this.lastUpdate=new Date}catch{}}addListener(e,o){this.listeners.set(e,o)}removeListener(e){this.listeners.delete(e)}disconnect(){this.pollingInterval&&(clearInterval(this.pollingInterval),this.pollingInterval=null),this.isConnected.value=!1}destroy(){this.disconnect(),this.listeners.clear()}}const $e=new ss,Je=We("media",()=>{const n=()=>{try{return localStorage.getItem("currentCategory")||"game"}catch(v){return console.error("Failed to load current category from localStorage:",v),"game"}},e=v=>{try{localStorage.setItem("currentCategory",v)}catch(a){console.error("Failed to save current category to localStorage:",a)}},o=()=>{try{return localStorage.getItem("searchQuery")||""}catch(v){return console.error("Failed to load search query from localStorage:",v),""}},t=v=>{try{localStorage.setItem("searchQuery",v)}catch(a){console.error("Failed to save search query to localStorage:",a)}},i=k(r()),d=k(n()),l=k(o()),c=k(null),f=k([]),w=k([]),R=k(!1),x=k(null),I=k(!1);Ue(d,v=>{e(v)},{immediate:!1}),Ue(l,v=>{t(v)},{immediate:!1});function r(){try{const v=localStorage.getItem("authToken"),a=localStorage.getItem("currentUser");if(!v||!a){const y=localStorage.getItem("mediaData");return y?JSON.parse(y):[]}return[]}catch(v){return console.error("Failed to load media from storage:",v),[]}}function V(){try{const v=localStorage.getItem("authToken"),a=localStorage.getItem("currentUser");(!v||!a)&&localStorage.setItem("mediaData",JSON.stringify(i.value))}catch(v){console.error("Failed to save media to storage:",v)}}const ne=G(()=>i.value.length),q=G(()=>{const v={};return i.value.forEach(a=>{const y=a.category||"unknown";v[y]=(v[y]||0)+1}),v}),ge=G(()=>{let v=[...i.value];if(d.value&&d.value!=="all"&&(v=v.filter(a=>d.value==="watchlist"?a.category==="watchlist"||a.isNew===!0:a.category===d.value)),f.value&&f.value.length>0&&(v=v.filter(a=>{if(!a.genre)return!1;const y=a.genre.split(",").map(D=>D.trim().toLowerCase());return f.value.some(D=>y.some(A=>A.includes(D.toLowerCase())))})),w.value&&w.value.length>0&&(v=v.filter(a=>{if(!a.genre)return!0;const y=a.genre.split(",").map(D=>D.trim().toLowerCase());return!w.value.some(D=>y.some(A=>A.includes(D.toLowerCase())))})),l.value){const a=l.value.toLowerCase();v=v.filter(y=>{var D,A,T,z;return((D=y.title)==null?void 0:D.toLowerCase().includes(a))||((A=y.description)==null?void 0:A.toLowerCase().includes(a))||((T=y.genre)==null?void 0:T.toLowerCase().includes(a))||((z=y.platforms)==null?void 0:z.toLowerCase().includes(a))})}return v});async function ee(){var v,a;R.value=!0,x.value=null;try{const y=localStorage.getItem("authToken"),D=localStorage.getItem("currentUser");if(y&&D)try{const A=await re.getMedia();i.value=A||[]}catch(A){console.warn("API load failed for logged in user:",A),i.value=[]}else{const A=r();if(A.length>0)i.value=A;else{const T=await re.getMedia();i.value=T||[],V()}}}catch(y){x.value=((a=(v=y.response)==null?void 0:v.data)==null?void 0:a.message)||y.message||"Failed to load media data",console.error("Failed to load media:",y)}finally{R.value=!1}}function ce(v){d.value=v}function h(v){l.value=v}function W(v){c.value=v}function ue(){c.value=null}function me(v){f.value=v}function Se(){f.value=[]}function pe(v){w.value=v}function Ae(){w.value=[]}function Te(v){const a=[...w.value],y=a.indexOf(v);y>-1?a.splice(y,1):a.push(v),w.value=a}function $(){I.value=!I.value}function j(v){I.value=v}async function Z(v,a){try{const y=localStorage.getItem("authToken"),D=localStorage.getItem("currentUser");if(y&&D)try{await re.updateMediaItem(v,{personal_rating:a});const A=i.value.findIndex(T=>T.id===v);return A!==-1&&(i.value[A].personal_rating=a),!0}catch(A){throw console.error("API rating update failed:",A),A}else{const A=i.value.findIndex(T=>T.id===v);if(A!==-1)return i.value[A].personal_rating=a,V(),!0;throw new Error("Media item not found")}}catch(y){throw console.error("Failed to update rating:",y),y}}async function Q(v,a=!1){var y,D,A;x.value=null;try{const T=localStorage.getItem("authToken"),z=localStorage.getItem("currentUser");if(T&&z)try{const ie=await re.addMediaItem(v);if(!a)await ee();else{const he={...ie,__order:i.value.length};i.value.push(he)}return ie}catch(ie){if(((y=ie.response)==null?void 0:y.status)===409&&((A=(D=ie.response)==null?void 0:D.data)!=null&&A.duplicate)){const he=new Error(ie.response.data.error||"Ein Eintrag mit diesem Titel und dieser Kategorie existiert bereits.");throw he.isDuplicate=!0,he}throw x.value=ie.message||"Failed to add media item",console.error("API save failed for logged in user:",ie),ie}else{const ie={id:Date.now(),...v,__order:i.value.length};return i.value.push(ie),V(),ie}}catch(T){throw T}}async function ve(v,a){x.value=null,console.log("🔍 ULTRA DEBUG - Store updateMediaItem called with:",{id:v,watchlist_release_date:a.watchlist_release_date,next_season_release:a.next_season_release,watchlist_number:a.watchlist_number,is_airing:a.is_airing,type_watchlist:typeof a.watchlist_release_date,type_next:typeof a.next_season_release,type_watchlist_number:typeof a.watchlist_number,is_null_watchlist:a.watchlist_release_date===null,is_null_next:a.next_season_release===null,is_null_watchlist_number:a.watchlist_number===null,is_undefined_watchlist:a.watchlist_release_date===void 0,is_undefined_next:a.next_season_release===void 0,is_undefined_watchlist_number:a.watchlist_number===void 0,is_empty_watchlist:a.watchlist_release_date==="",is_empty_next:a.next_season_release==="",is_empty_watchlist_number:a.watchlist_number==="",FULL_ITEM_DATA:a});try{const y=localStorage.getItem("authToken"),D=localStorage.getItem("currentUser");if(y&&D)try{console.log("🔍 ULTRA DEBUG - Store calling API updateMediaItem with:",{id:v,watchlist_release_date:a.watchlist_release_date,next_season_release:a.next_season_release,watchlist_number:a.watchlist_number,type_watchlist:typeof a.watchlist_release_date,type_next:typeof a.next_season_release,type_watchlist_number:typeof a.watchlist_number,is_null_watchlist:a.watchlist_release_date===null,is_null_next:a.next_season_release===null,is_null_watchlist_number:a.watchlist_number===null,is_undefined_watchlist:a.watchlist_release_date===void 0,is_undefined_next:a.next_season_release===void 0,is_undefined_watchlist_number:a.watchlist_number===void 0,FULL_ITEM_DATA:a});const A=await re.updateMediaItem(v,a);return console.log("🔍 COMPREHENSIVE DEBUG - Store API updateMediaItem returned:",A),await ee(),A}catch(A){throw console.error("API update failed for logged in user:",A),A}else{const A=i.value.findIndex(T=>T.id===v);if(A!==-1)return i.value[A]={...i.value[A],...a},V(),i.value[A];throw new Error("Media item not found")}}catch(y){throw y.isDuplicate||(x.value=y.message||"Failed to update media item"),y}}async function xe(v){var a;try{const y=localStorage.getItem("authToken"),D=localStorage.getItem("currentUser");if(y&&D)try{return await re.deleteMediaItem(v),await ee(),!0}catch(A){if(((a=A.response)==null?void 0:a.status)===404||A.isNotFound)return await ee(),!0;throw console.error("API delete failed for logged in user:",A),A}else{const A=i.value.findIndex(T=>T.id===v);if(A!==-1)return i.value.splice(A,1),V(),!0;throw new Error("Media item not found")}}catch(y){throw x.value=y.message||"Failed to delete media item",y}}async function ye(v){try{const a=localStorage.getItem("authToken"),y=localStorage.getItem("currentUser");if(a&&y)try{const D=await re.batchAddMediaItems(v);return await ee(),D}catch(D){throw console.error("API batch add failed for logged in user:",D),D}else{const D=v.map((A,T)=>({id:Date.now()+T,...A,__order:i.value.length+T}));return i.value.push(...D),V(),{success:!0,stats:{created:D.length,failed:0,errors:[]}}}}catch(a){throw x.value=a.message||"Failed to add media items",a}}async function Ce(v){try{const a=localStorage.getItem("authToken"),y=localStorage.getItem("currentUser");if(a&&y)try{return await re.batchDeleteMediaItems(v),await ee(),!0}catch(D){if(D.silent)return console.log("Silent batch delete error (some items may not exist):",D.message),await ee(),!0;throw console.error("API batch delete failed for logged in user:",D),D}else return i.value=i.value.filter(D=>!v.includes(D.id)),V(),!0}catch(a){throw a.silent||(x.value=a.message||"Failed to delete media items"),a}}async function Ie(){try{const v=localStorage.getItem("authToken"),a=localStorage.getItem("currentUser");v&&a?await re.saveMedia(i.value):V()}catch(v){console.error("Failed to save media:",v)}}function _e(){x.value=null}function De(v){if(console.log("Processing real-time update:",v),v.type==="media_updated"&&v.items)v.items.forEach(a=>{const y=i.value.findIndex(D=>D.id===a.id);y!==-1?i.value[y]={...i.value[y],...a}:i.value.push(a)});else if(v.action==="created"||v.action==="updated"){const a=v.item,y=i.value.findIndex(D=>D.id===a.id);y!==-1?i.value[y]={...i.value[y],...a}:i.value.push(a)}else if(v.action==="deleted"){const a=i.value.findIndex(y=>y.id===v.id);a!==-1&&i.value.splice(a,1)}V()}function fe(){const v=localStorage.getItem("authToken"),a=localStorage.getItem("currentUser");if(!v||!a){console.log("Skipping realtime initialization - user not authenticated");return}try{$e.addListener("media-store",De),$e.connect()}catch(y){console.error("Failed to initialize realtime updates:",y)}}function g(){$e.removeListener("media-store")}return{mediaData:i,currentCategory:d,searchQuery:l,selectedGenre:c,selectedGenres:f,excludedGenres:w,loading:R,error:x,editMode:I,totalItems:ne,categoryCounts:q,filteredMedia:ge,loadMedia:ee,setCategory:ce,setSearchQuery:h,setGenre:W,clearGenre:ue,setGenres:me,clearGenres:Se,setExcludedGenres:pe,clearExcludedGenres:Ae,toggleGenreExclude:Te,toggleEditMode:$,setEditMode:j,updateItemRating:Z,addMediaItem:Q,updateMediaItem:ve,deleteMediaItem:xe,batchAddMediaItems:ye,batchDeleteMediaItems:Ce,saveMedia:Ie,clearError:_e,initializeRealtimeUpdates:fe,cleanupRealtimeUpdates:g,resetMediaState:()=>{d.value="game",l.value="",localStorage.removeItem("currentCategory"),localStorage.removeItem("searchQuery")}}}),gt=We("message",()=>{const n=k(!1),e=k("info"),o=k(""),t=k(""),i=k("");function d(x){e.value=x.type||"info",o.value=x.title||"",t.value=x.message||"",i.value=x.details||"",n.value=!0}function l(x,I="Success",r=""){d({type:"success",title:I,message:x,details:r})}function c(x,I="Error",r=""){d({type:"error",title:I,message:x,details:r})}function f(x,I="Warning",r=""){d({type:"warning",title:I,message:x,details:r})}function w(x,I="Info",r=""){d({type:"info",title:I,message:x,details:r})}function R(){n.value=!1,setTimeout(()=>{e.value="info",o.value="",t.value="",i.value=""},300)}return{show:n,type:e,title:o,message:t,details:i,showMessage:d,showSuccess:l,showError:c,showWarning:f,showInfo:w,closeMessage:R}}),ft=We("confirm",()=>{const n=k(!1),e=k("Confirm Action"),o=k(""),t=k(null);function i(c){return new Promise(f=>{e.value=c.title||"Confirm Action",o.value=c.message||"",n.value=!0,t.value=f})}function d(){t.value&&(t.value(!0),t.value=null),n.value=!1}function l(){t.value&&(t.value(!1),t.value=null),n.value=!1}return{show:n,title:e,message:o,showConfirm:i,confirm:d,cancel:l}}),ht=We("input",()=>{const n=k(!1),e=k("Input Required"),o=k(""),t=k(""),i=k("text"),d=k(""),l=k(null);function c(R){return new Promise(x=>{e.value=R.title||"Input Required",o.value=R.message||"",t.value=R.placeholder||"",i.value=R.inputType||"text",d.value=R.defaultValue||"",n.value=!0,l.value=x})}function f(R){l.value&&(l.value(R),l.value=null),n.value=!1}function w(){l.value&&(l.value(null),l.value=null),n.value=!1}return{show:n,title:e,message:o,placeholder:t,inputType:i,defaultValue:d,showInput:c,confirm:f,cancel:w}}),pt=We("sidebar",()=>{const n=()=>{try{const r=localStorage.getItem("sidebarState");if(r)return{collapsed:JSON.parse(r).collapsed||!1,mobileOpen:!1}}catch(r){console.error("Failed to load sidebar state from localStorage:",r)}return{collapsed:!1,mobileOpen:!1}},e=r=>{try{localStorage.setItem("sidebarState",JSON.stringify({collapsed:r.collapsed}))}catch(V){console.error("Failed to save sidebar state to localStorage:",V)}},o=n(),t=k(o.collapsed),i=k(o.mobileOpen);Ue(t,r=>{e({collapsed:r,mobileOpen:i.value})},{immediate:!1});const d=()=>{t.value=!t.value},l=()=>{i.value=!i.value},c=()=>{i.value=!1},f=r=>{t.value=r},w=r=>{i.value=r},R=()=>{t.value=!1,i.value=!1,localStorage.removeItem("sidebarState")},x=G(()=>t.value),I=G(()=>i.value);return{collapsed:t,mobileOpen:i,toggleSidebar:d,toggleMobileSidebar:l,closeMobileSidebar:c,setCollapsed:f,setMobileOpen:w,resetSidebarState:R,isCollapsed:x,isMobileOpen:I}});function as(){const n=Jt(),e=Qe(),o=Je(),t=gt(),i=ft(),d=ht(),l=k(!1),c=k(!1),f=k(!1),w=k(!1),R=k(!1),x=k(!1),I=k(!1),r=k(null),V=()=>typeof window<"u"?window.innerWidth>768?8:3:8,ne=k(V()),q=k("order_asc"),ge=k(null),ee=()=>{ne.value=V()};typeof window<"u"&&window.addEventListener("resize",ee);const ce=[{key:"game",name:"Games",icon:"🎮"},{key:"series",name:"Series",icon:"📺"},{key:"movie",name:"Movies",icon:"🎬"},{key:"buecher",name:"Bücher",icon:"📚"},{key:"watchlist",name:"Watchlist",icon:"❤️"}],h=G(()=>{try{return e.isLoggedIn}catch(C){return console.error("Error accessing authStore.isLoggedIn:",C),!1}}),W=G(()=>{try{return e.userName}catch(C){return console.error("Error accessing authStore.userName:",C),""}}),ue=G(()=>{try{return e.isAdmin}catch(C){return console.error("Error accessing authStore.isAdmin:",C),!1}}),me=G(()=>{try{return o.currentCategory}catch(C){return console.error("Error accessing mediaStore.currentCategory:",C),"game"}}),Se=G({get:()=>{try{return o.searchQuery}catch(C){return console.error("Error accessing mediaStore.searchQuery:",C),""}},set:C=>{try{o.setSearchQuery(C)}catch(U){console.error("Error setting mediaStore.searchQuery:",U)}}}),pe=G(()=>{try{return o.categoryCounts}catch(C){return console.error("Error accessing mediaStore.categoryCounts:",C),{}}}),Ae=G(()=>{try{return o.excludedGenres}catch(C){return console.error("Error accessing mediaStore.excludedGenres:",C),[]}}),Te=G(()=>{try{return o.loading}catch(C){return console.error("Error accessing mediaStore.loading:",C),!1}}),$=G(()=>{try{return o.error}catch(C){return console.error("Error accessing mediaStore.error:",C),null}}),j=G(()=>{try{const C=[...o.filteredMedia||[]],[U,X]=q.value.split("_");return C.sort((P,F)=>{let K=P[U],O=F[U];return U==="order"?(K=P.__order||0,O=F.__order||0):U==="airing"?(K=P.is_airing?1:0,O=F.is_airing?1:0):U==="api_rating"?(K=P.api_rating||P.rating||0,O=F.api_rating||F.rating||0):U==="personal_rating"?(K=P.personal_rating||0,O=F.personal_rating||0):U==="release"?(K=P.release?new Date(P.release).getTime():0,O=F.release?new Date(F.release).getTime():0):U==="title"&&(K=P.title||"",O=F.title||""),K==null&&(K=0),O==null&&(O=0),typeof K=="string"&&(K=K.toLowerCase(),O=O.toLowerCase()),X==="asc"?K>O?1:-1:K<O?1:-1})}catch(C){return console.error("Error in sortedMedia computed:",C),[]}}),Z=G(()=>j.value),Q=C=>{o.setCategory(C),pt().closeMobileSidebar()},ve=()=>{o.setSearchQuery("")},xe=C=>{r.value=C,f.value=!0},ye=()=>{f.value=!1,r.value=null},Ce=()=>{R.value=!1},Ie=async C=>{console.log("handleBulkAddItems called but not used in new workflow")},_e=async C=>{r.value?await o.updateMediaItem(r.value.id,C):await o.addMediaItem(C),ye()},De=async C=>{var U;try{await o.deleteMediaItem(C.id)}catch(X){((U=X.response)==null?void 0:U.status)!==404&&!X.silent&&(console.error("Delete failed:",X),t.showError("Failed to delete item: "+(X.message||"Unknown error"),"Delete Failed"))}},fe=async()=>{await e.logout(),await g()},g=async()=>{try{await o.loadMedia()}catch(C){console.error("Error loading media:",C)}},b=()=>{w.value=!w.value},v=()=>{if(w.value=!1,!h.value){t.showWarning("Bitte loggen Sie sich ein, um neue Items hinzuzufügen.","Login erforderlich");return}r.value=null,f.value=!0},a=()=>{if(w.value=!1,!h.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}R.value=!0},y=()=>{if(w.value=!1,!h.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}x.value=!0},D=()=>{if(w.value=!1,!h.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}t.showInfo("API Import feature coming soon!","Feature in Entwicklung")},A=()=>{if(w.value=!1,!h.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}Ve()},T=C=>{if(!C)return"Unknown";const U=ce.find(X=>X.key===C);return U?U.name:C},z=async()=>{const C=T(me.value),U=pe.value[me.value]||0;if(U===0){t.showInfo("No items to delete in this category.","Nothing to Delete");return}const X=`Are you sure you want to delete ALL ${U} items in "${C}"?

This action cannot be undone!`;if(await i.showConfirm({title:"Delete All Items",message:X}))try{const K=((o==null?void 0:o.mediaData)||[]).filter(O=>me.value==="watchlist"?O.category==="watchlist"||O.isNew===!0:O.category===me.value).map(O=>O.id);await o.batchDeleteMediaItems(K),await g(),t.showSuccess(`Successfully deleted ${U} items from "${C}"`,"Items Deleted")}catch(F){console.error("Error deleting items:",F),F.silent?t.showSuccess(`Items deleted from "${C}" (some items may not have existed)`,"Items Deleted"):F.isNotFound?t.showWarning("Some items were not found and could not be deleted, but the operation completed.","Partial Success"):t.showError("Error occurred while deleting items. Please try again.","Delete Failed")}},ie=C=>{const U=C.split(`
`).map(O=>O.trim()).filter(O=>O.length>0);if(U.length===0){t.showWarning("Die TXT-Datei ist leer oder enthält keine gültigen Einträge.","Leere Datei");return}const P=o.filteredMedia.map(O=>O.title.toLowerCase().trim()),F=U.filter(O=>{const Re=O.toLowerCase().trim();return!P.some(Ee=>Ee.includes(Re)||Re.includes(Ee))}),K=U.filter(O=>{const Re=O.toLowerCase().trim();return P.some(Ee=>Ee.includes(Re)||Re.includes(Ee))});ge.value={totalInFile:U.length,missingItems:F,existingItems:K,currentCategory:me.value,categoryName:T(me.value)},x.value=!1,I.value=!0},he=()=>{ge.value=null,I.value=!1},Ve=async()=>{const C=(o==null?void 0:o.mediaData)||[];if(C.length===0){t.showInfo("Keine Media Items zum Exportieren gefunden.","Nichts zu exportieren");return}const U=await d.showInput({title:"Export Format wählen",message:`1 = CSV
2 = JSON
3 = Beide

Geben Sie die Nummer ein:`,placeholder:"1",defaultValue:"1"});if(!U||!["1","2","3"].includes(U))return;const X=new Date().toISOString().split("T")[0];(U==="1"||U==="3")&&Oe(C,X),(U==="2"||U==="3")&&je(C,X),t.showSuccess(`Collection mit ${C.length} Items wurde erfolgreich exportiert!`,"Export erfolgreich")},Oe=(C,U)=>{const P=[["Titel","Kategorie","Release","Rating","Platforms","Genre","Spielzeit","Status","Beschreibung"].join(","),...C.map(F=>[`"${(F.title||"").replace(/"/g,'""')}"`,`"${(F.category||F.category_name||"Unbekannt").replace(/"/g,'""')}"`,`"${F.release||""}"`,`"${F.rating||""}"`,`"${(F.platforms||"").replace(/"/g,'""')}"`,`"${(F.genre||"").replace(/"/g,'""')}"`,`"${F.spielzeit||""}"`,`"${F.isAiring?"Airing":"Abgeschlossen"}"`,`"${(F.description||"").replace(/"/g,'""')}"`].join(","))].join(`
`);Fe(P,`media_collection_${U}.csv`,"text/csv;charset=utf-8;")},je=(C,U)=>{const X={exportDate:new Date().toISOString(),totalItems:C.length,categories:[...new Set(C.map(P=>P.category||P.category_name||"Unbekannt"))],items:C.map(P=>({id:P.id,title:P.title||"",category:P.category||P.category_name||"Unbekannt",release:P.release||"",rating:P.rating||null,platforms:P.platforms||"",genre:P.genre||"",spielzeit:P.spielzeit||null,status:P.isAiring?"Airing":"Abgeschlossen",description:P.description||"",isNew:P.isNew||!1,nextSeason:P.nextSeason||null,discovered:P.discovered||null}))};Fe(JSON.stringify(X,null,2),`media_collection_${U}.json`,"application/json;charset=utf-8;")},Fe=(C,U,X)=>{const P=new Blob([C],{type:X}),F=document.createElement("a"),K=URL.createObjectURL(P);F.setAttribute("href",K),F.setAttribute("download",U),F.style.visibility="hidden",document.body.appendChild(F),F.click(),document.body.removeChild(F),URL.revokeObjectURL(K)};return{showLoginModal:l,showRegisterModal:c,showEditModal:f,showFloatingMenu:w,showBulkAddModal:R,showTxtImportModal:x,showTxtImportResults:I,editingItem:r,gridColumns:ne,sortBy:q,categories:ce,txtImportResults:ge,isLoggedIn:h,isAdmin:ue,userName:W,currentCategory:me,searchQuery:Se,categoryCounts:pe,excludedGenres:Ae,loading:Te,error:$,paginatedMedia:Z,setCategory:Q,clearSearch:ve,editItem:xe,closeEditModal:ye,closeBulkAddModal:Ce,handleBulkAddItems:Ie,handleSaveItem:_e,handleDeleteItem:De,logout:fe,loadMedia:g,toggleFloatingMenu:b,addNewItem:v,bulkAddItems:a,importFromTxt:y,importFromAPI:D,createCollection:A,exportMediaCollection:Ve,exportAsCSV:Oe,exportAsJSON:je,downloadFile:Fe,deleteAllInCategory:z,getCategoryDisplayName:T,navigateToCalendar:()=>{Q("calendar")},navigateToProfile:()=>{Q("profile")},navigateToAdmin:()=>{console.log("🔥 navigateToAdmin function called!"),console.log("🔥 Router object:",n),console.log("🔥 Pushing to /admin...");try{n.push("/admin"),console.log("🔥 Successfully navigated to /admin!")}catch(C){console.error("🔥 Error navigating to admin:",C)}},processTxtContent:ie,closeTxtImportResults:he,cleanup:()=>{typeof window<"u"&&window.removeEventListener("resize",ee)},router:n}}const os={name:"StarRating",props:{rating:{type:Number,default:0},editMode:{type:Boolean,default:!1},itemId:{type:[Number,String],required:!0}},emits:["rating-changed"],data(){return{currentRating:this.rating||0,hoverRating:0}},watch:{rating(n){this.currentRating=n||0}},methods:{handleStarClick(n){this.editMode&&(this.currentRating=n,this.showSuccessAnimation(),this.$emit("rating-changed",{itemId:this.itemId,rating:n}))},showSuccessAnimation(){const n=document.createElement("div");n.innerHTML="✓",n.style.cssText=`
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: #4CAF50;
        color: white;
        padding: 8px 12px;
        border-radius: 50%;
        font-size: 16px;
        font-weight: bold;
        z-index: 10000;
        animation: successPulse 0.6s ease-out;
        pointer-events: none;
      `;const e=document.createElement("style");e.textContent=`
        @keyframes successPulse {
          0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
          50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
          100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
        }
      `,document.head.appendChild(e),document.body.appendChild(n),setTimeout(()=>{document.body.removeChild(n),document.head.removeChild(e)},600)},handleMouseEnter(n){this.editMode&&(this.hoverRating=n)},handleMouseLeave(){this.editMode&&(this.hoverRating=0)},clearRating(){this.editMode&&(this.currentRating=0,this.$emit("rating-changed",{itemId:this.itemId,rating:0}))}}},ns={class:"stars-container"},is=["onClick","onMouseenter","disabled","title"],ls={class:"star-number"},rs={key:0,class:"rating-info"},ds={class:"rating-text"};function cs(n,e,o,t,i,d){return u(),m("div",{class:H(["star-rating",{"edit-mode":o.editMode}])},[s("div",ns,[(u(),m(se,null,ae(10,l=>s("button",{key:l,class:H(["star",{filled:l<=i.currentRating,hover:l<=i.hoverRating,"edit-mode":o.editMode}]),onClick:c=>d.handleStarClick(l),onMouseenter:c=>d.handleMouseEnter(l),onMouseleave:e[0]||(e[0]=(...c)=>d.handleMouseLeave&&d.handleMouseLeave(...c)),disabled:!o.editMode,title:o.editMode?`Rate ${l}/10`:`Current rating: ${i.currentRating}/10`},[e[2]||(e[2]=s("span",{class:"star-icon"},"★",-1)),s("span",ls,p(l),1)],42,is)),64))]),o.editMode&&i.currentRating>0?(u(),m("div",rs,[s("span",ds,p(i.currentRating)+"/10",1),s("button",{class:"clear-rating",onClick:e[1]||(e[1]=(...l)=>d.clearRating&&d.clearRating(...l)),title:"Clear rating"}," ✕ ")])):S("",!0)],2)}const us=oe(os,[["render",cs],["__scopeId","data-v-b5a8c120"]]),ms={name:"MediaItem",components:{StarRating:us},props:{item:{type:Object,required:!0},editMode:{type:Boolean,default:!1}},emits:["edit","watchlist-toggled","show-message","rating-changed"],computed:{showWatchlistTag(){return this.item.category==="watchlist"||this.item.isNew===!0},isWatchlistItem(){return this.item.category==="watchlist"||this.item.isNew===!0},isSeries(){return this.item.category==="series"||this.item.watchlist_type==="series"},isInWatchlist(){return this.item.category==="watchlist"?!0:this.item.is_in_watchlist||!1},shouldShowHeartButton(){return this.isSeries}},methods:{getImageUrl(n){return n?n.startsWith("http")?n.startsWith("http://")?n.replace("http://","https://"):n:n.startsWith("/")?n:n.startsWith("storage/")?`/${n}`:`/${n}`:""},handleImageError(n){var e;n.target.style.display="none",(e=n.target.nextElementSibling)==null||e.classList.add("show")},formatDate(n){return n?new Date(n).toLocaleDateString():""},editItem(){this.editMode||this.$emit("edit",this.item)},handleRatingChanged(n){this.$emit("rating-changed",n)},openExtraLink(){this.item.extra_link&&window.open(this.item.extra_link,"_blank","noopener,noreferrer")},getStatusIcon(){switch(this.item.series_status){case"Ended":return"✅";case"Canceled":return"❌";case"In Production":return"🔧";default:return"📺"}},getDaysLeftText(){if(!this.item.next_season_release)return"";const n=new Date(this.item.next_season_release),e=new Date,o=n.getTime()-e.getTime(),t=Math.ceil(o/(1e3*3600*24));return t>0?`${t} day${t>1?"s":""} left`:t===0?"Airs today!":`Aired ${Math.abs(t)} day${Math.abs(t)>1?"s":""} ago`},handleHeartClick(){console.log("💖 Heart button clicked!"),console.log("💖 Button visible:",this.isSeries&&this.item.is_airing),console.log("💖 Series check:",this.isSeries),console.log("💖 Airing check:",this.item.is_airing),this.toggleToWatchlist()},async toggleToWatchlist(){var n;try{console.log("💖 Toggling series to watchlist:",this.item.title),console.log("💖 Item details:",{id:this.item.id,title:this.item.title,category:this.item.category,is_airing:this.item.is_airing}),this.showHeartLoading();const e=await re.toggleSeriesToWatchlist(this.item.id);e.success?(console.log("💖 Watchlist toggle successful:",e),this.showHeartSuccess(),this.$emit("watchlist-toggled",{seriesId:this.item.id,action:e.action,watchlistType:e.watchlist_type,seasonInfo:e.season_info,message:e.message})):(console.error("❌ Watchlist toggle failed:",e.error),this.$emit("show-message",{type:"error",text:e.error||"Failed to toggle watchlist"}))}catch(e){if(console.error("❌ Watchlist toggle error:",e),e.response&&e.response.status===400){const o=((n=e.response.data)==null?void 0:n.error)||"Only airing series can be added to watchlist";this.$emit("show-message",{type:"error",text:o})}else this.$emit("show-message",{type:"error",text:"Failed to toggle watchlist"})}},showHeartLoading(){const n=this.$el.querySelector(".heart-toggle-button");n&&(n.style.opacity="0.7",n.style.transform="scale(0.95)",n.style.transition="all 0.2s ease")},showHeartSuccess(){const n=this.$el.querySelector(".heart-toggle-button");n&&(n.style.background="rgba(40, 167, 69, 0.9)",n.style.transform="scale(1.1)",n.style.boxShadow="0 4px 15px rgba(40, 167, 69, 0.4)",setTimeout(()=>{n.style.background="rgba(0, 0, 0, 0.8)",n.style.transform="scale(1)",n.style.boxShadow="none"},600))},getWatchlistDaysLeft(){const n=this.item.watchlist_release_date?new Date(this.item.watchlist_release_date):this.item.release?new Date(this.item.release):null;if(!n)return"";const e=new Date,o=n.getTime()-e.getTime(),t=Math.ceil(o/(1e3*3600*24));return t>0?`${t} day${t>1?"s":""} left`:t===0?"Releases today!":`Released ${Math.abs(t)} day${Math.abs(t)>1?"s":""} ago`},getWatchlistReleaseStatus(){if(!this.item.release)return"";const n=new Date(this.item.release),e=new Date;e.setHours(0,0,0,0),n.setHours(0,0,0,0);const o=n.getTime()-e.getTime(),t=Math.ceil(o/(1e3*3600*24));if(t>0)return t===1?"Tomorrow!":t<=7?`${t} days left`:t<=30?`${t} days left`:`${Math.ceil(t/30)} months left`;if(t===0)return"Released today!";{const i=this.getTypeTagText().toLowerCase();return i==="game"?"Unplayed yet":i==="series"||i==="movie"?"Unwatched yet":i==="buecher"?"Unread yet":"Unconsumed yet"}},getWatchlistReleaseStatusClass(){if(!this.item.release)return"";const n=new Date(this.item.release),e=new Date;e.setHours(0,0,0,0),n.setHours(0,0,0,0);const o=n.getTime()-e.getTime(),t=Math.ceil(o/(1e3*3600*24));return t>0?"countdown":t===0?"released-today":"unconsumed"},getTypeTagText(){var e,o,t;const n=this.item.watchlistType||this.item.watchlist_type;if(n)return n.charAt(0).toUpperCase()+n.slice(1);if(this.item.genre){const i=this.item.genre.toLowerCase();if(i.includes("game")||i.includes("gaming")||(e=this.item.platforms)!=null&&e.toLowerCase().includes("steam")||(o=this.item.platforms)!=null&&o.toLowerCase().includes("ps")||(t=this.item.platforms)!=null&&t.toLowerCase().includes("xbox"))return"Game";if(i.includes("series")||i.includes("tv")||i.includes("episode")||this.item.isAiring)return"Series";if(i.includes("movie")||i.includes("film")||i.includes("cinema"))return"Movie";if(i.includes("book")||i.includes("literature")||i.includes("novel")||i.includes("author"))return"Bücher"}if(this.item.platforms){const i=this.item.platforms.toLowerCase();if(i.includes("steam")||i.includes("ps")||i.includes("xbox")||i.includes("nintendo")||i.includes("pc"))return"Game";if(i.includes("netflix")||i.includes("hulu")||i.includes("disney")||i.includes("hbo"))return"Series";if(i.includes("cinema")||i.includes("theater"))return"Movie";if(i.includes("book")||i.includes("kindle")||i.includes("audible")||i.includes("author"))return"Bücher"}return"Media"},getTypeTagClass(){return`type-${this.getTypeTagText().toLowerCase()}`},getNextSeasonCountdown(){if(!this.item.nextSeasonRelease)return"";const n=new Date(this.item.nextSeasonRelease),e=new Date;e.setHours(0,0,0,0),n.setHours(0,0,0,0);const o=n.getTime()-e.getTime(),t=Math.ceil(o/(1e3*3600*24));return t>0?t===1?"Tomorrow!":t<=7?`${t} days`:t<=30?`${t} days`:`${Math.ceil(t/30)} months`:t===0?"Today!":"Released"},getCategoryClass(){var e,o;const n=((e=this.item.category)==null?void 0:e.toLowerCase())||((o=this.item.category_name)==null?void 0:o.toLowerCase());return n==="movies"||n==="movie"?"category-movies":n==="books"||n==="buecher"||n==="book"?"category-books":n==="series"||n==="tv"||n==="serie"?"category-series":n==="games"||n==="game"||n==="spiele"?"category-games":n==="watchlist"?"category-watchlist":"category-default"},getCategoryIcon(){var e,o,t,i;if(this.isWatchlistItem){const d=this.item.watchlistType||this.item.watchlist_type;if(d){const l=d.toLowerCase();if(l==="movies"||l==="movie")return"🎬";if(l==="books"||l==="buecher")return"📚";if(l==="series"||l==="tv")return"📺";if(l==="games"||l==="game")return"🎮"}if(this.item.genre){const l=this.item.genre.toLowerCase();if(l.includes("game")||l.includes("gaming")||(e=this.item.platforms)!=null&&e.toLowerCase().includes("steam")||(o=this.item.platforms)!=null&&o.toLowerCase().includes("ps")||(t=this.item.platforms)!=null&&t.toLowerCase().includes("xbox"))return"🎮";if(l.includes("book")||l.includes("buecher"))return"📚";if(l.includes("series")||l.includes("tv")||l.includes("tv show"))return"📺";if(l.includes("movie")||l.includes("film"))return"🎬"}return"📁"}const n=(i=this.item.category)==null?void 0:i.toLowerCase();return n==="movies"||n==="movie"?"🎬":n==="books"||n==="buecher"?"📚":n==="series"||n==="tv"?"📺":n==="games"||n==="game"?"🎮":"📁"},getCategoryStyle(){var e;const n=(e=this.item.category)==null?void 0:e.toLowerCase();if(n==="games"||n==="game"){const o=this.item.rating||0;return this.getGameStyleByRating(o)}return{}},getGameStyleByRating(n){return n>=4.5?{"--game-primary":"#ffd700","--game-secondary":"#ffed4e","--game-accent":"#ff6b35","--game-glow":"0 0 20px rgba(255, 215, 0, 0.6)","--game-border":"3px solid #ffd700"}:n>=4?{"--game-primary":"#00d4ff","--game-secondary":"#e8f4fd","--game-accent":"#00ff88","--game-glow":"0 0 15px rgba(0, 212, 255, 0.5)","--game-border":"3px solid #00d4ff"}:n>=3.5?{"--game-primary":"#00ff88","--game-secondary":"#4caf50","--game-accent":"#8bc34a","--game-glow":"0 0 12px rgba(0, 255, 136, 0.4)","--game-border":"3px solid #00ff88"}:n>=3?{"--game-primary":"#ff9800","--game-secondary":"#ffc107","--game-accent":"#ff5722","--game-glow":"0 0 10px rgba(255, 152, 0, 0.3)","--game-border":"3px solid #ff9800"}:n>=2?{"--game-primary":"#ff5722","--game-secondary":"#f44336","--game-accent":"#d32f2f","--game-glow":"0 0 8px rgba(255, 87, 34, 0.3)","--game-border":"3px solid #ff5722"}:{"--game-primary":"#9e9e9e","--game-secondary":"#757575","--game-accent":"#616161","--game-glow":"0 0 5px rgba(158, 158, 158, 0.2)","--game-border":"3px solid #9e9e9e"}}}},gs={class:"media-image"},fs=["src","alt"],hs={key:1,class:"no-image"},ps={class:"no-image-icon"},vs={class:"media-info"},ys={class:"labels-container"},bs={key:0,class:"category-type-tag"},_s={key:1,class:"watchlist-tag new-season"},ws={key:2,class:"status-badge airing"},ks={key:3,class:"status-badge finished"},Ss={key:4,class:"season-info"},xs={key:5,class:"days-left"},Cs={key:6,class:"days-left"},Is={class:"title-container"},Ds={class:"media-title"},As={class:"heart-text"},Ts={key:3,class:"star-rating-overlay"};function Ms(n,e,o,t,i,d){const l=le("StarRating");return u(),m("div",{class:H(["media-item",d.getCategoryClass()]),style:Le(d.getCategoryStyle()),onClick:e[4]||(e[4]=(...c)=>d.editItem&&d.editItem(...c))},[s("div",gs,[o.item.image_url||o.item.path?(u(),m("img",{key:0,src:d.getImageUrl(o.item.image_url||o.item.path),alt:o.item.title,onError:e[0]||(e[0]=(...c)=>d.handleImageError&&d.handleImageError(...c))},null,40,fs)):(u(),m("div",hs,[s("span",ps,p(d.getCategoryIcon()),1)]))]),s("div",vs,[s("div",ys,[d.isWatchlistItem&&d.getTypeTagText()?(u(),m("div",bs,p(d.getCategoryIcon()),1)):S("",!0),d.isWatchlistItem&&o.item.watchlist_series_type==="new_season"?(u(),m("div",_s," 📺 "+p(o.item.watchlist_season_info||"New Season"),1)):S("",!0),d.isSeries&&!d.isWatchlistItem&&o.item.is_airing?(u(),m("div",ws," 🔴 Airing ")):d.isSeries&&!d.isWatchlistItem&&o.item.series_status?(u(),m("div",ks,p(d.getStatusIcon())+" "+p(o.item.series_status),1)):S("",!0),d.isSeries&&o.item.is_airing&&o.item.next_season?(u(),m("div",Ss," 📺 S"+p(o.item.next_season),1)):S("",!0),d.isWatchlistItem&&o.item.release?(u(),m("div",xs," ⏰ "+p(d.getWatchlistDaysLeft()),1)):d.isSeries&&o.item.is_airing&&o.item.next_season_release?(u(),m("div",Cs," ⏰ "+p(d.getDaysLeftText()),1)):S("",!0)]),s("div",Is,[s("h3",Ds,p(o.item.title),1)])]),d.isSeries&&!d.isWatchlistItem&&o.item.extra_link?(u(),m("div",{key:0,class:"series-extra-button",onClick:e[1]||(e[1]=de((...c)=>d.openExtraLink&&d.openExtraLink(...c),["stop"]))},[...e[5]||(e[5]=[s("span",{class:"extra-link-icon"},"🔗",-1),s("span",{class:"extra-link-text"},"Extra Link",-1)])])):S("",!0),d.isWatchlistItem&&o.item.extra_link?(u(),m("div",{key:1,class:"watchlist-extra-button",onClick:e[2]||(e[2]=de((...c)=>d.openExtraLink&&d.openExtraLink(...c),["stop"]))},[...e[6]||(e[6]=[s("span",{class:"extra-link-icon"},"🔗",-1),s("span",{class:"extra-link-text"},"Go to Link",-1)])])):S("",!0),d.shouldShowHeartButton?(u(),m("div",{key:2,class:"heart-toggle-button",onClick:e[3]||(e[3]=de((...c)=>d.handleHeartClick&&d.handleHeartClick(...c),["stop"]))},[s("span",{class:H(["heart-icon",{active:d.isInWatchlist}])},p(d.isInWatchlist?"❤️":"🤍"),3),s("span",As,p(d.isInWatchlist?"In Watchlist":"Add to Watchlist"),1)])):S("",!0),o.editMode?(u(),m("div",Ts,[be(l,{rating:o.item.personal_rating||0,"edit-mode":o.editMode,"item-id":o.item.id,onRatingChanged:d.handleRatingChanged},null,8,["rating","edit-mode","item-id","onRatingChanged"])])):S("",!0),e[7]||(e[7]=s("div",{class:"edit-indicator"},[s("span",{class:"edit-icon"},"✏️")],-1))],6)}const Rs=oe(ms,[["render",Ms],["__scopeId","data-v-0ceec74d"]]),Es={name:"VersionInfo",data(){return{version:"1.0.0"}}},Us={class:"version-info"},Ls={class:"version-label"};function Bs(n,e,o,t,i,d){return u(),m("div",Us,[s("span",Ls,"Build #"+p(i.version),1)])}const Ps=oe(Es,[["render",Bs],["__scopeId","data-v-2d54e3c7"]]),Fs={name:"Sidebar",components:{VersionInfo:Ps},props:{collapsed:{type:Boolean,default:!1},mobileOpen:{type:Boolean,default:!1},isLoggedIn:{type:Boolean,default:!1},userName:{type:String,default:""},currentCategory:{type:String,default:"watchlist"},categoryCounts:{type:Object,default:()=>({})},categories:{type:Array,default:()=>[{key:"game",name:"Games",icon:"🎮"},{key:"series",name:"Series",icon:"📺"},{key:"movie",name:"Movies",icon:"🎬"},{key:"buecher",name:"Bücher",icon:"📚"},{key:"watchlist",name:"Watchlist",icon:"❤️"}]},selectedGenres:{type:Array,default:()=>[]},excludedGenres:{type:Array,default:()=>[]},genres:{type:Array,default:()=>[]},genreLoading:{type:Boolean,default:!1},genreError:{type:String,default:null}},emits:["toggle","setCategory","addItem","navigateToCalendar","navigateToProfile","showLogin","showRegister","logout","genres-updated","genres-excluded","genres-cleared","load-genres"],data(){return{showAllGenres:!1}},computed:{showGenreSection(){return this.currentCategory&&this.currentCategory!=="statistics"&&this.currentCategory!=="calendar"&&this.currentCategory!=="profile"},visibleGenres(){return this.showAllGenres||this.genres.length<=5?this.genres:this.genres.slice(0,5)},genreCheckboxStates(){return this.visibleGenres.map(n=>({...n,isIncluded:this.selectedGenres.includes(n.name),isExcluded:this.excludedGenres.includes(n.name)}))}},methods:{toggleGenreInclude(n){const e=[...this.selectedGenres],o=[...this.excludedGenres];if(e.includes(n)){const i=e.indexOf(n);e.splice(i,1)}else{e.push(n);const i=o.indexOf(n);i>-1&&o.splice(i,1)}this.$emit("genres-updated",e),this.$emit("genres-excluded",o)},toggleGenreExclude(n){const e=[...this.selectedGenres],o=[...this.excludedGenres];if(o.includes(n)){const i=o.indexOf(n);o.splice(i,1)}else{o.push(n);const i=e.indexOf(n);i>-1&&e.splice(i,1)}this.$emit("genres-updated",e),this.$emit("genres-excluded",o)},clearGenreFilter(){this.$emit("genres-cleared"),this.$emit("genres-excluded",[])},loadGenres(){this.$emit("load-genres")},toggleShowAllGenres(){this.showAllGenres=!this.showAllGenres}}},Ns={class:"sidebar-content"},Gs={class:"sidebar-section"},Ws={class:"sidebar-nav"},Vs=["onClick"],Os={class:"nav-icon"},js={class:"nav-text"},zs={class:"nav-count"},Ys=["onClick","title"],Hs={key:0,class:"sidebar-section genre-section"},qs={key:0,class:"genre-loading"},Qs={key:1,class:"genre-error"},Js={key:2,class:"genre-empty"},Ks=["title"],Zs={class:"genre-name"},Xs={class:"genre-checkbox-label include-checkbox"},$s=["value","checked","onChange"],ea={class:"genre-checkbox-label exclude-checkbox"},ta=["value","checked","onChange"],sa={class:"genre-count"},aa=["title"],oa={class:"sidebar-section"},na={key:0,class:"auth-buttons"},ia={key:1,class:"user-info"},la={class:"user-profile"},ra={class:"profile-details"},da={class:"user-name"};function ca(n,e,o,t,i,d){const l=le("VersionInfo");return u(),m("aside",{id:"sidebar",class:H(["sidebar",{collapsed:o.collapsed,open:o.mobileOpen}])},[s("div",{class:"sidebar-header",onClick:e[0]||(e[0]=c=>n.$emit("toggle"))},[...e[11]||(e[11]=[s("h2",null,"Media Library",-1),s("button",{class:"sidebar-toggle"},"☰",-1)])]),s("div",Ns,[s("div",Gs,[e[16]||(e[16]=s("h3",null,"Browse",-1)),s("nav",Ws,[(u(!0),m(se,null,ae(o.categories,c=>(u(),m("div",{key:c.key,class:"nav-item"},[s("button",{class:H(["nav-btn",{active:o.currentCategory===c.key}]),onClick:f=>n.$emit("setCategory",c.key)},[s("span",Os,p(c.icon),1),s("span",js,p(c.name),1),s("span",zs,p(o.categoryCounts[c.key]||0),1)],10,Vs),s("button",{class:"add-btn",onClick:f=>n.$emit("addItem",c.key),title:`Add ${c.name}`},[...e[12]||(e[12]=[s("span",{class:"add-icon"},"+",-1)])],8,Ys)]))),128)),s("button",{class:H(["nav-btn",{active:o.currentCategory==="statistics"}]),onClick:e[1]||(e[1]=c=>n.$emit("setCategory","statistics"))},[...e[13]||(e[13]=[s("span",{class:"nav-icon"},"📊",-1),s("span",{class:"nav-text"},"Statistics",-1)])],2),s("button",{class:H(["nav-btn",{active:o.currentCategory==="calendar"}]),onClick:e[2]||(e[2]=c=>n.$emit("setCategory","calendar"))},[...e[14]||(e[14]=[s("span",{class:"nav-icon"},"📅",-1),s("span",{class:"nav-text"},"Calendar",-1)])],2),s("button",{class:H(["nav-btn",{active:o.currentCategory==="profile"}]),onClick:e[3]||(e[3]=c=>n.$emit("setCategory","profile"))},[...e[15]||(e[15]=[s("span",{class:"nav-icon"},"👤",-1),s("span",{class:"nav-text"},"Profile",-1)])],2)])]),d.showGenreSection?(u(),m("div",Hs,[e[20]||(e[20]=s("h3",null,"Genres",-1)),o.genreLoading?(u(),m("div",qs,[...e[17]||(e[17]=[s("div",{class:"loading-spinner"},null,-1),s("span",null,"Loading genres...",-1)])])):o.genreError?(u(),m("div",Qs,[e[18]||(e[18]=s("span",null,"Failed to load genres",-1)),s("button",{onClick:e[4]||(e[4]=(...c)=>d.loadGenres&&d.loadGenres(...c)),class:"retry-btn"},"Retry")])):o.genres.length===0?(u(),m("div",Js,[...e[19]||(e[19]=[s("span",null,"No genres available",-1)])])):(u(),m("div",{key:3,class:H(["genre-list",{loading:o.genreLoading}])},[be(Zt,{name:"genre-fade",tag:"div"},{default:Kt(()=>[(u(!0),m(se,null,ae(d.genreCheckboxStates,(c,f)=>(u(),m("div",{key:c.name,class:"genre-checkbox-item",title:`${c.name} (${c.count} items)`,style:Le({"--animation-delay":`${f*50}ms`})},[s("span",Zs,p(c.name),1),s("label",Xs,[s("input",{type:"checkbox",value:c.name,checked:c.isIncluded,onChange:w=>d.toggleGenreInclude(c.name),class:"genre-checkbox include-checkbox-input"},null,40,$s)]),s("label",ea,[s("input",{type:"checkbox",value:c.name,checked:c.isExcluded,onChange:w=>d.toggleGenreExclude(c.name),class:"genre-checkbox exclude-checkbox-input"},null,40,ta)]),s("span",sa,p(c.count),1)],12,Ks))),128))]),_:1}),o.genres.length>5?(u(),m("button",{key:0,class:"show-more-btn",onClick:e[5]||(e[5]=(...c)=>d.toggleShowAllGenres&&d.toggleShowAllGenres(...c)),title:i.showAllGenres?"Show fewer genres":"Show all genres"},p(i.showAllGenres?"Show Less":`Show More (${o.genres.length-5})`),9,aa)):S("",!0),o.selectedGenres.length>0||o.excludedGenres.length>0?(u(),m("button",{key:1,class:"clear-genre-btn",onClick:e[6]||(e[6]=(...c)=>d.clearGenreFilter&&d.clearGenreFilter(...c)),title:"Clear all genre filters"}," Clear All Filters ("+p(o.selectedGenres.length+o.excludedGenres.length)+") ",1)):S("",!0)],2))])):S("",!0),s("div",oa,[e[22]||(e[22]=s("h3",null,"Account",-1)),o.isLoggedIn?(u(),m("div",ia,[s("div",la,[e[21]||(e[21]=s("div",{class:"profile-avatar"},[s("span",{class:"avatar-text"},"👤")],-1)),s("div",ra,[s("span",da,p(o.userName),1)]),s("button",{class:"account-btn",onClick:e[9]||(e[9]=c=>n.$emit("navigateToProfile"))},"⚙️")]),s("button",{class:"auth-btn",onClick:e[10]||(e[10]=c=>n.$emit("logout"))},"Logout")])):(u(),m("div",na,[s("button",{class:"auth-btn",onClick:e[7]||(e[7]=c=>n.$emit("showLogin"))},"Login"),s("button",{class:"auth-btn",onClick:e[8]||(e[8]=c=>n.$emit("showRegister"))},"Register")]))])]),be(l)],2)}const ua=oe(Fs,[["render",ca],["__scopeId","data-v-690c0dfc"]]),ma={name:"MainHeader",props:{searchQuery:{type:String,default:""},sortBy:{type:String,default:"order_asc"},editMode:{type:Boolean,default:!1}},emits:["update:searchQuery","update:sortBy","toggleMobileSidebar","clearSearch","toggleEditMode"]},ga={class:"main-header"},fa={class:"header-left"},ha={class:"header-center"},pa={class:"search-container"},va=["value"],ya={class:"header-right"},ba={class:"edit-mode-container"},_a=["title"],wa={class:"edit-icon"},ka={class:"edit-text"},Sa={class:"sort-container"},xa=["value"];function Ca(n,e,o,t,i,d){return u(),m("header",ga,[s("div",fa,[s("button",{class:"mobile-sidebar-toggle",onClick:e[0]||(e[0]=l=>n.$emit("toggleMobileSidebar"))},"☰")]),s("div",ha,[s("div",pa,[s("input",{type:"text",value:o.searchQuery,onInput:e[1]||(e[1]=l=>n.$emit("update:searchQuery",l.target.value)),placeholder:"Search..."},null,40,va),s("button",{class:"search-clear",onClick:e[2]||(e[2]=l=>n.$emit("clearSearch"))},"×")])]),s("div",ya,[s("div",ba,[s("button",{class:H(["edit-mode-toggle",{active:o.editMode}]),onClick:e[3]||(e[3]=l=>n.$emit("toggleEditMode")),title:o.editMode?"Exit Edit Mode":"Enter Edit Mode"},[s("span",wa,p(o.editMode?"✓":"✏️"),1),s("span",ka,p(o.editMode?"Done":"Edit"),1)],10,_a)]),s("div",Sa,[s("select",{value:o.sortBy,onChange:e[4]||(e[4]=l=>n.$emit("update:sortBy",l.target.value))},[...e[5]||(e[5]=[Ge('<option value="order_asc" data-v-e88ee4fe>Original order ↑</option><option value="order_desc" data-v-e88ee4fe>Original order ↓</option><option value="title_asc" data-v-e88ee4fe>Title A-Z</option><option value="title_desc" data-v-e88ee4fe>Title Z-A</option><option value="release_asc" data-v-e88ee4fe>Release ↑</option><option value="release_desc" data-v-e88ee4fe>Release ↓</option><option value="api_rating_asc" data-v-e88ee4fe>API Rating ↑</option><option value="api_rating_desc" data-v-e88ee4fe>API Rating ↓</option><option value="personal_rating_asc" data-v-e88ee4fe>Personal Rating ↑</option><option value="personal_rating_desc" data-v-e88ee4fe>Personal Rating ↓</option><option value="airing_desc" data-v-e88ee4fe>Airing first</option><option value="airing_asc" data-v-e88ee4fe>Finished first</option>',12)])],40,xa)])])])}const Ia=oe(ma,[["render",Ca],["__scopeId","data-v-e88ee4fe"]]),Da={name:"FloatingActionButton",props:{showMenu:{type:Boolean,default:!1},showDeleteAll:{type:Boolean,default:!1},categoryName:{type:String,default:""},itemCount:{type:Number,default:0}},emits:["toggleMenu","addNewItem","bulkAddItems","importFromTxt","importFromAPI","createCollection","deleteAllInCategory"]},Aa={class:"floating-actions"},Ta={class:"menu-text"},Ma={class:"item-count-badge"};function Ra(n,e,o,t,i,d){return u(),m("div",Aa,[s("div",{class:H(["floating-menu",{show:o.showMenu}])},[s("button",{class:"floating-menu-item",onClick:e[0]||(e[0]=l=>n.$emit("addNewItem"))},[...e[7]||(e[7]=[s("span",{class:"menu-icon"},"➕",-1),s("span",{class:"menu-text"},"Add Item",-1)])]),s("button",{class:"floating-menu-item",onClick:e[1]||(e[1]=l=>n.$emit("bulkAddItems"))},[...e[8]||(e[8]=[s("span",{class:"menu-icon"},"📦",-1),s("span",{class:"menu-text"},"Bulk Add",-1)])]),s("button",{class:"floating-menu-item",onClick:e[2]||(e[2]=l=>n.$emit("importFromTxt"))},[...e[9]||(e[9]=[s("span",{class:"menu-icon"},"📄",-1),s("span",{class:"menu-text"},"Import from TXT",-1)])]),s("button",{class:"floating-menu-item",onClick:e[3]||(e[3]=l=>n.$emit("importFromAPI"))},[...e[10]||(e[10]=[s("span",{class:"menu-icon"},"🌐",-1),s("span",{class:"menu-text"},"Import from API",-1)])]),s("button",{class:"floating-menu-item",onClick:e[4]||(e[4]=l=>n.$emit("createCollection"))},[...e[11]||(e[11]=[s("span",{class:"menu-icon"},"📚",-1),s("span",{class:"menu-text"},"Create Collection",-1)])]),o.showDeleteAll&&o.itemCount>0?(u(),m("button",{key:0,class:"floating-menu-item delete-all-item",onClick:e[5]||(e[5]=l=>n.$emit("deleteAllInCategory"))},[e[12]||(e[12]=s("span",{class:"menu-icon"},"🗑️",-1)),s("span",Ta,"Delete All "+p(o.categoryName),1),s("span",Ma,"("+p(o.itemCount)+")",1)])):S("",!0)],2),s("button",{class:"floating-add-btn",onClick:e[6]||(e[6]=l=>n.$emit("toggleMenu"))},p(o.showMenu?"✕":"+"),1)])}const Ea=oe(Da,[["render",Ra],["__scopeId","data-v-f77e6366"]]),Ua={name:"LoginModal",emits:["close","success"],setup(n,{emit:e}){const o=Qe(),t=Pe({email:"",password:""}),i=k(!1),d=k("");return{form:t,loading:i,error:d,handleLogin:async()=>{i.value=!0,d.value="";try{const x=await o.login(t.email,t.password);x.success?e("success",x):d.value=x.error}catch(x){d.value=x.message||"Login failed"}finally{i.value=!1}},closeModal:()=>{e("close")},checkLocalDB:async()=>{try{const I=await(await fetch("http://127.0.0.1:8000/api/check-db")).json();alert(`Local DB: ${I.success?"✅ Connected":"❌ Error"}
Users: ${I.user_count}
Error: ${I.error||"None"}`)}catch(x){alert(`Local DB Check Failed: ${x.message}`)}},checkProdDB:async()=>{try{const x=window.location.origin,r=await(await fetch(`${x}/api/check-db`)).json();alert(`Prod DB: ${r.success?"✅ Connected":"❌ Error"}
Users: ${r.user_count}
Error: ${r.error||"None"}`)}catch(x){alert(`Prod DB Check Failed: ${x.message}`)}},deleteAllUsers:async()=>{if(confirm("⚠️ WARNING: This will delete ALL users! Are you sure?"))try{const x=window.location.origin,r=await(await fetch(`${x}/api/delete-all-users`,{method:"POST",headers:{"Content-Type":"application/json"}})).json();alert(`Delete Result: ${r.success?"✅ Success":"❌ Error"}
Deleted: ${r.deleted_count} users
Error: ${r.error||"None"}`)}catch(x){alert(`Delete Failed: ${x.message}`)}}}}},La={class:"form-group"},Ba=["disabled"],Pa={class:"form-group"},Fa=["disabled"],Na={key:0,class:"error-message"},Ga={class:"modal-buttons"},Wa=["disabled"],Va=["disabled"];function Oa(n,e,o,t,i,d){return u(),m("div",{class:"modal",onClick:e[5]||(e[5]=(...l)=>t.closeModal&&t.closeModal(...l))},[s("div",{class:"modal-content auth-modal",onClick:e[4]||(e[4]=de(()=>{},["stop"]))},[e[8]||(e[8]=s("h2",null,"Login",-1)),s("form",{onSubmit:e[3]||(e[3]=de((...l)=>t.handleLogin&&t.handleLogin(...l),["prevent"]))},[s("div",La,[e[6]||(e[6]=s("label",{for:"email"},"Email:",-1)),M(s("input",{type:"email",id:"email","onUpdate:modelValue":e[0]||(e[0]=l=>t.form.email=l),required:"",disabled:t.loading},null,8,Ba),[[L,t.form.email]])]),s("div",Pa,[e[7]||(e[7]=s("label",{for:"password"},"Password:",-1)),M(s("input",{type:"password",id:"password","onUpdate:modelValue":e[1]||(e[1]=l=>t.form.password=l),required:"",disabled:t.loading},null,8,Fa),[[L,t.form.password]])]),t.error?(u(),m("div",Na,p(t.error),1)):S("",!0),s("div",Ga,[s("button",{type:"submit",disabled:t.loading},p(t.loading?"Logging in...":"Login"),9,Wa),s("button",{type:"button",onClick:e[2]||(e[2]=(...l)=>t.closeModal&&t.closeModal(...l)),disabled:t.loading}," Cancel ",8,Va)])],32)])])}const ja=oe(Ua,[["render",Oa],["__scopeId","data-v-64f3b00b"]]),za={name:"RegisterModal",emits:["close","success"],setup(n,{emit:e}){const o=Qe(),t=Pe({name:"",username:"",email:"",password:"",passwordConfirm:""}),i=k(!1),d=k(""),l=G(()=>t.name&&t.username&&t.email&&t.password&&t.passwordConfirm&&t.password===t.passwordConfirm&&t.password.length>=8);return{form:t,loading:i,error:d,isFormValid:l,handleRegister:async()=>{if(!l.value){d.value="Please fill in all fields and ensure passwords match";return}i.value=!0,d.value="";try{const w=await o.register(t.name,t.username,t.email,t.password,t.passwordConfirm);w.success?e("success"):d.value=w.error}catch(w){d.value=w.message||"Registration failed"}finally{i.value=!1}},closeModal:()=>{e("close")}}}},Ya={class:"form-group"},Ha=["disabled"],qa={class:"form-group"},Qa=["disabled"],Ja={class:"form-group"},Ka=["disabled"],Za={class:"form-group"},Xa=["disabled"],$a={class:"form-group"},eo=["disabled"],to={key:0,class:"error-message"},so={class:"modal-buttons"},ao=["disabled"],oo=["disabled"];function no(n,e,o,t,i,d){return u(),m("div",{class:"modal",onClick:e[8]||(e[8]=(...l)=>t.closeModal&&t.closeModal(...l))},[s("div",{class:"modal-content auth-modal",onClick:e[7]||(e[7]=de(()=>{},["stop"]))},[e[14]||(e[14]=s("h2",null,"Register",-1)),s("form",{onSubmit:e[6]||(e[6]=de((...l)=>t.handleRegister&&t.handleRegister(...l),["prevent"]))},[s("div",Ya,[e[9]||(e[9]=s("label",{for:"name"},"Name:",-1)),M(s("input",{type:"text",id:"name","onUpdate:modelValue":e[0]||(e[0]=l=>t.form.name=l),required:"",disabled:t.loading},null,8,Ha),[[L,t.form.name]])]),s("div",qa,[e[10]||(e[10]=s("label",{for:"username"},"Username:",-1)),M(s("input",{type:"text",id:"username","onUpdate:modelValue":e[1]||(e[1]=l=>t.form.username=l),required:"",disabled:t.loading},null,8,Qa),[[L,t.form.username]])]),s("div",Ja,[e[11]||(e[11]=s("label",{for:"email"},"Email:",-1)),M(s("input",{type:"email",id:"email","onUpdate:modelValue":e[2]||(e[2]=l=>t.form.email=l),required:"",disabled:t.loading},null,8,Ka),[[L,t.form.email]])]),s("div",Za,[e[12]||(e[12]=s("label",{for:"password"},"Password:",-1)),M(s("input",{type:"password",id:"password","onUpdate:modelValue":e[3]||(e[3]=l=>t.form.password=l),required:"",minlength:"8",disabled:t.loading},null,8,Xa),[[L,t.form.password]])]),s("div",$a,[e[13]||(e[13]=s("label",{for:"passwordConfirm"},"Confirm Password:",-1)),M(s("input",{type:"password",id:"passwordConfirm","onUpdate:modelValue":e[4]||(e[4]=l=>t.form.passwordConfirm=l),required:"",minlength:"8",disabled:t.loading},null,8,eo),[[L,t.form.passwordConfirm]])]),t.error?(u(),m("div",to,p(t.error),1)):S("",!0),s("div",so,[s("button",{type:"submit",disabled:t.loading||!t.isFormValid},p(t.loading?"Registering...":"Register"),9,ao),s("button",{type:"button",onClick:e[5]||(e[5]=(...l)=>t.closeModal&&t.closeModal(...l)),disabled:t.loading}," Cancel ",8,oo)])],32)])])}const io=oe(za,[["render",no],["__scopeId","data-v-eec5201a"]]),ct="http://127.0.0.1:8000/api",lo={async getConfig(){try{const n=await fetch(`${ct}/google-books-config`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);return await n.json()}catch(n){throw console.error("Simple Google Books - Config failed:",n),n}},async searchBooks(n,e=10){try{const o=await fetch(`${ct}/google-books/search?q=${encodeURIComponent(n)}&maxResults=${e}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!o.ok)throw new Error(`HTTP ${o.status}: ${o.statusText}`);return await o.json()}catch(o){throw console.error("Simple Google Books - Search failed:",o),o}}},ro=!1,co=!0,uo="production",mo={production:{apiUrl:"https://teabubble.attrebi.ch",apiBaseUrl:"https://teabubble.attrebi.ch/api",googleBooksUrl:"https://teabubble.attrebi.ch/api/google-books",debug:!1}};function go(){return mo.production}const He=go();He.debug&&console.log("🔧 Environment Configuration:",{mode:uo,isDevelopment:ro,isProduction:co,apiUrl:He.apiUrl,apiBaseUrl:He.apiBaseUrl,googleBooksUrl:He.googleBooksUrl});class fo{constructor(){this.baseUrl="https://en.wikipedia.org/w/api.php",this.timeout=1e4,this.maxResults=10}async searchBooks(e,o=10){if(!e||typeof e!="string"||e.trim().length===0)return console.warn("📚 [Wikipedia] Invalid query provided"),{success:!1,error:"Search query is required",data:[]};try{const t=await this.searchPages(e,o);if(!t.success||t.data.length===0)return{success:!1,error:"No results found",data:[]};const i=await this.getPageDetails(t.data),d=this.filterAndFormatBookResults(i);return console.log("📚 [Wikipedia] Search completed:",{totalResults:i.length,bookResults:d.length}),{success:!0,data:d,source:"wikipedia"}}catch(t){return console.error("📚 [Wikipedia] Search failed:",t),{success:!1,error:`Search failed: ${t.message}`,data:[]}}}async searchPages(e,o){var i;const t=new URLSearchParams({action:"query",format:"json",list:"search",srsearch:`${e} book novel`,srnamespace:0,srlimit:o,srprop:"snippet|timestamp",origin:"*"});try{const d=await fetch(`${this.baseUrl}?${t}`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout)});if(!d.ok)throw new Error(`HTTP ${d.status}: ${d.statusText}`);const l=await d.json();if(l.error)throw new Error(l.error.info||"Wikipedia API error");return{success:!0,data:(((i=l.query)==null?void 0:i.search)||[]).map(f=>({pageid:f.pageid,title:f.title,snippet:f.snippet,timestamp:f.timestamp}))}}catch(d){return console.error("📚 [Wikipedia] Page search failed:",d),{success:!1,error:d.message,data:[]}}}async getPageDetails(e){var i;if(!e||e.length===0)return[];const o=e.map(d=>d.pageid).join("|"),t=new URLSearchParams({action:"query",format:"json",pageids:o,prop:"extracts|pageimages|info",exintro:"true",explaintext:"true",exsectionformat:"plain",piprop:"thumbnail|original",pithumbsize:300,pilimit:1,inprop:"url",origin:"*"});try{const d=await fetch(`${this.baseUrl}?${t}`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout)});if(!d.ok)throw new Error(`HTTP ${d.status}: ${d.statusText}`);const l=await d.json();if(l.error)throw new Error(l.error.info||"Wikipedia API error");const c=((i=l.query)==null?void 0:i.pages)||{};return Object.values(c).map(f=>{var w;return{pageid:f.pageid,title:f.title,extract:f.extract||"",thumbnail:((w=f.thumbnail)==null?void 0:w.source)||null,fullurl:f.fullurl||null,canonicalurl:f.canonicalurl||null}})}catch(d){return console.error("📚 [Wikipedia] Page details failed:",d),[]}}filterAndFormatBookResults(e){const o=["book","novel","fiction","non-fiction","author","published","publisher","isbn","literature","story","chapter","edition","written by","series","trilogy","saga","collection","anthology"];return e.filter(t=>{const i=(t.extract||"").toLowerCase(),d=(t.title||"").toLowerCase(),l=o.some(w=>i.includes(w)||d.includes(w)),f=["book","novel","story","tale","chronicles","saga","trilogy"].some(w=>d.includes(w));return l||f}).map(t=>{const i=t.extract||"",d=t.title||"",l=i.match(/written by[^,.\n]*?([A-Z][^,.\n]*?[A-Z][^,.\n]*?)(?:\s|\.|,|$)/i),c=i.match(/(\d{4})/),f=i.match(/(?:published by|publisher)\s+([^,.\n]+)/i);let w="";if(l&&(w=l[1].trim().replace(/^(British|American|German|French|Spanish|Italian)\s+(?:author|writer|novelist)?\s*/i,""),w.includes("author")||w.includes("writer"))){const x=w.match(/([A-Z][^,.\n]*?[A-Z][^,.\n]*?)(?:\s|\.|,|$)/);w=x?x[1].trim():w}if(!w){const R=i.match(/(?:by|author|written by)\s+([A-Z][^,.\n]*?[A-Z][^,.\n]*?)(?:\s|\.|,|$)/i);R&&(w=R[1].trim().replace(/^(British|American|German|French|Spanish|Italian)\s+(?:author|writer|novelist)?\s*/i,""))}return{id:`wikipedia_${t.pageid}`,title:d,author:w,description:i.substring(0,300)+(i.length>300?"...":""),publishedDate:c?c[1]:"",publisher:f?f[1].trim():"",imageUrl:t.thumbnail||null,link:t.fullurl||t.canonicalurl||"",apiSource:"wikipedia",snippet:i.substring(0,150)+(i.length>150?"...":""),categories:this.extractCategories(i)}}).slice(0,this.maxResults)}extractCategories(e){const o=[],t=e.toLowerCase();return t.includes("fiction")&&o.push("Fiction"),(t.includes("non-fiction")||t.includes("nonfiction"))&&o.push("Non-Fiction"),t.includes("novel")&&o.push("Novel"),t.includes("biography")&&o.push("Biography"),t.includes("history")&&o.push("History"),t.includes("science")&&o.push("Science"),t.includes("philosophy")&&o.push("Philosophy"),t.includes("poetry")&&o.push("Poetry"),t.includes("drama")&&o.push("Drama"),t.includes("mystery")&&o.push("Mystery"),t.includes("romance")&&o.push("Romance"),t.includes("fantasy")&&o.push("Fantasy"),(t.includes("science fiction")||t.includes("sci-fi"))&&o.push("Science Fiction"),t.includes("thriller")&&o.push("Thriller"),t.includes("horror")&&o.push("Horror"),o}async getBookById(e){var o,t;try{const i=new URLSearchParams({action:"query",format:"json",pageids:e,prop:"extracts|pageimages|info",exintro:"true",explaintext:"true",piprop:"thumbnail",pithumbsize:300,inprop:"url",origin:"*"}),d=await fetch(`${this.baseUrl}?${i}`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout)});if(!d.ok)throw new Error(`HTTP ${d.status}: ${d.statusText}`);const l=await d.json(),c=Object.values(((o=l.query)==null?void 0:o.pages)||{})[0];if(!c)throw new Error("Page not found");return{success:!0,data:{id:`wikipedia_${c.pageid}`,title:c.title,description:c.extract||"",imageUrl:((t=c.thumbnail)==null?void 0:t.source)||null,link:c.fullurl||c.canonicalurl||"",apiSource:"wikipedia"}}}catch(i){return console.error("📚 [Wikipedia] Get book by ID failed:",i),{success:!1,error:i.message,data:null}}}}const ho=new fo;class po{constructor(){this.wikipediaService=ho,this.googleBooksService=lo}getUserPreferences(){try{const e=localStorage.getItem("profileData");if(e){const o=JSON.parse(e);return{booksApiProvider:o.booksApiProvider||"wikipedia",enableGoogleBooksFallback:o.enableGoogleBooksFallback!==!1}}}catch(e){console.warn("Failed to load user preferences:",e)}return{booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}}async searchBooks(e,o=10){const t=this.getUserPreferences();if(!e||typeof e!="string"||e.trim().length===0)return{success:!1,error:"Search query is required",data:[]};try{let i=[],d="",l=!1;switch(t.booksApiProvider){case"wikipedia":i=await this.searchWithWikipediaFirst(e,o,t),d="wikipedia";break;case"google_books":i=await this.searchWithGoogleBooksFirst(e,o,t),d="google_books";break;case"both":i=await this.searchWithBothApis(e,o,t),d="both";break;default:i=await this.searchWithWikipediaFirst(e,o,t),d="wikipedia"}return{success:!0,data:i,source:d,fallbackUsed:l}}catch(i){return console.error("📚 [UnifiedBooks] Search failed:",i),{success:!1,error:`Search failed: ${i.message}`,data:[]}}}async searchWithWikipediaFirst(e,o,t){const i=await this.wikipediaService.searchBooks(e,o);if(i.success&&i.data.length>0)return i.data;if(t.enableGoogleBooksFallback){const d=await this.googleBooksService.searchBooks(e,o);if(d.success&&d.data.length>0)return d.data}return[]}async searchWithGoogleBooksFirst(e,o,t){const i=await this.googleBooksService.searchBooks(e,o);if(i.success&&i.data.length>0)return i.data;if(t.enableGoogleBooksFallback){const d=await this.wikipediaService.searchBooks(e,o);if(d.success&&d.data.length>0)return d.data}return[]}async searchWithBothApis(e,o,t){const[i,d]=await Promise.allSettled([this.wikipediaService.searchBooks(e,Math.ceil(o/2)),this.googleBooksService.searchBooks(e,Math.ceil(o/2))]);let l=[];return i.status==="fulfilled"&&i.value.success&&(l=l.concat(i.value.data)),d.status==="fulfilled"&&d.value.success&&(l=l.concat(d.value.data)),l=this.removeDuplicateResults(l),l=l.slice(0,o),l}removeDuplicateResults(e){const o=new Set,t=[];for(const i of e){const d=i.title.toLowerCase().replace(/[^\w\s]/g,"").trim();o.has(d)||(o.add(d),t.push(i))}return t}async getBookById(e){if(e.startsWith("wikipedia_")){const o=e.replace("wikipedia_","");return await this.wikipediaService.getBookById(o)}else return await this.googleBooksService.getBookById(e)}getApiStatus(){const e=this.getUserPreferences();return{primaryProvider:e.booksApiProvider,fallbackEnabled:e.enableGoogleBooksFallback,availableProviders:["wikipedia","google_books"],wikipediaAvailable:!0,googleBooksAvailable:!0}}}const et=new po,vo={name:"BooksApiControlPanel",props:{expanded:{type:Boolean,default:!1}},emits:["preferences-changed"],setup(n,{emit:e}){const o=k(n.expanded),t=k(!1),i=k(null),d=k("checking"),l=Pe({booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}),c=()=>{o.value=!o.value},f=()=>{try{const I=localStorage.getItem("profileData");if(I){const r=JSON.parse(I);l.booksApiProvider=r.booksApiProvider||"wikipedia",l.enableGoogleBooksFallback=r.enableGoogleBooksFallback!==!1}}catch(I){console.warn("Failed to load preferences:",I)}},w=()=>{try{const I=localStorage.getItem("profileData"),r=I?JSON.parse(I):{};r.booksApiProvider=l.booksApiProvider,r.enableGoogleBooksFallback=l.enableGoogleBooksFallback,localStorage.setItem("profileData",JSON.stringify(r)),e("preferences-changed",{...l})}catch(I){console.error("Failed to save preferences:",I)}},R=async()=>{t.value=!0,i.value=null;try{const I=await et.searchBooks("Harry Potter",3);I.success&&I.data.length>0?i.value={success:!0,message:`✅ Found ${I.data.length} results using ${I.source}`}:i.value={success:!1,message:`❌ No results found: ${I.error||"Unknown error"}`}}catch(I){i.value={success:!1,message:`❌ Test failed: ${I.message}`}}finally{t.value=!1}},x=async()=>{try{const I=await et.getApiStatus();d.value=I.googleBooksAvailable?"available":"unavailable"}catch{d.value="unavailable"}};return ut(()=>{f(),x()}),{isExpanded:o,localPreferences:l,testing:t,testResult:i,googleBooksStatus:d,toggleExpanded:c,updatePreferences:w,testSearch:R}}},yo={class:"books-api-control-panel"},bo={class:"control-header"},_o={key:0,class:"control-content"},wo={class:"form-group"},ko={class:"form-group"},So={class:"checkbox-container"},xo={class:"api-status"},Co={class:"status-item"},Io={class:"search-preview"},Do=["disabled"];function Ao(n,e,o,t,i,d){return u(),m("div",yo,[s("div",bo,[e[6]||(e[6]=s("h4",null,"📚 Books API Settings",-1)),s("button",{class:H(["toggle-btn",{expanded:t.isExpanded}]),onClick:e[0]||(e[0]=(...l)=>t.toggleExpanded&&t.toggleExpanded(...l))},p(t.isExpanded?"▼":"▶"),3)]),t.isExpanded?(u(),m("div",_o,[s("div",wo,[e[8]||(e[8]=s("label",{for:"apiProvider"},"Primary API Provider:",-1)),M(s("select",{id:"apiProvider","onUpdate:modelValue":e[1]||(e[1]=l=>t.localPreferences.booksApiProvider=l),onChange:e[2]||(e[2]=(...l)=>t.updatePreferences&&t.updatePreferences(...l))},[...e[7]||(e[7]=[s("option",{value:"wikipedia"},"Wikipedia (Recommended)",-1),s("option",{value:"google_books"},"Google Books",-1),s("option",{value:"both"},"Both APIs",-1)])],544),[[ke,t.localPreferences.booksApiProvider]]),e[9]||(e[9]=s("div",{class:"field-hint"}," Choose your primary source for book information ",-1))]),s("div",ko,[s("div",So,[M(s("input",{type:"checkbox",id:"enableFallback","onUpdate:modelValue":e[3]||(e[3]=l=>t.localPreferences.enableGoogleBooksFallback=l),onChange:e[4]||(e[4]=(...l)=>t.updatePreferences&&t.updatePreferences(...l))},null,544),[[mt,t.localPreferences.enableGoogleBooksFallback]]),e[10]||(e[10]=s("label",{for:"enableFallback",class:"checkbox-label"}," Enable Google Books Fallback ",-1))]),e[11]||(e[11]=s("div",{class:"field-hint"}," Use Google Books when primary API fails ",-1))]),s("div",xo,[e[13]||(e[13]=s("div",{class:"status-item"},[s("span",{class:"status-label"},"Wikipedia:"),s("span",{class:"status-value available"},"✅ Available")],-1)),s("div",Co,[e[12]||(e[12]=s("span",{class:"status-label"},"Google Books:",-1)),s("span",{class:H(["status-value",t.googleBooksStatus])},p(t.googleBooksStatus==="available"?"✅ Available":"⚠️ Check API Key"),3)])]),s("div",Io,[s("button",{class:"test-search-btn",onClick:e[5]||(e[5]=(...l)=>t.testSearch&&t.testSearch(...l)),disabled:t.testing},p(t.testing?"Testing...":"Test Search"),9,Do),t.testResult?(u(),m("div",{key:0,class:H(["test-result",t.testResult.success?"success":"error"])},p(t.testResult.message),3)):S("",!0)])])):S("",!0)])}const To=oe(vo,[["render",Ao],["__scopeId","data-v-09652cba"]]),Mo={name:"EditModal",components:{BooksApiControlPanel:To},props:{item:{type:Object,default:null},currentCategory:{type:String,default:"watchlist"}},emits:["close","save","delete"],setup(n,{emit:e}){const o=Je(),t=k(!1),i=k(""),d=k([]),l=k(null),c=k(null),f=k(""),w=k(!1),R=k(""),x=k(!1),I=k(!1),r=Pe({category:"watchlist",title:"",release:"",apiRating:"",personalRating:"",count:"",platforms:"",genre:"",description:"",link:"",extraLink:"",path:"",discovered:"",spielzeit:"",isAiring:!1,nextSeason:"",nextSeasonRelease:"",imageUrl:"",watchlistType:"",watchlistReleaseDate:"",watchlistNumber:"",imageCleared:!1,tmdbId:"",nextSeasonName:"",lastAirDate:"",totalSeasons:"",totalEpisodes:"",seriesStatus:"",networks:"",createdBy:""}),V=G(()=>!!n.item),ne=G(()=>r.category==="game"),q=G(()=>r.category==="series"),ge=G(()=>r.category==="watchlist");Ue(()=>n.item,g=>{if(g){if(g.watchlist_type!==void 0?r.watchlistType=g.watchlist_type||"":g.watchlistType!==void 0?r.watchlistType=g.watchlistType||"":r.watchlistType="",g.watchlist_release_date!==void 0){const b=g.watchlist_release_date;b instanceof Date?r.watchlistReleaseDate=b.toISOString().split("T")[0]:typeof b=="string"&&b.includes("T")?r.watchlistReleaseDate=b.split("T")[0]:r.watchlistReleaseDate=b||""}else g.watchlistReleaseDate!==void 0?r.watchlistReleaseDate=g.watchlistReleaseDate||"":r.watchlistReleaseDate="";if(g.watchlist_number!==void 0?r.watchlistNumber=g.watchlist_number||"":g.watchlistNumber!==void 0?r.watchlistNumber=g.watchlistNumber||"":r.watchlistNumber="",Object.keys(r).forEach(b=>{b!=="watchlistType"&&b!=="watchlistReleaseDate"&&b!=="watchlistNumber"&&(r[b]=g[b]||"")}),g.is_airing!==void 0&&(console.log("DEBUG: Loading isAiring from backend:",{is_airing:g.is_airing,type:typeof g.is_airing,form_isAiring_before:r.isAiring}),r.isAiring=g.is_airing,console.log("DEBUG: form.isAiring after setting:",r.isAiring)),g.tmdb_id!==void 0&&(r.tmdbId=g.tmdb_id),g.next_season_name!==void 0&&(r.nextSeasonName=g.next_season_name),g.last_air_date!==void 0&&(r.lastAirDate=g.last_air_date),g.total_seasons!==void 0&&(r.totalSeasons=g.total_seasons),g.total_episodes!==void 0&&(r.totalEpisodes=g.total_episodes),g.series_status!==void 0&&(r.seriesStatus=g.series_status),g.networks!==void 0&&(r.networks=g.networks),g.created_by!==void 0&&(r.createdBy=g.created_by),g.next_season!==void 0&&(r.nextSeason=g.next_season),g.next_season_release!==void 0){const b=g.next_season_release;b instanceof Date?r.nextSeasonRelease=b.toISOString().split("T")[0]:typeof b=="string"&&b.includes("T")?r.nextSeasonRelease=b.split("T")[0]:r.nextSeasonRelease=b||""}g.api_rating!==void 0&&(r.apiRating=g.api_rating),g.personal_rating!==void 0&&(r.personalRating=g.personal_rating),g.description!==void 0&&(r.description=g.description),g.image_url!==void 0&&(r.imageUrl=g.image_url),g.path!==void 0&&(r.path=g.path),g.extra_link!==void 0&&(r.extraLink=g.extra_link),g.rating!==void 0&&!r.personalRating&&(r.personalRating=g.rating)}else Object.keys(r).forEach(b=>{b==="category"?r[b]=n.currentCategory||"watchlist":b==="release"?r[b]=new Date().toISOString().split("T")[0]:b==="watchlistType"?r[b]=n.currentCategory==="watchlist"?"series":"":r[b]=""})},{immediate:!0}),Ue(()=>n.currentCategory,g=>{!n.item&&g&&(r.category=g)});const ee=async()=>{var g,b,v;if(!r.title){i.value="Title is required";return}if(r.category==="watchlist"&&!r.watchlistType){i.value="Please select a type for watchlist items";return}if(r.category==="watchlist"&&!r.release){i.value="Release date is required for watchlist items";return}t.value=!0,i.value="";try{const a={...r};console.log("🔍 ULTRA DEBUG - Form data before processing:",{watchlistReleaseDate:r.watchlistReleaseDate,nextSeasonRelease:r.nextSeasonRelease,watchlistNumber:r.watchlistNumber,extraLink:r.extraLink,type_watchlist:typeof r.watchlistReleaseDate,type_next:typeof r.nextSeasonRelease,type_watchlist_number:typeof r.watchlistNumber,type_extraLink:typeof r.extraLink,is_empty_watchlist:r.watchlistReleaseDate==="",is_empty_next:r.nextSeasonRelease==="",is_empty_watchlist_number:r.watchlistNumber==="",is_empty_extraLink:r.extraLink==="",is_null_watchlist:r.watchlistReleaseDate===null,is_null_next:r.nextSeasonRelease===null,is_null_watchlist_number:r.watchlistNumber===null,is_null_extraLink:r.extraLink===null,is_undefined_watchlist:r.watchlistReleaseDate===void 0,is_undefined_next:r.nextSeasonRelease===void 0,is_undefined_watchlist_number:r.watchlistNumber===void 0,is_undefined_extraLink:r.extraLink===void 0,ALL_FORM_DATA:r}),Object.keys(a).forEach(y=>{a[y]===""&&y!=="watchlistType"&&y!=="imageUrl"&&y!=="path"&&y!=="extraLink"&&y!=="watchlistReleaseDate"&&y!=="nextSeasonRelease"&&y!=="lastAirDate"&&y!=="watchlistNumber"&&(a[y]=null)}),a.extraLink===""&&(a.extraLink=null),console.log("🔍 ULTRA DEBUG - Form data after null conversion:",{watchlistReleaseDate:a.watchlistReleaseDate,nextSeasonRelease:a.nextSeasonRelease,watchlistNumber:a.watchlistNumber,type_watchlist:typeof a.watchlistReleaseDate,type_next:typeof a.nextSeasonRelease,type_watchlist_number:typeof a.watchlistNumber,is_empty_watchlist:a.watchlistReleaseDate==="",is_empty_next:a.nextSeasonRelease==="",is_empty_watchlist_number:a.watchlistNumber==="",is_null_watchlist:a.watchlistReleaseDate===null,is_null_next:a.nextSeasonRelease===null,is_null_watchlist_number:a.watchlistNumber===null,is_undefined_watchlist:a.watchlistReleaseDate===void 0,is_undefined_next:a.nextSeasonRelease===void 0,is_undefined_watchlist_number:a.watchlistNumber===void 0,ALL_ITEM_DATA:a}),f.value?(a.path=f.value,a.imageUrl=f.value):a.imageUrl&&a.imageUrl.trim()?a.path=a.imageUrl:V.value&&n.item?n.item.image_url?(a.imageUrl=n.item.image_url,a.path=n.item.path||n.item.image_url):n.item.path&&(a.path=n.item.path,a.imageUrl=n.item.path):(a.imageUrl=null,a.path=null),a.apiRating!==void 0&&a.apiRating!==null&&a.apiRating!==""&&(a.apiRating=parseFloat(a.apiRating)),a.personalRating!==void 0&&a.personalRating!==null&&a.personalRating!==""&&(a.personalRating=parseFloat(a.personalRating)),a.count!==void 0&&a.count!==null&&a.count!==""&&(a.count=parseInt(a.count)),a.spielzeit!==void 0&&a.spielzeit!==null&&a.spielzeit!==""&&(a.spielzeit=parseInt(a.spielzeit)),a.nextSeason!==void 0&&a.nextSeason!==null&&a.nextSeason!==""&&(a.nextSeason=parseInt(a.nextSeason)),a.watchlistType!==void 0&&(a.watchlist_type=a.watchlistType||null,delete a.watchlistType),a.watchlistReleaseDate!==void 0&&(console.log("🔍 ULTRA DEBUG - watchlistReleaseDate mapping:",{original:a.watchlistReleaseDate,type:typeof a.watchlistReleaseDate,is_empty:a.watchlistReleaseDate==="",is_null:a.watchlistReleaseDate===null,is_undefined:a.watchlistReleaseDate===void 0,mapped:a.watchlistReleaseDate===""?null:a.watchlistReleaseDate,FINAL_VALUE:a.watchlistReleaseDate===""?null:a.watchlistReleaseDate,BEFORE_DELETE:a.watchlistReleaseDate}),a.watchlist_release_date=a.watchlistReleaseDate===""?null:a.watchlistReleaseDate,console.log("🔍 ULTRA DEBUG - watchlistReleaseDate after mapping:",{watchlist_release_date:a.watchlist_release_date,type:typeof a.watchlist_release_date,is_null:a.watchlist_release_date===null,is_undefined:a.watchlist_release_date===void 0}),delete a.watchlistReleaseDate),a.watchlistNumber!==void 0&&(console.log("🔍 ULTRA DEBUG - watchlistNumber mapping:",{original:a.watchlistNumber,type:typeof a.watchlistNumber,is_empty:a.watchlistNumber==="",is_null:a.watchlistNumber===null,is_undefined:a.watchlistNumber===void 0,mapped:a.watchlistNumber===""?null:a.watchlistNumber,FINAL_VALUE:a.watchlistNumber===""?null:a.watchlistNumber,BEFORE_DELETE:a.watchlistNumber}),a.watchlist_number=a.watchlistNumber===""?null:a.watchlistNumber,console.log("🔍 ULTRA DEBUG - watchlistNumber after mapping:",{watchlist_number:a.watchlist_number,type:typeof a.watchlist_number,is_null:a.watchlist_number===null,is_undefined:a.watchlist_number===void 0}),delete a.watchlistNumber),a.isAiring!==void 0&&(a.is_airing=a.isAiring,delete a.isAiring),a.tmdbId!==void 0&&(a.tmdb_id=a.tmdbId,delete a.tmdbId),a.nextSeasonName!==void 0&&(a.next_season_name=a.nextSeasonName,delete a.nextSeasonName),a.lastAirDate!==void 0&&(a.last_air_date=a.lastAirDate,delete a.lastAirDate),a.totalSeasons!==void 0&&(a.total_seasons=a.totalSeasons,delete a.totalSeasons),a.totalEpisodes!==void 0&&(a.total_episodes=a.totalEpisodes,delete a.totalEpisodes),a.seriesStatus!==void 0&&(a.series_status=a.seriesStatus,delete a.seriesStatus),a.networks!==void 0&&(a.networks=a.networks),a.createdBy!==void 0&&(a.created_by=a.createdBy,delete a.createdBy),a.nextSeason!==void 0&&(a.next_season=a.nextSeason||null,delete a.nextSeason),a.nextSeasonRelease!==void 0&&(console.log("🔍 ULTRA DEBUG - nextSeasonRelease mapping:",{original:a.nextSeasonRelease,type:typeof a.nextSeasonRelease,is_empty:a.nextSeasonRelease==="",is_null:a.nextSeasonRelease===null,is_undefined:a.nextSeasonRelease===void 0,mapped:a.nextSeasonRelease===""?null:a.nextSeasonRelease,FINAL_VALUE:a.nextSeasonRelease===""?null:a.nextSeasonRelease,BEFORE_DELETE:a.nextSeasonRelease}),a.next_season_release=a.nextSeasonRelease===""?null:a.nextSeasonRelease,console.log("🔍 ULTRA DEBUG - nextSeasonRelease after mapping:",{next_season_release:a.next_season_release,type:typeof a.next_season_release,is_null:a.next_season_release===null,is_undefined:a.next_season_release===void 0}),delete a.nextSeasonRelease),a.personalRating!==void 0?(a.rating=a.personalRating,delete a.personalRating):a.apiRating!==void 0&&(a.rating=a.apiRating,delete a.apiRating),a.imageUrl&&(a.image_url=a.imageUrl,delete a.imageUrl),a.extraLink!==void 0&&(console.log("🔍 ULTRA DEBUG - extraLink processing:",{original_extraLink:a.extraLink,type:typeof a.extraLink,is_empty:a.extraLink==="",is_null:a.extraLink===null,is_undefined:a.extraLink===void 0,mapped_to:"extra_link"}),a.extraLink&&a.extraLink.trim()!==""?a.extra_link=a.extraLink:a.extra_link=null,delete a.extraLink,console.log("🔍 ULTRA DEBUG - extraLink after mapping:",{extra_link:a.extra_link,type:typeof a.extra_link,is_null:a.extra_link===null,is_undefined:a.extra_link===void 0})),V.value&&n.item?(console.log("🔍 ULTRA DEBUG - Final data being sent to store:",{id:n.item.id,watchlist_release_date:a.watchlist_release_date,next_season_release:a.next_season_release,watchlist_number:a.watchlist_number,extra_link:a.extra_link,is_airing:a.is_airing,watchlist_type:a.watchlist_type,type_watchlist_release:typeof a.watchlist_release_date,type_next_season:typeof a.next_season_release,type_watchlist_number:typeof a.watchlist_number,type_extra_link:typeof a.extra_link,is_null_watchlist:a.watchlist_release_date===null,is_null_next:a.next_season_release===null,is_null_watchlist_number:a.watchlist_number===null,is_null_extra_link:a.extra_link===null,is_undefined_watchlist:a.watchlist_release_date===void 0,is_undefined_next:a.next_season_release===void 0,is_undefined_watchlist_number:a.watchlist_number===void 0,is_undefined_extra_link:a.extra_link===void 0,FULL_ITEM_DATA:a}),await o.updateMediaItem(n.item.id,a)):await o.addMediaItem(a),ce()}catch(a){a.isDuplicate||((g=a.response)==null?void 0:g.status)===409&&((v=(b=a.response)==null?void 0:b.data)!=null&&v.duplicate)?i.value="Ein Eintrag mit diesem Titel und dieser Kategorie existiert bereits. Bitte wählen Sie einen anderen Titel oder bearbeiten Sie den bestehenden Eintrag.":i.value=a.message||"Failed to save item"}finally{t.value=!1}},ce=()=>{i.value="",e("close")},h=()=>{e("delete",n.item),ce()},W=async()=>{if(f.value){d.value=[];return}if(l.value&&clearTimeout(l.value),!r.title||r.title.length<3){d.value=[];return}l.value=setTimeout(async()=>{try{const g=r.category==="watchlist"?r.watchlistType:r.category;if(r.category==="watchlist"&&!r.watchlistType){d.value=[];return}let b=[],v=[];if(g==="buecher"){const a=await et.searchBooks(r.title,10);a.success&&a.data&&(v=a.data.map(y=>({title:y.title,release:y.publishedDate?Se(y.publishedDate):"",genre:y.categories?y.categories.join(", "):"",platforms:y.author||"",link:y.link||"",imageUrl:y.imageUrl||"",rating:"",apiSource:y.apiSource||a.source,id:y.id,author:y.author,description:y.description,publisher:y.publisher,isbn10:y.isbn10,isbn13:y.isbn13})))}else b=await re.searchApi(r.title,g,10),b&&b.length>0&&(v=b.map(a=>({title:a.title,release:a.release,genre:a.genre||"",description:a.overview||"",platforms:a.platforms||"",link:a.link||"",imageUrl:a.image||"",rating:a.rating||"",apiSource:a.api_source||"",id:a.id||""})));v.length>0?d.value=v:d.value=[{title:`"${r.title}" - Keine Ergebnisse gefunden`,release:"",genre:"Bitte manuell ausfüllen",isPlaceholder:!0}]}catch{d.value=[{title:`"${r.title}" - API nicht verfügbar`,release:"",genre:"Bitte manuell ausfüllen",isPlaceholder:!0}]}},500)},ue=async g=>{if(g.isPlaceholder){d.value=[];return}if(r.title=g.title,g.release&&(r.release=g.release),g.platforms&&(r.platforms=g.platforms),g.genre&&(r.genre=g.genre),g.description&&(r.description=g.description),g.link&&(r.link=g.link),g.rating&&(r.apiRating=g.rating),(g.apiSource==="google_books"||g.apiSource==="wikipedia")&&(g.author&&(r.platforms=g.author),g.publisher)){const b=r.link||"";r.link=b||`Publisher: ${g.publisher}`}g.imageUrl?(r.imageUrl=g.imageUrl,r.path=g.imageUrl):(r.imageUrl="",r.path=""),r.category==="series"&&(console.log("🔍 Auto-fetching TMDB info for series:",r.title),await fe()),d.value=[]},me=g=>g?new Date(g).toLocaleDateString():"",Se=g=>{if(!g)return"";let b;if(typeof g=="string"){if(/^\d{4}$/.test(g))return`${g}-01-01`;if(/^\d{4}-\d{2}$/.test(g))return`${g}-01`;if(/^\d{4}-\d{2}-\d{2}$/.test(g))return g;b=new Date(g)}else b=new Date(g);return isNaN(b.getTime())?"":b.toISOString().split("T")[0]},pe=g=>g&&(g.startsWith("http://")?g.replace("http://","https://"):g),Ae=()=>{var y;if(!r.release)return"";const g=new Date(r.release),b=new Date;b.setHours(0,0,0,0),g.setHours(0,0,0,0);const v=g.getTime()-b.getTime(),a=Math.ceil(v/(1e3*3600*24));if(a>0)return a===1?"Tomorrow!":a<=7?`${a} days left`:a<=30?`${a} days left`:`${Math.ceil(a/30)} months left`;if(a===0)return"Released today!";{const D=((y=r.watchlistType)==null?void 0:y.toLowerCase())||"media";return D==="game"?"Unplayed yet":D==="series"||D==="movie"?"Unwatched yet":"Unconsumed yet"}},Te=()=>{var g;(g=c.value)==null||g.click()},$=async g=>{const b=g.target.files[0];if(b){if(!b.type.startsWith("image/")){i.value="Please select a valid image file";return}if(b.size>10*1024*1024){i.value="Image file too large. Maximum size is 10MB";return}t.value=!0,i.value="";try{const v=r.title.replace(/[^a-zA-Z0-9\s\-_\.]/g,"").trim()||"item",a=Date.now(),y=b.name.split(".").pop()||"jpg",D=`images_downloads/uploads/${v}_${a}.${y}`,A=await re.uploadImage(b,D);A.success?(f.value=A.saved,r.path=A.saved,r.imageUrl=A.saved):i.value=A.error||"Failed to upload image"}catch(v){i.value=v.message||"Failed to upload image"}finally{t.value=!1}}},j=()=>f.value?f.value.startsWith("storage/")?`/${f.value}`:`/${f.value}`:r.imageUrl?r.imageUrl.startsWith("http")?r.imageUrl:r.imageUrl.startsWith("storage/")?`/${r.imageUrl}`:`/${r.imageUrl}`:"",Z=g=>{g.target.style.display="none",i.value="Failed to load image: "+g.target.src},Q=g=>{i.value&&i.value.includes("Failed to load image")&&(i.value="")},ve=g=>{},xe=g=>{},ye=()=>{r.imageUrl="",r.path="",f.value="",c.value&&(c.value.value="")},Ce=()=>{f.value="",r.imageUrl===f.value&&(r.imageUrl=""),r.path===f.value&&(r.path=""),c.value&&(c.value.value="")},Ie=G(()=>!!(r.imageUrl||f.value)),_e=g=>{d.value=[]},De=()=>{I.value=!I.value},fe=async()=>{if(!r.title||r.title.trim()===""){R.value="Please enter a series title first";return}console.log("🔍 Starting TMDB API check for:",r.title),w.value=!0,R.value="",x.value=!1;try{console.log("📡 Calling checkSeriesInfo API...");const g=await re.checkSeriesInfo(r.title);if(console.log("📡 API Response:",g),g.success&&g.data){const b=g.data;console.log("📊 Series Data received:",b),b.tmdb_id&&(r.tmdbId=b.tmdb_id,console.log("✅ Set tmdbId:",b.tmdb_id)),b.is_airing!==void 0&&(r.isAiring=b.is_airing,console.log("✅ Set isAiring:",b.is_airing)),b.next_episode&&(r.nextSeason=b.next_episode.season_number,r.nextSeasonRelease=b.next_episode.air_date,r.nextSeasonName=b.next_episode.name,console.log("✅ Set next season info:",{season:b.next_episode.season_number,release:b.next_episode.air_date,name:b.next_episode.name})),b.last_air_date&&(r.lastAirDate=b.last_air_date,console.log("✅ Set lastAirDate:",b.last_air_date)),b.number_of_seasons&&(r.totalSeasons=b.number_of_seasons,console.log("✅ Set totalSeasons:",b.number_of_seasons)),b.number_of_episodes&&(r.totalEpisodes=b.number_of_episodes,console.log("✅ Set totalEpisodes:",b.number_of_episodes)),b.status&&(r.seriesStatus=b.status,console.log("✅ Set seriesStatus:",b.status)),b.networks&&b.networks.length>0&&(r.networks=b.networks.join(", "),console.log("✅ Set networks:",b.networks.join(", "))),b.created_by&&b.created_by.length>0&&(r.createdBy=b.created_by.join(", "),console.log("✅ Set createdBy:",b.created_by.join(", "))),b.overview&&(r.description=b.overview,console.log("✅ Set description")),b.genres&&b.genres.length>0&&(r.genre=b.genres.join(", "),console.log("✅ Set genre:",b.genres.join(", "))),b.poster_path&&(r.imageUrl=b.poster_path,r.path=b.poster_path,console.log("✅ Set imageUrl:",b.poster_path)),console.log("📝 Final form state:",r),x.value=!0,setTimeout(()=>{x.value=!1},3e3)}else console.error("❌ API returned error:",g.error),R.value=g.error||"Failed to fetch series information"}catch(g){console.error("❌ TMDB API check failed:",g),R.value=g.message||"Failed to check series information"}finally{w.value=!1}};return{form:r,loading:t,error:i,apiResults:d,isEditing:V,isGame:ne,isSeries:q,isWatchlist:ge,imageUploadRef:c,uploadedImagePath:f,apiLoading:w,apiError:R,apiSuccess:x,seriesDetailsExpanded:I,handleSave:ee,closeModal:ce,deleteItem:h,searchApi:W,selectApiResult:ue,formatDate:me,formatDateForInput:Se,ensureHttpsUrl:pe,getReleasePreview:Ae,triggerImageUpload:Te,handleImageUpload:$,getImagePreviewUrl:j,handleImageError:Z,handleImageLoad:Q,handleImageLoadStart:ve,handleImageLoadEnd:xe,clearImage:ye,removeUploadedImage:Ce,shouldShowImagePreview:Ie,handlePreferencesChanged:_e,toggleSeriesDetails:De,checkSeriesAPI:fe}}},Ro={class:"top-control-panel"},Eo={class:"control-row-1"},Uo={class:"form-group category-group"},Lo={class:"form-group title-group"},Bo={class:"search-container"},Po=["placeholder","disabled"],Fo={key:0,class:"search-results"},No=["onClick"],Go={class:"result-thumbnail"},Wo=["src","alt"],Vo={key:1,class:"no-image"},Oo={class:"result-content"},jo={class:"result-title"},zo={class:"result-meta"},Yo={key:0},Ho={key:1},qo={key:2,class:"rating"},Qo={class:"control-row-2"},Jo={class:"form-group"},Ko={for:"release"},Zo={key:0,class:"required"},Xo=["required"],$o={class:"form-group"},en={key:0,class:"form-group"},tn={class:"form-group"},sn={class:"control-row-3"},an={class:"control-buttons"},on=["disabled"],nn=["disabled"],ln=["disabled"],rn={class:"main-form-area"},dn={class:"form-columns"},cn={class:"form-column-left"},un={class:"form-group"},mn={class:"form-group"},gn={class:"form-group"},fn={class:"form-group"},hn={class:"form-column-right"},pn={class:"form-group"},vn={class:"form-group"},yn={class:"form-group"},bn={class:"image-input-group"},_n=["disabled"],wn={key:0,class:"upload-success"},kn={key:0,class:"watchlist-fields"},Sn={class:"form-group"},xn={key:0,class:"field-error"},Cn={class:"form-group"},In={class:"form-group"},Dn={class:"form-group"},An={key:1,class:"game-fields"},Tn={class:"form-group"},Mn={class:"collapsible-sections"},Rn={key:0,class:"collapsible-section"},En={key:0,class:"collapsible-content"},Un={class:"form-row"},Ln={class:"form-group"},Bn={class:"form-group"},Pn={class:"form-row"},Fn={class:"form-group"},Nn={class:"form-group"},Gn={class:"form-row"},Wn={class:"form-group"},Vn={class:"form-group"},On={class:"form-row"},jn={class:"form-group full-width"},zn={class:"form-row"},Yn={class:"form-group full-width"},Hn={key:0,class:"form-row"},qn={class:"form-group"},Qn={class:"form-row"},Jn={class:"form-group full-width"},Kn={class:"api-check-container"},Zn=["disabled"],Xn={key:0},$n={key:1},ei={key:0,class:"api-error"},ti={key:1,class:"api-success"},si={key:3,class:"error-message"};function ai(n,e,o,t,i,d){const l=le("BooksApiControlPanel");return u(),m("div",{class:"modal",onClick:e[36]||(e[36]=(...c)=>t.closeModal&&t.closeModal(...c))},[s("div",{class:"modal-content",onClick:e[35]||(e[35]=de(()=>{},["stop"]))},[s("h2",null,p(t.isEditing?"Edit Item":"Add Item"),1),s("form",{onSubmit:e[34]||(e[34]=de((...c)=>t.handleSave&&t.handleSave(...c),["prevent"]))},[s("div",Ro,[s("div",Eo,[s("div",Uo,[e[38]||(e[38]=s("label",{for:"category"},"Category:",-1)),M(s("select",{id:"category","onUpdate:modelValue":e[0]||(e[0]=c=>t.form.category=c),required:""},[...e[37]||(e[37]=[Ge('<option value="watchlist" data-v-d1208d11>Watchlist</option><option value="game" data-v-d1208d11>Game</option><option value="series" data-v-d1208d11>Series</option><option value="movie" data-v-d1208d11>Movie</option><option value="buecher" data-v-d1208d11>Bücher</option>',5)])],512),[[ke,t.form.category]])]),s("div",Lo,[e[39]||(e[39]=s("label",{for:"title"},"Title:",-1)),s("div",Bo,[M(s("input",{type:"text",id:"title","onUpdate:modelValue":e[1]||(e[1]=c=>t.form.title=c),onInput:e[2]||(e[2]=(...c)=>t.searchApi&&t.searchApi(...c)),required:"",placeholder:t.isWatchlist?"Enter title (API search + manual input available)":"Enter title",disabled:t.loading},null,40,Po),[[L,t.form.title]]),t.apiResults.length>0?(u(),m("div",Fo,[(u(!0),m(se,null,ae(t.apiResults,c=>(u(),m("div",{key:c.title,class:"search-result-item",onClick:f=>t.selectApiResult(c)},[s("div",Go,[c.imageUrl?(u(),m("img",{key:0,src:t.ensureHttpsUrl(c.imageUrl),alt:c.title},null,8,Wo)):(u(),m("div",Vo,[s("span",null,p(c.title.charAt(0).toUpperCase()),1)]))]),s("div",Oo,[s("div",jo,p(c.title),1),s("div",zo,[c.release?(u(),m("span",Yo,p(t.formatDate(c.release)),1)):S("",!0),c.genre?(u(),m("span",Ho,p(c.genre),1)):S("",!0),c.rating?(u(),m("span",qo,"⭐ "+p(c.rating),1)):S("",!0)])])],8,No))),128))])):S("",!0)])])]),s("div",Qo,[s("div",Jo,[s("label",Ko,[qe(p(t.isWatchlist?"Release Date:":"Release:")+" ",1),t.isWatchlist?(u(),m("span",Zo,"*")):S("",!0)]),M(s("input",{type:"date",id:"release","onUpdate:modelValue":e[3]||(e[3]=c=>t.form.release=c),required:t.isWatchlist},null,8,Xo),[[L,t.form.release]])]),s("div",$o,[e[40]||(e[40]=s("label",{for:"personalRating"},"Personal Rating:",-1)),M(s("input",{type:"number",id:"personalRating","onUpdate:modelValue":e[4]||(e[4]=c=>t.form.personalRating=c),step:"0.1",min:"0",max:"10",placeholder:"0-10"},null,512),[[L,t.form.personalRating]])]),t.isSeries?(u(),m("div",en,[e[42]||(e[42]=s("label",{for:"isAiring"},"Status:",-1)),M(s("select",{id:"isAiring","onUpdate:modelValue":e[5]||(e[5]=c=>t.form.isAiring=c)},[...e[41]||(e[41]=[s("option",{value:!1},"Finished",-1),s("option",{value:!0},"Airing",-1)])],512),[[ke,t.form.isAiring]])])):S("",!0),s("div",tn,[e[43]||(e[43]=s("label",{for:"apiRating"},"API Rating:",-1)),M(s("input",{type:"number",id:"apiRating","onUpdate:modelValue":e[6]||(e[6]=c=>t.form.apiRating=c),step:"0.1",min:"0",max:"10",placeholder:"0-10",readonly:""},null,512),[[L,t.form.apiRating]])])]),s("div",sn,[s("div",an,[s("button",{type:"submit",disabled:t.loading,class:"save-btn"},p(t.loading?"Saving...":"💾 Save"),9,on),s("button",{type:"button",onClick:e[7]||(e[7]=(...c)=>t.closeModal&&t.closeModal(...c)),disabled:t.loading,class:"cancel-btn"}," ✕ Cancel ",8,nn),t.isEditing?(u(),m("button",{key:0,type:"button",onClick:e[8]||(e[8]=(...c)=>t.deleteItem&&t.deleteItem(...c)),disabled:t.loading,class:"delete-btn"}," 🗑️ Delete ",8,ln)):S("",!0)])])]),s("div",rn,[s("div",dn,[s("div",cn,[s("div",un,[e[44]||(e[44]=s("label",{for:"views"},"Views:",-1)),M(s("input",{type:"number",id:"views","onUpdate:modelValue":e[9]||(e[9]=c=>t.form.count=c),min:"0",placeholder:"0"},null,512),[[L,t.form.count]])]),s("div",mn,[e[45]||(e[45]=s("label",{for:"discovered"},"Discovered:",-1)),M(s("input",{type:"date",id:"discovered","onUpdate:modelValue":e[10]||(e[10]=c=>t.form.discovered=c)},null,512),[[L,t.form.discovered]])]),s("div",gn,[e[46]||(e[46]=s("label",{for:"platforms"},"Platforms:",-1)),M(s("input",{type:"text",id:"platforms","onUpdate:modelValue":e[11]||(e[11]=c=>t.form.platforms=c),placeholder:"PC, PS5, Xbox"},null,512),[[L,t.form.platforms]])]),s("div",fn,[e[47]||(e[47]=s("label",{for:"genre"},"Genre:",-1)),M(s("input",{type:"text",id:"genre","onUpdate:modelValue":e[12]||(e[12]=c=>t.form.genre=c),placeholder:"Action, Adventure, RPG"},null,512),[[L,t.form.genre]])])]),s("div",hn,[s("div",pn,[e[48]||(e[48]=s("label",{for:"description"},"Description:",-1)),M(s("textarea",{id:"description","onUpdate:modelValue":e[13]||(e[13]=c=>t.form.description=c),placeholder:"Enter description...",rows:"3"},null,512),[[L,t.form.description]])]),s("div",vn,[e[49]||(e[49]=s("label",{for:"link"},"Link:",-1)),M(s("input",{type:"url",id:"link","onUpdate:modelValue":e[14]||(e[14]=c=>t.form.link=c),placeholder:"https://..."},null,512),[[L,t.form.link]])]),s("div",yn,[e[50]||(e[50]=s("label",{for:"imageUrl"},"Image URL:",-1)),s("div",bn,[M(s("input",{type:"text",id:"imageUrl","onUpdate:modelValue":e[15]||(e[15]=c=>t.form.imageUrl=c),placeholder:"https://... or leave empty for API images"},null,512),[[L,t.form.imageUrl]]),s("button",{type:"button",onClick:e[16]||(e[16]=(...c)=>t.triggerImageUpload&&t.triggerImageUpload(...c)),class:"upload-btn",disabled:t.loading}," 📁 Upload ",8,_n)]),t.uploadedImagePath?(u(),m("div",wn,[qe(" ✅ Image uploaded: "+p(t.uploadedImagePath)+" ",1),s("button",{type:"button",onClick:e[17]||(e[17]=(...c)=>t.removeUploadedImage&&t.removeUploadedImage(...c)),class:"remove-uploaded-btn",title:"Remove uploaded image to enable API search"}," ✕ Remove ")])):S("",!0)])])])]),t.form.category==="watchlist"?(u(),m("div",kn,[s("div",Sn,[e[52]||(e[52]=s("label",{for:"watchlistType"},[qe("Type: "),s("span",{class:"required"},"*")],-1)),M(s("select",{id:"watchlistType","onUpdate:modelValue":e[18]||(e[18]=c=>t.form.watchlistType=c)},[...e[51]||(e[51]=[Ge('<option value="" data-v-d1208d11>Select Type</option><option value="game" data-v-d1208d11>Game</option><option value="series" data-v-d1208d11>Series</option><option value="movie" data-v-d1208d11>Movie</option><option value="buecher" data-v-d1208d11>Bücher</option>',5)])],512),[[ke,t.form.watchlistType]]),t.form.category==="watchlist"&&!t.form.watchlistType?(u(),m("div",xn," Please select a type for watchlist items ")):S("",!0)]),s("div",Cn,[e[53]||(e[53]=s("label",{for:"watchlistReleaseDate"},"Watchlist Release Date",-1)),M(s("input",{type:"date",id:"watchlistReleaseDate","onUpdate:modelValue":e[19]||(e[19]=c=>t.form.watchlistReleaseDate=c),placeholder:"When does this release?"},null,512),[[L,t.form.watchlistReleaseDate]])]),s("div",In,[e[54]||(e[54]=s("label",{for:"watchlistNumber"},"Watchlist Number",-1)),M(s("input",{type:"number",id:"watchlistNumber","onUpdate:modelValue":e[20]||(e[20]=c=>t.form.watchlistNumber=c),placeholder:"Enter a number",min:"1"},null,512),[[L,t.form.watchlistNumber]])]),s("div",Dn,[e[55]||(e[55]=s("label",{for:"extraLink"},"Extra Link:",-1)),M(s("input",{type:"url",id:"extraLink","onUpdate:modelValue":e[21]||(e[21]=c=>t.form.extraLink=c),placeholder:"https://... (e.g., streaming platform, official website)"},null,512),[[L,t.form.extraLink]]),e[56]||(e[56]=s("div",{class:"field-hint"},"Optional: Additional link for watchlist items (e.g., streaming platform, official website)",-1))])])):S("",!0),t.isGame?(u(),m("div",An,[s("div",Tn,[e[57]||(e[57]=s("label",{for:"playtime"},"Playtime (Minutes):",-1)),M(s("input",{type:"number",id:"playtime","onUpdate:modelValue":e[22]||(e[22]=c=>t.form.spielzeit=c),min:"0",placeholder:"0"},null,512),[[L,t.form.spielzeit]])])])):S("",!0),s("div",Mn,[t.isSeries?(u(),m("div",Rn,[s("button",{type:"button",onClick:e[23]||(e[23]=(...c)=>t.toggleSeriesDetails&&t.toggleSeriesDetails(...c)),class:H(["collapsible-header",{expanded:t.seriesDetailsExpanded}])}," 📺 Series Details "+p(t.seriesDetailsExpanded?"▼":"▶"),3),t.seriesDetailsExpanded?(u(),m("div",En,[s("div",Un,[s("div",Ln,[e[58]||(e[58]=s("label",{for:"nextSeasonName"},"Next Season Name:",-1)),M(s("input",{type:"text",id:"nextSeasonName","onUpdate:modelValue":e[24]||(e[24]=c=>t.form.nextSeasonName=c),placeholder:"e.g., The Final Season"},null,512),[[L,t.form.nextSeasonName]])]),s("div",Bn,[e[59]||(e[59]=s("label",{for:"lastAirDate"},"Last Air Date:",-1)),M(s("input",{type:"date",id:"lastAirDate","onUpdate:modelValue":e[25]||(e[25]=c=>t.form.lastAirDate=c)},null,512),[[L,t.form.lastAirDate]])])]),s("div",Pn,[s("div",Fn,[e[60]||(e[60]=s("label",{for:"totalSeasons"},"Total Seasons:",-1)),M(s("input",{type:"number",id:"totalSeasons","onUpdate:modelValue":e[26]||(e[26]=c=>t.form.totalSeasons=c),min:"0",placeholder:"0"},null,512),[[L,t.form.totalSeasons]])]),s("div",Nn,[e[61]||(e[61]=s("label",{for:"totalEpisodes"},"Total Episodes:",-1)),M(s("input",{type:"number",id:"totalEpisodes","onUpdate:modelValue":e[27]||(e[27]=c=>t.form.totalEpisodes=c),min:"0",placeholder:"0"},null,512),[[L,t.form.totalEpisodes]])])]),s("div",Gn,[s("div",Wn,[e[63]||(e[63]=s("label",{for:"seriesStatus"},"Series Status:",-1)),M(s("select",{id:"seriesStatus","onUpdate:modelValue":e[28]||(e[28]=c=>t.form.seriesStatus=c)},[...e[62]||(e[62]=[Ge('<option value="" data-v-d1208d11>Select Status</option><option value="Returning Series" data-v-d1208d11>Returning Series</option><option value="Ended" data-v-d1208d11>Ended</option><option value="In Production" data-v-d1208d11>In Production</option><option value="Canceled" data-v-d1208d11>Canceled</option>',5)])],512),[[ke,t.form.seriesStatus]])]),s("div",Vn,[e[64]||(e[64]=s("label",{for:"networks"},"Networks:",-1)),M(s("input",{type:"text",id:"networks","onUpdate:modelValue":e[29]||(e[29]=c=>t.form.networks=c),placeholder:"e.g., Netflix, HBO"},null,512),[[L,t.form.networks]])])]),s("div",On,[s("div",jn,[e[65]||(e[65]=s("label",{for:"createdBy"},"Created By:",-1)),M(s("input",{type:"text",id:"createdBy","onUpdate:modelValue":e[30]||(e[30]=c=>t.form.createdBy=c),placeholder:"e.g., The Duffer Brothers"},null,512),[[L,t.form.createdBy]])])]),s("div",zn,[s("div",Yn,[e[66]||(e[66]=s("label",{for:"extraLink"},"Extra Link:",-1)),M(s("input",{type:"url",id:"extraLink","onUpdate:modelValue":e[31]||(e[31]=c=>t.form.extraLink=c),placeholder:"https://... (e.g., streaming platform, official website)"},null,512),[[L,t.form.extraLink]]),e[67]||(e[67]=s("div",{class:"field-hint"},"Optional: Additional link for series (e.g., streaming platform, official website)",-1))])]),t.form.isAiring?(u(),m("div",Hn,[s("div",qn,[e[68]||(e[68]=s("label",{for:"nextSeasonRelease"},"Next Season Release:",-1)),M(s("input",{type:"date",id:"nextSeasonRelease","onUpdate:modelValue":e[32]||(e[32]=c=>t.form.nextSeasonRelease=c)},null,512),[[L,t.form.nextSeasonRelease]])])])):S("",!0),s("div",Qn,[s("div",Jn,[e[69]||(e[69]=s("label",null,"TMDB Series Information:",-1)),s("div",Kn,[s("button",{type:"button",onClick:e[33]||(e[33]=(...c)=>t.checkSeriesAPI&&t.checkSeriesAPI(...c)),disabled:t.loading||!t.form.title,class:"api-check-btn"},[t.apiLoading?(u(),m("span",Xn,"🔍 Checking...")):(u(),m("span",$n,"🔍 Check Series Info"))],8,Zn),t.apiError?(u(),m("div",ei,p(t.apiError),1)):S("",!0),t.apiSuccess?(u(),m("div",ti," ✅ Series information updated from TMDB ")):S("",!0)])])])])):S("",!0)])):S("",!0)]),t.form.category==="buecher"||t.form.watchlistType==="buecher"?(u(),Be(l,{key:2,expanded:!1,onPreferencesChanged:t.handlePreferencesChanged},null,8,["onPreferencesChanged"])):S("",!0),t.error?(u(),m("div",si,p(t.error),1)):S("",!0)],32)])])}const oi=oe(Mo,[["render",ai],["__scopeId","data-v-d1208d11"]]),ni={name:"BulkAddModal",props:{show:{type:Boolean,default:!1},currentCategory:{type:String,default:""}},emits:["close"],setup(n,{emit:e}){const o=Je(),t=k(1),i=k(!1),d=k(!0),l=k(!1),c=k(0),f=k(0),w=k(0),R=k(0),x=k(null),I=k(""),r=k(""),V=k([]),ne=k([]),q=k({category:"",itemsText:"",defaultRating:null}),ge=G(()=>q.value.category&&q.value.itemsText.trim()&&!i.value),ee=G(()=>{const j=ce().length;return j>0?Math.round(c.value/j*100):0}),ce=()=>!q.value.itemsText||!q.value.itemsText.trim()?[]:q.value.itemsText.split(`
`).map(j=>j.trim()).filter(j=>j.length>0).map(j=>{const Z=j.split("|").map(Q=>Q.trim());return{searchTerm:Z[0]||"",additionalInfo:Z[1]||null}}),h=()=>{c.value=0,f.value=0,w.value=0,R.value=0,x.value=null,I.value="",r.value="",V.value=[],ne.value=[]},W=(j,Z,Q)=>{x.value=j,I.value=Z,r.value=Q},ue=(j,Z,Q="")=>{const ve={searching:"Searching...",found:"Found",adding:"Adding...",added:"Added",skipped:"Skipped",error:"Error"}[Z]||Z;V.value.push({title:j,status:Z,statusText:ve,message:Q})},me=async()=>{var Q,ve,xe,ye,Ce,Ie,_e,De;if(!ge.value)return;t.value=2,i.value=!0,d.value=!0,h();const j=ce();let Z=0;try{let fe=[];const g=localStorage.getItem("authToken"),b=localStorage.getItem("currentUser");if(g&&b)try{W({title:"Checking all items..."},"searching","Checking profile for duplicates..."),fe=(await re.checkExistingItems(j.map(a=>({title:a.searchTerm,category:q.value.category})))).existing_items||[]}catch(v){console.warn("Failed to check existing items, falling back to individual checks:",v)}for(let v=0;v<j.length;v++){const a=j[v];c.value=v+1,W({title:a.searchTerm,description:a.additionalInfo},"searching","Processing...");try{let y=!1;if(g&&b&&fe.length>0?y=fe.some(T=>T.title.toLowerCase().trim()===a.searchTerm.toLowerCase().trim()):y=(o.mediaData||[]).some(z=>z.title&&z.title.toLowerCase().trim()===a.searchTerm.toLowerCase().trim()&&z.category===q.value.category),y){console.log(`✅ Found exact match in profile for "${a.searchTerm}"`),W({title:a.searchTerm},"skipped","Already exists in profile - skipped"),ne.value.push({searchTerm:a.searchTerm,additionalInfo:a.additionalInfo,reason:"duplicate"}),w.value++,ue(a.searchTerm,"skipped","Already exists in profile - skipped");continue}W({title:a.searchTerm,description:a.additionalInfo},"searching","Searching API..."),ue(a.searchTerm,"searching","Searching API...");const D=await re.searchApi(a.searchTerm,q.value.category,1);if(D&&D.length>0&&D[0]&&D[0].api_source&&D[0].image){const T=D[0];console.log(`✅ Found real API data for "${a.searchTerm}":`,{title:T.title,api_source:T.api_source,has_image:!!T.image,has_genre:!!T.genre,has_release:!!T.release}),W({title:T.title,description:`Found: ${T.genre||"Unknown genre"} • ${T.release||"Unknown year"} • ${T.api_source}`},"found","Found in API with data"),ue(a.searchTerm,"found",`Found: ${T.title} (${T.api_source})`);let z=null;if(q.value.category==="series"){W({title:T.title},"fetching","Fetching TMDB series info...");try{console.log("🔍 Fetching TMDB info for series:",T.title);const he=await re.checkSeriesInfo(T.title);he.success&&he.data&&(z=he.data,console.log("✅ TMDB data received:",z))}catch(he){console.warn("⚠️ Failed to fetch TMDB info:",he)}}W({title:T.title},"adding","Adding to library...");const ie={title:T.title,category:q.value.category,release:T.release||null,rating:T.rating?Math.round(T.rating):q.value.defaultRating||null,platforms:T.platforms||null,genre:T.genre||null,link:T.link||null,path:T.image||null,external_id:T.id||null,count:1,is_airing:!1,spielzeit:0,description:T.overview||a.additionalInfo||null,...z&&{tmdb_id:z.tmdb_id,is_airing:z.is_airing||!1,next_season:((Q=z.next_episode)==null?void 0:Q.season_number)||null,next_season_release:((ve=z.next_episode)==null?void 0:ve.air_date)||null,next_season_name:((xe=z.next_episode)==null?void 0:xe.name)||null,last_air_date:z.last_air_date||null,total_seasons:z.number_of_seasons||null,total_episodes:z.number_of_episodes||null,series_status:z.status||null,networks:((ye=z.networks)==null?void 0:ye.join(", "))||null,created_by:((Ce=z.created_by)==null?void 0:Ce.join(", "))||null}};await o.addMediaItem(ie,!0),f.value++,W({title:T.title},"added","Successfully added with API data"),ue(a.searchTerm,"added",`Added: ${T.title} with API data`)}else console.log(`❌ No real API data found for "${a.searchTerm}"`),W({title:a.searchTerm},"skipped","No API data found - will retry"),ne.value.push({searchTerm:a.searchTerm,additionalInfo:a.additionalInfo,reason:"no_api_data"}),w.value++,ue(a.searchTerm,"skipped","No API data found - ready for retry")}catch(y){console.error(`Error processing "${a.searchTerm}":`,y),y.isDuplicate||((Ie=y.response)==null?void 0:Ie.status)===409&&((De=(_e=y.response)==null?void 0:_e.data)!=null&&De.duplicate)?(W({title:a.searchTerm},"skipped","Already exists - skipped"),w.value++,ue(a.searchTerm,"skipped","Item already exists in library")):(W({title:a.searchTerm},"error","Error occurred"),R.value++,ue(a.searchTerm,"error",y.message||"Unknown error"))}if(Z++,Z>=5){console.log("🔄 Reloading media data after 5 items...");try{await o.loadMedia(),Z=0}catch(y){console.warn("Failed to reload media data:",y)}}if(!i.value)break;for(;l.value&&i.value;)await new Promise(y=>setTimeout(y,100));await new Promise(y=>setTimeout(y,1e3))}console.log("🔄 Final media data reload...");try{await o.loadMedia()}catch(v){console.warn("Failed to reload media data at end:",v)}t.value=3,W(null,"","")}catch(fe){console.error("Bulk processing error:",fe),R.value++}finally{i.value=!1,d.value=!1}},Se=()=>{i.value=!1,d.value=!1,l.value=!1,t.value=1,h()},pe=()=>{l.value=!0},Ae=()=>{l.value=!1},Te=()=>{const j=ne.value.filter(Q=>Q.reason!=="duplicate");if(j.length===0){$();return}const Z=j.map(Q=>Q.additionalInfo?`${Q.searchTerm} | ${Q.additionalInfo}`:Q.searchTerm).join(`
`);q.value.itemsText=Z,c.value=0,f.value=0,R.value=0,x.value=null,I.value="",r.value="",V.value=[],t.value=1},$=()=>{t.value=1,i.value=!1,d.value=!0,h(),q.value={category:"",itemsText:"",defaultRating:null},e("close")};return Ue(()=>n.show,j=>{j&&n.currentCategory?q.value.category=n.currentCategory:j||$()}),{currentStep:t,isProcessing:i,canCancel:d,isPaused:l,processedCount:c,addedCount:f,skippedCount:w,errorCount:R,currentItem:x,currentItemStatus:I,currentItemStatusText:r,processingResults:V,skippedItems:ne,bulkData:q,canStart:ge,progressPercentage:ee,startProcessing:me,cancelProcessing:Se,pauseProcessing:pe,resumeProcessing:Ae,retrySkippedItems:Te,closeModal:$}}},ii={class:"modal-header"},li={class:"modal-body"},ri={key:0,class:"step-container"},di={class:"bulk-add-form"},ci={class:"form-row"},ui={class:"form-group"},mi={class:"form-group"},gi={class:"form-group"},fi={key:1,class:"step-container"},hi={class:"processing-container"},pi={class:"progress-overview"},vi={class:"progress-stats"},yi={class:"stat"},bi={class:"stat-number"},_i={class:"stat"},wi={class:"stat-number"},ki={class:"stat"},Si={class:"stat-number"},xi={class:"stat"},Ci={class:"stat-number"},Ii={class:"progress-bar"},Di={class:"progress-text"},Ai={class:"current-item"},Ti={class:"current-item-header"},Mi={class:"current-item-title"},Ri={key:0,class:"paused-indicator"},Ei={key:0,class:"current-item-description"},Ui={key:1,class:"api-data-indicator"},Li={key:2,class:"no-api-indicator"},Bi={class:"results-list"},Pi={class:"result-header"},Fi={class:"result-title"},Ni={class:"result-status"},Gi={key:0,class:"result-message"},Wi={key:2,class:"step-container"},Vi={class:"results-summary"},Oi={class:"summary-stats"},ji={class:"summary-stat success"},zi={class:"stat-number"},Yi={class:"summary-stat warning"},Hi={class:"stat-number"},qi={class:"summary-stat info"},Qi={class:"stat-number"},Ji={class:"summary-stat error"},Ki={class:"stat-number"},Zi={key:0,class:"retry-section"},Xi={class:"retry-list"},$i=["onUpdate:modelValue","disabled"],el={key:0,class:"retry-additional"},tl={key:1,class:"duplicate-badge"},sl={key:2,class:"retry-badge"},al={key:1,class:"detailed-results"},ol={class:"results-list"},nl={class:"result-header"},il={class:"result-title"},ll={class:"result-status"},rl={key:0,class:"result-message"},dl={class:"modal-footer"},cl=["disabled"],ul={key:2,class:"processing-controls"},ml=["disabled"],gl=["disabled"],fl={key:3,class:"footer-buttons"};function hl(n,e,o,t,i,d){var l,c;return o.show?(u(),m("div",{key:0,class:"modal-overlay",onClick:e[12]||(e[12]=(...f)=>t.closeModal&&t.closeModal(...f))},[s("div",{class:"modal-content",onClick:e[11]||(e[11]=de(()=>{},["stop"]))},[s("div",ii,[e[13]||(e[13]=s("h2",null,"Bulk Add Items",-1)),s("button",{class:"close-btn",onClick:e[0]||(e[0]=(...f)=>t.closeModal&&t.closeModal(...f))},"✕")]),s("div",li,[t.currentStep===1?(u(),m("div",ri,[e[19]||(e[19]=s("div",{class:"step-header"},[s("div",{class:"step-number"},"1"),s("h3",null,"Enter Your List")],-1)),s("div",di,[s("div",ci,[s("div",ui,[e[15]||(e[15]=s("label",{for:"category"},"Category *",-1)),M(s("select",{id:"category","onUpdate:modelValue":e[1]||(e[1]=f=>t.bulkData.category=f),required:""},[...e[14]||(e[14]=[Ge('<option value="" data-v-04d8250b>Select Category</option><option value="game" data-v-04d8250b>Game</option><option value="series" data-v-04d8250b>Series</option><option value="movie" data-v-04d8250b>Movie</option><option value="buecher" data-v-04d8250b>Bücher</option><option value="watchlist" data-v-04d8250b>Watchlist</option>',6)])],512),[[ke,t.bulkData.category]])]),s("div",mi,[e[16]||(e[16]=s("label",{for:"default-rating"},"Default Rating",-1)),M(s("input",{id:"default-rating","onUpdate:modelValue":e[2]||(e[2]=f=>t.bulkData.defaultRating=f),type:"number",min:"0",max:"10",step:"0.1",placeholder:"Optional rating for all items"},null,512),[[L,t.bulkData.defaultRating,void 0,{number:!0}]])])]),s("div",gi,[e[17]||(e[17]=s("label",{for:"items-text"},"Items (one per line) *",-1)),M(s("textarea",{id:"items-text","onUpdate:modelValue":e[3]||(e[3]=f=>t.bulkData.itemsText=f),placeholder:`Enter items one per line, for example:
The Witcher 3
Cyberpunk 2077
Red Dead Redemption 2`,rows:"6",required:""},null,512),[[L,t.bulkData.itemsText]]),e[18]||(e[18]=s("small",{class:"help-text"},"Enter one item per line. The system will automatically search and add each item individually.",-1))])])])):S("",!0),t.currentStep===2?(u(),m("div",fi,[e[24]||(e[24]=s("div",{class:"step-header"},[s("div",{class:"step-number"},"2"),s("h3",null,"Processing Items")],-1)),s("div",hi,[s("div",pi,[s("div",vi,[s("span",yi,[s("span",bi,p(t.processedCount),1),e[20]||(e[20]=s("span",{class:"stat-label"},"Processed",-1))]),s("span",_i,[s("span",wi,p(t.addedCount),1),e[21]||(e[21]=s("span",{class:"stat-label"},"Added",-1))]),s("span",ki,[s("span",Si,p(t.skippedCount),1),e[22]||(e[22]=s("span",{class:"stat-label"},"Skipped",-1))]),s("span",xi,[s("span",Ci,p(t.errorCount),1),e[23]||(e[23]=s("span",{class:"stat-label"},"Errors",-1))])]),s("div",Ii,[s("div",{class:"progress-fill",style:Le({width:t.progressPercentage+"%"})},null,4)]),s("div",Di,p(t.progressPercentage)+"% Complete",1)]),s("div",Ai,[s("div",Ti,[s("span",Mi,"Processing: "+p(((l=t.currentItem)==null?void 0:l.title)||"..."),1),s("span",{class:H(["current-item-status",t.currentItemStatus])},[t.isPaused?(u(),m("span",Ri,"⏸️ PAUSED - ")):S("",!0),qe(p(t.currentItemStatusText),1)],2)]),(c=t.currentItem)!=null&&c.description?(u(),m("div",Ei,p(t.currentItem.description),1)):S("",!0),t.currentItemStatus==="found"?(u(),m("div",Ui," ✅ Real API data found with image and metadata ")):S("",!0),t.currentItemStatus==="skipped"?(u(),m("div",Li," ❌ No API data found - will be retried ")):S("",!0)]),s("div",Bi,[(u(!0),m(se,null,ae(t.processingResults,(f,w)=>(u(),m("div",{key:w,class:H(["result-item",f.status])},[s("div",Pi,[s("span",Fi,p(f.title),1),s("span",Ni,p(f.statusText),1)]),f.message?(u(),m("div",Gi,p(f.message),1)):S("",!0)],2))),128))])])])):S("",!0),t.currentStep===3?(u(),m("div",Wi,[e[32]||(e[32]=s("div",{class:"step-header"},[s("div",{class:"step-number"},"3"),s("h3",null,"Results")],-1)),s("div",Vi,[s("div",Oi,[s("div",ji,[s("span",zi,p(t.addedCount),1),e[25]||(e[25]=s("span",{class:"stat-label"},"Successfully Added",-1))]),s("div",Yi,[s("span",Hi,p(t.skippedItems.filter(f=>f.reason!=="duplicate").length),1),e[26]||(e[26]=s("span",{class:"stat-label"},"Not Found (Ready for Retry)",-1))]),s("div",qi,[s("span",Qi,p(t.skippedItems.filter(f=>f.reason==="duplicate").length),1),e[27]||(e[27]=s("span",{class:"stat-label"},"Already in Profile",-1))]),s("div",Ji,[s("span",Ki,p(t.errorCount),1),e[28]||(e[28]=s("span",{class:"stat-label"},"Errors",-1))])]),t.skippedItems.length>0?(u(),m("div",Zi,[e[29]||(e[29]=s("h4",null,"Items Ready for Retry",-1)),e[30]||(e[30]=s("p",{class:"retry-description"}," The following items can be edited and tried again: ",-1)),s("div",Xi,[(u(!0),m(se,null,ae(t.skippedItems,(f,w)=>(u(),m("div",{key:w,class:H(["retry-item",{"duplicate-item":f.reason==="duplicate"}])},[M(s("input",{"onUpdate:modelValue":R=>f.searchTerm=R,class:"retry-input",placeholder:"Edit search term...",disabled:f.reason==="duplicate"},null,8,$i),[[L,f.searchTerm]]),f.additionalInfo?(u(),m("span",el," | "+p(f.additionalInfo),1)):S("",!0),f.reason==="duplicate"?(u(),m("span",tl," Already in profile ")):(u(),m("span",sl," No API data "))],2))),128))])])):S("",!0),t.processingResults.length>0?(u(),m("div",al,[e[31]||(e[31]=s("h4",null,"Detailed Results",-1)),s("div",ol,[(u(!0),m(se,null,ae(t.processingResults,(f,w)=>(u(),m("div",{key:w,class:H(["result-item",f.status])},[s("div",nl,[s("span",il,p(f.title),1),s("span",ll,p(f.statusText),1)]),f.message?(u(),m("div",rl,p(f.message),1)):S("",!0)],2))),128))])])):S("",!0)])])):S("",!0)]),s("div",dl,[t.currentStep===1?(u(),m("button",{key:0,class:"btn btn-secondary",onClick:e[4]||(e[4]=(...f)=>t.closeModal&&t.closeModal(...f))}," Cancel ")):S("",!0),t.currentStep===1?(u(),m("button",{key:1,class:"btn btn-primary",onClick:e[5]||(e[5]=(...f)=>t.startProcessing&&t.startProcessing(...f)),disabled:!t.canStart}," Check All and Add ",8,cl)):S("",!0),t.currentStep===2?(u(),m("div",ul,[s("button",{class:"btn btn-secondary",onClick:e[6]||(e[6]=(...f)=>t.cancelProcessing&&t.cancelProcessing(...f)),disabled:!t.canCancel}," Cancel ",8,ml),t.isPaused?S("",!0):(u(),m("button",{key:0,class:"btn btn-warning",onClick:e[7]||(e[7]=(...f)=>t.pauseProcessing&&t.pauseProcessing(...f)),disabled:!t.isProcessing}," Pause ",8,gl)),t.isPaused?(u(),m("button",{key:1,class:"btn btn-primary",onClick:e[8]||(e[8]=(...f)=>t.resumeProcessing&&t.resumeProcessing(...f))}," Resume ")):S("",!0)])):S("",!0),t.currentStep===3?(u(),m("div",fl,[t.skippedItems.filter(f=>f.reason!=="duplicate").length>0?(u(),m("button",{key:0,class:"btn btn-warning",onClick:e[9]||(e[9]=(...f)=>t.retrySkippedItems&&t.retrySkippedItems(...f))}," Retry "+p(t.skippedItems.filter(f=>f.reason!=="duplicate").length)+" Items ",1)):S("",!0),s("button",{class:"btn btn-primary",onClick:e[10]||(e[10]=(...f)=>t.closeModal&&t.closeModal(...f))}," Done ")])):S("",!0)])])])):S("",!0)}const pl=oe(ni,[["render",hl],["__scopeId","data-v-04d8250b"]]),vl={name:"TxtImportModal",props:{show:{type:Boolean,default:!1}},emits:["close","fileProcessed"],methods:{handleFileUpload(n){const e=n.target.files[0];if(!e)return;if(!e.name.toLowerCase().endsWith(".txt")){alert("Bitte wählen Sie eine .txt Datei aus.");return}const o=new FileReader;o.onload=t=>{const i=t.target.result;this.$emit("fileProcessed",i)},o.readAsText(e,"UTF-8")}}},yl={class:"file-upload-area"},bl={class:"modal-buttons"};function _l(n,e,o,t,i,d){return o.show?(u(),m("div",{key:0,class:"modal",onClick:e[3]||(e[3]=l=>n.$emit("close"))},[s("div",{class:"modal-content",onClick:e[2]||(e[2]=de(()=>{},["stop"]))},[e[5]||(e[5]=s("h2",null,"📄 Import from TXT File",-1)),e[6]||(e[6]=s("p",null,"Wählen Sie eine .txt Datei mit einer Liste von Titeln aus, um zu prüfen, welche Items in der aktuellen Kategorie fehlen.",-1)),s("div",yl,[s("input",{type:"file",id:"txtFileInput",accept:".txt",onChange:e[0]||(e[0]=(...l)=>d.handleFileUpload&&d.handleFileUpload(...l)),style:{display:"none"}},null,32),e[4]||(e[4]=s("label",{for:"txtFileInput",class:"file-upload-label"},[s("span",{class:"upload-icon"},"📁"),s("span",{class:"upload-text"},"TXT-Datei auswählen"),s("span",{class:"upload-hint"},"Eine .txt Datei mit einer Liste von Titeln")],-1))]),s("div",bl,[s("button",{type:"button",onClick:e[1]||(e[1]=l=>n.$emit("close"))}," Cancel ")])])])):S("",!0)}const wl=oe(vl,[["render",_l],["__scopeId","data-v-e20860d6"]]),kl={name:"TxtImportResultsModal",props:{show:{type:Boolean,default:!1},results:{type:Object,default:null}},emits:["close"]},Sl={class:"results-summary"},xl={class:"summary-item"},Cl={class:"summary-value"},Il={class:"summary-item"},Dl={class:"summary-value"},Al={class:"summary-item"},Tl={class:"summary-value existing"},Ml={class:"summary-item"},Rl={class:"summary-value missing"},El={key:0,class:"missing-items"},Ul={class:"items-list"},Ll={key:1,class:"existing-items"},Bl={class:"items-list"},Pl={class:"modal-buttons"};function Fl(n,e,o,t,i,d){return o.show&&o.results?(u(),m("div",{key:0,class:"modal",onClick:e[2]||(e[2]=l=>n.$emit("close"))},[s("div",{class:"modal-content results-modal",onClick:e[1]||(e[1]=de(()=>{},["stop"]))},[e[7]||(e[7]=s("h2",null,"📊 TXT Import Ergebnisse",-1)),s("div",Sl,[s("div",xl,[e[3]||(e[3]=s("span",{class:"summary-label"},"Kategorie:",-1)),s("span",Cl,p(o.results.categoryName),1)]),s("div",Il,[e[4]||(e[4]=s("span",{class:"summary-label"},"Titel in Datei:",-1)),s("span",Dl,p(o.results.totalInFile),1)]),s("div",Al,[e[5]||(e[5]=s("span",{class:"summary-label"},"Bereits vorhanden:",-1)),s("span",Tl,p(o.results.existingItems.length),1)]),s("div",Ml,[e[6]||(e[6]=s("span",{class:"summary-label"},"Fehlende Titel:",-1)),s("span",Rl,p(o.results.missingItems.length),1)])]),o.results.missingItems.length>0?(u(),m("div",El,[s("h3",null,"❌ Fehlende Titel ("+p(o.results.missingItems.length)+"):",1),s("div",Ul,[(u(!0),m(se,null,ae(o.results.missingItems,(l,c)=>(u(),m("div",{key:c,class:"missing-item"},p(l),1))),128))])])):S("",!0),o.results.existingItems.length>0?(u(),m("div",Ll,[s("h3",null,"✅ Bereits vorhanden ("+p(o.results.existingItems.length)+"):",1),s("div",Bl,[(u(!0),m(se,null,ae(o.results.existingItems,(l,c)=>(u(),m("div",{key:c,class:"existing-item"},p(l),1))),128))])])):S("",!0),s("div",Pl,[s("button",{type:"button",onClick:e[0]||(e[0]=l=>n.$emit("close"))}," Schließen ")])])])):S("",!0)}const Nl=oe(kl,[["render",Fl],["__scopeId","data-v-ec385b83"]]),Gl={name:"SimpleAddItem",setup(){const n=k(!1),e=k(null),o=Pe({title:"Test Game",category:"game",release:"2003-01-01",count:1});return{form:o,loading:n,result:e,addItem:async()=>{n.value=!0,e.value=null;try{const i=window.location.origin,d=await fetch(`${i}/api/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:"admin@example.com",password:"admin123"})});if(!d.ok)throw new Error("Login failed");const c=(await d.json()).token,w=await(await fetch(`${i}/api/media`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify(o)})).json();w.success?e.value={success:!0,message:`Success! Item added with ID: ${w.data.id}`}:e.value={success:!1,message:`Error: ${JSON.stringify(w)}`}}catch(i){e.value={success:!1,message:`Error: ${i.message}`}}finally{n.value=!1}}}}},Wl={class:"simple-add-item"},Vl=["disabled"];function Ol(n,e,o,t,i,d){return u(),m("div",Wl,[e[10]||(e[10]=s("h3",null,"Simple Add Item Test",-1)),s("form",{onSubmit:e[4]||(e[4]=de((...l)=>t.addItem&&t.addItem(...l),["prevent"]))},[s("div",null,[e[5]||(e[5]=s("label",null,"Title:",-1)),M(s("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>t.form.title=l),type:"text",required:""},null,512),[[L,t.form.title]])]),s("div",null,[e[7]||(e[7]=s("label",null,"Category:",-1)),M(s("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>t.form.category=l)},[...e[6]||(e[6]=[s("option",{value:"game"},"Game",-1),s("option",{value:"movie"},"Movie",-1),s("option",{value:"series"},"Series",-1)])],512),[[ke,t.form.category]])]),s("div",null,[e[8]||(e[8]=s("label",null,"Release:",-1)),M(s("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>t.form.release=l),type:"date"},null,512),[[L,t.form.release]])]),s("div",null,[e[9]||(e[9]=s("label",null,"Count:",-1)),M(s("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>t.form.count=l),type:"number",min:"0"},null,512),[[L,t.form.count]])]),s("button",{type:"submit",disabled:t.loading},p(t.loading?"Adding...":"Add Item"),9,Vl)],32),t.result?(u(),m("div",{key:0,class:H(["result",t.result.success?"success":"error"])},p(t.result.message),3)):S("",!0)])}const jl=oe(Gl,[["render",Ol],["__scopeId","data-v-4298065b"]]),zl={name:"LoadingSpinner",props:{loading:{type:Boolean,default:!0},message:{type:String,default:"Loading..."}}},Yl={key:0,class:"loading-spinner"},Hl={key:0};function ql(n,e,o,t,i,d){return o.loading?(u(),m("div",Yl,[e[0]||(e[0]=s("div",{class:"spinner"},null,-1)),o.message?(u(),m("p",Hl,p(o.message),1)):S("",!0)])):S("",!0)}const Ql=oe(zl,[["render",ql],["__scopeId","data-v-0e82c46a"]]),Jl={name:"MessageBox",props:{show:{type:Boolean,default:!1},type:{type:String,default:"info",validator:n=>["success","error","warning","info"].includes(n)},title:{type:String,default:""},message:{type:String,required:!0},details:{type:String,default:""}},emits:["close"],setup(n,{emit:e}){const o=()=>{e("close")},t=G(()=>{switch(n.type){case"success":return"✅";case"error":return"❌";case"warning":return"⚠️";case"info":return"ℹ️";default:return"ℹ️"}}),i=G(()=>`message-${n.type}`);return{closeMessage:o,icon:t,messageType:i}}},Kl={class:"message-header"},Zl={class:"message-icon"},Xl={class:"message-title"},$l={class:"message-body"},er={key:0,class:"message-details"},tr={class:"message-footer"};function sr(n,e,o,t,i,d){return o.show?(u(),m("div",{key:0,class:"message-overlay",onClick:e[3]||(e[3]=(...l)=>t.closeMessage&&t.closeMessage(...l))},[s("div",{class:H(["message-box",t.messageType]),onClick:e[2]||(e[2]=de(()=>{},["stop"]))},[s("div",Kl,[s("span",Zl,p(t.icon),1),s("h3",Xl,p(o.title),1),s("button",{class:"close-btn",onClick:e[0]||(e[0]=(...l)=>t.closeMessage&&t.closeMessage(...l))},"✕")]),s("div",$l,[s("p",null,p(o.message),1),o.details?(u(),m("div",er,[s("pre",null,p(o.details),1)])):S("",!0)]),s("div",tr,[s("button",{class:"btn btn-primary",onClick:e[1]||(e[1]=(...l)=>t.closeMessage&&t.closeMessage(...l))},"OK")])],2)])):S("",!0)}const ar=oe(Jl,[["render",sr],["__scopeId","data-v-198ec3cc"]]),or={name:"ConfirmDialog",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm Action"},message:{type:String,required:!0}},emits:["confirm","close"],setup(n,{emit:e}){const o=()=>{e("close")};return{closeDialog:o,confirmAction:()=>{e("confirm"),o()}}}},nr={class:"confirm-header"},ir={class:"confirm-title"},lr={class:"confirm-body"},rr={class:"confirm-footer"};function dr(n,e,o,t,i,d){return o.show?(u(),m("div",{key:0,class:"confirm-overlay",onClick:e[4]||(e[4]=(...l)=>t.closeDialog&&t.closeDialog(...l))},[s("div",{class:"confirm-dialog",onClick:e[3]||(e[3]=de(()=>{},["stop"]))},[s("div",nr,[s("h3",ir,p(o.title),1),s("button",{class:"close-btn",onClick:e[0]||(e[0]=(...l)=>t.closeDialog&&t.closeDialog(...l))},"✕")]),s("div",lr,[s("p",null,p(o.message),1)]),s("div",rr,[s("button",{class:"btn btn-secondary",onClick:e[1]||(e[1]=(...l)=>t.closeDialog&&t.closeDialog(...l))},"Cancel"),s("button",{class:"btn btn-danger",onClick:e[2]||(e[2]=(...l)=>t.confirmAction&&t.confirmAction(...l))},"Confirm")])])])):S("",!0)}const cr=oe(or,[["render",dr],["__scopeId","data-v-fd570f57"]]),ur={name:"InputDialog",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Input Required"},message:{type:String,required:!0},placeholder:{type:String,default:""},inputType:{type:String,default:"text"},defaultValue:{type:String,default:""}},emits:["confirm","close"],setup(n,{emit:e}){const o=k(""),t=k(null),i=()=>{e("close")},d=()=>{e("confirm",o.value),i()};return Ue(()=>n.show,async l=>{l&&(o.value=n.defaultValue,await es(),t.value&&(t.value.focus(),t.value.select()))}),{inputValue:o,inputRef:t,closeDialog:i,confirmAction:d}}},mr={class:"input-header"},gr={class:"input-title"},fr={class:"input-body"},hr={class:"input-message"},pr=["type","placeholder"],vr={class:"input-footer"};function yr(n,e,o,t,i,d){return o.show?(u(),m("div",{key:0,class:"input-overlay",onClick:e[6]||(e[6]=(...l)=>t.closeDialog&&t.closeDialog(...l))},[s("div",{class:"input-dialog",onClick:e[5]||(e[5]=de(()=>{},["stop"]))},[s("div",mr,[s("h3",gr,p(o.title),1),s("button",{class:"close-btn",onClick:e[0]||(e[0]=(...l)=>t.closeDialog&&t.closeDialog(...l))},"✕")]),s("div",fr,[s("p",hr,p(o.message),1),M(s("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>t.inputValue=l),type:o.inputType,placeholder:o.placeholder,class:"input-field",onKeyup:e[2]||(e[2]=$t((...l)=>t.confirmAction&&t.confirmAction(...l),["enter"])),ref:"inputRef"},null,40,pr),[[Xt,t.inputValue]])]),s("div",vr,[s("button",{class:"btn btn-secondary",onClick:e[3]||(e[3]=(...l)=>t.closeDialog&&t.closeDialog(...l))},"Cancel"),s("button",{class:"btn btn-primary",onClick:e[4]||(e[4]=(...l)=>t.confirmAction&&t.confirmAction(...l))},"OK")])])])):S("",!0)}const br=oe(ur,[["render",yr],["__scopeId","data-v-0ee78a4d"]]),_r={name:"MediaLibrary",components:{MediaItem:Rs,Sidebar:ua,MainHeader:Ia,FloatingActionButton:Ea,LoginModal:ja,RegisterModal:io,EditModal:oi,BulkAddModal:pl,TxtImportModal:wl,TxtImportResultsModal:Nl,SimpleAddItem:jl,LoadingSpinner:Ql,MessageBox:ar,ConfirmDialog:cr,InputDialog:br},setup(){const n=Je(),e=gt(),o=ft(),t=ht(),i=Qe(),d=pt(),l=G(()=>!d||typeof d!="object"?(console.warn("SidebarStore not properly initialized, using fallback values"),{collapsed:!1,mobileOpen:!1,toggleSidebar:()=>{},toggleMobileSidebar:()=>{},closeMobileSidebar:()=>{}}):d),c=k(!1),f=k(null),w=k(new Date),R=k(null),x=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],I=k(null),r=Pe({firstName:"",lastName:"",displayName:"",email:"",bio:"",avatar:"",language:"en",timezone:"UTC",dateFormat:"MM/DD/YYYY",booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}),{showLoginModal:V,showRegisterModal:ne,showEditModal:q,showFloatingMenu:ge,showBulkAddModal:ee,showTxtImportModal:ce,showTxtImportResults:h,editingItem:W,sortBy:ue,categories:me,txtImportResults:Se,isLoggedIn:pe,isAdmin:Ae,userName:Te,currentCategory:$,searchQuery:j,categoryCounts:Z,loading:Q,error:ve,paginatedMedia:xe,setCategory:ye,clearSearch:Ce,editItem:Ie,closeEditModal:_e,closeBulkAddModal:De,handleBulkAddItems:fe,handleSaveItem:g,handleDeleteItem:b,logout:v,loadMedia:a,toggleFloatingMenu:y,addNewItem:D,bulkAddItems:A,importFromTxt:T,importFromAPI:z,createCollection:ie,exportMediaCollection:he,exportAsCSV:Ve,exportAsJSON:Oe,downloadFile:je,deleteAllInCategory:Fe,getCategoryDisplayName:ze,navigateToCalendar:tt,navigateToProfile:st,processTxtContent:at,closeTxtImportResults:C,cleanup:U,router:X}=as(),P=G(()=>n.editMode),F=()=>{n.toggleEditMode()},K=async _=>{try{await n.updateItemRating(_.itemId,_.rating),console.log("✅ Rating updated successfully:",_),dt({type:"success",text:`Rating updated to ${_.rating}/10`})}catch(E){console.error("❌ Failed to update rating:",E),dt({type:"error",text:"Failed to update rating. Please try again."})}},O=G(()=>{try{return ze?ze($.value):$.value}catch(_){return console.error("Error getting category display name:",_),$.value||"Unknown"}}),Re=G(()=>w.value.getFullYear()),Ee=G(()=>w.value.getMonth()),vt=G(()=>w.value.toLocaleDateString("en-US",{month:"long"})),Ne=k([]),Ke=k(!1),Ze=k(null),ot=G(()=>{const _=Re.value,E=Ee.value,N=new Date(_,E,1),Y=new Date(N),B=N.getDay(),J=B===0?6:B-1;Y.setDate(Y.getDate()-J);const Me=[],te=new Date;for(let Xe=0;Xe<42;Xe++){const we=new Date(Y);we.setDate(Y.getDate()+Xe);const Yt=we.getMonth()===E,Ht=we.toDateString()===te.toDateString(),qt=we.getDay()===0||we.getDay()===6;Me.push({date:we.getDate(),month:we.getMonth(),year:we.getFullYear(),fullDate:new Date(we),isCurrentMonth:Yt,isToday:Ht,isWeekend:qt,hasEvents:nt(we),events:it(we)})}return Me}),yt=G(()=>{const _=n.mediaData||[],E={totalItems:_.length,totalCollections:0,totalPlaytime:0,avgRating:0,categoryDistribution:{},ratingDistribution:{},platformDistribution:{},genreDistribution:{},recentActivity:[],airingSeries:[]};let N=0,Y=0;return _.forEach(B=>{const J=B.category||"unknown";if(E.categoryDistribution[J]=(E.categoryDistribution[J]||0)+1,B.rating&&B.rating>0){const Me=Math.floor(B.rating);E.ratingDistribution[Me]=(E.ratingDistribution[Me]||0)+1,N+=B.rating,Y++}if(B.platforms&&B.category==="game"&&B.platforms.split(",").map(te=>te.trim()).filter(te=>te).forEach(te=>{E.platformDistribution[te]=(E.platformDistribution[te]||0)+1}),B.genre&&(B.category==="series"||B.category==="movie")&&B.genre.split(",").map(te=>te.trim()).filter(te=>te).forEach(te=>{E.genreDistribution[te]=(E.genreDistribution[te]||0)+1}),B.spielzeit&&B.spielzeit>0&&(E.totalPlaytime+=B.spielzeit),B.category==="series"&&B.isAiring===!0&&E.airingSeries.push({title:B.title,nextSeason:B.nextSeason,nextSeasonRelease:B.nextSeasonRelease}),B.discovered){const Me=new Date(B.discovered),te=new Date;te.setDate(te.getDate()-30),Me>=te&&E.recentActivity.push({title:B.title,category:B.category,discovered:B.discovered})}}),Y>0&&(E.avgRating=(N/Y).toFixed(1)),E.totalPlaytime=Math.round(E.totalPlaytime/60),E.recentActivity.sort((B,J)=>new Date(J.discovered)-new Date(B.discovered)),E}),bt=_=>_?new Date(_).toLocaleDateString():"",_t=_=>{const E=Math.max(0,Math.min(5,parseInt(_)||0)),N="★".repeat(E),Y="☆".repeat(5-E);return N+Y},wt=_=>{ye(_),D()},kt=()=>{V.value=!1,ne.value=!0},St=()=>{V.value=!0},xt=_=>{V.value=!1,a()},Ct=()=>{ne.value=!1,a()},It=async()=>{c.value=!0,f.value=null;try{const _=await i.adminSetup();_.success?(console.log("✅ Admin setup successful:",_),f.value={type:"success",text:`✅ Admin created and logged in! User: ${_.user.name} (${_.user.email})`},await a(),setTimeout(()=>{f.value=null},5e3)):(console.log("ℹ️ Admin already exists:",_),f.value={type:"info",text:`ℹ️ ${_.message} (${_.admin_count} admin(s) exist)`},setTimeout(()=>{f.value=null},3e3))}catch(_){console.error("❌ Admin setup failed:",_),f.value={type:"error",text:`❌ Admin setup failed: ${_.message||"Unknown error"}`},setTimeout(()=>{f.value=null},5e3)}finally{c.value=!1}},Dt=()=>{console.log("🔥 DEBUG: Direct admin navigation called!"),console.log("🔥 DEBUG: Router object:",X);try{X.push("/admin"),console.log("🔥 DEBUG: Successfully navigated to /admin!")}catch(_){console.error("🔥 DEBUG: Error navigating to admin:",_)}},At=()=>{w.value=new Date(w.value.getFullYear(),w.value.getMonth()-1,1),R.value=null},Tt=()=>{w.value=new Date(w.value.getFullYear(),w.value.getMonth()+1,1),R.value=null},Mt=_=>{_.isCurrentMonth&&(R.value=_)},Rt=_=>_.fullDate.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),nt=_=>lt(_).length>0,it=_=>lt(_).map(N=>({id:N.id,title:N.title,time:"Release",type:N.watchlistType||N.watchlist_type||"unknown",item:N})),lt=_=>n.mediaData.filter(N=>N.category==="watchlist"&&N.release).filter(N=>{if(!N.release)return!1;const Y=new Date(N.release),B=new Date(_);return Y.getFullYear()===B.getFullYear()&&Y.getMonth()===B.getMonth()&&Y.getDate()===B.getDate()}),Et=()=>{var N,Y;const _=((N=r.firstName)==null?void 0:N.charAt(0))||"U",E=((Y=r.lastName)==null?void 0:Y.charAt(0))||"S";return(_+E).toUpperCase()},Ut=()=>{var _;(_=I.value)==null||_.click()},Lt=_=>{const E=_.target.files[0];if(E){const N=new FileReader;N.onload=Y=>{r.avatar=Y.target.result},N.readAsDataURL(E)}},rt=async()=>{if(!$.value||$.value==="statistics"||$.value==="calendar"||$.value==="profile"){Ne.value=[];return}Ke.value=!0,Ze.value=null;try{const _=await re.getGenres($.value);if(_.success)Ne.value=_.genres||[];else throw new Error(_.error||"Failed to load genres")}catch(_){console.error("Failed to load genres:",_),Ze.value=_.message||"Failed to load genres",Ne.value=[]}finally{Ke.value=!1}},Bt=_=>{n.setGenres(_)},Pt=_=>{n.setExcludedGenres(_)},Ft=()=>{n.clearGenres(),n.clearExcludedGenres()},dt=_=>{console.log("📢 Message:",_.type,_.text),_.type==="error"?e.showMessage("Error",_.text,"error"):e.showMessage("Success",_.text,"success")};Ue($,_=>{_&&_!=="statistics"&&_!=="calendar"&&_!=="profile"?(rt(),n.clearGenres()):(Ne.value=[],n.clearGenres())},{immediate:!0});const Nt=()=>{const _={profile:r,media:n.mediaData,settings:{language:r.language,timezone:r.timezone,dateFormat:r.dateFormat},exportDate:new Date().toISOString()},E=new Blob([JSON.stringify(_,null,2)],{type:"application/json"}),N=URL.createObjectURL(E),Y=document.createElement("a");Y.href=N,Y.download=`media-library-backup-${new Date().toISOString().split("T")[0]}.json`,Y.click(),URL.revokeObjectURL(N)},Gt=()=>{const _=document.createElement("input");_.type="file",_.accept=".json",_.onchange=E=>{const N=E.target.files[0];if(N){const Y=new FileReader;Y.onload=B=>{try{const J=JSON.parse(B.target.result);J.profile&&Object.assign(r,J.profile),J.media&&(n.mediaData=J.media,n.saveMedia()),J.settings&&Object.assign(r,J.settings),Ye()}catch(J){console.error("Failed to import data:",J)}},Y.readAsText(N)}},_.click()},Wt=()=>{const _={profile:r,media:n.mediaData,settings:{language:r.language,timezone:r.timezone,dateFormat:r.dateFormat},backupDate:new Date().toISOString()},E=`backup_${Date.now()}`;localStorage.setItem(E,JSON.stringify(_)),alert("Backup created successfully!")},Vt=()=>{alert("Cache cleared successfully!")},Ot=()=>{confirm("Are you sure you want to reset all settings?")&&(Object.assign(r,{firstName:"",lastName:"",displayName:"",email:"",bio:"",avatar:"",language:"en",timezone:"UTC",dateFormat:"MM/DD/YYYY",booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}),Ye())},jt=()=>{confirm("Are you sure you want to clear all data? This cannot be undone!")&&(localStorage.clear(),window.location.reload())},Ye=()=>{localStorage.setItem("profileData",JSON.stringify(r))},zt=()=>{Ye(),alert("All changes saved successfully!")};return ut(async()=>{var _,E;try{await a();const N=localStorage.getItem("profileData");if(N)try{const J=JSON.parse(N);Object.assign(r,J)}catch(J){console.error("Failed to load profile data:",J)}i.user&&(r.firstName=((_=i.user.name)==null?void 0:_.split(" ")[0])||"",r.lastName=((E=i.user.name)==null?void 0:E.split(" ").slice(1).join(" "))||"",r.email=i.user.email||"");const Y=new Date,B=ot.value.find(J=>J.isToday&&J.isCurrentMonth);if(B&&(R.value=B),pe.value)try{n.initializeRealtimeUpdates()}catch(J){console.error("Error initializing realtime updates:",J)}}catch(N){console.error("Error during initialization:",N)}}),ts(()=>{if(pe.value)try{n.cleanupRealtimeUpdates()}catch(_){console.error("Error cleaning up realtime updates:",_)}U()}),{showLoginModal:V,showRegisterModal:ne,showEditModal:q,showFloatingMenu:ge,showBulkAddModal:ee,showTxtImportModal:ce,showTxtImportResults:h,editingItem:W,sortBy:ue,categories:me,txtImportResults:Se,adminSetupLoading:c,adminSetupMessage:f,editMode:P,currentDate:w,selectedDay:R,weekdays:x,avatarInput:I,profileData:r,isLoggedIn:pe,isAdmin:Ae,userName:Te,currentCategory:$,currentCategoryDisplayName:O,searchQuery:j,categoryCounts:Z,loading:Q,error:ve,paginatedMedia:xe,selectedGenres:G(()=>n.selectedGenres),genres:Ne,genreLoading:Ke,genreError:Ze,currentYear:Re,currentMonth:Ee,currentMonthName:vt,calendarDays:ot,setCategory:ye,clearSearch:Ce,navigateToCalendar:tt,navigateToProfile:st,addItemFromSidebar:wt,editItem:Ie,switchToRegister:kt,showAdminLogin:St,handleLoginSuccess:xt,handleRegisterSuccess:Ct,handleAdminSetup:It,debugNavigateToAdmin:Dt,closeEditModal:_e,closeBulkAddModal:De,handleBulkAddItems:fe,handleSaveItem:g,handleDeleteItem:b,logout:v,loadMedia:a,toggleFloatingMenu:y,addNewItem:D,bulkAddItems:A,importFromTxt:T,importFromAPI:z,createCollection:ie,exportMediaCollection:he,exportAsCSV:Ve,exportAsJSON:Oe,downloadFile:je,deleteAllInCategory:Fe,getCategoryDisplayName:ze,processTxtContent:at,closeTxtImportResults:C,handleGenresUpdated:Bt,handleGenresExcluded:Pt,handleGenresCleared:Ft,loadGenres:rt,toggleEditMode:F,handleRatingChanged:K,previousMonth:At,nextMonth:Tt,selectDay:Mt,formatSelectedDay:Rt,hasEventsForDate:nt,getEventsForDate:it,getInitials:Et,changeAvatar:Ut,handleAvatarChange:Lt,exportData:Nt,importData:Gt,createBackup:Wt,clearCache:Vt,resetSettings:Ot,clearAllData:jt,saveProfileData:Ye,saveAllChanges:zt,messageStore:e,confirmStore:o,inputStore:t,statistics:yt,formatDate:bt,getRatingStars:_t,sidebarStore:d,safeSidebarStore:l}}},wr={class:"vue-app"},kr={class:"main-content"},Sr={class:"content-area"},xr={key:1,class:"error"},Cr={key:2},Ir={key:0,class:"calendar-view"},Dr={class:"calendar-header"},Ar=["disabled"],Tr={class:"month-year-display"},Mr={class:"month-name"},Rr={class:"year"},Er=["disabled"],Ur={class:"calendar-container"},Lr={class:"calendar-grid"},Br=["onClick"],Pr={class:"day-number"},Fr={key:0,class:"event-indicator"},Nr={key:0,class:"event-count"},Gr={key:0,class:"selected-day-info"},Wr={class:"day-events"},Vr={key:0,class:"no-events"},Or={key:1,class:"events-list"},jr={class:"event-header"},zr={class:"event-time"},Yr={class:"event-type-badge"},Hr={class:"event-title"},qr={key:0,class:"event-platforms"},Qr={key:1,class:"event-genre"},Jr={key:1,class:"profile-container"},Kr={class:"profile-header"},Zr={class:"profile-avatar-section"},Xr=["src"],$r={key:1,class:"avatar-initials"},ed={class:"profile-info-header"},td={class:"profile-stats"},sd={class:"stat-item"},ad={class:"stat-number"},od={class:"stat-item"},nd={class:"stat-number"},id={class:"settings-sections"},ld={class:"settings-section"},rd={class:"section-content"},dd={class:"form-row"},cd={class:"form-group"},ud={class:"form-group"},md={class:"form-group"},gd={class:"form-group"},fd={class:"form-group"},hd={class:"settings-section"},pd={class:"section-content"},vd={class:"form-row"},yd={class:"form-group"},bd={class:"form-group"},_d={class:"form-row"},wd={class:"form-group"},kd={class:"form-group"},Sd={class:"form-row"},xd={class:"form-group"},Cd={class:"checkbox-container"},Id={class:"settings-section"},Dd={class:"section-content"},Ad={class:"data-actions"},Td={class:"settings-section danger-zone"},Md={class:"section-content"},Rd={class:"danger-actions"},Ed={key:2,class:"statistics-container"},Ud={class:"statistics-header"},Ld={class:"refresh-controls"},Bd={class:"statistics-content"},Pd={class:"stats-summary"},Fd={class:"summary-card"},Nd={class:"summary-number"},Gd={class:"summary-card"},Wd={class:"summary-number"},Vd={class:"summary-card"},Od={class:"summary-number"},jd={class:"summary-card"},zd={class:"summary-number"},Yd={class:"chart-container"},Hd={class:"category-stats"},qd={class:"category-name"},Qd={class:"category-bar"},Jd={class:"category-count"},Kd={class:"chart-container"},Zd={class:"rating-stats"},Xd={class:"rating-stars"},$d={class:"rating-bar"},ec={class:"rating-count"},tc={class:"chart-container"},sc={class:"platform-stats"},ac={class:"platform-name"},oc={class:"platform-bar"},nc={class:"platform-count"},ic={class:"chart-container"},lc={class:"genre-stats"},rc={class:"genre-name"},dc={class:"genre-bar"},cc={class:"genre-count"},uc={class:"chart-container"},mc={class:"recent-activity"},gc={class:"activity-title"},fc={class:"activity-category"},hc={class:"activity-date"},pc={class:"chart-container"},vc={class:"airing-series"},yc={class:"airing-title"},bc={class:"airing-next"},_c={class:"airing-date"},wc={key:0,class:"admin-setup-container"},kc=["disabled"],Sc={key:0},xc={key:1};function Cc(n,e,o,t,i,d){const l=le("Sidebar"),c=le("MainHeader"),f=le("LoadingSpinner"),w=le("MediaItem"),R=le("LoginModal"),x=le("RegisterModal"),I=le("EditModal"),r=le("BulkAddModal"),V=le("TxtImportModal"),ne=le("TxtImportResultsModal"),q=le("FloatingActionButton"),ge=le("MessageBox"),ee=le("ConfirmDialog"),ce=le("InputDialog");return u(),m("div",wr,[s("div",{class:H(["mobile-overlay",{show:t.safeSidebarStore.mobileOpen}]),onClick:e[0]||(e[0]=(...h)=>t.safeSidebarStore.closeMobileSidebar&&t.safeSidebarStore.closeMobileSidebar(...h))},null,2),be(l,{collapsed:t.safeSidebarStore.collapsed,"mobile-open":t.safeSidebarStore.mobileOpen,"is-logged-in":t.isLoggedIn,"is-admin":t.isAdmin,"user-name":t.userName,"current-category":t.currentCategory,"category-counts":t.categoryCounts,categories:t.categories,"selected-genres":t.selectedGenres,"excluded-genres":n.excludedGenres,genres:t.genres,"genre-loading":t.genreLoading,"genre-error":t.genreError,onToggle:t.safeSidebarStore.toggleSidebar,onSetCategory:t.setCategory,onNavigateToCalendar:t.navigateToCalendar,onNavigateToProfile:t.navigateToProfile,onNavigateToAdmin:t.debugNavigateToAdmin,onAddItem:t.addItemFromSidebar,onShowLogin:e[1]||(e[1]=h=>t.showLoginModal=!0),onShowRegister:e[2]||(e[2]=h=>t.showRegisterModal=!0),onShowAdminLogin:t.showAdminLogin,onLogout:t.logout,onGenresUpdated:t.handleGenresUpdated,onGenresExcluded:t.handleGenresExcluded,onGenresCleared:t.handleGenresCleared,onLoadGenres:t.loadGenres},null,8,["collapsed","mobile-open","is-logged-in","is-admin","user-name","current-category","category-counts","categories","selected-genres","excluded-genres","genres","genre-loading","genre-error","onToggle","onSetCategory","onNavigateToCalendar","onNavigateToProfile","onNavigateToAdmin","onAddItem","onShowAdminLogin","onLogout","onGenresUpdated","onGenresExcluded","onGenresCleared","onLoadGenres"]),s("div",kr,[be(c,{"search-query":t.searchQuery,"onUpdate:searchQuery":e[3]||(e[3]=h=>t.searchQuery=h),"sort-by":t.sortBy,"onUpdate:sortBy":e[4]||(e[4]=h=>t.sortBy=h),"edit-mode":t.editMode,onToggleMobileSidebar:t.safeSidebarStore.toggleMobileSidebar,onClearSearch:t.clearSearch,onToggleEditMode:t.toggleEditMode},null,8,["search-query","sort-by","edit-mode","onToggleMobileSidebar","onClearSearch","onToggleEditMode"]),s("main",Sr,[t.loading?(u(),Be(f,{key:0,message:"Loading media data..."})):t.error?(u(),m("div",xr,[s("p",null,p(t.error),1),s("button",{onClick:e[5]||(e[5]=(...h)=>t.loadMedia&&t.loadMedia(...h))},"Retry")])):(u(),m("div",Cr,[t.currentCategory==="calendar"?(u(),m("div",Ir,[s("div",Dr,[s("button",{class:"month-nav-btn",onClick:e[6]||(e[6]=(...h)=>t.previousMonth&&t.previousMonth(...h)),disabled:n.isLoading},[...e[31]||(e[31]=[s("span",{class:"nav-icon"},"‹",-1)])],8,Ar),s("div",Tr,[s("h2",Mr,p(t.currentMonthName),1),s("span",Rr,p(t.currentYear),1)]),s("button",{class:"month-nav-btn",onClick:e[7]||(e[7]=(...h)=>t.nextMonth&&t.nextMonth(...h)),disabled:n.isLoading},[...e[32]||(e[32]=[s("span",{class:"nav-icon"},"›",-1)])],8,Er)]),s("div",Ur,[s("div",Lr,[(u(!0),m(se,null,ae(t.weekdays,h=>(u(),m("div",{class:"weekday-header",key:h},p(h),1))),128)),(u(!0),m(se,null,ae(t.calendarDays,h=>(u(),m("div",{key:`${h.date}-${h.month}`,class:H(["calendar-day",{"other-month":!h.isCurrentMonth,today:h.isToday,weekend:h.isWeekend,"has-events":h.hasEvents}]),onClick:W=>t.selectDay(h)},[s("span",Pr,p(h.day),1),h.hasEvents?(u(),m("div",Fr,[e[33]||(e[33]=s("div",{class:"event-dot"},null,-1)),h.events&&h.events.length>1?(u(),m("span",Nr,p(h.events.length),1)):S("",!0)])):S("",!0)],10,Br))),128))])]),t.selectedDay?(u(),m("div",Gr,[s("h3",null,p(t.formatSelectedDay(t.selectedDay)),1),s("div",Wr,[!t.selectedDay.events||t.selectedDay.events.length===0?(u(),m("p",Vr," No watchlist releases scheduled for this day ")):(u(),m("div",Or,[(u(!0),m(se,null,ae(t.selectedDay.events,h=>(u(),m("div",{key:h.id,class:H(["event-item",`event-${h.type}`])},[s("div",jr,[s("span",zr,p(h.time),1),s("span",Yr,p(h.type),1)]),s("span",Hr,p(h.title),1),h.item.platforms?(u(),m("div",qr,p(h.item.platforms),1)):S("",!0),h.item.genre?(u(),m("div",Qr,p(h.item.genre),1)):S("",!0)],2))),128))]))])])):S("",!0)])):t.currentCategory==="profile"?(u(),m("div",Jr,[s("div",Kr,[s("div",Zr,[s("div",{class:"profile-avatar-large",onClick:e[8]||(e[8]=(...h)=>t.changeAvatar&&t.changeAvatar(...h))},[t.profileData.avatar?(u(),m("img",{key:0,src:t.profileData.avatar,alt:"Profile Picture"},null,8,Xr)):(u(),m("span",$r,p(t.getInitials()),1))]),s("input",{type:"file",ref:"avatarInput",accept:"image/*",onChange:e[9]||(e[9]=(...h)=>t.handleAvatarChange&&t.handleAvatarChange(...h)),style:{display:"none"}},null,544)]),s("div",ed,[s("h2",null,p(t.profileData.displayName||t.profileData.firstName+" "+t.profileData.lastName||"User"),1),s("p",null,p(t.profileData.email||"user@example.com"),1),s("div",td,[s("div",sd,[s("span",ad,p(n.totalItems),1),e[34]||(e[34]=s("span",{class:"stat-label"},"Total Items",-1))]),s("div",od,[s("span",nd,p(new Date().getFullYear()),1),e[35]||(e[35]=s("span",{class:"stat-label"},"Member Since",-1))])])])]),s("div",id,[s("div",ld,[e[41]||(e[41]=s("div",{class:"section-header"},[s("h3",null,"Personal Information"),s("p",null,"Manage your personal details and account information")],-1)),s("div",rd,[s("div",dd,[s("div",cd,[e[36]||(e[36]=s("label",{for:"firstName"},"First Name",-1)),M(s("input",{type:"text",id:"firstName","onUpdate:modelValue":e[10]||(e[10]=h=>t.profileData.firstName=h),placeholder:"Enter your first name"},null,512),[[L,t.profileData.firstName]])]),s("div",ud,[e[37]||(e[37]=s("label",{for:"lastName"},"Last Name",-1)),M(s("input",{type:"text",id:"lastName","onUpdate:modelValue":e[11]||(e[11]=h=>t.profileData.lastName=h),placeholder:"Enter your last name"},null,512),[[L,t.profileData.lastName]])])]),s("div",md,[e[38]||(e[38]=s("label",{for:"displayName"},"Display Name",-1)),M(s("input",{type:"text",id:"displayName","onUpdate:modelValue":e[12]||(e[12]=h=>t.profileData.displayName=h),placeholder:"How others see your name"},null,512),[[L,t.profileData.displayName]])]),s("div",gd,[e[39]||(e[39]=s("label",{for:"email"},"Email Address",-1)),M(s("input",{type:"email",id:"email","onUpdate:modelValue":e[13]||(e[13]=h=>t.profileData.email=h),placeholder:"your.email@example.com"},null,512),[[L,t.profileData.email]])]),s("div",fd,[e[40]||(e[40]=s("label",{for:"bio"},"Bio",-1)),M(s("textarea",{id:"bio","onUpdate:modelValue":e[14]||(e[14]=h=>t.profileData.bio=h),placeholder:"Tell us about yourself...",rows:"4"},null,512),[[L,t.profileData.bio]])])])]),s("div",hd,[e[53]||(e[53]=s("div",{class:"section-header"},[s("h3",null,"Preferences"),s("p",null,"Customize your application experience")],-1)),s("div",pd,[s("div",vd,[s("div",yd,[e[43]||(e[43]=s("label",{for:"language"},"Language",-1)),M(s("select",{id:"language","onUpdate:modelValue":e[15]||(e[15]=h=>t.profileData.language=h)},[...e[42]||(e[42]=[s("option",{value:"en"},"English",-1),s("option",{value:"de"},"Deutsch",-1),s("option",{value:"fr"},"Français",-1),s("option",{value:"es"},"Español",-1)])],512),[[ke,t.profileData.language]])]),s("div",bd,[e[45]||(e[45]=s("label",{for:"timezone"},"Timezone",-1)),M(s("select",{id:"timezone","onUpdate:modelValue":e[16]||(e[16]=h=>t.profileData.timezone=h)},[...e[44]||(e[44]=[s("option",{value:"UTC"},"UTC",-1),s("option",{value:"Europe/Berlin"},"Europe/Berlin",-1),s("option",{value:"America/New_York"},"America/New_York",-1),s("option",{value:"America/Los_Angeles"},"America/Los_Angeles",-1)])],512),[[ke,t.profileData.timezone]])])]),s("div",_d,[s("div",wd,[e[47]||(e[47]=s("label",{for:"dateFormat"},"Date Format",-1)),M(s("select",{id:"dateFormat","onUpdate:modelValue":e[17]||(e[17]=h=>t.profileData.dateFormat=h)},[...e[46]||(e[46]=[s("option",{value:"MM/DD/YYYY"},"MM/DD/YYYY",-1),s("option",{value:"DD/MM/YYYY"},"DD/MM/YYYY",-1),s("option",{value:"YYYY-MM-DD"},"YYYY-MM-DD",-1)])],512),[[ke,t.profileData.dateFormat]])]),s("div",kd,[e[49]||(e[49]=s("label",{for:"booksApiProvider"},"Books API Provider",-1)),M(s("select",{id:"booksApiProvider","onUpdate:modelValue":e[18]||(e[18]=h=>t.profileData.booksApiProvider=h)},[...e[48]||(e[48]=[s("option",{value:"wikipedia"},"Wikipedia (Primary)",-1),s("option",{value:"google_books"},"Google Books (Fallback)",-1),s("option",{value:"both"},"Both (Wikipedia + Google Books)",-1)])],512),[[ke,t.profileData.booksApiProvider]])])]),s("div",Sd,[s("div",xd,[e[51]||(e[51]=s("label",{for:"enableGoogleBooksFallback"},"Enable Google Books Fallback",-1)),s("div",Cd,[M(s("input",{type:"checkbox",id:"enableGoogleBooksFallback","onUpdate:modelValue":e[19]||(e[19]=h=>t.profileData.enableGoogleBooksFallback=h)},null,512),[[mt,t.profileData.enableGoogleBooksFallback]]),e[50]||(e[50]=s("label",{for:"enableGoogleBooksFallback",class:"checkbox-label"}," Use Google Books as fallback when Wikipedia search fails ",-1))])]),e[52]||(e[52]=s("div",{class:"form-group"},null,-1))])])]),s("div",Id,[e[58]||(e[58]=s("div",{class:"section-header"},[s("h3",null,"Data Management"),s("p",null,"Manage your data and account")],-1)),s("div",Dd,[s("div",Ad,[s("button",{class:"data-btn export-btn",onClick:e[20]||(e[20]=(...h)=>t.exportData&&t.exportData(...h))},[...e[54]||(e[54]=[s("span",{class:"btn-icon"},"📦",-1),s("span",{class:"btn-text"},"Export All Data",-1),s("span",{class:"btn-description"},"Download your complete media library",-1)])]),s("button",{class:"data-btn import-btn",onClick:e[21]||(e[21]=(...h)=>t.importData&&t.importData(...h))},[...e[55]||(e[55]=[s("span",{class:"btn-icon"},"📥",-1),s("span",{class:"btn-text"},"Import Data",-1),s("span",{class:"btn-description"},"Import data from a backup file",-1)])]),s("button",{class:"data-btn backup-btn",onClick:e[22]||(e[22]=(...h)=>t.createBackup&&t.createBackup(...h))},[...e[56]||(e[56]=[s("span",{class:"btn-icon"},"💾",-1),s("span",{class:"btn-text"},"Create Backup",-1),s("span",{class:"btn-description"},"Create a local backup of your data",-1)])]),s("button",{class:"data-btn cache-btn",onClick:e[23]||(e[23]=(...h)=>t.clearCache&&t.clearCache(...h))},[...e[57]||(e[57]=[s("span",{class:"btn-icon"},"🗑️",-1),s("span",{class:"btn-text"},"Clear Cache",-1),s("span",{class:"btn-description"},"Clear temporary files and cache",-1)])])])])]),s("div",Td,[e[61]||(e[61]=s("div",{class:"section-header"},[s("h3",null,"Danger Zone"),s("p",null,"Irreversible and destructive actions")],-1)),s("div",Md,[s("div",Rd,[s("button",{class:"danger-btn reset-btn",onClick:e[24]||(e[24]=(...h)=>t.resetSettings&&t.resetSettings(...h))},[...e[59]||(e[59]=[s("span",{class:"btn-icon"},"🔄",-1),s("span",{class:"btn-text"},"Reset All Settings",-1),s("span",{class:"btn-description"},"Reset all settings to default values",-1)])]),s("button",{class:"danger-btn clear-btn",onClick:e[25]||(e[25]=(...h)=>t.clearAllData&&t.clearAllData(...h))},[...e[60]||(e[60]=[s("span",{class:"btn-icon"},"🗑️",-1),s("span",{class:"btn-text"},"Clear All Data",-1),s("span",{class:"btn-description"},"Permanently delete all your data",-1)])])])])])])])):t.currentCategory==="statistics"?(u(),m("div",Ed,[s("div",Ud,[e[62]||(e[62]=s("h1",null,"📊 Media Library Statistics",-1)),e[63]||(e[63]=s("p",null,"Übersicht über deine Media Collection",-1)),s("div",Ld,[s("button",{class:"refresh-btn",onClick:e[26]||(e[26]=(...h)=>t.loadMedia&&t.loadMedia(...h))},"🔄 Refresh Statistics")])]),s("div",Bd,[s("div",Pd,[s("div",Fd,[s("div",Nd,p(t.statistics.totalItems),1),e[64]||(e[64]=s("div",{class:"summary-label"},"Total Items",-1))]),s("div",Gd,[s("div",Wd,p(t.statistics.totalCollections),1),e[65]||(e[65]=s("div",{class:"summary-label"},"Collections",-1))]),s("div",Vd,[s("div",Od,p(t.statistics.totalPlaytime)+"h",1),e[66]||(e[66]=s("div",{class:"summary-label"},"Total Playtime",-1))]),s("div",jd,[s("div",zd,p(t.statistics.avgRating),1),e[67]||(e[67]=s("div",{class:"summary-label"},"Avg Rating",-1))])]),s("div",Yd,[e[68]||(e[68]=s("h3",{class:"chart-title"},"📈 Category Distribution",-1)),s("div",Hd,[(u(!0),m(se,null,ae(t.statistics.categoryDistribution,(h,W)=>(u(),m("div",{key:W,class:"category-stat"},[s("div",qd,p(W),1),s("div",Qd,[s("div",{class:"category-fill",style:Le({width:`${h/t.statistics.totalItems*100}%`})},null,4)]),s("div",Jd,p(h)+" ("+p((h/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",Kd,[e[69]||(e[69]=s("h3",{class:"chart-title"},"⭐ Rating Distribution",-1)),s("div",Zd,[(u(!0),m(se,null,ae(t.statistics.ratingDistribution,(h,W)=>(u(),m("div",{key:W,class:"rating-stat"},[s("div",Xd,p(t.getRatingStars(W)),1),s("div",$d,[s("div",{class:"rating-fill",style:Le({width:`${h/t.statistics.totalItems*100}%`})},null,4)]),s("div",ec,p(h)+" ("+p((h/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",tc,[e[70]||(e[70]=s("h3",{class:"chart-title"},"🎮 Platform Distribution",-1)),s("div",sc,[(u(!0),m(se,null,ae(t.statistics.platformDistribution,(h,W)=>(u(),m("div",{key:W,class:"platform-stat"},[s("div",ac,p(W),1),s("div",oc,[s("div",{class:"platform-fill",style:Le({width:`${h/t.statistics.totalItems*100}%`})},null,4)]),s("div",nc,p(h)+" ("+p((h/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",ic,[e[71]||(e[71]=s("h3",{class:"chart-title"},"🎭 Top Genres",-1)),s("div",lc,[(u(!0),m(se,null,ae(t.statistics.genreDistribution,(h,W)=>(u(),m("div",{key:W,class:"genre-stat"},[s("div",rc,p(W),1),s("div",dc,[s("div",{class:"genre-fill",style:Le({width:`${h/t.statistics.totalItems*100}%`})},null,4)]),s("div",cc,p(h)+" ("+p((h/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",uc,[e[72]||(e[72]=s("h3",{class:"chart-title"},"📅 Recent Activity",-1)),s("div",mc,[(u(!0),m(se,null,ae(t.statistics.recentActivity,h=>(u(),m("div",{key:h.title,class:"activity-item"},[s("div",gc,p(h.title),1),s("div",fc,p(h.category),1),s("div",hc,p(t.formatDate(h.discovered)),1)]))),128))])]),s("div",pc,[e[73]||(e[73]=s("h3",{class:"chart-title"},"📺 Currently Airing Series",-1)),s("div",vc,[(u(!0),m(se,null,ae(t.statistics.airingSeries,h=>(u(),m("div",{key:h.title,class:"airing-item"},[s("div",yc,p(h.title),1),s("div",bc,"Next: Season "+p(h.nextSeason),1),s("div",_c,p(h.nextSeasonRelease?t.formatDate(h.nextSeasonRelease):"TBA"),1)]))),128))])])])])):(u(),m("div",{key:3,class:H(["grid",{"edit-mode":t.editMode}])},[(u(!0),m(se,null,ae(t.paginatedMedia,h=>(u(),Be(w,{key:h.id,item:h,"edit-mode":t.editMode,onEdit:t.editItem,onWatchlistToggled:n.handleWatchlistToggled,onShowMessage:n.showMessage,onRatingChanged:t.handleRatingChanged},null,8,["item","edit-mode","onEdit","onWatchlistToggled","onShowMessage","onRatingChanged"]))),128))],2))]))])]),t.isLoggedIn?S("",!0):(u(),m("div",wc,[s("button",{onClick:e[27]||(e[27]=(...h)=>t.handleAdminSetup&&t.handleAdminSetup(...h)),disabled:t.adminSetupLoading,class:"admin-setup-btn",title:"Setup Admin Account (Creates admin account with default password)"},[t.adminSetupLoading?(u(),m("span",Sc,"🔧 Setting up...")):(u(),m("span",xc,"🔧 Admin Setup"))],8,kc),t.adminSetupMessage?(u(),m("div",{key:0,class:H(["admin-setup-message",t.adminSetupMessage.type])},p(t.adminSetupMessage.text),3)):S("",!0)])),t.showLoginModal?(u(),Be(R,{key:1,onClose:e[28]||(e[28]=h=>t.showLoginModal=!1),onSuccess:t.handleLoginSuccess,onSwitchToRegister:t.switchToRegister},null,8,["onSuccess","onSwitchToRegister"])):S("",!0),t.showRegisterModal?(u(),Be(x,{key:2,onClose:e[29]||(e[29]=h=>t.showRegisterModal=!1),onSuccess:t.handleRegisterSuccess},null,8,["onSuccess"])):S("",!0),t.showEditModal?(u(),Be(I,{key:3,item:t.editingItem,"current-category":t.currentCategory,onClose:t.closeEditModal,onSave:t.handleSaveItem,onDelete:t.handleDeleteItem},null,8,["item","current-category","onClose","onSave","onDelete"])):S("",!0),be(r,{show:t.showBulkAddModal,"current-category":t.currentCategory,onClose:t.closeBulkAddModal},null,8,["show","current-category","onClose"]),be(V,{show:t.showTxtImportModal,onClose:e[30]||(e[30]=h=>t.showTxtImportModal=!1),onFileProcessed:t.processTxtContent},null,8,["show","onFileProcessed"]),be(ne,{show:t.showTxtImportResults,results:t.txtImportResults,onClose:t.closeTxtImportResults},null,8,["show","results","onClose"]),be(q,{"show-menu":t.showFloatingMenu,"show-delete-all":t.isLoggedIn&&t.currentCategory!=="all"&&t.categoryCounts[t.currentCategory]>0,"category-name":t.currentCategoryDisplayName,"item-count":t.categoryCounts[t.currentCategory]||0,onToggleMenu:t.toggleFloatingMenu,onAddNewItem:t.addNewItem,onBulkAddItems:t.bulkAddItems,onImportFromTxt:t.importFromTxt,onImportFromApi:t.importFromAPI,onCreateCollection:t.createCollection,onDeleteAllInCategory:t.deleteAllInCategory},null,8,["show-menu","show-delete-all","category-name","item-count","onToggleMenu","onAddNewItem","onBulkAddItems","onImportFromTxt","onImportFromApi","onCreateCollection","onDeleteAllInCategory"]),be(ge,{show:t.messageStore.show,type:t.messageStore.type,title:t.messageStore.title,message:t.messageStore.message,details:t.messageStore.details,onClose:t.messageStore.closeMessage},null,8,["show","type","title","message","details","onClose"]),be(ee,{show:t.confirmStore.show,title:t.confirmStore.title,message:t.confirmStore.message,onConfirm:t.confirmStore.confirm,onClose:t.confirmStore.cancel},null,8,["show","title","message","onConfirm","onClose"]),be(ce,{show:t.inputStore.show,title:t.inputStore.title,message:t.inputStore.message,placeholder:t.inputStore.placeholder,"input-type":t.inputStore.inputType,"default-value":t.inputStore.defaultValue,onConfirm:t.inputStore.confirm,onClose:t.inputStore.cancel},null,8,["show","title","message","placeholder","input-type","default-value","onConfirm","onClose"])])}const Dc=oe(_r,[["render",Cc],["__scopeId","data-v-2b4e9e08"]]);export{Dc as default};
