import{d as Ye,r as b,u as at,a as Ze,c as U,_ as O,b as u,e as o,t as f,f as h,n as X,g as de,h as je,o as d,i as $e,w as ue,j as Y,k as A,v as ce,l as Oe,m as R,F as me,p as ge,q as We,s as lt,x as nt,y as it,z as J,A as re,B as V,C as rt,D as dt}from"./index-DpwEkaq-.js";import{u as et}from"./media-MuJQ4yh4.js";import{u as tt}from"./message-Cqo-r7V0.js";import{S as ct}from"./Sidebar-Cqy7J5Ga.js";import{R as ut,L as mt,M as gt}from"./RegisterModal-DdF2PNeI.js";import{L as ft}from"./LoadingSpinner-DH8RwzIJ.js";const ot=Ye("confirm",()=>{const l=b(!1),t=b("Confirm Action"),a=b(""),e=b(null);function n(m){return new Promise(r=>{t.value=m.title||"Confirm Action",a.value=m.message||"",l.value=!0,e.value=r})}function g(){e.value&&(e.value(!0),e.value=null),l.value=!1}function s(){e.value&&(e.value(!1),e.value=null),l.value=!1}return{show:l,title:t,message:a,showConfirm:n,confirm:g,cancel:s}}),st=Ye("input",()=>{const l=b(!1),t=b("Input Required"),a=b(""),e=b(""),n=b("text"),g=b(""),s=b(null);function m(M){return new Promise(P=>{t.value=M.title||"Input Required",a.value=M.message||"",e.value=M.placeholder||"",n.value=M.inputType||"text",g.value=M.defaultValue||"",l.value=!0,s.value=P})}function r(M){s.value&&(s.value(M),s.value=null),l.value=!1}function L(){s.value&&(s.value(null),s.value=null),l.value=!1}return{show:l,title:t,message:a,placeholder:e,inputType:n,defaultValue:g,showInput:m,confirm:r,cancel:L}});function vt(){const l=at(),t=Ze(),a=et(),e=tt(),n=ot(),g=st(),s=b(!1),m=b(!1),r=b(!1),L=b(!1),M=b(!1),P=b(!1),z=b(!1),C=b(!1),k=b(!1),p=b(null),B=()=>typeof window<"u"?window.innerWidth>768?8:3:8,E=b(B()),F=b("order_asc"),W=b(null),x=()=>{E.value=B()};typeof window<"u"&&window.addEventListener("resize",x);const Z=[{key:"game",name:"Games",icon:"🎮"},{key:"series",name:"Series",icon:"📺"},{key:"movie",name:"Movies",icon:"🎬"},{key:"buecher",name:"Bücher",icon:"📚"},{key:"watchlist",name:"Watchlist",icon:"❤️"}],H=U(()=>{try{return t.isLoggedIn}catch(c){return console.error("Error accessing authStore.isLoggedIn:",c),!1}}),fe=U(()=>{try{return t.userName}catch(c){return console.error("Error accessing authStore.userName:",c),""}}),$=U(()=>{try{return t.isAdmin}catch(c){return console.error("Error accessing authStore.isAdmin:",c),!1}}),j=U(()=>{try{return a.currentCategory}catch(c){return console.error("Error accessing mediaStore.currentCategory:",c),"game"}}),ve=U({get:()=>{try{return a.searchQuery}catch(c){return console.error("Error accessing mediaStore.searchQuery:",c),""}},set:c=>{try{a.setSearchQuery(c)}catch(v){console.error("Error setting mediaStore.searchQuery:",v)}}}),oe=U(()=>{try{return a.categoryCounts}catch(c){return console.error("Error accessing mediaStore.categoryCounts:",c),{}}}),i=U(()=>{try{return a.loading}catch(c){return console.error("Error accessing mediaStore.loading:",c),!1}}),w=U(()=>{try{return a.error}catch(c){return console.error("Error accessing mediaStore.error:",c),null}}),G=U(()=>{try{const c=[...a.filteredMedia||[]],[v,D]=F.value.split("_");return c.sort((I,S)=>{let N=I[v],y=S[v];return v==="order"?(N=I.__order||0,y=S.__order||0):v==="airing"&&(N=I.isAiring?1:0,y=S.isAiring?1:0),typeof N=="string"&&(N=N.toLowerCase(),y=y.toLowerCase()),D==="asc"?N>y?1:-1:N<y?1:-1})}catch(c){return console.error("Error in sortedMedia computed:",c),[]}}),T=U(()=>G.value),_=U(()=>{try{if(!a||!a.mediaData)return[];const c=new Set;return a.mediaData.forEach(v=>{v.platforms&&v.platforms.split(",").forEach(D=>c.add(D.trim()))}),Array.from(c).sort()}catch(c){return console.error("Error in platforms computed:",c),[]}}),K=U(()=>{try{if(!a||!a.mediaData)return[];const c=new Set;return a.mediaData.forEach(v=>{v.genre&&v.genre.split(",").forEach(D=>c.add(D.trim()))}),Array.from(c).sort()}catch(c){return console.error("Error in genres computed:",c),[]}}),Q=()=>{s.value=!s.value},pe=()=>{m.value=!m.value},Se=()=>{m.value=!1},Ce=c=>{a.setCategory(c),m.value=!1},Te=()=>{a.setSearchQuery("")},Ae=(c,v)=>{v?a.addFilter({type:"platform",value:c}):a.removeFilter({type:"platform",value:c})},xe=(c,v)=>{v?a.addFilter({type:"genre",value:c}):a.removeFilter({type:"genre",value:c})},_e=(c,v)=>{v?a.addFilter({type:"airing",value:c}):a.removeFilter({type:"airing",value:c})},Me=c=>{p.value=c,M.value=!0},he=()=>{M.value=!1,p.value=null},ye=()=>{z.value=!1},De=async c=>{try{const v=await a.batchAddMediaItems(c);if(v.success){const{created:D,failed:I}=v.stats;let S=`Successfully added ${D} items`;I>0&&(S+=` (${I} failed)`),e.showSuccess(S,"Bulk Add Successful")}ye()}catch(v){console.error("Bulk add failed:",v),e.showError("Failed to add items: "+(v.message||"Unknown error"),"Bulk Add Failed")}},Be=async c=>{p.value?await a.updateMediaItem(p.value.id,c):await a.addMediaItem(c),he()},ee=async c=>{await a.deleteMediaItem(c.id)},Ue=async()=>{await t.logout(),await te()},te=async()=>{try{await a.loadMedia()}catch(c){console.error("Error loading media:",c)}},Re=()=>{P.value=!P.value},Pe=()=>{if(P.value=!1,!H.value){e.showWarning("Bitte loggen Sie sich ein, um neue Items hinzuzufügen.","Login erforderlich");return}p.value=null,M.value=!0},Fe=()=>{if(P.value=!1,!H.value){e.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}z.value=!0},Le=()=>{if(P.value=!1,!H.value){e.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}C.value=!0},Ee=()=>{if(P.value=!1,!H.value){e.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}e.showInfo("API Import feature coming soon!","Feature in Entwicklung")},Ge=()=>{if(P.value=!1,!H.value){e.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}be()},se=c=>{if(!c)return"Unknown";const v=Z.find(D=>D.key===c);return v?v.name:c},Ne=async()=>{const c=se(j.value),v=oe.value[j.value]||0;if(v===0){e.showInfo("No items to delete in this category.","Nothing to Delete");return}const D=`Are you sure you want to delete ALL ${v} items in "${c}"?

This action cannot be undone!`;if(await n.showConfirm({title:"Delete All Items",message:D}))try{const N=((a==null?void 0:a.mediaData)||[]).filter(y=>j.value==="watchlist"?y.category==="watchlist"||y.isNew===!0:y.category===j.value).map(y=>y.id);await a.batchDeleteMediaItems(N),await te(),e.showSuccess(`Successfully deleted ${v} items from "${c}"`,"Items Deleted")}catch(S){console.error("Error deleting items:",S),e.showError("Error occurred while deleting items. Please try again.","Delete Failed")}},Ve=c=>{const v=c.split(`
`).map(y=>y.trim()).filter(y=>y.length>0);if(v.length===0){e.showWarning("Die TXT-Datei ist leer oder enthält keine gültigen Einträge.","Leere Datei");return}const I=a.filteredMedia.map(y=>y.title.toLowerCase().trim()),S=v.filter(y=>{const ne=y.toLowerCase().trim();return!I.some(ie=>ie.includes(ne)||ne.includes(ie))}),N=v.filter(y=>{const ne=y.toLowerCase().trim();return I.some(ie=>ie.includes(ne)||ne.includes(ie))});W.value={totalInFile:v.length,missingItems:S,existingItems:N,currentCategory:j.value,categoryName:se(j.value)},C.value=!1,k.value=!0},ae=()=>{W.value=null,k.value=!1},be=async()=>{const c=(a==null?void 0:a.mediaData)||[];if(c.length===0){e.showInfo("Keine Media Items zum Exportieren gefunden.","Nichts zu exportieren");return}const v=await g.showInput({title:"Export Format wählen",message:`1 = CSV
2 = JSON
3 = Beide

Geben Sie die Nummer ein:`,placeholder:"1",defaultValue:"1"});if(!v||!["1","2","3"].includes(v))return;const D=new Date().toISOString().split("T")[0];(v==="1"||v==="3")&&we(c,D),(v==="2"||v==="3")&&ke(c,D),e.showSuccess(`Collection mit ${c.length} Items wurde erfolgreich exportiert!`,"Export erfolgreich")},we=(c,v)=>{const I=[["Titel","Kategorie","Release","Rating","Platforms","Genre","Spielzeit","Status","Beschreibung"].join(","),...c.map(S=>[`"${(S.title||"").replace(/"/g,'""')}"`,`"${(S.category||S.category_name||"Unbekannt").replace(/"/g,'""')}"`,`"${S.release||""}"`,`"${S.rating||""}"`,`"${(S.platforms||"").replace(/"/g,'""')}"`,`"${(S.genre||"").replace(/"/g,'""')}"`,`"${S.spielzeit||""}"`,`"${S.isAiring?"Airing":"Abgeschlossen"}"`,`"${(S.description||"").replace(/"/g,'""')}"`].join(","))].join(`
`);le(I,`media_collection_${v}.csv`,"text/csv;charset=utf-8;")},ke=(c,v)=>{const D={exportDate:new Date().toISOString(),totalItems:c.length,categories:[...new Set(c.map(I=>I.category||I.category_name||"Unbekannt"))],items:c.map(I=>({id:I.id,title:I.title||"",category:I.category||I.category_name||"Unbekannt",release:I.release||"",rating:I.rating||null,platforms:I.platforms||"",genre:I.genre||"",spielzeit:I.spielzeit||null,status:I.isAiring?"Airing":"Abgeschlossen",description:I.description||"",isNew:I.isNew||!1,nextSeason:I.nextSeason||null,discovered:I.discovered||null}))};le(JSON.stringify(D,null,2),`media_collection_${v}.json`,"application/json;charset=utf-8;")},le=(c,v,D)=>{const I=new Blob([c],{type:D}),S=document.createElement("a"),N=URL.createObjectURL(I);S.setAttribute("href",N),S.setAttribute("download",v),S.style.visibility="hidden",document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL(N)};return{sidebarCollapsed:s,mobileSidebarOpen:m,showLoginModal:r,showRegisterModal:L,showEditModal:M,showFloatingMenu:P,showBulkAddModal:z,showTxtImportModal:C,showTxtImportResults:k,editingItem:p,gridColumns:E,sortBy:F,categories:Z,txtImportResults:W,isLoggedIn:H,isAdmin:$,userName:fe,currentCategory:j,searchQuery:ve,categoryCounts:oe,loading:i,error:w,paginatedMedia:T,platforms:_,genres:K,toggleSidebar:Q,toggleMobileSidebar:pe,closeMobileSidebar:Se,setCategory:Ce,clearSearch:Te,togglePlatformFilter:Ae,toggleGenreFilter:xe,toggleAiringFilter:_e,editItem:Me,closeEditModal:he,closeBulkAddModal:ye,handleBulkAddItems:De,handleSaveItem:Be,handleDeleteItem:ee,logout:Ue,loadMedia:te,toggleFloatingMenu:Re,addNewItem:Pe,bulkAddItems:Fe,importFromTxt:Le,importFromAPI:Ee,createCollection:Ge,exportMediaCollection:be,exportAsCSV:we,exportAsJSON:ke,downloadFile:le,deleteAllInCategory:Ne,getCategoryDisplayName:se,navigateToBooks:()=>{console.log("📚 Navigating to books..."),l.push("/books")},navigateToStatistics:()=>{l.push("/statistics")},navigateToCalendar:()=>{l.push("/calendar")},navigateToFeatures:()=>{l.push("/features")},navigateToProfile:()=>{l.push("/profile")},navigateToAdmin:()=>{console.log("🔥 navigateToAdmin function called!"),console.log("🔥 Router object:",l),console.log("🔥 Pushing to /admin...");try{l.push("/admin"),console.log("🔥 Successfully navigated to /admin!")}catch(c){console.error("🔥 Error navigating to admin:",c)}},processTxtContent:Ve,closeTxtImportResults:ae,cleanup:()=>{typeof window<"u"&&window.removeEventListener("resize",x)},router:l}}const pt={name:"MediaItem",props:{item:{type:Object,required:!0}},emits:["edit"],computed:{showWatchlistTag(){return this.item.category==="watchlist"||this.item.isNew===!0},isWatchlistItem(){return this.item.category==="watchlist"||this.item.isNew===!0}},methods:{getImageUrl(l){return l?l.startsWith("http")?l.startsWith("http://")?l.replace("http://","https://"):l:l.startsWith("/")?l:`/storage/${l}`:""},handleImageError(l){var t;l.target.style.display="none",(t=l.target.nextElementSibling)==null||t.classList.add("show")},formatDate(l){return l?new Date(l).toLocaleDateString():""},editItem(){this.$emit("edit",this.item)},getWatchlistReleaseStatus(){if(!this.item.release)return"";const l=new Date(this.item.release),t=new Date;t.setHours(0,0,0,0),l.setHours(0,0,0,0);const a=l.getTime()-t.getTime(),e=Math.ceil(a/(1e3*3600*24));if(e>0)return e===1?"Tomorrow!":e<=7?`${e} days left`:e<=30?`${e} days left`:`${Math.ceil(e/30)} months left`;if(e===0)return"Released today!";{const n=this.getTypeTagText().toLowerCase();return n==="game"?"Unplayed yet":n==="series"||n==="movie"?"Unwatched yet":n==="buecher"?"Unread yet":"Unconsumed yet"}},getWatchlistReleaseStatusClass(){if(!this.item.release)return"";const l=new Date(this.item.release),t=new Date;t.setHours(0,0,0,0),l.setHours(0,0,0,0);const a=l.getTime()-t.getTime(),e=Math.ceil(a/(1e3*3600*24));return e>0?"countdown":e===0?"released-today":"unconsumed"},getTypeTagText(){var t,a,e;const l=this.item.watchlistType||this.item.watchlist_type;if(l)return l.charAt(0).toUpperCase()+l.slice(1);if(this.item.genre){const n=this.item.genre.toLowerCase();if(n.includes("game")||n.includes("gaming")||(t=this.item.platforms)!=null&&t.toLowerCase().includes("steam")||(a=this.item.platforms)!=null&&a.toLowerCase().includes("ps")||(e=this.item.platforms)!=null&&e.toLowerCase().includes("xbox"))return"Game";if(n.includes("series")||n.includes("tv")||n.includes("episode")||this.item.isAiring)return"Series";if(n.includes("movie")||n.includes("film")||n.includes("cinema"))return"Movie";if(n.includes("book")||n.includes("literature")||n.includes("novel")||n.includes("author"))return"Bücher"}if(this.item.platforms){const n=this.item.platforms.toLowerCase();if(n.includes("steam")||n.includes("ps")||n.includes("xbox")||n.includes("nintendo")||n.includes("pc"))return"Game";if(n.includes("netflix")||n.includes("hulu")||n.includes("disney")||n.includes("hbo"))return"Series";if(n.includes("cinema")||n.includes("theater"))return"Movie";if(n.includes("book")||n.includes("kindle")||n.includes("audible")||n.includes("author"))return"Bücher"}return"Media"},getTypeTagClass(){return`type-${this.getTypeTagText().toLowerCase()}`},getNextSeasonCountdown(){if(!this.item.nextSeasonRelease)return"";const l=new Date(this.item.nextSeasonRelease),t=new Date;t.setHours(0,0,0,0),l.setHours(0,0,0,0);const a=l.getTime()-t.getTime(),e=Math.ceil(a/(1e3*3600*24));return e>0?e===1?"Tomorrow!":e<=7?`${e} days`:e<=30?`${e} days`:`${Math.ceil(e/30)} months`:e===0?"Today!":"Released"},getCategoryClass(){var t;const l=(t=this.item.category)==null?void 0:t.toLowerCase();return l==="movies"||l==="movie"?"category-movies":l==="books"||l==="buecher"?"category-books":l==="series"||l==="tv"?"category-series":l==="games"||l==="game"?"category-games":"category-default"},getCategoryIcon(){var t;const l=(t=this.item.category)==null?void 0:t.toLowerCase();return l==="movies"||l==="movie"?"🎬":l==="books"||l==="buecher"?"📚":l==="series"||l==="tv"?"📺":l==="games"||l==="game"?"🎮":"📁"},getCategoryStyle(){var t;const l=(t=this.item.category)==null?void 0:t.toLowerCase();if(l==="games"||l==="game"){const a=this.item.rating||0;return this.getGameStyleByRating(a)}return{}},getGameStyleByRating(l){return l>=4.5?{"--game-primary":"#ffd700","--game-secondary":"#ffed4e","--game-accent":"#ff6b35","--game-glow":"0 0 20px rgba(255, 215, 0, 0.6)","--game-border":"3px solid #ffd700"}:l>=4?{"--game-primary":"#00d4ff","--game-secondary":"#4a9eff","--game-accent":"#00ff88","--game-glow":"0 0 15px rgba(0, 212, 255, 0.5)","--game-border":"3px solid #00d4ff"}:l>=3.5?{"--game-primary":"#00ff88","--game-secondary":"#4caf50","--game-accent":"#8bc34a","--game-glow":"0 0 12px rgba(0, 255, 136, 0.4)","--game-border":"3px solid #00ff88"}:l>=3?{"--game-primary":"#ff9800","--game-secondary":"#ffc107","--game-accent":"#ff5722","--game-glow":"0 0 10px rgba(255, 152, 0, 0.3)","--game-border":"3px solid #ff9800"}:l>=2?{"--game-primary":"#ff5722","--game-secondary":"#f44336","--game-accent":"#d32f2f","--game-glow":"0 0 8px rgba(255, 87, 34, 0.3)","--game-border":"3px solid #ff5722"}:{"--game-primary":"#9e9e9e","--game-secondary":"#757575","--game-accent":"#616161","--game-glow":"0 0 5px rgba(158, 158, 158, 0.2)","--game-border":"3px solid #9e9e9e"}}}},ht={class:"media-image"},yt=["src","alt"],bt={key:1,class:"no-image"},wt={class:"no-image-icon"},kt={class:"media-info"},It={class:"media-title"},St={class:"media-meta"},Ct={key:0,class:"media-release"},Tt={key:1},At={key:1,class:"media-rating"},xt={key:0,class:"media-platforms"},_t={key:1,class:"media-genre"},Mt={key:2,class:"media-airing"},Dt={key:0,class:"next-season"},Bt={key:1,class:"countdown"},Ut={key:3,class:"watchlist-type-tag"};function Rt(l,t,a,e,n,g){return d(),u("div",{class:X(["media-item",g.getCategoryClass()]),style:je(g.getCategoryStyle()),onClick:t[1]||(t[1]=(...s)=>g.editItem&&g.editItem(...s))},[o("div",ht,[a.item.path?(d(),u("img",{key:0,src:g.getImageUrl(a.item.path),alt:a.item.title,onError:t[0]||(t[0]=(...s)=>g.handleImageError&&g.handleImageError(...s))},null,40,yt)):(d(),u("div",bt,[o("span",wt,f(g.getCategoryIcon()),1)]))]),o("div",kt,[o("h3",It,f(a.item.title),1),o("div",St,[a.item.release?(d(),u("span",Ct,[g.isWatchlistItem&&a.item.release?(d(),u("span",{key:0,class:X(g.getWatchlistReleaseStatusClass())},f(g.getWatchlistReleaseStatus()),3)):(d(),u("span",Tt,f(g.formatDate(a.item.release)),1))])):h("",!0),a.item.rating?(d(),u("span",At,f("★".repeat(Math.max(0,Math.min(5,Math.floor(a.item.rating)))))+f("☆".repeat(Math.max(0,5-Math.max(0,Math.min(5,Math.floor(a.item.rating)))))),1)):h("",!0)]),a.item.platforms?(d(),u("div",xt,f(a.item.platforms),1)):h("",!0),a.item.genre?(d(),u("div",_t,f(a.item.genre),1)):h("",!0),a.item.isAiring?(d(),u("div",Mt,[t[2]||(t[2]=o("span",{class:"airing-badge"},[o("span",{class:"airing-dot"}),de(" Airing ")],-1)),a.item.nextSeason?(d(),u("span",Dt,"S"+f(a.item.nextSeason),1)):h("",!0),a.item.nextSeasonRelease?(d(),u("span",Bt,f(g.getNextSeasonCountdown()),1)):h("",!0)])):h("",!0),g.showWatchlistTag?(d(),u("div",Ut,[o("span",{class:X(["type-tag",g.getTypeTagClass()])},f(g.getTypeTagText()),3)])):h("",!0)]),t[3]||(t[3]=o("div",{class:"edit-indicator"},[o("span",{class:"edit-icon"},"✏️")],-1))],6)}const Pt=O(pt,[["render",Rt],["__scopeId","data-v-8da80e20"]]),Ft={name:"FloatingActionButton",props:{showMenu:{type:Boolean,default:!1},showDeleteAll:{type:Boolean,default:!1},categoryName:{type:String,default:""},itemCount:{type:Number,default:0}},emits:["toggleMenu","addNewItem","bulkAddItems","importFromTxt","importFromAPI","createCollection","deleteAllInCategory"]},Lt={class:"floating-actions"},Et={class:"menu-text"},Gt={class:"item-count-badge"};function Nt(l,t,a,e,n,g){return d(),u("div",Lt,[o("div",{class:X(["floating-menu",{show:a.showMenu}])},[o("button",{class:"floating-menu-item",onClick:t[0]||(t[0]=s=>l.$emit("addNewItem"))},[...t[7]||(t[7]=[o("span",{class:"menu-icon"},"➕",-1),o("span",{class:"menu-text"},"Add Item",-1)])]),o("button",{class:"floating-menu-item",onClick:t[1]||(t[1]=s=>l.$emit("bulkAddItems"))},[...t[8]||(t[8]=[o("span",{class:"menu-icon"},"📦",-1),o("span",{class:"menu-text"},"Bulk Add",-1)])]),o("button",{class:"floating-menu-item",onClick:t[2]||(t[2]=s=>l.$emit("importFromTxt"))},[...t[9]||(t[9]=[o("span",{class:"menu-icon"},"📄",-1),o("span",{class:"menu-text"},"Import from TXT",-1)])]),o("button",{class:"floating-menu-item",onClick:t[3]||(t[3]=s=>l.$emit("importFromAPI"))},[...t[10]||(t[10]=[o("span",{class:"menu-icon"},"🌐",-1),o("span",{class:"menu-text"},"Import from API",-1)])]),o("button",{class:"floating-menu-item",onClick:t[4]||(t[4]=s=>l.$emit("createCollection"))},[...t[11]||(t[11]=[o("span",{class:"menu-icon"},"📚",-1),o("span",{class:"menu-text"},"Create Collection",-1)])]),a.showDeleteAll&&a.itemCount>0?(d(),u("button",{key:0,class:"floating-menu-item delete-all-item",onClick:t[5]||(t[5]=s=>l.$emit("deleteAllInCategory"))},[t[12]||(t[12]=o("span",{class:"menu-icon"},"🗑️",-1)),o("span",Et,"Delete All "+f(a.categoryName),1),o("span",Gt,"("+f(a.itemCount)+")",1)])):h("",!0)],2),o("button",{class:"floating-add-btn",onClick:t[6]||(t[6]=s=>l.$emit("toggleMenu"))},f(a.showMenu?"✕":"+"),1)])}const Vt=O(Ft,[["render",Nt],["__scopeId","data-v-19731834"]]);let q=null,Ie="https://www.googleapis.com/books/v1";class zt{constructor(){console.log("📚 Google Books API initialized"),this.initializeConfig()}async initializeConfig(){try{console.log("📚 Fetching Google Books API config from backend...");const a=await(await fetch("http://127.0.0.1:8000/api/google-books-config")).json();q=a.api_key,Ie=a.base_url,console.log("📚 Google Books API Config loaded:",{apiKey:q?`${q.substring(0,10)}...`:"MISSING",baseUrl:Ie})}catch(t){console.error("📚 Failed to load Google Books API config:",t)}}async searchBooks(t,a=10){if(console.log("📚 Google Books Search:",{query:t,maxResults:a,apiKey:q?`${q.substring(0,10)}...`:"MISSING"}),!t||t.trim().length===0)return console.warn("📚 Google Books Search: Empty query provided"),{success:!1,error:"Query cannot be empty"};try{console.log("📚 Trying backend Google Books API...");const e=await fetch(`http://127.0.0.1:8000/api/google-books/search?q=${encodeURIComponent(t)}&maxResults=${a}`);if(e.ok){const n=await e.json();return console.log("📚 Backend Google Books API Success:",n),n}else console.warn("📚 Backend Google Books API failed:",e.status)}catch(e){console.warn("📚 Backend Google Books API error:",e.message)}if(console.log("📚 Falling back to direct Google Books API..."),!q&&(console.log("📚 Google Books Search: API key not loaded, waiting..."),await this.initializeConfig(),!q))return console.error("📚 Google Books Search: API key still missing after initialization"),{success:!1,error:"Google Books API key not configured"};try{const e=`${Ie}/volumes?q=${encodeURIComponent(t)}&key=${q}&maxResults=${a}`;console.log("📚 Google Books Request URL:",e);const n=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json"}});if(console.log("📚 Google Books Response Status:",n.status),console.log("📚 Google Books Response Headers:",Object.fromEntries(n.headers.entries())),!n.ok){const s=await n.text();return console.error("📚 Google Books API Error Response:",{status:n.status,statusText:n.statusText,body:s}),console.log("📚 Returning fallback results due to API error"),this.getFallbackResults(t)}const g=await n.json();return console.log("📚 Google Books API Success:",{totalItems:g.totalItems,itemsCount:g.items?g.items.length:0,items:g.items?g.items.map(s=>{var m,r,L;return{id:s.id,title:(m=s.volumeInfo)==null?void 0:m.title,authors:(r=s.volumeInfo)==null?void 0:r.authors,publishedDate:(L=s.volumeInfo)==null?void 0:L.publishedDate}}):[]}),{success:!0,data:this.formatBooksData(g.items||[]),totalItems:g.totalItems||0}}catch(e){return console.error("📚 Google Books Search Error:",{message:e.message,stack:e.stack,query:t}),console.log("📚 Returning fallback results due to network error"),this.getFallbackResults(t)}}getFallbackResults(t){console.log("📚 Generating fallback results for:",t);const a=[{id:"fallback-1",title:`${t} - Sample Book 1`,authors:["Unknown Author"],author:"Unknown Author",description:"This is a sample book result. Please fill in the details manually.",publishedDate:"2020-01-01",publisher:"Sample Publisher",pageCount:300,categories:["Fiction"],language:"en",isbn10:null,isbn13:null,imageUrl:null,previewLink:null,infoLink:null,canonicalVolumeLink:null},{id:"fallback-2",title:`${t} - Sample Book 2`,authors:["Another Author"],author:"Another Author",description:"Another sample book result. Please fill in the details manually.",publishedDate:"2021-01-01",publisher:"Another Publisher",pageCount:250,categories:["Non-Fiction"],language:"en",isbn10:null,isbn13:null,imageUrl:null,previewLink:null,infoLink:null,canonicalVolumeLink:null}];return{success:!0,data:a,totalItems:a.length,fallback:!0}}formatBooksData(t){return console.log("📚 Formatting books data:",{itemsCount:t.length}),t.map((a,e)=>{var m,r;const n=a.volumeInfo||{},g=n.imageLinks||{},s={id:a.id,title:n.title||"Unknown Title",authors:n.authors||[],author:n.authors?n.authors.join(", "):"",description:n.description||"",publishedDate:n.publishedDate||"",publisher:n.publisher||"",pageCount:n.pageCount||null,categories:n.categories||[],language:n.language||"",isbn10:this.extractISBN((m=a.volumeInfo)==null?void 0:m.industryIdentifiers,"ISBN_10"),isbn13:this.extractISBN((r=a.volumeInfo)==null?void 0:r.industryIdentifiers,"ISBN_13"),imageUrl:g.thumbnail||g.smallThumbnail||null,previewLink:n.previewLink||null,infoLink:n.infoLink||null,canonicalVolumeLink:n.canonicalVolumeLink||null};return console.log(`📚 Formatted book ${e+1}:`,{title:s.title,author:s.author,publishedDate:s.publishedDate,imageUrl:s.imageUrl?"Yes":"No"}),s})}extractISBN(t,a){if(!t||!Array.isArray(t))return null;const e=t.find(n=>n.type===a);return e?e.identifier:null}async getBookDetails(t){var a;if(console.log("📚 Google Books Get Details:",{bookId:t}),!t)return console.warn("📚 Google Books Get Details: No book ID provided"),{success:!1,error:"Book ID is required"};if(!q)return console.error("📚 Google Books Get Details: API key missing"),{success:!1,error:"Google Books API key not configured"};try{const e=`${Ie}/volumes/${t}?key=${q}`;console.log("📚 Google Books Details URL:",e);const n=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json"}});if(console.log("📚 Google Books Details Response Status:",n.status),!n.ok){const s=await n.text();return console.error("📚 Google Books Details Error:",{status:n.status,statusText:n.statusText,body:s}),{success:!1,error:`Google Books API error: ${n.status} ${n.statusText}`,details:s}}const g=await n.json();return console.log("📚 Google Books Details Success:",{id:g.id,title:(a=g.volumeInfo)==null?void 0:a.title}),{success:!0,data:this.formatBooksData([g])[0]}}catch(e){return console.error("📚 Google Books Details Error:",{message:e.message,stack:e.stack,bookId:t}),{success:!1,error:`Network error: ${e.message}`}}}}const Ot=new zt,Wt={name:"EditModal",props:{item:{type:Object,default:null},currentCategory:{type:String,default:"watchlist"}},emits:["close","save","delete"],setup(l,{emit:t}){const a=b(!1),e=b(""),n=b([]),g=b(null),s=b(null),m=b(""),r=$e({category:"watchlist",title:"",release:"",rating:"",count:"",platforms:"",genre:"",link:"",path:"",discovered:"",spielzeit:"",isAiring:!1,nextSeason:"",nextSeasonRelease:"",imageUrl:"",watchlistType:""}),L=U(()=>!!l.item),M=U(()=>r.category==="game"),P=U(()=>r.category==="series"),z=U(()=>r.category==="watchlist");ue(()=>l.item,i=>{i?Object.keys(r).forEach(w=>{r[w]=i[w]||""}):Object.keys(r).forEach(w=>{w==="category"?r[w]=l.currentCategory||"watchlist":w==="release"?r[w]=new Date().toISOString().split("T")[0]:r[w]=""})},{immediate:!0}),ue(()=>l.currentCategory,i=>{!l.item&&i&&(r.category=i)});const C=async()=>{if(!r.title){e.value="Title is required";return}if(r.category==="watchlist"&&!r.watchlistType){e.value="Please select a type for watchlist items";return}if(r.category==="watchlist"&&!r.release){e.value="Release date is required for watchlist items";return}a.value=!0,e.value="";try{const i={...r};m.value?(i.path=m.value,i.imageUrl=m.value):i.imageUrl&&i.imageUrl.trim()?i.path=i.imageUrl:(i.imageUrl=null,i.path=null),Object.keys(i).forEach(w=>{i[w]===""&&w!=="watchlistType"&&(i[w]=null)}),i.rating&&(i.rating=parseFloat(i.rating)),i.count&&(i.count=parseInt(i.count)),i.spielzeit&&(i.spielzeit=parseInt(i.spielzeit)),i.nextSeason&&(i.nextSeason=parseInt(i.nextSeason)),t("save",i)}catch(i){e.value=i.message||"Failed to save item"}finally{a.value=!1}},k=()=>{e.value="",t("close")},p=()=>{t("delete",l.item),k()},B=async()=>{if(m.value){n.value=[];return}if(g.value&&clearTimeout(g.value),!r.title||r.title.length<3){n.value=[];return}g.value=setTimeout(async()=>{try{console.log("🔍 EditModal API Search:",{title:r.title,category:r.category,watchlistType:r.watchlistType});const i=r.category==="watchlist"?r.watchlistType:r.category;if(r.category==="watchlist"&&!r.watchlistType){n.value=[];return}let w=[],G=[];if(i==="buecher"){console.log("📚 Searching Google Books API for:",r.title);const T=await Ot.searchBooks(r.title,10);T.success&&T.data?(console.log("📚 Google Books API Success:",T.data.length,"results"),G=T.data.map(_=>({title:_.title,release:_.publishedDate?W(_.publishedDate):"",genre:_.categories?_.categories.join(", "):"",platforms:"",link:_.infoLink||_.previewLink||"",imageUrl:_.imageUrl||"",rating:"",apiSource:"google_books",id:_.id,author:_.author,description:_.description,publisher:_.publisher,isbn10:_.isbn10,isbn13:_.isbn13})),console.log("📚 Formatted Google Books results:",G)):console.warn("📚 Google Books API failed:",T.error)}else console.log("🎬 Searching Media API for:",r.title,"category:",i),w=await We.searchApi(r.title,i,10),w&&w.length>0&&(G=w.map(T=>({title:T.title,release:T.release,genre:T.overview||"",platforms:T.platforms||"",link:T.link||"",imageUrl:T.image||"",rating:T.rating||"",apiSource:T.api_source||"",id:T.id||""})));G.length>0?(console.log("✅ API Search Results:",G.length,"items found"),n.value=G):(console.log("❌ No API results found"),n.value=[{title:`"${r.title}" - Keine Ergebnisse gefunden`,release:"",genre:"Bitte manuell ausfüllen",isPlaceholder:!0}])}catch(i){console.error("❌ API search failed:",i),n.value=[{title:`"${r.title}" - API nicht verfügbar`,release:"",genre:"Bitte manuell ausfüllen",isPlaceholder:!0}]}},500)},E=async i=>{if(i.isPlaceholder){n.value=[];return}if(console.log("📚 Selecting API result:",{title:i.title,apiSource:i.apiSource,author:i.author}),r.title=i.title,i.release&&(r.release=i.release),i.platforms&&(r.platforms=i.platforms),i.genre&&(r.genre=i.genre),i.link&&(r.link=i.link),i.rating&&(r.rating=i.rating),i.apiSource==="google_books"){if(console.log("📚 Filling Google Books data:",{author:i.author,description:i.description,publisher:i.publisher,isbn10:i.isbn10,isbn13:i.isbn13}),i.author&&(r.platforms=i.author),i.description){const w=r.genre||"";r.genre=w?`${w} | ${i.description.substring(0,100)}...`:i.description.substring(0,200)}if(i.publisher){const w=r.link||"";r.link=w||`Publisher: ${i.publisher}`}}i.imageUrl?(r.imageUrl=i.imageUrl,r.path=i.imageUrl):(r.imageUrl="",r.path=""),n.value=[]},F=i=>i?new Date(i).toLocaleDateString():"",W=i=>{if(!i)return"";let w;if(typeof i=="string"){if(/^\d{4}$/.test(i))return`${i}-01-01`;if(/^\d{4}-\d{2}$/.test(i))return`${i}-01`;if(/^\d{4}-\d{2}-\d{2}$/.test(i))return i;w=new Date(i)}else w=new Date(i);return isNaN(w.getTime())?(console.warn("📚 Invalid date format:",i),""):w.toISOString().split("T")[0]};return{form:r,loading:a,error:e,apiResults:n,isEditing:L,isGame:M,isSeries:P,isWatchlist:z,imageUploadRef:s,uploadedImagePath:m,handleSave:C,closeModal:k,deleteItem:p,searchApi:B,selectApiResult:E,formatDate:F,formatDateForInput:W,ensureHttpsUrl:i=>i&&(i.startsWith("http://")?i.replace("http://","https://"):i),getReleasePreview:()=>{var _;if(!r.release)return"";const i=new Date(r.release),w=new Date;w.setHours(0,0,0,0),i.setHours(0,0,0,0);const G=i.getTime()-w.getTime(),T=Math.ceil(G/(1e3*3600*24));if(T>0)return T===1?"Tomorrow!":T<=7?`${T} days left`:T<=30?`${T} days left`:`${Math.ceil(T/30)} months left`;if(T===0)return"Released today!";{const K=((_=r.watchlistType)==null?void 0:_.toLowerCase())||"media";return K==="game"?"Unplayed yet":K==="series"||K==="movie"?"Unwatched yet":"Unconsumed yet"}},triggerImageUpload:()=>{var i;(i=s.value)==null||i.click()},handleImageUpload:async i=>{const w=i.target.files[0];if(w){if(!w.type.startsWith("image/")){e.value="Please select a valid image file";return}if(w.size>10*1024*1024){e.value="Image file too large. Maximum size is 10MB";return}a.value=!0,e.value="";try{const G=r.title.replace(/[^a-zA-Z0-9\s\-_\.]/g,"").trim()||"item",T=Date.now(),_=w.name.split(".").pop()||"jpg",K=`images_downloads/uploads/${G}_${T}.${_}`,Q=await We.uploadImage(w,K);Q.success?(m.value=Q.saved,r.path=Q.saved,r.imageUrl=Q.saved):e.value=Q.error||"Failed to upload image"}catch(G){e.value=G.message||"Failed to upload image"}finally{a.value=!1}}},getImagePreviewUrl:()=>m.value?`/storage/${m.value}`:r.imageUrl?r.imageUrl.startsWith("http")?r.imageUrl:`/storage/${r.imageUrl}`:"",handleImageError:i=>{console.warn("Image preview failed:",i.target.src),i.target.style.display="none"},clearImage:()=>{r.imageUrl="",r.path="",m.value="",s.value&&(s.value.value="")},removeUploadedImage:()=>{m.value="",r.imageUrl===m.value&&(r.imageUrl=""),r.path===m.value&&(r.path=""),s.value&&(s.value.value="")}}}},jt={class:"form-header"},qt={class:"form-group category-group"},Ht={class:"form-group title-group"},Kt={class:"search-container"},Qt=["placeholder","disabled"],Jt={key:0,class:"search-results"},Xt=["onClick"],Yt={class:"result-thumbnail"},Zt=["src","alt"],$t={key:1,class:"no-image"},eo={class:"result-content"},to={class:"result-title"},oo={class:"result-meta"},so={key:0},ao={key:1},lo={key:2,class:"rating"},no={class:"form-row"},io={class:"form-group"},ro={for:"release"},co={key:0,class:"required"},uo=["required"],mo={key:0,class:"field-hint"},go={key:1,class:"release-preview"},fo={class:"form-group"},vo={class:"form-row"},po={class:"form-group"},ho={class:"form-group"},yo={class:"form-row"},bo={class:"form-group"},wo={class:"form-group"},ko={key:0,class:"form-row"},Io={class:"form-group"},So={key:0,class:"field-error"},Co={class:"form-row"},To={class:"form-group"},Ao={class:"form-group"},xo={key:1,class:"form-row"},_o={class:"form-group"},Mo={key:2,class:"form-row"},Do={class:"form-group"},Bo={key:0,class:"form-group"},Uo={key:3,class:"form-row"},Ro={class:"form-group"},Po={class:"form-row"},Fo={class:"form-group"},Lo={class:"form-group"},Eo={class:"image-upload-container"},Go=["disabled"],No={key:0,class:"upload-success"},Vo={key:4,class:"form-row"},zo={class:"form-group image-preview-group"},Oo={class:"image-preview"},Wo=["src","alt"],jo={key:5,class:"error-message"},qo={class:"modal-buttons"},Ho=["disabled"],Ko=["disabled"],Qo=["disabled"],Jo=["disabled"];function Xo(l,t,a,e,n,g){return d(),u("div",{class:"modal",onClick:t[27]||(t[27]=(...s)=>e.closeModal&&e.closeModal(...s))},[o("div",{class:"modal-content",onClick:t[26]||(t[26]=Y(()=>{},["stop"]))},[o("h2",null,f(e.isEditing?"Edit Item":"Add Item"),1),o("form",{onSubmit:t[25]||(t[25]=Y((...s)=>e.handleSave&&e.handleSave(...s),["prevent"]))},[o("div",jt,[o("div",qt,[t[29]||(t[29]=o("label",{for:"category"},"Category:",-1)),A(o("select",{id:"category","onUpdate:modelValue":t[0]||(t[0]=s=>e.form.category=s),required:""},[...t[28]||(t[28]=[Oe('<option value="watchlist" data-v-468476f7>Watchlist</option><option value="game" data-v-468476f7>Game</option><option value="series" data-v-468476f7>Series</option><option value="movie" data-v-468476f7>Movie</option><option value="buecher" data-v-468476f7>Bücher</option>',5)])],512),[[ce,e.form.category]])]),o("div",Ht,[t[30]||(t[30]=o("label",{for:"title"},"Title:",-1)),o("div",Kt,[A(o("input",{type:"text",id:"title","onUpdate:modelValue":t[1]||(t[1]=s=>e.form.title=s),onInput:t[2]||(t[2]=(...s)=>e.searchApi&&e.searchApi(...s)),required:"",placeholder:e.isWatchlist?"Enter title (API search + manual input available)":"Enter title",disabled:e.loading},null,40,Qt),[[R,e.form.title]]),e.apiResults.length>0?(d(),u("div",Jt,[(d(!0),u(me,null,ge(e.apiResults,s=>(d(),u("div",{key:s.title,class:"search-result-item",onClick:m=>e.selectApiResult(s)},[o("div",Yt,[s.imageUrl?(d(),u("img",{key:0,src:e.ensureHttpsUrl(s.imageUrl),alt:s.title},null,8,Zt)):(d(),u("div",$t,[o("span",null,f(s.title.charAt(0).toUpperCase()),1)]))]),o("div",eo,[o("div",to,f(s.title),1),o("div",oo,[s.release?(d(),u("span",so,f(e.formatDate(s.release)),1)):h("",!0),s.genre?(d(),u("span",ao,f(s.genre),1)):h("",!0),s.rating?(d(),u("span",lo,"⭐ "+f(s.rating),1)):h("",!0)])])],8,Xt))),128))])):h("",!0)])])]),o("div",no,[o("div",io,[o("label",ro,[de(f(e.isWatchlist?"Release Date:":"Release:")+" ",1),e.isWatchlist?(d(),u("span",co,"*")):h("",!0)]),A(o("input",{type:"date",id:"release","onUpdate:modelValue":t[3]||(t[3]=s=>e.form.release=s),required:e.isWatchlist},null,8,uo),[[R,e.form.release]]),e.isWatchlist?(d(),u("div",mo," 📅 Set the release date to track countdown or status ")):h("",!0),e.isWatchlist&&e.form.release?(d(),u("div",go,[t[31]||(t[31]=o("strong",null,"Preview:",-1)),de(" "+f(e.getReleasePreview()),1)])):h("",!0)]),o("div",fo,[t[32]||(t[32]=o("label",{for:"rating"},"Rating:",-1)),A(o("input",{type:"number",id:"rating","onUpdate:modelValue":t[4]||(t[4]=s=>e.form.rating=s),step:"0.1",min:"0",max:"10",placeholder:"0-10"},null,512),[[R,e.form.rating]])])]),o("div",vo,[o("div",po,[t[33]||(t[33]=o("label",{for:"views"},"Views:",-1)),A(o("input",{type:"number",id:"views","onUpdate:modelValue":t[5]||(t[5]=s=>e.form.count=s),min:"0",placeholder:"0"},null,512),[[R,e.form.count]])]),o("div",ho,[t[34]||(t[34]=o("label",{for:"discovered"},"Discovered:",-1)),A(o("input",{type:"date",id:"discovered","onUpdate:modelValue":t[6]||(t[6]=s=>e.form.discovered=s)},null,512),[[R,e.form.discovered]])])]),o("div",yo,[o("div",bo,[t[35]||(t[35]=o("label",{for:"platforms"},"Platforms:",-1)),A(o("input",{type:"text",id:"platforms","onUpdate:modelValue":t[7]||(t[7]=s=>e.form.platforms=s),placeholder:"PC, PS5, Xbox"},null,512),[[R,e.form.platforms]])]),o("div",wo,[t[36]||(t[36]=o("label",{for:"genre"},"Genre:",-1)),A(o("input",{type:"text",id:"genre","onUpdate:modelValue":t[8]||(t[8]=s=>e.form.genre=s),placeholder:"Action, Adventure, RPG"},null,512),[[R,e.form.genre]])])]),e.form.category==="watchlist"?(d(),u("div",ko,[o("div",Io,[t[38]||(t[38]=o("label",{for:"watchlistType"},[de("Type: "),o("span",{class:"required"},"*")],-1)),A(o("select",{id:"watchlistType","onUpdate:modelValue":t[9]||(t[9]=s=>e.form.watchlistType=s)},[...t[37]||(t[37]=[Oe('<option value="" data-v-468476f7>Select Type</option><option value="game" data-v-468476f7>Game</option><option value="series" data-v-468476f7>Series</option><option value="movie" data-v-468476f7>Movie</option><option value="buecher" data-v-468476f7>Bücher</option>',5)])],512),[[ce,e.form.watchlistType]]),e.form.category==="watchlist"&&!e.form.watchlistType?(d(),u("div",So," Please select a type for watchlist items ")):h("",!0)])])):h("",!0),o("div",Co,[o("div",To,[t[39]||(t[39]=o("label",{for:"link"},"Link:",-1)),A(o("input",{type:"url",id:"link","onUpdate:modelValue":t[10]||(t[10]=s=>e.form.link=s),placeholder:"https://..."},null,512),[[R,e.form.link]])]),o("div",Ao,[t[40]||(t[40]=o("label",{for:"path"},"Image Path:",-1)),A(o("input",{type:"text",id:"path","onUpdate:modelValue":t[11]||(t[11]=s=>e.form.path=s),placeholder:"images/movies/filename.jpg"},null,512),[[R,e.form.path]])])]),e.isGame?(d(),u("div",xo,[o("div",_o,[t[41]||(t[41]=o("label",{for:"playtime"},"Playtime (Minutes):",-1)),A(o("input",{type:"number",id:"playtime","onUpdate:modelValue":t[12]||(t[12]=s=>e.form.spielzeit=s),min:"0",placeholder:"0"},null,512),[[R,e.form.spielzeit]])])])):h("",!0),e.isSeries?(d(),u("div",Mo,[o("div",Do,[t[43]||(t[43]=o("label",{for:"isAiring"},"Status:",-1)),A(o("select",{id:"isAiring","onUpdate:modelValue":t[13]||(t[13]=s=>e.form.isAiring=s)},[...t[42]||(t[42]=[o("option",{value:!1},"Finished",-1),o("option",{value:!0},"Airing",-1)])],512),[[ce,e.form.isAiring]])]),e.form.isAiring?(d(),u("div",Bo,[t[44]||(t[44]=o("label",{for:"nextSeason"},"Next Season:",-1)),A(o("input",{type:"number",id:"nextSeason","onUpdate:modelValue":t[14]||(t[14]=s=>e.form.nextSeason=s),min:"1",placeholder:"1"},null,512),[[R,e.form.nextSeason]])])):h("",!0)])):h("",!0),e.form.isAiring?(d(),u("div",Uo,[o("div",Ro,[t[45]||(t[45]=o("label",{for:"nextSeasonRelease"},"Next Season Release:",-1)),A(o("input",{type:"date",id:"nextSeasonRelease","onUpdate:modelValue":t[15]||(t[15]=s=>e.form.nextSeasonRelease=s)},null,512),[[R,e.form.nextSeasonRelease]])])])):h("",!0),o("div",Po,[o("div",Fo,[t[46]||(t[46]=o("label",{for:"imageUrl"},"Image URL (optional):",-1)),A(o("input",{type:"text",id:"imageUrl","onUpdate:modelValue":t[16]||(t[16]=s=>e.form.imageUrl=s),placeholder:"https://... or leave empty for API images"},null,512),[[R,e.form.imageUrl]])]),o("div",Lo,[t[47]||(t[47]=o("label",{for:"imageUpload"},"Upload Image:",-1)),o("div",Eo,[o("input",{type:"file",id:"imageUpload",ref:"imageUploadRef",onChange:t[17]||(t[17]=(...s)=>e.handleImageUpload&&e.handleImageUpload(...s)),accept:"image/*",style:{display:"none"}},null,544),o("button",{type:"button",onClick:t[18]||(t[18]=(...s)=>e.triggerImageUpload&&e.triggerImageUpload(...s)),class:"upload-btn",disabled:e.loading}," 📁 Choose Image ",8,Go),e.uploadedImagePath?(d(),u("div",No,[de(" ✅ Image uploaded: "+f(e.uploadedImagePath)+" ",1),o("button",{type:"button",onClick:t[19]||(t[19]=(...s)=>e.removeUploadedImage&&e.removeUploadedImage(...s)),class:"remove-uploaded-btn",title:"Remove uploaded image to enable API search"}," ✕ Remove ")])):h("",!0)])])]),e.form.imageUrl||e.uploadedImagePath?(d(),u("div",Vo,[o("div",zo,[t[48]||(t[48]=o("label",null,"Image Preview:",-1)),o("div",Oo,[o("img",{src:e.getImagePreviewUrl(),alt:e.form.title,onError:t[20]||(t[20]=(...s)=>e.handleImageError&&e.handleImageError(...s))},null,40,Wo),o("button",{type:"button",onClick:t[21]||(t[21]=(...s)=>e.clearImage&&e.clearImage(...s)),class:"clear-image-btn",title:"Remove image"}," ✕ ")])])])):h("",!0),e.error?(d(),u("div",jo,f(e.error),1)):h("",!0),o("div",qo,[o("button",{type:"submit",disabled:e.loading},f(e.loading?"Saving...":"Save"),9,Ho),o("button",{type:"button",onClick:t[22]||(t[22]=(...s)=>e.closeModal&&e.closeModal(...s)),disabled:e.loading}," Cancel ",8,Ko),e.isEditing?(d(),u("button",{key:0,type:"button",onClick:t[23]||(t[23]=(...s)=>e.deleteItem&&e.deleteItem(...s)),disabled:e.loading,class:"delete-btn"}," Delete ",8,Qo)):h("",!0),o("button",{type:"button",onClick:t[24]||(t[24]=(...s)=>e.handleSave&&e.handleSave(...s)),disabled:e.loading,class:"check-btn",title:"Add to list"}," ✓ ",8,Jo)])],32)])])}const Yo=O(Wt,[["render",Xo],["__scopeId","data-v-468476f7"]]),Zo={name:"BulkAddModal",props:{show:{type:Boolean,default:!1},currentCategory:{type:String,default:""}},emits:["close","save"],setup(l,{emit:t}){const a=b(!1),e=b(null),n=b(0),g=b([]),s=b(!1),m=b({category:"",itemsText:"",defaultRating:null,defaultPlatforms:"",defaultGenre:""}),r=U(()=>{if(!m.value.itemsText||!m.value.itemsText.trim())return[];const C=m.value.itemsText.split(`
`).map(k=>k.trim()).filter(k=>k.length>0).map(k=>{const p=k.split("|").map(B=>B.trim());return{searchTerm:p[0]||"",additionalInfo:p[1]||null}});return g.value&&g.value.length>0?C.map((k,p)=>{const B=g.value[p];return{searchTerm:k.searchTerm,additionalInfo:k.additionalInfo,title:(B==null?void 0:B.title)||k.searchTerm,apiData:B||null,hasApiData:!!B}}):C.map(k=>({searchTerm:k.searchTerm,additionalInfo:k.additionalInfo,title:k.searchTerm,apiData:null,hasApiData:!1}))}),L=U(()=>m.value.category&&m.value.itemsText.trim()&&r.value&&r.value.length>0&&!s.value),M=()=>{e.value=null,t("close")},P=async()=>{if(!(!m.value.category||!m.value.itemsText||!m.value.itemsText.trim())){s.value=!0,n.value=0,g.value=[],e.value=null;try{const C=m.value.itemsText.split(`
`).map(p=>p.trim()).filter(p=>p.length>0).map(p=>p.split("|")[0].trim()),k=[];for(let p=0;p<C.length;p++){const B=C[p];n.value=Math.round((p+1)/C.length*100);try{const E=await We.searchApi(B,m.value.category,1);if(E&&E.length>0){const F=E[0];k.push({title:F.title,release:F.release,rating:F.rating?Math.round(F.rating):null,platforms:F.platforms||m.value.defaultPlatforms,genre:F.genre||m.value.defaultGenre,link:F.link,path:F.image,external_id:F.id,api_source:F.api_source})}else k.push({title:B,release:null,rating:m.value.defaultRating,platforms:m.value.defaultPlatforms,genre:m.value.defaultGenre,link:null,path:null,external_id:null,api_source:null})}catch(E){console.warn(`Search failed for "${B}":`,E),k.push({title:B,release:null,rating:m.value.defaultRating,platforms:m.value.defaultPlatforms,genre:m.value.defaultGenre,link:null,path:null,external_id:null,api_source:null})}await new Promise(E=>setTimeout(E,200))}g.value=k||[]}catch(C){e.value="Failed to search API data: "+(C.message||"Unknown error"),console.error("API search error:",C)}finally{s.value=!1,n.value=100}}},z=async()=>{if(!(!L.value||!r.value)){a.value=!0,e.value=null;try{const C=r.value.map(k=>{const p=k.apiData;return{title:k.title,category:m.value.category,release:(p==null?void 0:p.release)||null,rating:(p==null?void 0:p.rating)||m.value.defaultRating||null,platforms:(p==null?void 0:p.platforms)||m.value.defaultPlatforms||null,genre:(p==null?void 0:p.genre)||m.value.defaultGenre||null,link:(p==null?void 0:p.link)||null,path:(p==null?void 0:p.path)||null,external_id:(p==null?void 0:p.external_id)||null,count:0,is_airing:!1,spielzeit:0}});t("save",C),m.value={category:"",itemsText:"",defaultRating:null,defaultPlatforms:"",defaultGenre:""},g.value=[]}catch(C){e.value=C.message||"Failed to add items",console.error("Bulk add error:",C)}finally{a.value=!1}}};return ue([()=>m.value.category,()=>m.value.itemsText],([C,k])=>{C&&k&&k.trim()&&!s.value&&setTimeout(()=>{m.value.category===C&&m.value.itemsText===k&&!s.value&&P()},1e3)}),ue(()=>l.show,C=>{C&&l.currentCategory?m.value.category=l.currentCategory:C||(m.value={category:"",itemsText:"",defaultRating:null,defaultPlatforms:"",defaultGenre:""},g.value=[],e.value=null,s.value=!1,n.value=0)}),{loading:a,error:e,bulkData:m,previewItems:r,canSave:L,closeModal:M,searchApiData:P,saveBulkItems:z,isSearching:s,searchProgress:n}}},$o={class:"modal-header"},es={class:"modal-body"},ts={class:"bulk-add-form"},os={class:"form-group"},ss={class:"form-group"},as={class:"form-group"},ls={class:"form-group"},ns={class:"form-group"},is={key:0,class:"search-progress"},rs={class:"progress-bar"},ds={class:"progress-text"},cs={key:1,class:"preview-section"},us={class:"preview-list"},ms={class:"item-main"},gs={class:"item-title"},fs={key:0,class:"api-badge"},vs={key:1,class:"manual-badge"},ps={key:0,class:"item-info"},hs={key:1,class:"item-details"},ys={key:0,class:"item-release"},bs={key:1,class:"item-rating"},ws={key:2,class:"item-genre"},ks={key:0,class:"preview-more"},Is={class:"modal-footer"},Ss=["disabled"],Cs={key:0},Ts={key:1},As={key:2};function xs(l,t,a,e,n,g){return a.show?(d(),u("div",{key:0,class:"modal-overlay",onClick:t[9]||(t[9]=(...s)=>e.closeModal&&e.closeModal(...s))},[o("div",{class:"modal-content",onClick:t[8]||(t[8]=Y(()=>{},["stop"]))},[o("div",$o,[t[10]||(t[10]=o("h2",null,"Bulk Add Items",-1)),o("button",{class:"close-btn",onClick:t[0]||(t[0]=(...s)=>e.closeModal&&e.closeModal(...s))},"✕")]),o("div",es,[o("div",ts,[o("div",os,[t[12]||(t[12]=o("label",{for:"category"},"Category *",-1)),A(o("select",{id:"category","onUpdate:modelValue":t[1]||(t[1]=s=>e.bulkData.category=s),required:""},[...t[11]||(t[11]=[Oe('<option value="" data-v-0ecb5be6>Select Category</option><option value="game" data-v-0ecb5be6>Game</option><option value="series" data-v-0ecb5be6>Series</option><option value="movie" data-v-0ecb5be6>Movie</option><option value="buecher" data-v-0ecb5be6>Bücher</option><option value="watchlist" data-v-0ecb5be6>Watchlist</option>',6)])],512),[[ce,e.bulkData.category]])]),o("div",ss,[t[13]||(t[13]=o("label",{for:"items-text"},"Items (one per line) *",-1)),A(o("textarea",{id:"items-text","onUpdate:modelValue":t[2]||(t[2]=s=>e.bulkData.itemsText=s),placeholder:`Enter items one per line, for example:
The Witcher 3
Cyberpunk 2077
Red Dead Redemption 2`,rows:"10",required:""},null,512),[[R,e.bulkData.itemsText]]),t[14]||(t[14]=o("small",{class:"help-text"},"Enter one item per line. The system will automatically search the API for each title and use the official names, images, and details. You can add additional info using: Title | Additional Info",-1))]),o("div",as,[t[15]||(t[15]=o("label",{for:"default-rating"},"Default Rating",-1)),A(o("input",{id:"default-rating","onUpdate:modelValue":t[3]||(t[3]=s=>e.bulkData.defaultRating=s),type:"number",min:"0",max:"10",step:"0.1",placeholder:"Optional rating for all items"},null,512),[[R,e.bulkData.defaultRating,void 0,{number:!0}]])]),o("div",ls,[t[16]||(t[16]=o("label",{for:"default-platforms"},"Default Platforms",-1)),A(o("input",{id:"default-platforms","onUpdate:modelValue":t[4]||(t[4]=s=>e.bulkData.defaultPlatforms=s),type:"text",placeholder:"e.g., PC, PS5, Xbox"},null,512),[[R,e.bulkData.defaultPlatforms]])]),o("div",ns,[t[17]||(t[17]=o("label",{for:"default-genre"},"Default Genre",-1)),A(o("input",{id:"default-genre","onUpdate:modelValue":t[5]||(t[5]=s=>e.bulkData.defaultGenre=s),type:"text",placeholder:"e.g., Action, Adventure, RPG"},null,512),[[R,e.bulkData.defaultGenre]])])]),e.isSearching?(d(),u("div",is,[o("div",rs,[o("div",{class:"progress-fill",style:je({width:e.searchProgress+"%"})},null,4)]),o("span",ds,"Searching API for "+f(e.previewItems?e.previewItems.length:0)+" items... "+f(e.searchProgress)+"%",1)])):h("",!0),e.previewItems&&e.previewItems.length>0&&!e.isSearching?(d(),u("div",cs,[o("h3",null,"Preview ("+f(e.previewItems.length)+" items)",1),o("div",us,[(d(!0),u(me,null,ge(e.previewItems.slice(0,10),(s,m)=>(d(),u("div",{key:m,class:X(["preview-item",{"has-api-data":s.hasApiData}])},[o("div",ms,[o("span",gs,f(s.title),1),s.hasApiData?(d(),u("span",fs,"✓ API")):(d(),u("span",vs,"Manual"))]),s.additionalInfo?(d(),u("div",ps," | "+f(s.additionalInfo),1)):h("",!0),s.apiData?(d(),u("div",hs,[s.apiData.release?(d(),u("small",ys,f(s.apiData.release),1)):h("",!0),s.apiData.rating?(d(),u("small",bs,"⭐ "+f(s.apiData.rating),1)):h("",!0),s.apiData.genre?(d(),u("small",ws,f(s.apiData.genre),1)):h("",!0)])):h("",!0)],2))),128)),e.previewItems&&e.previewItems.length>10?(d(),u("div",ks," ... and "+f(e.previewItems.length-10)+" more items ",1)):h("",!0)])])):h("",!0)]),o("div",Is,[o("button",{class:"btn btn-secondary",onClick:t[6]||(t[6]=(...s)=>e.closeModal&&e.closeModal(...s))},"Cancel"),o("button",{class:"btn btn-primary",onClick:t[7]||(t[7]=(...s)=>e.saveBulkItems&&e.saveBulkItems(...s)),disabled:!e.canSave||e.loading},[e.loading?(d(),u("span",Cs,"Adding "+f(e.previewItems?e.previewItems.length:0)+" items...",1)):e.isSearching?(d(),u("span",Ts,"Searching API...")):(d(),u("span",As,"Add "+f(e.previewItems?e.previewItems.length:0)+" Items",1))],8,Ss)])])])):h("",!0)}const _s=O(Zo,[["render",xs],["__scopeId","data-v-0ecb5be6"]]),Ms={name:"TxtImportModal",props:{show:{type:Boolean,default:!1}},emits:["close","fileProcessed"],methods:{handleFileUpload(l){const t=l.target.files[0];if(!t)return;if(!t.name.toLowerCase().endsWith(".txt")){alert("Bitte wählen Sie eine .txt Datei aus.");return}const a=new FileReader;a.onload=e=>{const n=e.target.result;this.$emit("fileProcessed",n)},a.readAsText(t,"UTF-8")}}},Ds={class:"file-upload-area"},Bs={class:"modal-buttons"};function Us(l,t,a,e,n,g){return a.show?(d(),u("div",{key:0,class:"modal",onClick:t[3]||(t[3]=s=>l.$emit("close"))},[o("div",{class:"modal-content",onClick:t[2]||(t[2]=Y(()=>{},["stop"]))},[t[5]||(t[5]=o("h2",null,"📄 Import from TXT File",-1)),t[6]||(t[6]=o("p",null,"Wählen Sie eine .txt Datei mit einer Liste von Titeln aus, um zu prüfen, welche Items in der aktuellen Kategorie fehlen.",-1)),o("div",Ds,[o("input",{type:"file",id:"txtFileInput",accept:".txt",onChange:t[0]||(t[0]=(...s)=>g.handleFileUpload&&g.handleFileUpload(...s)),style:{display:"none"}},null,32),t[4]||(t[4]=o("label",{for:"txtFileInput",class:"file-upload-label"},[o("span",{class:"upload-icon"},"📁"),o("span",{class:"upload-text"},"TXT-Datei auswählen"),o("span",{class:"upload-hint"},"Eine .txt Datei mit einer Liste von Titeln")],-1))]),o("div",Bs,[o("button",{type:"button",onClick:t[1]||(t[1]=s=>l.$emit("close"))}," Cancel ")])])])):h("",!0)}const Rs=O(Ms,[["render",Us],["__scopeId","data-v-d761bd17"]]),Ps={name:"TxtImportResultsModal",props:{show:{type:Boolean,default:!1},results:{type:Object,default:null}},emits:["close"]},Fs={class:"results-summary"},Ls={class:"summary-item"},Es={class:"summary-value"},Gs={class:"summary-item"},Ns={class:"summary-value"},Vs={class:"summary-item"},zs={class:"summary-value existing"},Os={class:"summary-item"},Ws={class:"summary-value missing"},js={key:0,class:"missing-items"},qs={class:"items-list"},Hs={key:1,class:"existing-items"},Ks={class:"items-list"},Qs={class:"modal-buttons"};function Js(l,t,a,e,n,g){return a.show&&a.results?(d(),u("div",{key:0,class:"modal",onClick:t[2]||(t[2]=s=>l.$emit("close"))},[o("div",{class:"modal-content results-modal",onClick:t[1]||(t[1]=Y(()=>{},["stop"]))},[t[7]||(t[7]=o("h2",null,"📊 TXT Import Ergebnisse",-1)),o("div",Fs,[o("div",Ls,[t[3]||(t[3]=o("span",{class:"summary-label"},"Kategorie:",-1)),o("span",Es,f(a.results.categoryName),1)]),o("div",Gs,[t[4]||(t[4]=o("span",{class:"summary-label"},"Titel in Datei:",-1)),o("span",Ns,f(a.results.totalInFile),1)]),o("div",Vs,[t[5]||(t[5]=o("span",{class:"summary-label"},"Bereits vorhanden:",-1)),o("span",zs,f(a.results.existingItems.length),1)]),o("div",Os,[t[6]||(t[6]=o("span",{class:"summary-label"},"Fehlende Titel:",-1)),o("span",Ws,f(a.results.missingItems.length),1)])]),a.results.missingItems.length>0?(d(),u("div",js,[o("h3",null,"❌ Fehlende Titel ("+f(a.results.missingItems.length)+"):",1),o("div",qs,[(d(!0),u(me,null,ge(a.results.missingItems,(s,m)=>(d(),u("div",{key:m,class:"missing-item"},f(s),1))),128))])])):h("",!0),a.results.existingItems.length>0?(d(),u("div",Hs,[o("h3",null,"✅ Bereits vorhanden ("+f(a.results.existingItems.length)+"):",1),o("div",Ks,[(d(!0),u(me,null,ge(a.results.existingItems,(s,m)=>(d(),u("div",{key:m,class:"existing-item"},f(s),1))),128))])])):h("",!0),o("div",Qs,[o("button",{type:"button",onClick:t[0]||(t[0]=s=>l.$emit("close"))}," Schließen ")])])])):h("",!0)}const Xs=O(Ps,[["render",Js],["__scopeId","data-v-ec385b83"]]),Ys={name:"SimpleAddItem",setup(){const l=b(!1),t=b(null),a=$e({title:"Test Game",category:"game",release:"2003-01-01",count:1});return{form:a,loading:l,result:t,addItem:async()=>{l.value=!0,t.value=null;try{const n=await fetch("http://127.0.0.1:8000/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:"admin@teabubble.attrebi.ch",password:"admin123"})});if(!n.ok)throw new Error("Login failed");const s=(await n.json()).token,r=await(await fetch("http://127.0.0.1:8000/api/media",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(a)})).json();r.success?t.value={success:!0,message:`Success! Item added with ID: ${r.data.id}`}:t.value={success:!1,message:`Error: ${JSON.stringify(r)}`}}catch(n){t.value={success:!1,message:`Error: ${n.message}`}}finally{l.value=!1}}}}},Zs={class:"simple-add-item"},$s=["disabled"];function ea(l,t,a,e,n,g){return d(),u("div",Zs,[t[10]||(t[10]=o("h3",null,"Simple Add Item Test",-1)),o("form",{onSubmit:t[4]||(t[4]=Y((...s)=>e.addItem&&e.addItem(...s),["prevent"]))},[o("div",null,[t[5]||(t[5]=o("label",null,"Title:",-1)),A(o("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>e.form.title=s),type:"text",required:""},null,512),[[R,e.form.title]])]),o("div",null,[t[7]||(t[7]=o("label",null,"Category:",-1)),A(o("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>e.form.category=s)},[...t[6]||(t[6]=[o("option",{value:"game"},"Game",-1),o("option",{value:"movie"},"Movie",-1),o("option",{value:"series"},"Series",-1)])],512),[[ce,e.form.category]])]),o("div",null,[t[8]||(t[8]=o("label",null,"Release:",-1)),A(o("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>e.form.release=s),type:"date"},null,512),[[R,e.form.release]])]),o("div",null,[t[9]||(t[9]=o("label",null,"Count:",-1)),A(o("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>e.form.count=s),type:"number",min:"0"},null,512),[[R,e.form.count]])]),o("button",{type:"submit",disabled:e.loading},f(e.loading?"Adding...":"Add Item"),9,$s)],32),e.result?(d(),u("div",{key:0,class:X(["result",e.result.success?"success":"error"])},f(e.result.message),3)):h("",!0)])}const ta=O(Ys,[["render",ea],["__scopeId","data-v-af6703da"]]),oa={name:"MessageBox",props:{show:{type:Boolean,default:!1},type:{type:String,default:"info",validator:l=>["success","error","warning","info"].includes(l)},title:{type:String,default:""},message:{type:String,required:!0},details:{type:String,default:""}},emits:["close"],setup(l,{emit:t}){const a=()=>{t("close")},e=U(()=>{switch(l.type){case"success":return"✅";case"error":return"❌";case"warning":return"⚠️";case"info":return"ℹ️";default:return"ℹ️"}}),n=U(()=>`message-${l.type}`);return{closeMessage:a,icon:e,messageType:n}}},sa={class:"message-header"},aa={class:"message-icon"},la={class:"message-title"},na={class:"message-body"},ia={key:0,class:"message-details"},ra={class:"message-footer"};function da(l,t,a,e,n,g){return a.show?(d(),u("div",{key:0,class:"message-overlay",onClick:t[3]||(t[3]=(...s)=>e.closeMessage&&e.closeMessage(...s))},[o("div",{class:X(["message-box",e.messageType]),onClick:t[2]||(t[2]=Y(()=>{},["stop"]))},[o("div",sa,[o("span",aa,f(e.icon),1),o("h3",la,f(a.title),1),o("button",{class:"close-btn",onClick:t[0]||(t[0]=(...s)=>e.closeMessage&&e.closeMessage(...s))},"✕")]),o("div",na,[o("p",null,f(a.message),1),a.details?(d(),u("div",ia,[o("pre",null,f(a.details),1)])):h("",!0)]),o("div",ra,[o("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=(...s)=>e.closeMessage&&e.closeMessage(...s))},"OK")])],2)])):h("",!0)}const ca=O(oa,[["render",da],["__scopeId","data-v-fca96fb5"]]),ua={name:"ConfirmDialog",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm Action"},message:{type:String,required:!0}},emits:["confirm","close"],setup(l,{emit:t}){const a=()=>{t("close")};return{closeDialog:a,confirmAction:()=>{t("confirm"),a()}}}},ma={class:"confirm-header"},ga={class:"confirm-title"},fa={class:"confirm-body"},va={class:"confirm-footer"};function pa(l,t,a,e,n,g){return a.show?(d(),u("div",{key:0,class:"confirm-overlay",onClick:t[4]||(t[4]=(...s)=>e.closeDialog&&e.closeDialog(...s))},[o("div",{class:"confirm-dialog",onClick:t[3]||(t[3]=Y(()=>{},["stop"]))},[o("div",ma,[o("h3",ga,f(a.title),1),o("button",{class:"close-btn",onClick:t[0]||(t[0]=(...s)=>e.closeDialog&&e.closeDialog(...s))},"✕")]),o("div",fa,[o("p",null,f(a.message),1)]),o("div",va,[o("button",{class:"btn btn-secondary",onClick:t[1]||(t[1]=(...s)=>e.closeDialog&&e.closeDialog(...s))},"Cancel"),o("button",{class:"btn btn-danger",onClick:t[2]||(t[2]=(...s)=>e.confirmAction&&e.confirmAction(...s))},"Confirm")])])])):h("",!0)}const ha=O(ua,[["render",pa],["__scopeId","data-v-b56b6a08"]]),ya={name:"InputDialog",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Input Required"},message:{type:String,required:!0},placeholder:{type:String,default:""},inputType:{type:String,default:"text"},defaultValue:{type:String,default:""}},emits:["confirm","close"],setup(l,{emit:t}){const a=b(""),e=b(null),n=()=>{t("close")},g=()=>{t("confirm",a.value),n()};return ue(()=>l.show,async s=>{s&&(a.value=l.defaultValue,await it(),e.value&&(e.value.focus(),e.value.select()))}),{inputValue:a,inputRef:e,closeDialog:n,confirmAction:g}}},ba={class:"input-header"},wa={class:"input-title"},ka={class:"input-body"},Ia={class:"input-message"},Sa=["type","placeholder"],Ca={class:"input-footer"};function Ta(l,t,a,e,n,g){return a.show?(d(),u("div",{key:0,class:"input-overlay",onClick:t[6]||(t[6]=(...s)=>e.closeDialog&&e.closeDialog(...s))},[o("div",{class:"input-dialog",onClick:t[5]||(t[5]=Y(()=>{},["stop"]))},[o("div",ba,[o("h3",wa,f(a.title),1),o("button",{class:"close-btn",onClick:t[0]||(t[0]=(...s)=>e.closeDialog&&e.closeDialog(...s))},"✕")]),o("div",ka,[o("p",Ia,f(a.message),1),A(o("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>e.inputValue=s),type:a.inputType,placeholder:a.placeholder,class:"input-field",onKeyup:t[2]||(t[2]=nt((...s)=>e.confirmAction&&e.confirmAction(...s),["enter"])),ref:"inputRef"},null,40,Sa),[[lt,e.inputValue]])]),o("div",Ca,[o("button",{class:"btn btn-secondary",onClick:t[3]||(t[3]=(...s)=>e.closeDialog&&e.closeDialog(...s))},"Cancel"),o("button",{class:"btn btn-primary",onClick:t[4]||(t[4]=(...s)=>e.confirmAction&&e.confirmAction(...s))},"OK")])])])):h("",!0)}const Aa=O(ya,[["render",Ta],["__scopeId","data-v-e3a01eb7"]]),xa={name:"MediaLibrary",components:{MediaItem:Pt,Sidebar:ct,MainHeader:gt,FloatingActionButton:Vt,LoginModal:mt,RegisterModal:ut,EditModal:Yo,BulkAddModal:_s,TxtImportModal:Rs,TxtImportResultsModal:Xs,SimpleAddItem:ta,LoadingSpinner:ft,MessageBox:ca,ConfirmDialog:ha,InputDialog:Aa},setup(){const l=et(),t=tt(),a=ot(),e=st(),n=Ze(),g=b(!1),s=b(null),{sidebarCollapsed:m,mobileSidebarOpen:r,showLoginModal:L,showRegisterModal:M,showEditModal:P,showFloatingMenu:z,showBulkAddModal:C,showTxtImportModal:k,showTxtImportResults:p,editingItem:B,gridColumns:E,sortBy:F,categories:W,txtImportResults:x,isLoggedIn:Z,isAdmin:H,userName:fe,currentCategory:$,searchQuery:j,categoryCounts:ve,loading:oe,error:i,paginatedMedia:w,platforms:G,genres:T,toggleSidebar:_,toggleMobileSidebar:K,closeMobileSidebar:Q,setCategory:pe,clearSearch:Se,togglePlatformFilter:Ce,toggleGenreFilter:Te,toggleAiringFilter:Ae,editItem:xe,closeEditModal:_e,closeBulkAddModal:Me,handleBulkAddItems:he,handleSaveItem:ye,handleDeleteItem:De,logout:Be,loadMedia:ee,toggleFloatingMenu:Ue,addNewItem:te,bulkAddItems:Re,importFromTxt:Pe,importFromAPI:Fe,createCollection:Le,exportMediaCollection:Ee,exportAsCSV:Ge,exportAsJSON:se,downloadFile:Ne,deleteAllInCategory:Ve,getCategoryDisplayName:ae,navigateToBooks:be,navigateToStatistics:we,navigateToCalendar:ke,navigateToFeatures:le,navigateToProfile:qe,processTxtContent:He,closeTxtImportResults:Ke,cleanup:Qe,router:ze}=vt(),Je=U(()=>{try{return ae?ae($.value):$.value}catch(y){return console.error("Error getting category display name:",y),$.value||"Unknown"}}),Xe=y=>{pe(y),te()},c=()=>{L.value=!1,M.value=!0},v=()=>{L.value=!0},D=y=>{L.value=!1,ee()},I=()=>{M.value=!1,ee()},S=async()=>{g.value=!0,s.value=null;try{console.log("🔧 Starting admin setup...");const y=await n.adminSetup();y.success?(console.log("✅ Admin setup successful:",y),s.value={type:"success",text:`✅ Admin created and logged in! User: ${y.user.name} (${y.user.email})`},await ee(),setTimeout(()=>{s.value=null},5e3)):(console.log("ℹ️ Admin already exists:",y),s.value={type:"info",text:`ℹ️ ${y.message} (${y.admin_count} admin(s) exist)`},setTimeout(()=>{s.value=null},3e3))}catch(y){console.error("❌ Admin setup failed:",y),s.value={type:"error",text:`❌ Admin setup failed: ${y.message||"Unknown error"}`},setTimeout(()=>{s.value=null},5e3)}finally{g.value=!1}},N=()=>{console.log("🔥 DEBUG: Direct admin navigation called!"),console.log("🔥 DEBUG: Router object:",ze);try{ze.push("/admin"),console.log("🔥 DEBUG: Successfully navigated to /admin!")}catch(y){console.error("🔥 DEBUG: Error navigating to admin:",y)}};return rt(async()=>{try{if(await ee(),Z.value)try{l.initializeRealtimeUpdates()}catch(y){console.error("Error initializing realtime updates:",y)}}catch(y){console.error("Error during initialization:",y)}}),dt(()=>{if(Z.value)try{l.cleanupRealtimeUpdates()}catch(y){console.error("Error cleaning up realtime updates:",y)}Qe()}),{sidebarCollapsed:m,mobileSidebarOpen:r,showLoginModal:L,showRegisterModal:M,showEditModal:P,showFloatingMenu:z,showBulkAddModal:C,showTxtImportModal:k,showTxtImportResults:p,editingItem:B,gridColumns:E,sortBy:F,categories:W,txtImportResults:x,adminSetupLoading:g,adminSetupMessage:s,isLoggedIn:Z,isAdmin:H,userName:fe,currentCategory:$,currentCategoryDisplayName:Je,searchQuery:j,categoryCounts:ve,loading:oe,error:i,paginatedMedia:w,platforms:G,genres:T,toggleSidebar:_,toggleMobileSidebar:K,closeMobileSidebar:Q,setCategory:pe,clearSearch:Se,navigateToBooks:be,navigateToStatistics:we,navigateToCalendar:ke,navigateToFeatures:le,navigateToProfile:qe,addItemFromSidebar:Xe,togglePlatformFilter:Ce,toggleGenreFilter:Te,toggleAiringFilter:Ae,editItem:xe,switchToRegister:c,showAdminLogin:v,handleLoginSuccess:D,handleRegisterSuccess:I,handleAdminSetup:S,debugNavigateToAdmin:N,closeEditModal:_e,closeBulkAddModal:Me,handleBulkAddItems:he,handleSaveItem:ye,handleDeleteItem:De,logout:Be,loadMedia:ee,toggleFloatingMenu:Ue,addNewItem:te,bulkAddItems:Re,importFromTxt:Pe,importFromAPI:Fe,createCollection:Le,exportMediaCollection:Ee,exportAsCSV:Ge,exportAsJSON:se,downloadFile:Ne,deleteAllInCategory:Ve,getCategoryDisplayName:ae,processTxtContent:He,closeTxtImportResults:Ke,messageStore:t,confirmStore:a,inputStore:e}}},_a={class:"vue-app"},Ma={class:"main-content"},Da={class:"content-area"},Ba={key:1,class:"error"},Ua={key:2},Ra={key:0,class:"admin-setup-container"},Pa=["disabled"],Fa={key:0},La={key:1};function Ea(l,t,a,e,n,g){const s=V("Sidebar"),m=V("MainHeader"),r=V("LoadingSpinner"),L=V("MediaItem"),M=V("LoginModal"),P=V("RegisterModal"),z=V("EditModal"),C=V("BulkAddModal"),k=V("TxtImportModal"),p=V("TxtImportResultsModal"),B=V("FloatingActionButton"),E=V("MessageBox"),F=V("ConfirmDialog"),W=V("InputDialog");return d(),u("div",_a,[o("div",{class:X(["mobile-overlay",{show:e.mobileSidebarOpen}]),onClick:t[0]||(t[0]=(...x)=>e.closeMobileSidebar&&e.closeMobileSidebar(...x))},null,2),J(s,{collapsed:e.sidebarCollapsed,"mobile-open":e.mobileSidebarOpen,"is-logged-in":e.isLoggedIn,"is-admin":e.isAdmin,"user-name":e.userName,"current-category":e.currentCategory,"category-counts":e.categoryCounts,platforms:e.platforms,genres:e.genres,categories:e.categories,onToggle:e.toggleSidebar,onSetCategory:e.setCategory,onNavigateToBooks:e.navigateToBooks,onNavigateToStatistics:e.navigateToStatistics,onNavigateToCalendar:e.navigateToCalendar,onNavigateToFeatures:e.navigateToFeatures,onNavigateToProfile:e.navigateToProfile,onNavigateToAdmin:e.debugNavigateToAdmin,onTogglePlatformFilter:e.togglePlatformFilter,onToggleGenreFilter:e.toggleGenreFilter,onToggleAiringFilter:e.toggleAiringFilter,onAddItem:e.addItemFromSidebar,onShowLogin:t[1]||(t[1]=x=>e.showLoginModal=!0),onShowRegister:t[2]||(t[2]=x=>e.showRegisterModal=!0),onShowAdminLogin:e.showAdminLogin,onLogout:e.logout},null,8,["collapsed","mobile-open","is-logged-in","is-admin","user-name","current-category","category-counts","platforms","genres","categories","onToggle","onSetCategory","onNavigateToBooks","onNavigateToStatistics","onNavigateToCalendar","onNavigateToFeatures","onNavigateToProfile","onNavigateToAdmin","onTogglePlatformFilter","onToggleGenreFilter","onToggleAiringFilter","onAddItem","onShowAdminLogin","onLogout"]),o("div",Ma,[J(m,{"search-query":e.searchQuery,"onUpdate:searchQuery":t[3]||(t[3]=x=>e.searchQuery=x),"grid-columns":e.gridColumns,"onUpdate:gridColumns":t[4]||(t[4]=x=>e.gridColumns=x),"sort-by":e.sortBy,"onUpdate:sortBy":t[5]||(t[5]=x=>e.sortBy=x),onToggleMobileSidebar:e.toggleMobileSidebar,onClearSearch:e.clearSearch},null,8,["search-query","grid-columns","sort-by","onToggleMobileSidebar","onClearSearch"]),o("main",Da,[e.loading?(d(),re(r,{key:0,message:"Loading media data..."})):e.error?(d(),u("div",Ba,[o("p",null,f(e.error),1),o("button",{onClick:t[6]||(t[6]=(...x)=>e.loadMedia&&e.loadMedia(...x))},"Retry")])):(d(),u("div",Ua,[o("div",{class:"grid",style:je({gridTemplateColumns:`repeat(${e.gridColumns}, 1fr)`})},[(d(!0),u(me,null,ge(e.paginatedMedia,x=>(d(),re(L,{key:x.id,item:x,onEdit:e.editItem},null,8,["item","onEdit"]))),128))],4)]))])]),e.isLoggedIn?h("",!0):(d(),u("div",Ra,[o("button",{onClick:t[7]||(t[7]=(...x)=>e.handleAdminSetup&&e.handleAdminSetup(...x)),disabled:e.adminSetupLoading,class:"admin-setup-btn",title:"Setup Admin Account (Creates admin@teabubble.attrebi.ch / admin123)"},[e.adminSetupLoading?(d(),u("span",Fa,"🔧 Setting up...")):(d(),u("span",La,"🔧 Admin Setup"))],8,Pa),e.adminSetupMessage?(d(),u("div",{key:0,class:X(["admin-setup-message",e.adminSetupMessage.type])},f(e.adminSetupMessage.text),3)):h("",!0)])),e.showLoginModal?(d(),re(M,{key:1,onClose:t[8]||(t[8]=x=>e.showLoginModal=!1),onSuccess:e.handleLoginSuccess,onSwitchToRegister:e.switchToRegister},null,8,["onSuccess","onSwitchToRegister"])):h("",!0),e.showRegisterModal?(d(),re(P,{key:2,onClose:t[9]||(t[9]=x=>e.showRegisterModal=!1),onSuccess:e.handleRegisterSuccess},null,8,["onSuccess"])):h("",!0),e.showEditModal?(d(),re(z,{key:3,item:e.editingItem,"current-category":e.currentCategory,onClose:e.closeEditModal,onSave:e.handleSaveItem,onDelete:e.handleDeleteItem},null,8,["item","current-category","onClose","onSave","onDelete"])):h("",!0),J(C,{show:e.showBulkAddModal,"current-category":e.currentCategory,onClose:e.closeBulkAddModal,onSave:e.handleBulkAddItems},null,8,["show","current-category","onClose","onSave"]),J(k,{show:e.showTxtImportModal,onClose:t[10]||(t[10]=x=>e.showTxtImportModal=!1),onFileProcessed:e.processTxtContent},null,8,["show","onFileProcessed"]),J(p,{show:e.showTxtImportResults,results:e.txtImportResults,onClose:e.closeTxtImportResults},null,8,["show","results","onClose"]),J(B,{"show-menu":e.showFloatingMenu,"show-delete-all":e.isLoggedIn&&e.currentCategory!=="all"&&e.categoryCounts[e.currentCategory]>0,"category-name":e.currentCategoryDisplayName,"item-count":e.categoryCounts[e.currentCategory]||0,onToggleMenu:e.toggleFloatingMenu,onAddNewItem:e.addNewItem,onBulkAddItems:e.bulkAddItems,onImportFromTxt:e.importFromTxt,onImportFromApi:e.importFromAPI,onCreateCollection:e.createCollection,onDeleteAllInCategory:e.deleteAllInCategory},null,8,["show-menu","show-delete-all","category-name","item-count","onToggleMenu","onAddNewItem","onBulkAddItems","onImportFromTxt","onImportFromApi","onCreateCollection","onDeleteAllInCategory"]),J(E,{show:e.messageStore.show,type:e.messageStore.type,title:e.messageStore.title,message:e.messageStore.message,details:e.messageStore.details,onClose:e.messageStore.closeMessage},null,8,["show","type","title","message","details","onClose"]),J(F,{show:e.confirmStore.show,title:e.confirmStore.title,message:e.confirmStore.message,onConfirm:e.confirmStore.confirm,onClose:e.confirmStore.cancel},null,8,["show","title","message","onConfirm","onClose"]),J(W,{show:e.inputStore.show,title:e.inputStore.title,message:e.inputStore.message,placeholder:e.inputStore.placeholder,"input-type":e.inputStore.inputType,"default-value":e.inputStore.defaultValue,onConfirm:e.inputStore.confirm,onClose:e.inputStore.cancel},null,8,["show","title","message","placeholder","input-type","default-value","onConfirm","onClose"])])}const ja=O(xa,[["render",Ea],["__scopeId","data-v-00efb3cd"]]);export{ja as default};
