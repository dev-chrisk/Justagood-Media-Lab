import{A as zt,d as Pe,r as b,w as Ce,c as z,m as fe,u as jt,a as Oe,_ as oe,b as u,e as s,f as y,t as f,n as J,g as Ae,h as ue,i as Te,o as d,j as be,F as se,k as ae,l as ie,p as Ve,q as Me,s as U,v as G,x as lt,y as ke,z as dt,B as xe,C as Yt,D as qt,E as Ht,G as Qt}from"./index-By6yLuuf.js";class Jt{constructor(){this.isConnected={value:!1},this.listeners=new Map,this.pollingInterval=null,this.lastUpdate=null,this.pollingIntervalMs=2e4}getApiBaseUrl(){return zt.BASE_URL}connect(){if(this.pollingInterval)return;const e=localStorage.getItem("authToken"),a=localStorage.getItem("currentUser");!e||!a||(this.isConnected.value=!0,this.lastUpdate=new Date,this.pollingInterval=setInterval(()=>{this.checkForUpdates()},this.pollingIntervalMs))}async checkForUpdates(){try{const e=localStorage.getItem("authToken"),a=localStorage.getItem("currentUser");if(!e||!a)return;const t=this.getApiBaseUrl(),o=await fetch(`${t}/api/media`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!o.ok){if(o.status===401){this.disconnect();return}throw new Error(`HTTP error! status: ${o.status}`)}const r=await o.json();r&&r.length>0&&this.listeners.forEach((i,l)=>{try{i({type:"media_updated",items:r,count:r.length,timestamp:new Date().toISOString()})}catch{}}),this.lastUpdate=new Date}catch{}}addListener(e,a){this.listeners.set(e,a)}removeListener(e){this.listeners.delete(e)}disconnect(){this.pollingInterval&&(clearInterval(this.pollingInterval),this.pollingInterval=null),this.isConnected.value=!1}destroy(){this.disconnect(),this.listeners.clear()}}const Ze=new Jt,ze=Pe("media",()=>{const n=()=>{try{return localStorage.getItem("currentCategory")||"game"}catch(h){return console.error("Failed to load current category from localStorage:",h),"game"}},e=h=>{try{localStorage.setItem("currentCategory",h)}catch(S){console.error("Failed to save current category to localStorage:",S)}},a=()=>{try{return localStorage.getItem("searchQuery")||""}catch(h){return console.error("Failed to load search query from localStorage:",h),""}},t=h=>{try{localStorage.setItem("searchQuery",h)}catch(S){console.error("Failed to save search query to localStorage:",S)}},o=b(A()),r=b(n()),i=b(a()),l=b(null),g=b([]),c=b(!1),T=b(null);Ce(r,h=>{e(h)},{immediate:!1}),Ce(i,h=>{t(h)},{immediate:!1});function A(){try{const h=localStorage.getItem("authToken"),S=localStorage.getItem("currentUser");if(!h||!S){const C=localStorage.getItem("mediaData");return C?JSON.parse(C):[]}return[]}catch(h){return console.error("Failed to load media from storage:",h),[]}}function I(){try{const h=localStorage.getItem("authToken"),S=localStorage.getItem("currentUser");(!h||!S)&&localStorage.setItem("mediaData",JSON.stringify(o.value))}catch(h){console.error("Failed to save media to storage:",h)}}const k=z(()=>o.value.length),K=z(()=>{const h={};return o.value.forEach(S=>{const C=S.category||"unknown";h[C]=(h[C]||0)+1}),h}),X=z(()=>{let h=[...o.value];if(r.value&&r.value!=="all"&&(h=h.filter(S=>r.value==="watchlist"?S.category==="watchlist"||S.isNew===!0:S.category===r.value)),g.value&&g.value.length>0&&(h=h.filter(S=>{if(!S.genre)return!1;const C=S.genre.split(",").map(M=>M.trim().toLowerCase());return g.value.some(M=>C.some(_=>_.includes(M.toLowerCase())))})),i.value){const S=i.value.toLowerCase();h=h.filter(C=>{var M,_,F,re;return((M=C.title)==null?void 0:M.toLowerCase().includes(S))||((_=C.description)==null?void 0:_.toLowerCase().includes(S))||((F=C.genre)==null?void 0:F.toLowerCase().includes(S))||((re=C.platforms)==null?void 0:re.toLowerCase().includes(S))})}return h});async function V(){var h,S;c.value=!0,T.value=null;try{const C=localStorage.getItem("authToken"),M=localStorage.getItem("currentUser");if(C&&M)try{const _=await fe.getMedia();o.value=_||[]}catch(_){console.warn("API load failed for logged in user:",_),o.value=[]}else{const _=A();if(_.length>0)o.value=_;else{const F=await fe.getMedia();o.value=F||[],I()}}}catch(C){T.value=((S=(h=C.response)==null?void 0:h.data)==null?void 0:S.message)||C.message||"Failed to load media data",console.error("Failed to load media:",C)}finally{c.value=!1}}function le(h){r.value=h}function pe(h){i.value=h}function me(h){l.value=h}function m(){l.value=null}function O(h){g.value=h}function de(){g.value=[]}async function ce(h,S=!1){var C,M,_;T.value=null;try{const F=localStorage.getItem("authToken"),re=localStorage.getItem("currentUser");if(F&&re)try{const ne=await fe.addMediaItem(h);if(!S)await V();else{const E={...ne,__order:o.value.length};o.value.push(E)}return ne}catch(ne){if(((C=ne.response)==null?void 0:C.status)===409&&((_=(M=ne.response)==null?void 0:M.data)!=null&&_.duplicate)){const E=new Error(ne.response.data.error||"Ein Eintrag mit diesem Titel und dieser Kategorie existiert bereits.");throw E.isDuplicate=!0,E}throw T.value=ne.message||"Failed to add media item",console.error("API save failed for logged in user:",ne),ne}else{const ne={id:Date.now(),...h,__order:o.value.length};return o.value.push(ne),I(),ne}}catch(F){throw F}}async function Se(h,S){T.value=null;try{const C=localStorage.getItem("authToken"),M=localStorage.getItem("currentUser");if(C&&M)try{const _=await fe.updateMediaItem(h,S);return await V(),_}catch(_){throw console.error("API update failed for logged in user:",_),_}else{const _=o.value.findIndex(F=>F.id===h);if(_!==-1)return o.value[_]={...o.value[_],...S},I(),o.value[_];throw new Error("Media item not found")}}catch(C){throw C.isDuplicate||(T.value=C.message||"Failed to update media item"),C}}async function ve(h){var S;try{const C=localStorage.getItem("authToken"),M=localStorage.getItem("currentUser");if(C&&M)try{return await fe.deleteMediaItem(h),await V(),!0}catch(_){if(((S=_.response)==null?void 0:S.status)===404||_.isNotFound)return await V(),!0;throw console.error("API delete failed for logged in user:",_),_}else{const _=o.value.findIndex(F=>F.id===h);if(_!==-1)return o.value.splice(_,1),I(),!0;throw new Error("Media item not found")}}catch(C){throw T.value=C.message||"Failed to delete media item",C}}async function _e(h){try{const S=localStorage.getItem("authToken"),C=localStorage.getItem("currentUser");if(S&&C)try{const M=await fe.batchAddMediaItems(h);return await V(),M}catch(M){throw console.error("API batch add failed for logged in user:",M),M}else{const M=h.map((_,F)=>({id:Date.now()+F,..._,__order:o.value.length+F}));return o.value.push(...M),I(),{success:!0,stats:{created:M.length,failed:0,errors:[]}}}}catch(S){throw T.value=S.message||"Failed to add media items",S}}async function Ie(h){try{const S=localStorage.getItem("authToken"),C=localStorage.getItem("currentUser");if(S&&C)try{return await fe.batchDeleteMediaItems(h),await V(),!0}catch(M){if(M.silent)return console.log("Silent batch delete error (some items may not exist):",M.message),await V(),!0;throw console.error("API batch delete failed for logged in user:",M),M}else return o.value=o.value.filter(M=>!h.includes(M.id)),I(),!0}catch(S){throw S.silent||(T.value=S.message||"Failed to delete media items"),S}}async function $(){try{const h=localStorage.getItem("authToken"),S=localStorage.getItem("currentUser");h&&S?await fe.saveMedia(o.value):I()}catch(h){console.error("Failed to save media:",h)}}function j(){T.value=null}function v(h){if(console.log("Processing real-time update:",h),h.type==="media_updated"&&h.items)h.items.forEach(S=>{const C=o.value.findIndex(M=>M.id===S.id);C!==-1?o.value[C]={...o.value[C],...S}:o.value.push(S)});else if(h.action==="created"||h.action==="updated"){const S=h.item,C=o.value.findIndex(M=>M.id===S.id);C!==-1?o.value[C]={...o.value[C],...S}:o.value.push(S)}else if(h.action==="deleted"){const S=o.value.findIndex(C=>C.id===h.id);S!==-1&&o.value.splice(S,1)}I()}function x(){const h=localStorage.getItem("authToken"),S=localStorage.getItem("currentUser");if(!h||!S){console.log("Skipping realtime initialization - user not authenticated");return}try{Ze.addListener("media-store",v),Ze.connect()}catch(C){console.error("Failed to initialize realtime updates:",C)}}function H(){Ze.removeListener("media-store")}return{mediaData:o,currentCategory:r,searchQuery:i,selectedGenre:l,selectedGenres:g,loading:c,error:T,totalItems:k,categoryCounts:K,filteredMedia:X,loadMedia:V,setCategory:le,setSearchQuery:pe,setGenre:me,clearGenre:m,setGenres:O,clearGenres:de,addMediaItem:ce,updateMediaItem:Se,deleteMediaItem:ve,batchAddMediaItems:_e,batchDeleteMediaItems:Ie,saveMedia:$,clearError:j,initializeRealtimeUpdates:x,cleanupRealtimeUpdates:H,resetMediaState:()=>{r.value="game",i.value="",localStorage.removeItem("currentCategory"),localStorage.removeItem("searchQuery")}}}),ct=Pe("message",()=>{const n=b(!1),e=b("info"),a=b(""),t=b(""),o=b("");function r(A){e.value=A.type||"info",a.value=A.title||"",t.value=A.message||"",o.value=A.details||"",n.value=!0}function i(A,I="Success",k=""){r({type:"success",title:I,message:A,details:k})}function l(A,I="Error",k=""){r({type:"error",title:I,message:A,details:k})}function g(A,I="Warning",k=""){r({type:"warning",title:I,message:A,details:k})}function c(A,I="Info",k=""){r({type:"info",title:I,message:A,details:k})}function T(){n.value=!1,setTimeout(()=>{e.value="info",a.value="",t.value="",o.value=""},300)}return{show:n,type:e,title:a,message:t,details:o,showMessage:r,showSuccess:i,showError:l,showWarning:g,showInfo:c,closeMessage:T}}),ut=Pe("confirm",()=>{const n=b(!1),e=b("Confirm Action"),a=b(""),t=b(null);function o(l){return new Promise(g=>{e.value=l.title||"Confirm Action",a.value=l.message||"",n.value=!0,t.value=g})}function r(){t.value&&(t.value(!0),t.value=null),n.value=!1}function i(){t.value&&(t.value(!1),t.value=null),n.value=!1}return{show:n,title:e,message:a,showConfirm:o,confirm:r,cancel:i}}),mt=Pe("input",()=>{const n=b(!1),e=b("Input Required"),a=b(""),t=b(""),o=b("text"),r=b(""),i=b(null);function l(T){return new Promise(A=>{e.value=T.title||"Input Required",a.value=T.message||"",t.value=T.placeholder||"",o.value=T.inputType||"text",r.value=T.defaultValue||"",n.value=!0,i.value=A})}function g(T){i.value&&(i.value(T),i.value=null),n.value=!1}function c(){i.value&&(i.value(null),i.value=null),n.value=!1}return{show:n,title:e,message:a,placeholder:t,inputType:o,defaultValue:r,showInput:l,confirm:g,cancel:c}}),gt=Pe("sidebar",()=>{const n=()=>{try{const k=localStorage.getItem("sidebarState");if(k)return{collapsed:JSON.parse(k).collapsed||!1,mobileOpen:!1}}catch(k){console.error("Failed to load sidebar state from localStorage:",k)}return{collapsed:!1,mobileOpen:!1}},e=k=>{try{localStorage.setItem("sidebarState",JSON.stringify({collapsed:k.collapsed}))}catch(K){console.error("Failed to save sidebar state to localStorage:",K)}},a=n(),t=b(a.collapsed),o=b(a.mobileOpen);Ce(t,k=>{e({collapsed:k,mobileOpen:o.value})},{immediate:!1});const r=()=>{t.value=!t.value},i=()=>{o.value=!o.value},l=()=>{o.value=!1},g=k=>{t.value=k},c=k=>{o.value=k},T=()=>{t.value=!1,o.value=!1,localStorage.removeItem("sidebarState")},A=z(()=>t.value),I=z(()=>o.value);return{collapsed:t,mobileOpen:o,toggleSidebar:r,toggleMobileSidebar:i,closeMobileSidebar:l,setCollapsed:g,setMobileOpen:c,resetSidebarState:T,isCollapsed:A,isMobileOpen:I}});function Kt(){const n=jt(),e=Oe(),a=ze(),t=ct(),o=ut(),r=mt(),i=b(!1),l=b(!1),g=b(!1),c=b(!1),T=b(!1),A=b(!1),I=b(!1),k=b(null),K=()=>typeof window<"u"?window.innerWidth>768?8:3:8,X=b(K()),V=b("order_asc"),le=b(null),pe=()=>{X.value=K()};typeof window<"u"&&window.addEventListener("resize",pe);const me=[{key:"game",name:"Games",icon:"ðŸŽ®"},{key:"series",name:"Series",icon:"ðŸ“º"},{key:"movie",name:"Movies",icon:"ðŸŽ¬"},{key:"buecher",name:"BÃ¼cher",icon:"ðŸ“š"},{key:"watchlist",name:"Watchlist",icon:"â¤ï¸"}],m=z(()=>{try{return e.isLoggedIn}catch(D){return console.error("Error accessing authStore.isLoggedIn:",D),!1}}),O=z(()=>{try{return e.userName}catch(D){return console.error("Error accessing authStore.userName:",D),""}}),de=z(()=>{try{return e.isAdmin}catch(D){return console.error("Error accessing authStore.isAdmin:",D),!1}}),ce=z(()=>{try{return a.currentCategory}catch(D){return console.error("Error accessing mediaStore.currentCategory:",D),"game"}}),Se=z({get:()=>{try{return a.searchQuery}catch(D){return console.error("Error accessing mediaStore.searchQuery:",D),""}},set:D=>{try{a.setSearchQuery(D)}catch(P){console.error("Error setting mediaStore.searchQuery:",P)}}}),ve=z(()=>{try{return a.categoryCounts}catch(D){return console.error("Error accessing mediaStore.categoryCounts:",D),{}}}),_e=z(()=>{try{return a.loading}catch(D){return console.error("Error accessing mediaStore.loading:",D),!1}}),Ie=z(()=>{try{return a.error}catch(D){return console.error("Error accessing mediaStore.error:",D),null}}),$=z(()=>{try{const D=[...a.filteredMedia||[]],[P,Z]=V.value.split("_");return D.sort((N,W)=>{let ee=N[P],Y=W[P];return P==="order"?(ee=N.__order||0,Y=W.__order||0):P==="airing"?(ee=N.isAiring?1:0,Y=W.isAiring?1:0):P==="api_rating"?(ee=N.api_rating||N.rating||0,Y=W.api_rating||W.rating||0):P==="personal_rating"&&(ee=N.personal_rating||0,Y=W.personal_rating||0),typeof ee=="string"&&(ee=ee.toLowerCase(),Y=Y.toLowerCase()),Z==="asc"?ee>Y?1:-1:ee<Y?1:-1})}catch(D){return console.error("Error in sortedMedia computed:",D),[]}}),j=z(()=>$.value),v=D=>{a.setCategory(D),gt().closeMobileSidebar()},x=()=>{a.setSearchQuery("")},H=D=>{k.value=D,g.value=!0},p=()=>{g.value=!1,k.value=null},h=()=>{T.value=!1},S=async D=>{console.log("handleBulkAddItems called but not used in new workflow")},C=async D=>{k.value?await a.updateMediaItem(k.value.id,D):await a.addMediaItem(D),p()},M=async D=>{var P;try{await a.deleteMediaItem(D.id)}catch(Z){((P=Z.response)==null?void 0:P.status)!==404&&!Z.silent&&(console.error("Delete failed:",Z),t.showError("Failed to delete item: "+(Z.message||"Unknown error"),"Delete Failed"))}},_=async()=>{await e.logout(),await F()},F=async()=>{try{await a.loadMedia()}catch(D){console.error("Error loading media:",D)}},re=()=>{c.value=!c.value},ne=()=>{if(c.value=!1,!m.value){t.showWarning("Bitte loggen Sie sich ein, um neue Items hinzuzufÃ¼gen.","Login erforderlich");return}k.value=null,g.value=!0},E=()=>{if(c.value=!1,!m.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}T.value=!0},ge=()=>{if(c.value=!1,!m.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}A.value=!0},je=()=>{if(c.value=!1,!m.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}t.showInfo("API Import feature coming soon!","Feature in Entwicklung")},Be=()=>{if(c.value=!1,!m.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}Fe()},Ue=D=>{if(!D)return"Unknown";const P=me.find(Z=>Z.key===D);return P?P.name:D},Ye=async()=>{const D=Ue(ce.value),P=ve.value[ce.value]||0;if(P===0){t.showInfo("No items to delete in this category.","Nothing to Delete");return}const Z=`Are you sure you want to delete ALL ${P} items in "${D}"?

This action cannot be undone!`;if(await o.showConfirm({title:"Delete All Items",message:Z}))try{const ee=((a==null?void 0:a.mediaData)||[]).filter(Y=>ce.value==="watchlist"?Y.category==="watchlist"||Y.isNew===!0:Y.category===ce.value).map(Y=>Y.id);await a.batchDeleteMediaItems(ee),await F(),t.showSuccess(`Successfully deleted ${P} items from "${D}"`,"Items Deleted")}catch(W){console.error("Error deleting items:",W),W.silent?t.showSuccess(`Items deleted from "${D}" (some items may not have existed)`,"Items Deleted"):W.isNotFound?t.showWarning("Some items were not found and could not be deleted, but the operation completed.","Partial Success"):t.showError("Error occurred while deleting items. Please try again.","Delete Failed")}},qe=D=>{const P=D.split(`
`).map(Y=>Y.trim()).filter(Y=>Y.length>0);if(P.length===0){t.showWarning("Die TXT-Datei ist leer oder enthÃ¤lt keine gÃ¼ltigen EintrÃ¤ge.","Leere Datei");return}const N=a.filteredMedia.map(Y=>Y.title.toLowerCase().trim()),W=P.filter(Y=>{const De=Y.toLowerCase().trim();return!N.some(he=>he.includes(De)||De.includes(he))}),ee=P.filter(Y=>{const De=Y.toLowerCase().trim();return N.some(he=>he.includes(De)||De.includes(he))});le.value={totalInFile:P.length,missingItems:W,existingItems:ee,currentCategory:ce.value,categoryName:Ue(ce.value)},A.value=!1,I.value=!0},He=()=>{le.value=null,I.value=!1},Fe=async()=>{const D=(a==null?void 0:a.mediaData)||[];if(D.length===0){t.showInfo("Keine Media Items zum Exportieren gefunden.","Nichts zu exportieren");return}const P=await r.showInput({title:"Export Format wÃ¤hlen",message:`1 = CSV
2 = JSON
3 = Beide

Geben Sie die Nummer ein:`,placeholder:"1",defaultValue:"1"});if(!P||!["1","2","3"].includes(P))return;const Z=new Date().toISOString().split("T")[0];(P==="1"||P==="3")&&Ee(D,Z),(P==="2"||P==="3")&&Le(D,Z),t.showSuccess(`Collection mit ${D.length} Items wurde erfolgreich exportiert!`,"Export erfolgreich")},Ee=(D,P)=>{const N=[["Titel","Kategorie","Release","Rating","Platforms","Genre","Spielzeit","Status","Beschreibung"].join(","),...D.map(W=>[`"${(W.title||"").replace(/"/g,'""')}"`,`"${(W.category||W.category_name||"Unbekannt").replace(/"/g,'""')}"`,`"${W.release||""}"`,`"${W.rating||""}"`,`"${(W.platforms||"").replace(/"/g,'""')}"`,`"${(W.genre||"").replace(/"/g,'""')}"`,`"${W.spielzeit||""}"`,`"${W.isAiring?"Airing":"Abgeschlossen"}"`,`"${(W.description||"").replace(/"/g,'""')}"`].join(","))].join(`
`);Re(N,`media_collection_${P}.csv`,"text/csv;charset=utf-8;")},Le=(D,P)=>{const Z={exportDate:new Date().toISOString(),totalItems:D.length,categories:[...new Set(D.map(N=>N.category||N.category_name||"Unbekannt"))],items:D.map(N=>({id:N.id,title:N.title||"",category:N.category||N.category_name||"Unbekannt",release:N.release||"",rating:N.rating||null,platforms:N.platforms||"",genre:N.genre||"",spielzeit:N.spielzeit||null,status:N.isAiring?"Airing":"Abgeschlossen",description:N.description||"",isNew:N.isNew||!1,nextSeason:N.nextSeason||null,discovered:N.discovered||null}))};Re(JSON.stringify(Z,null,2),`media_collection_${P}.json`,"application/json;charset=utf-8;")},Re=(D,P,Z)=>{const N=new Blob([D],{type:Z}),W=document.createElement("a"),ee=URL.createObjectURL(N);W.setAttribute("href",ee),W.setAttribute("download",P),W.style.visibility="hidden",document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL(ee)};return{showLoginModal:i,showRegisterModal:l,showEditModal:g,showFloatingMenu:c,showBulkAddModal:T,showTxtImportModal:A,showTxtImportResults:I,editingItem:k,gridColumns:X,sortBy:V,categories:me,txtImportResults:le,isLoggedIn:m,isAdmin:de,userName:O,currentCategory:ce,searchQuery:Se,categoryCounts:ve,loading:_e,error:Ie,paginatedMedia:j,setCategory:v,clearSearch:x,editItem:H,closeEditModal:p,closeBulkAddModal:h,handleBulkAddItems:S,handleSaveItem:C,handleDeleteItem:M,logout:_,loadMedia:F,toggleFloatingMenu:re,addNewItem:ne,bulkAddItems:E,importFromTxt:ge,importFromAPI:je,createCollection:Be,exportMediaCollection:Fe,exportAsCSV:Ee,exportAsJSON:Le,downloadFile:Re,deleteAllInCategory:Ye,getCategoryDisplayName:Ue,navigateToCalendar:()=>{v("calendar")},navigateToProfile:()=>{v("profile")},navigateToAdmin:()=>{console.log("ðŸ”¥ navigateToAdmin function called!"),console.log("ðŸ”¥ Router object:",n),console.log("ðŸ”¥ Pushing to /admin...");try{n.push("/admin"),console.log("ðŸ”¥ Successfully navigated to /admin!")}catch(D){console.error("ðŸ”¥ Error navigating to admin:",D)}},processTxtContent:qe,closeTxtImportResults:He,cleanup:()=>{typeof window<"u"&&window.removeEventListener("resize",pe)},router:n}}const Zt={name:"MediaItem",props:{item:{type:Object,required:!0}},emits:["edit"],computed:{showWatchlistTag(){return this.item.category==="watchlist"||this.item.isNew===!0},isWatchlistItem(){return this.item.category==="watchlist"||this.item.isNew===!0},isSeries(){return this.item.category==="series"||this.item.watchlist_type==="series"}},methods:{getImageUrl(n){return n?n.startsWith("http")?n.startsWith("http://")?n.replace("http://","https://"):n:n.startsWith("/")?n:n.startsWith("storage/")?`/${n}`:`/storage/${n}`:""},handleImageError(n){var e;n.target.style.display="none",(e=n.target.nextElementSibling)==null||e.classList.add("show")},formatDate(n){return n?new Date(n).toLocaleDateString():""},editItem(){this.$emit("edit",this.item)},openExtraLink(){this.item.extra_link&&window.open(this.item.extra_link,"_blank","noopener,noreferrer")},getWatchlistReleaseStatus(){if(!this.item.release)return"";const n=new Date(this.item.release),e=new Date;e.setHours(0,0,0,0),n.setHours(0,0,0,0);const a=n.getTime()-e.getTime(),t=Math.ceil(a/(1e3*3600*24));if(t>0)return t===1?"Tomorrow!":t<=7?`${t} days left`:t<=30?`${t} days left`:`${Math.ceil(t/30)} months left`;if(t===0)return"Released today!";{const o=this.getTypeTagText().toLowerCase();return o==="game"?"Unplayed yet":o==="series"||o==="movie"?"Unwatched yet":o==="buecher"?"Unread yet":"Unconsumed yet"}},getWatchlistReleaseStatusClass(){if(!this.item.release)return"";const n=new Date(this.item.release),e=new Date;e.setHours(0,0,0,0),n.setHours(0,0,0,0);const a=n.getTime()-e.getTime(),t=Math.ceil(a/(1e3*3600*24));return t>0?"countdown":t===0?"released-today":"unconsumed"},getTypeTagText(){var e,a,t;const n=this.item.watchlistType||this.item.watchlist_type;if(n)return n.charAt(0).toUpperCase()+n.slice(1);if(this.item.genre){const o=this.item.genre.toLowerCase();if(o.includes("game")||o.includes("gaming")||(e=this.item.platforms)!=null&&e.toLowerCase().includes("steam")||(a=this.item.platforms)!=null&&a.toLowerCase().includes("ps")||(t=this.item.platforms)!=null&&t.toLowerCase().includes("xbox"))return"Game";if(o.includes("series")||o.includes("tv")||o.includes("episode")||this.item.isAiring)return"Series";if(o.includes("movie")||o.includes("film")||o.includes("cinema"))return"Movie";if(o.includes("book")||o.includes("literature")||o.includes("novel")||o.includes("author"))return"BÃ¼cher"}if(this.item.platforms){const o=this.item.platforms.toLowerCase();if(o.includes("steam")||o.includes("ps")||o.includes("xbox")||o.includes("nintendo")||o.includes("pc"))return"Game";if(o.includes("netflix")||o.includes("hulu")||o.includes("disney")||o.includes("hbo"))return"Series";if(o.includes("cinema")||o.includes("theater"))return"Movie";if(o.includes("book")||o.includes("kindle")||o.includes("audible")||o.includes("author"))return"BÃ¼cher"}return"Media"},getTypeTagClass(){return`type-${this.getTypeTagText().toLowerCase()}`},getNextSeasonCountdown(){if(!this.item.nextSeasonRelease)return"";const n=new Date(this.item.nextSeasonRelease),e=new Date;e.setHours(0,0,0,0),n.setHours(0,0,0,0);const a=n.getTime()-e.getTime(),t=Math.ceil(a/(1e3*3600*24));return t>0?t===1?"Tomorrow!":t<=7?`${t} days`:t<=30?`${t} days`:`${Math.ceil(t/30)} months`:t===0?"Today!":"Released"},getCategoryClass(){var e,a;const n=((e=this.item.category)==null?void 0:e.toLowerCase())||((a=this.item.category_name)==null?void 0:a.toLowerCase());return n==="movies"||n==="movie"?"category-movies":n==="books"||n==="buecher"||n==="book"?"category-books":n==="series"||n==="tv"||n==="serie"?"category-series":n==="games"||n==="game"||n==="spiele"?"category-games":n==="watchlist"?"category-watchlist":"category-default"},getCategoryIcon(){var e;const n=(e=this.item.category)==null?void 0:e.toLowerCase();return n==="movies"||n==="movie"?"ðŸŽ¬":n==="books"||n==="buecher"?"ðŸ“š":n==="series"||n==="tv"?"ðŸ“º":n==="games"||n==="game"?"ðŸŽ®":"ðŸ“"},getCategoryStyle(){var e;const n=(e=this.item.category)==null?void 0:e.toLowerCase();if(n==="games"||n==="game"){const a=this.item.rating||0;return this.getGameStyleByRating(a)}return{}},getGameStyleByRating(n){return n>=4.5?{"--game-primary":"#ffd700","--game-secondary":"#ffed4e","--game-accent":"#ff6b35","--game-glow":"0 0 20px rgba(255, 215, 0, 0.6)","--game-border":"3px solid #ffd700"}:n>=4?{"--game-primary":"#00d4ff","--game-secondary":"#e8f4fd","--game-accent":"#00ff88","--game-glow":"0 0 15px rgba(0, 212, 255, 0.5)","--game-border":"3px solid #00d4ff"}:n>=3.5?{"--game-primary":"#00ff88","--game-secondary":"#4caf50","--game-accent":"#8bc34a","--game-glow":"0 0 12px rgba(0, 255, 136, 0.4)","--game-border":"3px solid #00ff88"}:n>=3?{"--game-primary":"#ff9800","--game-secondary":"#ffc107","--game-accent":"#ff5722","--game-glow":"0 0 10px rgba(255, 152, 0, 0.3)","--game-border":"3px solid #ff9800"}:n>=2?{"--game-primary":"#ff5722","--game-secondary":"#f44336","--game-accent":"#d32f2f","--game-glow":"0 0 8px rgba(255, 87, 34, 0.3)","--game-border":"3px solid #ff5722"}:{"--game-primary":"#9e9e9e","--game-secondary":"#757575","--game-accent":"#616161","--game-glow":"0 0 5px rgba(158, 158, 158, 0.2)","--game-border":"3px solid #9e9e9e"}}}},Xt={class:"media-image"},$t=["src","alt"],es={key:1,class:"no-image"},ts={class:"no-image-icon"},ss={class:"media-info"},as={class:"media-title"},os={class:"media-meta"},ns={key:0,class:"media-release"},is={key:1},rs={key:1,class:"media-rating"},ls={key:0,class:"media-platforms"},ds={key:1,class:"media-genre"},cs={key:2,class:"media-description"},us={key:3,class:"media-airing"},ms={key:0,class:"next-season"},gs={key:1,class:"countdown"},fs={key:4,class:"watchlist-type-tag"};function ps(n,e,a,t,o,r){return d(),u("div",{class:J(["media-item",r.getCategoryClass()]),style:Te(r.getCategoryStyle()),onClick:e[2]||(e[2]=(...i)=>r.editItem&&r.editItem(...i))},[s("div",Xt,[a.item.image_url||a.item.path?(d(),u("img",{key:0,src:r.getImageUrl(a.item.image_url||a.item.path),alt:a.item.title,onError:e[0]||(e[0]=(...i)=>r.handleImageError&&r.handleImageError(...i))},null,40,$t)):(d(),u("div",es,[s("span",ts,f(r.getCategoryIcon()),1)]))]),s("div",ss,[s("h3",as,f(a.item.title),1),s("div",os,[a.item.release?(d(),u("span",ns,[r.isWatchlistItem&&a.item.release?(d(),u("span",{key:0,class:J(r.getWatchlistReleaseStatusClass())},f(r.getWatchlistReleaseStatus()),3)):(d(),u("span",is,f(r.formatDate(a.item.release)),1))])):y("",!0),a.item.rating?(d(),u("span",rs,f("â˜…".repeat(Math.max(0,Math.min(5,Math.floor(a.item.rating)))))+f("â˜†".repeat(Math.max(0,5-Math.max(0,Math.min(5,Math.floor(a.item.rating)))))),1)):y("",!0)]),a.item.platforms?(d(),u("div",ls,f(a.item.platforms),1)):y("",!0),a.item.genre?(d(),u("div",ds,f(a.item.genre),1)):y("",!0),a.item.description?(d(),u("div",cs,f(a.item.description),1)):y("",!0),a.item.isAiring?(d(),u("div",us,[e[3]||(e[3]=s("span",{class:"airing-badge"},[s("span",{class:"airing-dot"}),Ae(" Airing ")],-1)),a.item.nextSeason?(d(),u("span",ms,"S"+f(a.item.nextSeason),1)):y("",!0),a.item.nextSeasonRelease?(d(),u("span",gs,f(r.getNextSeasonCountdown()),1)):y("",!0)])):y("",!0),r.showWatchlistTag?(d(),u("div",fs,[s("span",{class:J(["type-tag",r.getTypeTagClass()])},f(r.getTypeTagText()),3)])):y("",!0)]),r.isSeries&&a.item.extra_link?(d(),u("div",{key:0,class:"series-extra-button",onClick:e[1]||(e[1]=ue((...i)=>r.openExtraLink&&r.openExtraLink(...i),["stop"]))},[...e[4]||(e[4]=[s("span",{class:"extra-link-icon"},"ðŸ”—",-1),s("span",{class:"extra-link-text"},"Extra Link",-1)])])):y("",!0),e[5]||(e[5]=s("div",{class:"edit-indicator"},[s("span",{class:"edit-icon"},"âœï¸")],-1))],6)}const vs=oe(Zt,[["render",ps],["__scopeId","data-v-35cdd815"]]),hs={name:"VersionInfo",data(){return{version:"1.0.0"}}},ys={class:"version-info"},bs={class:"version-label"};function ks(n,e,a,t,o,r){return d(),u("div",ys,[s("span",bs,"Build #"+f(o.version),1)])}const ws=oe(hs,[["render",ks],["__scopeId","data-v-2d54e3c7"]]),Ss={name:"Sidebar",components:{VersionInfo:ws},props:{collapsed:{type:Boolean,default:!1},mobileOpen:{type:Boolean,default:!1},isLoggedIn:{type:Boolean,default:!1},userName:{type:String,default:""},currentCategory:{type:String,default:"watchlist"},categoryCounts:{type:Object,default:()=>({})},categories:{type:Array,default:()=>[{key:"game",name:"Games",icon:"ðŸŽ®"},{key:"series",name:"Series",icon:"ðŸ“º"},{key:"movie",name:"Movies",icon:"ðŸŽ¬"},{key:"buecher",name:"BÃ¼cher",icon:"ðŸ“š"},{key:"watchlist",name:"Watchlist",icon:"â¤ï¸"}]},selectedGenres:{type:Array,default:()=>[]},genres:{type:Array,default:()=>[]},genreLoading:{type:Boolean,default:!1},genreError:{type:String,default:null}},emits:["toggle","setCategory","addItem","navigateToCalendar","navigateToProfile","showLogin","showRegister","logout","genres-updated","genres-cleared","load-genres"],computed:{showGenreSection(){return this.currentCategory&&this.currentCategory!=="statistics"&&this.currentCategory!=="calendar"&&this.currentCategory!=="profile"}},methods:{toggleGenre(n){const e=[...this.selectedGenres],a=e.indexOf(n);a>-1?e.splice(a,1):e.push(n),this.$emit("genres-updated",e)},clearGenreFilter(){this.$emit("genres-cleared")},loadGenres(){this.$emit("load-genres")}}},_s={class:"sidebar-content"},Is={class:"sidebar-section"},Cs={class:"sidebar-nav"},Ds=["onClick"],xs={class:"nav-icon"},As={class:"nav-text"},Ts={class:"nav-count"},Ms=["onClick","title"],Us={key:0,class:"sidebar-section"},Rs={key:0,class:"genre-loading"},Ps={key:1,class:"genre-error"},Bs={key:2,class:"genre-empty"},Fs={key:3,class:"genre-list"},Es=["title"],Ls={class:"genre-checkbox-label"},Ns=["value","checked","onChange"],Gs={class:"genre-checkbox-text"},Ws={class:"genre-name"},Vs={class:"genre-count"},Os={class:"sidebar-section"},zs={key:0,class:"auth-buttons"},js={key:1,class:"user-info"},Ys={class:"user-profile"},qs={class:"profile-details"},Hs={class:"user-name"};function Qs(n,e,a,t,o,r){const i=ie("VersionInfo");return d(),u("aside",{id:"sidebar",class:J(["sidebar",{collapsed:a.collapsed,open:a.mobileOpen}])},[s("div",{class:"sidebar-header",onClick:e[0]||(e[0]=l=>n.$emit("toggle"))},[...e[10]||(e[10]=[s("h2",null,"Media Library",-1),s("button",{class:"sidebar-toggle"},"â˜°",-1)])]),s("div",_s,[s("div",Is,[e[15]||(e[15]=s("h3",null,"Browse",-1)),s("nav",Cs,[(d(!0),u(se,null,ae(a.categories,l=>(d(),u("div",{key:l.key,class:"nav-item"},[s("button",{class:J(["nav-btn",{active:a.currentCategory===l.key}]),onClick:g=>n.$emit("setCategory",l.key)},[s("span",xs,f(l.icon),1),s("span",As,f(l.name),1),s("span",Ts,f(a.categoryCounts[l.key]||0),1)],10,Ds),s("button",{class:"add-btn",onClick:g=>n.$emit("addItem",l.key),title:`Add ${l.name}`},[...e[11]||(e[11]=[s("span",{class:"add-icon"},"+",-1)])],8,Ms)]))),128)),s("button",{class:J(["nav-btn",{active:a.currentCategory==="statistics"}]),onClick:e[1]||(e[1]=l=>n.$emit("setCategory","statistics"))},[...e[12]||(e[12]=[s("span",{class:"nav-icon"},"ðŸ“Š",-1),s("span",{class:"nav-text"},"Statistics",-1)])],2),s("button",{class:J(["nav-btn",{active:a.currentCategory==="calendar"}]),onClick:e[2]||(e[2]=l=>n.$emit("setCategory","calendar"))},[...e[13]||(e[13]=[s("span",{class:"nav-icon"},"ðŸ“…",-1),s("span",{class:"nav-text"},"Calendar",-1)])],2),s("button",{class:J(["nav-btn",{active:a.currentCategory==="profile"}]),onClick:e[3]||(e[3]=l=>n.$emit("setCategory","profile"))},[...e[14]||(e[14]=[s("span",{class:"nav-icon"},"ðŸ‘¤",-1),s("span",{class:"nav-text"},"Profile",-1)])],2)])]),r.showGenreSection?(d(),u("div",Us,[e[19]||(e[19]=s("h3",null,"Genres",-1)),a.genreLoading?(d(),u("div",Rs,[...e[16]||(e[16]=[s("div",{class:"loading-spinner"},null,-1),s("span",null,"Loading genres...",-1)])])):a.genreError?(d(),u("div",Ps,[e[17]||(e[17]=s("span",null,"Failed to load genres",-1)),s("button",{onClick:e[4]||(e[4]=(...l)=>r.loadGenres&&r.loadGenres(...l)),class:"retry-btn"},"Retry")])):a.genres.length===0?(d(),u("div",Bs,[...e[18]||(e[18]=[s("span",null,"No genres available",-1)])])):(d(),u("div",Fs,[(d(!0),u(se,null,ae(a.genres,l=>(d(),u("div",{key:l.name,class:"genre-checkbox-item",title:`${l.name} (${l.count} items)`},[s("label",Ls,[s("input",{type:"checkbox",value:l.name,checked:a.selectedGenres.includes(l.name),onChange:g=>r.toggleGenre(l.name),class:"genre-checkbox"},null,40,Ns),s("span",Gs,[s("span",Ws,f(l.name),1),s("span",Vs,f(l.count),1)])])],8,Es))),128)),a.selectedGenres.length>0?(d(),u("button",{key:0,class:"clear-genre-btn",onClick:e[5]||(e[5]=(...l)=>r.clearGenreFilter&&r.clearGenreFilter(...l)),title:"Clear all genre filters"}," Clear All Filters ("+f(a.selectedGenres.length)+") ",1)):y("",!0)]))])):y("",!0),s("div",Os,[e[21]||(e[21]=s("h3",null,"Account",-1)),a.isLoggedIn?(d(),u("div",js,[s("div",Ys,[e[20]||(e[20]=s("div",{class:"profile-avatar"},[s("span",{class:"avatar-text"},"ðŸ‘¤")],-1)),s("div",qs,[s("span",Hs,f(a.userName),1)]),s("button",{class:"account-btn",onClick:e[8]||(e[8]=l=>n.$emit("navigateToProfile"))},"âš™ï¸")]),s("button",{class:"auth-btn",onClick:e[9]||(e[9]=l=>n.$emit("logout"))},"Logout")])):(d(),u("div",zs,[s("button",{class:"auth-btn",onClick:e[6]||(e[6]=l=>n.$emit("showLogin"))},"Login"),s("button",{class:"auth-btn",onClick:e[7]||(e[7]=l=>n.$emit("showRegister"))},"Register")]))])]),be(i)],2)}const Js=oe(Ss,[["render",Qs],["__scopeId","data-v-23b04853"]]),Ks={name:"MainHeader",props:{searchQuery:{type:String,default:""},sortBy:{type:String,default:"order_asc"}},emits:["update:searchQuery","update:sortBy","toggleMobileSidebar","clearSearch"]},Zs={class:"main-header"},Xs={class:"header-left"},$s={class:"header-center"},ea={class:"search-container"},ta=["value"],sa={class:"header-right"},aa={class:"sort-container"},oa=["value"];function na(n,e,a,t,o,r){return d(),u("header",Zs,[s("div",Xs,[s("button",{class:"mobile-sidebar-toggle",onClick:e[0]||(e[0]=i=>n.$emit("toggleMobileSidebar"))},"â˜°")]),s("div",$s,[s("div",ea,[s("input",{type:"text",value:a.searchQuery,onInput:e[1]||(e[1]=i=>n.$emit("update:searchQuery",i.target.value)),placeholder:"Search..."},null,40,ta),s("button",{class:"search-clear",onClick:e[2]||(e[2]=i=>n.$emit("clearSearch"))},"Ã—")])]),s("div",sa,[s("div",aa,[s("select",{value:a.sortBy,onChange:e[3]||(e[3]=i=>n.$emit("update:sortBy",i.target.value))},[...e[4]||(e[4]=[Ve('<option value="order_asc" data-v-8aca1f2e>Original order â†‘</option><option value="order_desc" data-v-8aca1f2e>Original order â†“</option><option value="title_asc" data-v-8aca1f2e>Title A-Z</option><option value="title_desc" data-v-8aca1f2e>Title Z-A</option><option value="release_asc" data-v-8aca1f2e>Release â†‘</option><option value="release_desc" data-v-8aca1f2e>Release â†“</option><option value="api_rating_asc" data-v-8aca1f2e>API Rating â†‘</option><option value="api_rating_desc" data-v-8aca1f2e>API Rating â†“</option><option value="personal_rating_asc" data-v-8aca1f2e>Personal Rating â†‘</option><option value="personal_rating_desc" data-v-8aca1f2e>Personal Rating â†“</option><option value="airing_desc" data-v-8aca1f2e>Airing first</option><option value="airing_asc" data-v-8aca1f2e>Finished first</option>',12)])],40,oa)])])])}const ia=oe(Ks,[["render",na],["__scopeId","data-v-8aca1f2e"]]),ra={name:"FloatingActionButton",props:{showMenu:{type:Boolean,default:!1},showDeleteAll:{type:Boolean,default:!1},categoryName:{type:String,default:""},itemCount:{type:Number,default:0}},emits:["toggleMenu","addNewItem","bulkAddItems","importFromTxt","importFromAPI","createCollection","deleteAllInCategory"]},la={class:"floating-actions"},da={class:"menu-text"},ca={class:"item-count-badge"};function ua(n,e,a,t,o,r){return d(),u("div",la,[s("div",{class:J(["floating-menu",{show:a.showMenu}])},[s("button",{class:"floating-menu-item",onClick:e[0]||(e[0]=i=>n.$emit("addNewItem"))},[...e[7]||(e[7]=[s("span",{class:"menu-icon"},"âž•",-1),s("span",{class:"menu-text"},"Add Item",-1)])]),s("button",{class:"floating-menu-item",onClick:e[1]||(e[1]=i=>n.$emit("bulkAddItems"))},[...e[8]||(e[8]=[s("span",{class:"menu-icon"},"ðŸ“¦",-1),s("span",{class:"menu-text"},"Bulk Add",-1)])]),s("button",{class:"floating-menu-item",onClick:e[2]||(e[2]=i=>n.$emit("importFromTxt"))},[...e[9]||(e[9]=[s("span",{class:"menu-icon"},"ðŸ“„",-1),s("span",{class:"menu-text"},"Import from TXT",-1)])]),s("button",{class:"floating-menu-item",onClick:e[3]||(e[3]=i=>n.$emit("importFromAPI"))},[...e[10]||(e[10]=[s("span",{class:"menu-icon"},"ðŸŒ",-1),s("span",{class:"menu-text"},"Import from API",-1)])]),s("button",{class:"floating-menu-item",onClick:e[4]||(e[4]=i=>n.$emit("createCollection"))},[...e[11]||(e[11]=[s("span",{class:"menu-icon"},"ðŸ“š",-1),s("span",{class:"menu-text"},"Create Collection",-1)])]),a.showDeleteAll&&a.itemCount>0?(d(),u("button",{key:0,class:"floating-menu-item delete-all-item",onClick:e[5]||(e[5]=i=>n.$emit("deleteAllInCategory"))},[e[12]||(e[12]=s("span",{class:"menu-icon"},"ðŸ—‘ï¸",-1)),s("span",da,"Delete All "+f(a.categoryName),1),s("span",ca,"("+f(a.itemCount)+")",1)])):y("",!0)],2),s("button",{class:"floating-add-btn",onClick:e[6]||(e[6]=i=>n.$emit("toggleMenu"))},f(a.showMenu?"âœ•":"+"),1)])}const ma=oe(ra,[["render",ua],["__scopeId","data-v-f77e6366"]]),ga={name:"LoginModal",emits:["close","success"],setup(n,{emit:e}){const a=Oe(),t=Me({email:"",password:""}),o=b(!1),r=b("");return{form:t,loading:o,error:r,handleLogin:async()=>{o.value=!0,r.value="";try{const A=await a.login(t.email,t.password);A.success?e("success",A):r.value=A.error}catch(A){r.value=A.message||"Login failed"}finally{o.value=!1}},closeModal:()=>{e("close")},checkLocalDB:async()=>{try{const I=await(await fetch("http://127.0.0.1:8000/api/check-db")).json();alert(`Local DB: ${I.success?"âœ… Connected":"âŒ Error"}
Users: ${I.user_count}
Error: ${I.error||"None"}`)}catch(A){alert(`Local DB Check Failed: ${A.message}`)}},checkProdDB:async()=>{try{const A=window.location.origin,k=await(await fetch(`${A}/api/check-db`)).json();alert(`Prod DB: ${k.success?"âœ… Connected":"âŒ Error"}
Users: ${k.user_count}
Error: ${k.error||"None"}`)}catch(A){alert(`Prod DB Check Failed: ${A.message}`)}},deleteAllUsers:async()=>{if(confirm("âš ï¸ WARNING: This will delete ALL users! Are you sure?"))try{const A=window.location.origin,k=await(await fetch(`${A}/api/delete-all-users`,{method:"POST",headers:{"Content-Type":"application/json"}})).json();alert(`Delete Result: ${k.success?"âœ… Success":"âŒ Error"}
Deleted: ${k.deleted_count} users
Error: ${k.error||"None"}`)}catch(A){alert(`Delete Failed: ${A.message}`)}}}}},fa={class:"form-group"},pa=["disabled"],va={class:"form-group"},ha=["disabled"],ya={key:0,class:"error-message"},ba={class:"modal-buttons"},ka=["disabled"],wa=["disabled"];function Sa(n,e,a,t,o,r){return d(),u("div",{class:"modal",onClick:e[5]||(e[5]=(...i)=>t.closeModal&&t.closeModal(...i))},[s("div",{class:"modal-content auth-modal",onClick:e[4]||(e[4]=ue(()=>{},["stop"]))},[e[8]||(e[8]=s("h2",null,"Login",-1)),s("form",{onSubmit:e[3]||(e[3]=ue((...i)=>t.handleLogin&&t.handleLogin(...i),["prevent"]))},[s("div",fa,[e[6]||(e[6]=s("label",{for:"email"},"Email:",-1)),U(s("input",{type:"email",id:"email","onUpdate:modelValue":e[0]||(e[0]=i=>t.form.email=i),required:"",disabled:t.loading},null,8,pa),[[G,t.form.email]])]),s("div",va,[e[7]||(e[7]=s("label",{for:"password"},"Password:",-1)),U(s("input",{type:"password",id:"password","onUpdate:modelValue":e[1]||(e[1]=i=>t.form.password=i),required:"",disabled:t.loading},null,8,ha),[[G,t.form.password]])]),t.error?(d(),u("div",ya,f(t.error),1)):y("",!0),s("div",ba,[s("button",{type:"submit",disabled:t.loading},f(t.loading?"Logging in...":"Login"),9,ka),s("button",{type:"button",onClick:e[2]||(e[2]=(...i)=>t.closeModal&&t.closeModal(...i)),disabled:t.loading}," Cancel ",8,wa)])],32)])])}const _a=oe(ga,[["render",Sa],["__scopeId","data-v-64f3b00b"]]),Ia={name:"RegisterModal",emits:["close","success"],setup(n,{emit:e}){const a=Oe(),t=Me({name:"",username:"",email:"",password:"",passwordConfirm:""}),o=b(!1),r=b(""),i=z(()=>t.name&&t.username&&t.email&&t.password&&t.passwordConfirm&&t.password===t.passwordConfirm&&t.password.length>=8);return{form:t,loading:o,error:r,isFormValid:i,handleRegister:async()=>{if(!i.value){r.value="Please fill in all fields and ensure passwords match";return}o.value=!0,r.value="";try{const c=await a.register(t.name,t.username,t.email,t.password,t.passwordConfirm);c.success?e("success"):r.value=c.error}catch(c){r.value=c.message||"Registration failed"}finally{o.value=!1}},closeModal:()=>{e("close")}}}},Ca={class:"form-group"},Da=["disabled"],xa={class:"form-group"},Aa=["disabled"],Ta={class:"form-group"},Ma=["disabled"],Ua={class:"form-group"},Ra=["disabled"],Pa={class:"form-group"},Ba=["disabled"],Fa={key:0,class:"error-message"},Ea={class:"modal-buttons"},La=["disabled"],Na=["disabled"];function Ga(n,e,a,t,o,r){return d(),u("div",{class:"modal",onClick:e[8]||(e[8]=(...i)=>t.closeModal&&t.closeModal(...i))},[s("div",{class:"modal-content auth-modal",onClick:e[7]||(e[7]=ue(()=>{},["stop"]))},[e[14]||(e[14]=s("h2",null,"Register",-1)),s("form",{onSubmit:e[6]||(e[6]=ue((...i)=>t.handleRegister&&t.handleRegister(...i),["prevent"]))},[s("div",Ca,[e[9]||(e[9]=s("label",{for:"name"},"Name:",-1)),U(s("input",{type:"text",id:"name","onUpdate:modelValue":e[0]||(e[0]=i=>t.form.name=i),required:"",disabled:t.loading},null,8,Da),[[G,t.form.name]])]),s("div",xa,[e[10]||(e[10]=s("label",{for:"username"},"Username:",-1)),U(s("input",{type:"text",id:"username","onUpdate:modelValue":e[1]||(e[1]=i=>t.form.username=i),required:"",disabled:t.loading},null,8,Aa),[[G,t.form.username]])]),s("div",Ta,[e[11]||(e[11]=s("label",{for:"email"},"Email:",-1)),U(s("input",{type:"email",id:"email","onUpdate:modelValue":e[2]||(e[2]=i=>t.form.email=i),required:"",disabled:t.loading},null,8,Ma),[[G,t.form.email]])]),s("div",Ua,[e[12]||(e[12]=s("label",{for:"password"},"Password:",-1)),U(s("input",{type:"password",id:"password","onUpdate:modelValue":e[3]||(e[3]=i=>t.form.password=i),required:"",minlength:"8",disabled:t.loading},null,8,Ra),[[G,t.form.password]])]),s("div",Pa,[e[13]||(e[13]=s("label",{for:"passwordConfirm"},"Confirm Password:",-1)),U(s("input",{type:"password",id:"passwordConfirm","onUpdate:modelValue":e[4]||(e[4]=i=>t.form.passwordConfirm=i),required:"",minlength:"8",disabled:t.loading},null,8,Ba),[[G,t.form.passwordConfirm]])]),t.error?(d(),u("div",Fa,f(t.error),1)):y("",!0),s("div",Ea,[s("button",{type:"submit",disabled:t.loading||!t.isFormValid},f(t.loading?"Registering...":"Register"),9,La),s("button",{type:"button",onClick:e[5]||(e[5]=(...i)=>t.closeModal&&t.closeModal(...i)),disabled:t.loading}," Cancel ",8,Na)])],32)])])}const Wa=oe(Ia,[["render",Ga],["__scopeId","data-v-eec5201a"]]),rt="http://127.0.0.1:8000/api",Va={async getConfig(){try{const n=await fetch(`${rt}/google-books-config`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);return await n.json()}catch(n){throw console.error("Simple Google Books - Config failed:",n),n}},async searchBooks(n,e=10){try{const a=await fetch(`${rt}/google-books/search?q=${encodeURIComponent(n)}&maxResults=${e}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);return await a.json()}catch(a){throw console.error("Simple Google Books - Search failed:",a),a}}},Oa=!1,za=!0,ja="production",Ya={production:{apiUrl:"https://teabubble.attrebi.ch",apiBaseUrl:"https://teabubble.attrebi.ch/api",googleBooksUrl:"https://teabubble.attrebi.ch/api/google-books",debug:!1}};function qa(){return Ya.production}const We=qa();We.debug&&console.log("ðŸ”§ Environment Configuration:",{mode:ja,isDevelopment:Oa,isProduction:za,apiUrl:We.apiUrl,apiBaseUrl:We.apiBaseUrl,googleBooksUrl:We.googleBooksUrl});class Ha{constructor(){this.baseUrl="https://en.wikipedia.org/w/api.php",this.timeout=1e4,this.maxResults=10}async searchBooks(e,a=10){if(!e||typeof e!="string"||e.trim().length===0)return console.warn("ðŸ“š [Wikipedia] Invalid query provided"),{success:!1,error:"Search query is required",data:[]};try{const t=await this.searchPages(e,a);if(!t.success||t.data.length===0)return{success:!1,error:"No results found",data:[]};const o=await this.getPageDetails(t.data),r=this.filterAndFormatBookResults(o);return console.log("ðŸ“š [Wikipedia] Search completed:",{totalResults:o.length,bookResults:r.length}),{success:!0,data:r,source:"wikipedia"}}catch(t){return console.error("ðŸ“š [Wikipedia] Search failed:",t),{success:!1,error:`Search failed: ${t.message}`,data:[]}}}async searchPages(e,a){var o;const t=new URLSearchParams({action:"query",format:"json",list:"search",srsearch:`${e} book novel`,srnamespace:0,srlimit:a,srprop:"snippet|timestamp",origin:"*"});try{const r=await fetch(`${this.baseUrl}?${t}`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout)});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const i=await r.json();if(i.error)throw new Error(i.error.info||"Wikipedia API error");return{success:!0,data:(((o=i.query)==null?void 0:o.search)||[]).map(g=>({pageid:g.pageid,title:g.title,snippet:g.snippet,timestamp:g.timestamp}))}}catch(r){return console.error("ðŸ“š [Wikipedia] Page search failed:",r),{success:!1,error:r.message,data:[]}}}async getPageDetails(e){var o;if(!e||e.length===0)return[];const a=e.map(r=>r.pageid).join("|"),t=new URLSearchParams({action:"query",format:"json",pageids:a,prop:"extracts|pageimages|info",exintro:"true",explaintext:"true",exsectionformat:"plain",piprop:"thumbnail|original",pithumbsize:300,pilimit:1,inprop:"url",origin:"*"});try{const r=await fetch(`${this.baseUrl}?${t}`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout)});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const i=await r.json();if(i.error)throw new Error(i.error.info||"Wikipedia API error");const l=((o=i.query)==null?void 0:o.pages)||{};return Object.values(l).map(g=>{var c;return{pageid:g.pageid,title:g.title,extract:g.extract||"",thumbnail:((c=g.thumbnail)==null?void 0:c.source)||null,fullurl:g.fullurl||null,canonicalurl:g.canonicalurl||null}})}catch(r){return console.error("ðŸ“š [Wikipedia] Page details failed:",r),[]}}filterAndFormatBookResults(e){const a=["book","novel","fiction","non-fiction","author","published","publisher","isbn","literature","story","chapter","edition","written by","series","trilogy","saga","collection","anthology"];return e.filter(t=>{const o=(t.extract||"").toLowerCase(),r=(t.title||"").toLowerCase(),i=a.some(c=>o.includes(c)||r.includes(c)),g=["book","novel","story","tale","chronicles","saga","trilogy"].some(c=>r.includes(c));return i||g}).map(t=>{const o=t.extract||"",r=t.title||"",i=o.match(/written by[^,.\n]*?([A-Z][^,.\n]*?[A-Z][^,.\n]*?)(?:\s|\.|,|$)/i),l=o.match(/(\d{4})/),g=o.match(/(?:published by|publisher)\s+([^,.\n]+)/i);let c="";if(i&&(c=i[1].trim().replace(/^(British|American|German|French|Spanish|Italian)\s+(?:author|writer|novelist)?\s*/i,""),c.includes("author")||c.includes("writer"))){const A=c.match(/([A-Z][^,.\n]*?[A-Z][^,.\n]*?)(?:\s|\.|,|$)/);c=A?A[1].trim():c}if(!c){const T=o.match(/(?:by|author|written by)\s+([A-Z][^,.\n]*?[A-Z][^,.\n]*?)(?:\s|\.|,|$)/i);T&&(c=T[1].trim().replace(/^(British|American|German|French|Spanish|Italian)\s+(?:author|writer|novelist)?\s*/i,""))}return{id:`wikipedia_${t.pageid}`,title:r,author:c,description:o.substring(0,300)+(o.length>300?"...":""),publishedDate:l?l[1]:"",publisher:g?g[1].trim():"",imageUrl:t.thumbnail||null,link:t.fullurl||t.canonicalurl||"",apiSource:"wikipedia",snippet:o.substring(0,150)+(o.length>150?"...":""),categories:this.extractCategories(o)}}).slice(0,this.maxResults)}extractCategories(e){const a=[],t=e.toLowerCase();return t.includes("fiction")&&a.push("Fiction"),(t.includes("non-fiction")||t.includes("nonfiction"))&&a.push("Non-Fiction"),t.includes("novel")&&a.push("Novel"),t.includes("biography")&&a.push("Biography"),t.includes("history")&&a.push("History"),t.includes("science")&&a.push("Science"),t.includes("philosophy")&&a.push("Philosophy"),t.includes("poetry")&&a.push("Poetry"),t.includes("drama")&&a.push("Drama"),t.includes("mystery")&&a.push("Mystery"),t.includes("romance")&&a.push("Romance"),t.includes("fantasy")&&a.push("Fantasy"),(t.includes("science fiction")||t.includes("sci-fi"))&&a.push("Science Fiction"),t.includes("thriller")&&a.push("Thriller"),t.includes("horror")&&a.push("Horror"),a}async getBookById(e){var a,t;try{const o=new URLSearchParams({action:"query",format:"json",pageids:e,prop:"extracts|pageimages|info",exintro:"true",explaintext:"true",piprop:"thumbnail",pithumbsize:300,inprop:"url",origin:"*"}),r=await fetch(`${this.baseUrl}?${o}`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout)});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const i=await r.json(),l=Object.values(((a=i.query)==null?void 0:a.pages)||{})[0];if(!l)throw new Error("Page not found");return{success:!0,data:{id:`wikipedia_${l.pageid}`,title:l.title,description:l.extract||"",imageUrl:((t=l.thumbnail)==null?void 0:t.source)||null,link:l.fullurl||l.canonicalurl||"",apiSource:"wikipedia"}}}catch(o){return console.error("ðŸ“š [Wikipedia] Get book by ID failed:",o),{success:!1,error:o.message,data:null}}}}const Qa=new Ha;class Ja{constructor(){this.wikipediaService=Qa,this.googleBooksService=Va}getUserPreferences(){try{const e=localStorage.getItem("profileData");if(e){const a=JSON.parse(e);return{booksApiProvider:a.booksApiProvider||"wikipedia",enableGoogleBooksFallback:a.enableGoogleBooksFallback!==!1}}}catch(e){console.warn("Failed to load user preferences:",e)}return{booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}}async searchBooks(e,a=10){const t=this.getUserPreferences();if(!e||typeof e!="string"||e.trim().length===0)return{success:!1,error:"Search query is required",data:[]};try{let o=[],r="",i=!1;switch(t.booksApiProvider){case"wikipedia":o=await this.searchWithWikipediaFirst(e,a,t),r="wikipedia";break;case"google_books":o=await this.searchWithGoogleBooksFirst(e,a,t),r="google_books";break;case"both":o=await this.searchWithBothApis(e,a,t),r="both";break;default:o=await this.searchWithWikipediaFirst(e,a,t),r="wikipedia"}return{success:!0,data:o,source:r,fallbackUsed:i}}catch(o){return console.error("ðŸ“š [UnifiedBooks] Search failed:",o),{success:!1,error:`Search failed: ${o.message}`,data:[]}}}async searchWithWikipediaFirst(e,a,t){const o=await this.wikipediaService.searchBooks(e,a);if(o.success&&o.data.length>0)return o.data;if(t.enableGoogleBooksFallback){const r=await this.googleBooksService.searchBooks(e,a);if(r.success&&r.data.length>0)return r.data}return[]}async searchWithGoogleBooksFirst(e,a,t){const o=await this.googleBooksService.searchBooks(e,a);if(o.success&&o.data.length>0)return o.data;if(t.enableGoogleBooksFallback){const r=await this.wikipediaService.searchBooks(e,a);if(r.success&&r.data.length>0)return r.data}return[]}async searchWithBothApis(e,a,t){const[o,r]=await Promise.allSettled([this.wikipediaService.searchBooks(e,Math.ceil(a/2)),this.googleBooksService.searchBooks(e,Math.ceil(a/2))]);let i=[];return o.status==="fulfilled"&&o.value.success&&(i=i.concat(o.value.data)),r.status==="fulfilled"&&r.value.success&&(i=i.concat(r.value.data)),i=this.removeDuplicateResults(i),i=i.slice(0,a),i}removeDuplicateResults(e){const a=new Set,t=[];for(const o of e){const r=o.title.toLowerCase().replace(/[^\w\s]/g,"").trim();a.has(r)||(a.add(r),t.push(o))}return t}async getBookById(e){if(e.startsWith("wikipedia_")){const a=e.replace("wikipedia_","");return await this.wikipediaService.getBookById(a)}else return await this.googleBooksService.getBookById(e)}getApiStatus(){const e=this.getUserPreferences();return{primaryProvider:e.booksApiProvider,fallbackEnabled:e.enableGoogleBooksFallback,availableProviders:["wikipedia","google_books"],wikipediaAvailable:!0,googleBooksAvailable:!0}}}const Xe=new Ja,Ka={name:"BooksApiControlPanel",props:{expanded:{type:Boolean,default:!1}},emits:["preferences-changed"],setup(n,{emit:e}){const a=b(n.expanded),t=b(!1),o=b(null),r=b("checking"),i=Me({booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}),l=()=>{a.value=!a.value},g=()=>{try{const I=localStorage.getItem("profileData");if(I){const k=JSON.parse(I);i.booksApiProvider=k.booksApiProvider||"wikipedia",i.enableGoogleBooksFallback=k.enableGoogleBooksFallback!==!1}}catch(I){console.warn("Failed to load preferences:",I)}},c=()=>{try{const I=localStorage.getItem("profileData"),k=I?JSON.parse(I):{};k.booksApiProvider=i.booksApiProvider,k.enableGoogleBooksFallback=i.enableGoogleBooksFallback,localStorage.setItem("profileData",JSON.stringify(k)),e("preferences-changed",{...i})}catch(I){console.error("Failed to save preferences:",I)}},T=async()=>{t.value=!0,o.value=null;try{const I=await Xe.searchBooks("Harry Potter",3);I.success&&I.data.length>0?o.value={success:!0,message:`âœ… Found ${I.data.length} results using ${I.source}`}:o.value={success:!1,message:`âŒ No results found: ${I.error||"Unknown error"}`}}catch(I){o.value={success:!1,message:`âŒ Test failed: ${I.message}`}}finally{t.value=!1}},A=async()=>{try{const I=await Xe.getApiStatus();r.value=I.googleBooksAvailable?"available":"unavailable"}catch{r.value="unavailable"}};return lt(()=>{g(),A()}),{isExpanded:a,localPreferences:i,testing:t,testResult:o,googleBooksStatus:r,toggleExpanded:l,updatePreferences:c,testSearch:T}}},Za={class:"books-api-control-panel"},Xa={class:"control-header"},$a={key:0,class:"control-content"},eo={class:"form-group"},to={class:"form-group"},so={class:"checkbox-container"},ao={class:"api-status"},oo={class:"status-item"},no={class:"search-preview"},io=["disabled"];function ro(n,e,a,t,o,r){return d(),u("div",Za,[s("div",Xa,[e[6]||(e[6]=s("h4",null,"ðŸ“š Books API Settings",-1)),s("button",{class:J(["toggle-btn",{expanded:t.isExpanded}]),onClick:e[0]||(e[0]=(...i)=>t.toggleExpanded&&t.toggleExpanded(...i))},f(t.isExpanded?"â–¼":"â–¶"),3)]),t.isExpanded?(d(),u("div",$a,[s("div",eo,[e[8]||(e[8]=s("label",{for:"apiProvider"},"Primary API Provider:",-1)),U(s("select",{id:"apiProvider","onUpdate:modelValue":e[1]||(e[1]=i=>t.localPreferences.booksApiProvider=i),onChange:e[2]||(e[2]=(...i)=>t.updatePreferences&&t.updatePreferences(...i))},[...e[7]||(e[7]=[s("option",{value:"wikipedia"},"Wikipedia (Recommended)",-1),s("option",{value:"google_books"},"Google Books",-1),s("option",{value:"both"},"Both APIs",-1)])],544),[[ke,t.localPreferences.booksApiProvider]]),e[9]||(e[9]=s("div",{class:"field-hint"}," Choose your primary source for book information ",-1))]),s("div",to,[s("div",so,[U(s("input",{type:"checkbox",id:"enableFallback","onUpdate:modelValue":e[3]||(e[3]=i=>t.localPreferences.enableGoogleBooksFallback=i),onChange:e[4]||(e[4]=(...i)=>t.updatePreferences&&t.updatePreferences(...i))},null,544),[[dt,t.localPreferences.enableGoogleBooksFallback]]),e[10]||(e[10]=s("label",{for:"enableFallback",class:"checkbox-label"}," Enable Google Books Fallback ",-1))]),e[11]||(e[11]=s("div",{class:"field-hint"}," Use Google Books when primary API fails ",-1))]),s("div",ao,[e[13]||(e[13]=s("div",{class:"status-item"},[s("span",{class:"status-label"},"Wikipedia:"),s("span",{class:"status-value available"},"âœ… Available")],-1)),s("div",oo,[e[12]||(e[12]=s("span",{class:"status-label"},"Google Books:",-1)),s("span",{class:J(["status-value",t.googleBooksStatus])},f(t.googleBooksStatus==="available"?"âœ… Available":"âš ï¸ Check API Key"),3)])]),s("div",no,[s("button",{class:"test-search-btn",onClick:e[5]||(e[5]=(...i)=>t.testSearch&&t.testSearch(...i)),disabled:t.testing},f(t.testing?"Testing...":"Test Search"),9,io),t.testResult?(d(),u("div",{key:0,class:J(["test-result",t.testResult.success?"success":"error"])},f(t.testResult.message),3)):y("",!0)])])):y("",!0)])}const lo=oe(Ka,[["render",ro],["__scopeId","data-v-f9c6cc0b"]]),co={name:"EditModal",components:{BooksApiControlPanel:lo},props:{item:{type:Object,default:null},currentCategory:{type:String,default:"watchlist"}},emits:["close","save","delete"],setup(n,{emit:e}){const a=ze(),t=b(!1),o=b(""),r=b([]),i=b(null),l=b(null),g=b(""),c=Me({category:"watchlist",title:"",release:"",apiRating:"",personalRating:"",count:"",platforms:"",genre:"",description:"",link:"",extraLink:"",path:"",discovered:"",spielzeit:"",isAiring:!1,nextSeason:"",nextSeasonRelease:"",imageUrl:"",watchlistType:"",imageCleared:!1}),T=z(()=>!!n.item),A=z(()=>c.category==="game"),I=z(()=>c.category==="series"),k=z(()=>c.category==="watchlist");Ce(()=>n.item,v=>{v?(v.watchlist_type!==void 0?c.watchlistType=v.watchlist_type||"":v.watchlistType!==void 0?c.watchlistType=v.watchlistType||"":c.watchlistType="",Object.keys(c).forEach(x=>{x!=="watchlistType"&&(c[x]=v[x]||"")}),v.is_airing!==void 0&&(c.isAiring=v.is_airing),v.next_season!==void 0&&(c.nextSeason=v.next_season),v.next_season_release!==void 0&&(c.nextSeasonRelease=v.next_season_release),v.api_rating!==void 0&&(c.apiRating=v.api_rating),v.personal_rating!==void 0&&(c.personalRating=v.personal_rating),v.description!==void 0&&(c.description=v.description),v.image_url!==void 0&&(c.imageUrl=v.image_url),v.path!==void 0&&(c.path=v.path),v.extra_link!==void 0&&(c.extraLink=v.extra_link),v.rating!==void 0&&!c.personalRating&&(c.personalRating=v.rating)):Object.keys(c).forEach(x=>{x==="category"?c[x]=n.currentCategory||"watchlist":x==="release"?c[x]=new Date().toISOString().split("T")[0]:x==="watchlistType"?c[x]=n.currentCategory==="watchlist"?"series":"":c[x]=""})},{immediate:!0}),Ce(()=>n.currentCategory,v=>{!n.item&&v&&(c.category=v)});const K=async()=>{var v,x,H;if(!c.title){o.value="Title is required";return}if(c.category==="watchlist"&&!c.watchlistType){o.value="Please select a type for watchlist items";return}if(c.category==="watchlist"&&!c.release){o.value="Release date is required for watchlist items";return}t.value=!0,o.value="";try{const p={...c};Object.keys(p).forEach(h=>{p[h]===""&&h!=="watchlistType"&&h!=="imageUrl"&&h!=="path"&&h!=="extraLink"&&(p[h]=null)}),g.value?(p.path=g.value,p.imageUrl=g.value):p.imageUrl&&p.imageUrl.trim()?p.path=p.imageUrl:T.value&&n.item?n.item.image_url?(p.imageUrl=n.item.image_url,p.path=n.item.path||n.item.image_url):n.item.path&&(p.path=n.item.path,p.imageUrl=n.item.path):(p.imageUrl=null,p.path=null),p.apiRating!==void 0&&p.apiRating!==null&&p.apiRating!==""&&(p.apiRating=parseFloat(p.apiRating)),p.personalRating!==void 0&&p.personalRating!==null&&p.personalRating!==""&&(p.personalRating=parseFloat(p.personalRating)),p.count!==void 0&&p.count!==null&&p.count!==""&&(p.count=parseInt(p.count)),p.spielzeit!==void 0&&p.spielzeit!==null&&p.spielzeit!==""&&(p.spielzeit=parseInt(p.spielzeit)),p.nextSeason!==void 0&&p.nextSeason!==null&&p.nextSeason!==""&&(p.nextSeason=parseInt(p.nextSeason)),p.watchlistType!==void 0&&(p.watchlist_type=p.watchlistType||null,delete p.watchlistType),p.isAiring!==void 0&&(p.is_airing=p.isAiring,delete p.isAiring),p.nextSeason&&(p.next_season=p.nextSeason,delete p.nextSeason),p.nextSeasonRelease&&(p.next_season_release=p.nextSeasonRelease,delete p.nextSeasonRelease),p.personalRating!==void 0?(p.rating=p.personalRating,delete p.personalRating):p.apiRating!==void 0&&(p.rating=p.apiRating,delete p.apiRating),p.imageUrl&&(p.image_url=p.imageUrl,delete p.imageUrl),p.extraLink!==void 0&&(p.extra_link=p.extraLink,delete p.extraLink),T.value&&n.item?await a.updateMediaItem(n.item.id,p):await a.addMediaItem(p),X()}catch(p){p.isDuplicate||((v=p.response)==null?void 0:v.status)===409&&((H=(x=p.response)==null?void 0:x.data)!=null&&H.duplicate)?o.value="Ein Eintrag mit diesem Titel und dieser Kategorie existiert bereits. Bitte wÃ¤hlen Sie einen anderen Titel oder bearbeiten Sie den bestehenden Eintrag.":o.value=p.message||"Failed to save item"}finally{t.value=!1}},X=()=>{o.value="",e("close")},V=()=>{e("delete",n.item),X()},le=async()=>{if(g.value){r.value=[];return}if(i.value&&clearTimeout(i.value),!c.title||c.title.length<3){r.value=[];return}i.value=setTimeout(async()=>{try{const v=c.category==="watchlist"?c.watchlistType:c.category;if(c.category==="watchlist"&&!c.watchlistType){r.value=[];return}let x=[],H=[];if(v==="buecher"){const p=await Xe.searchBooks(c.title,10);p.success&&p.data&&(H=p.data.map(h=>({title:h.title,release:h.publishedDate?m(h.publishedDate):"",genre:h.categories?h.categories.join(", "):"",platforms:h.author||"",link:h.link||"",imageUrl:h.imageUrl||"",rating:"",apiSource:h.apiSource||p.source,id:h.id,author:h.author,description:h.description,publisher:h.publisher,isbn10:h.isbn10,isbn13:h.isbn13})))}else x=await fe.searchApi(c.title,v,10),x&&x.length>0&&(H=x.map(p=>({title:p.title,release:p.release,genre:p.genre||"",description:p.overview||"",platforms:p.platforms||"",link:p.link||"",imageUrl:p.image||"",rating:p.rating||"",apiSource:p.api_source||"",id:p.id||""})));H.length>0?r.value=H:r.value=[{title:`"${c.title}" - Keine Ergebnisse gefunden`,release:"",genre:"Bitte manuell ausfÃ¼llen",isPlaceholder:!0}]}catch{r.value=[{title:`"${c.title}" - API nicht verfÃ¼gbar`,release:"",genre:"Bitte manuell ausfÃ¼llen",isPlaceholder:!0}]}},500)},pe=async v=>{if(v.isPlaceholder){r.value=[];return}if(c.title=v.title,v.release&&(c.release=v.release),v.platforms&&(c.platforms=v.platforms),v.genre&&(c.genre=v.genre),v.description&&(c.description=v.description),v.link&&(c.link=v.link),v.rating&&(c.apiRating=v.rating),(v.apiSource==="google_books"||v.apiSource==="wikipedia")&&(v.author&&(c.platforms=v.author),v.publisher)){const x=c.link||"";c.link=x||`Publisher: ${v.publisher}`}v.imageUrl?(c.imageUrl=v.imageUrl,c.path=v.imageUrl):(c.imageUrl="",c.path=""),r.value=[]},me=v=>v?new Date(v).toLocaleDateString():"",m=v=>{if(!v)return"";let x;if(typeof v=="string"){if(/^\d{4}$/.test(v))return`${v}-01-01`;if(/^\d{4}-\d{2}$/.test(v))return`${v}-01`;if(/^\d{4}-\d{2}-\d{2}$/.test(v))return v;x=new Date(v)}else x=new Date(v);return isNaN(x.getTime())?"":x.toISOString().split("T")[0]};return{form:c,loading:t,error:o,apiResults:r,isEditing:T,isGame:A,isSeries:I,isWatchlist:k,imageUploadRef:l,uploadedImagePath:g,handleSave:K,closeModal:X,deleteItem:V,searchApi:le,selectApiResult:pe,formatDate:me,formatDateForInput:m,ensureHttpsUrl:v=>v&&(v.startsWith("http://")?v.replace("http://","https://"):v),getReleasePreview:()=>{var h;if(!c.release)return"";const v=new Date(c.release),x=new Date;x.setHours(0,0,0,0),v.setHours(0,0,0,0);const H=v.getTime()-x.getTime(),p=Math.ceil(H/(1e3*3600*24));if(p>0)return p===1?"Tomorrow!":p<=7?`${p} days left`:p<=30?`${p} days left`:`${Math.ceil(p/30)} months left`;if(p===0)return"Released today!";{const S=((h=c.watchlistType)==null?void 0:h.toLowerCase())||"media";return S==="game"?"Unplayed yet":S==="series"||S==="movie"?"Unwatched yet":"Unconsumed yet"}},triggerImageUpload:()=>{var v;(v=l.value)==null||v.click()},handleImageUpload:async v=>{const x=v.target.files[0];if(x){if(!x.type.startsWith("image/")){o.value="Please select a valid image file";return}if(x.size>10*1024*1024){o.value="Image file too large. Maximum size is 10MB";return}t.value=!0,o.value="";try{const H=c.title.replace(/[^a-zA-Z0-9\s\-_\.]/g,"").trim()||"item",p=Date.now(),h=x.name.split(".").pop()||"jpg",S=`images_downloads/uploads/${H}_${p}.${h}`,C=await fe.uploadImage(x,S);C.success?(g.value=C.saved,c.path=C.saved,c.imageUrl=C.saved):o.value=C.error||"Failed to upload image"}catch(H){o.value=H.message||"Failed to upload image"}finally{t.value=!1}}},getImagePreviewUrl:()=>g.value?g.value.startsWith("storage/")?`/${g.value}`:`/storage/${g.value}`:c.imageUrl?c.imageUrl.startsWith("http")?c.imageUrl:c.imageUrl.startsWith("storage/")?`/${c.imageUrl}`:`/storage/${c.imageUrl}`:"",handleImageError:v=>{v.target.style.display="none"},clearImage:()=>{c.imageUrl="",c.path="",g.value="",l.value&&(l.value.value="")},removeUploadedImage:()=>{g.value="",c.imageUrl===g.value&&(c.imageUrl=""),c.path===g.value&&(c.path=""),l.value&&(l.value.value="")},handlePreferencesChanged:v=>{r.value=[]}}}},uo={class:"form-header"},mo={class:"form-group category-group"},go={class:"form-group title-group"},fo={class:"search-container"},po=["placeholder","disabled"],vo={key:0,class:"search-results"},ho=["onClick"],yo={class:"result-thumbnail"},bo=["src","alt"],ko={key:1,class:"no-image"},wo={class:"result-content"},So={class:"result-title"},_o={class:"result-meta"},Io={key:0},Co={key:1},Do={key:2,class:"rating"},xo={class:"form-row"},Ao={class:"form-group"},To={for:"release"},Mo={key:0,class:"required"},Uo=["required"],Ro={key:0,class:"field-hint"},Po={key:1,class:"release-preview"},Bo={class:"form-group"},Fo={class:"form-group"},Eo={class:"form-row"},Lo={class:"form-group"},No={class:"form-group"},Go={class:"form-row"},Wo={class:"form-group"},Vo={class:"form-group"},Oo={class:"form-row"},zo={class:"form-group full-width"},jo={key:0,class:"form-row"},Yo={class:"form-group"},qo={key:0,class:"field-error"},Ho={class:"form-row"},Qo={class:"form-group"},Jo={class:"form-group"},Ko={key:2,class:"form-row"},Zo={class:"form-group"},Xo={key:3,class:"form-row"},$o={class:"form-group"},en={key:0,class:"form-group"},tn={key:4,class:"form-row"},sn={class:"form-group full-width"},an={key:5,class:"form-row"},on={class:"form-group"},nn={class:"form-row"},rn={class:"form-group"},ln={class:"form-group"},dn={class:"image-upload-container"},cn=["disabled"],un={key:0,class:"upload-success"},mn={key:6,class:"form-row"},gn={class:"form-group image-preview-group"},fn={class:"image-preview"},pn=["src","alt"],vn={key:7,class:"error-message"},hn={class:"modal-buttons"},yn=["disabled"],bn=["disabled"],kn=["disabled"],wn=["disabled"];function Sn(n,e,a,t,o,r){const i=ie("BooksApiControlPanel");return d(),u("div",{class:"modal",onClick:e[30]||(e[30]=(...l)=>t.closeModal&&t.closeModal(...l))},[s("div",{class:"modal-content",onClick:e[29]||(e[29]=ue(()=>{},["stop"]))},[s("h2",null,f(t.isEditing?"Edit Item":"Add Item"),1),s("form",{onSubmit:e[28]||(e[28]=ue((...l)=>t.handleSave&&t.handleSave(...l),["prevent"]))},[s("div",uo,[s("div",mo,[e[32]||(e[32]=s("label",{for:"category"},"Category:",-1)),U(s("select",{id:"category","onUpdate:modelValue":e[0]||(e[0]=l=>t.form.category=l),required:""},[...e[31]||(e[31]=[Ve('<option value="watchlist" data-v-c046ffe3>Watchlist</option><option value="game" data-v-c046ffe3>Game</option><option value="series" data-v-c046ffe3>Series</option><option value="movie" data-v-c046ffe3>Movie</option><option value="buecher" data-v-c046ffe3>BÃ¼cher</option>',5)])],512),[[ke,t.form.category]])]),s("div",go,[e[33]||(e[33]=s("label",{for:"title"},"Title:",-1)),s("div",fo,[U(s("input",{type:"text",id:"title","onUpdate:modelValue":e[1]||(e[1]=l=>t.form.title=l),onInput:e[2]||(e[2]=(...l)=>t.searchApi&&t.searchApi(...l)),required:"",placeholder:t.isWatchlist?"Enter title (API search + manual input available)":"Enter title",disabled:t.loading},null,40,po),[[G,t.form.title]]),t.apiResults.length>0?(d(),u("div",vo,[(d(!0),u(se,null,ae(t.apiResults,l=>(d(),u("div",{key:l.title,class:"search-result-item",onClick:g=>t.selectApiResult(l)},[s("div",yo,[l.imageUrl?(d(),u("img",{key:0,src:t.ensureHttpsUrl(l.imageUrl),alt:l.title},null,8,bo)):(d(),u("div",ko,[s("span",null,f(l.title.charAt(0).toUpperCase()),1)]))]),s("div",wo,[s("div",So,f(l.title),1),s("div",_o,[l.release?(d(),u("span",Io,f(t.formatDate(l.release)),1)):y("",!0),l.genre?(d(),u("span",Co,f(l.genre),1)):y("",!0),l.rating?(d(),u("span",Do,"â­ "+f(l.rating),1)):y("",!0)])])],8,ho))),128))])):y("",!0)])])]),s("div",xo,[s("div",Ao,[s("label",To,[Ae(f(t.isWatchlist?"Release Date:":"Release:")+" ",1),t.isWatchlist?(d(),u("span",Mo,"*")):y("",!0)]),U(s("input",{type:"date",id:"release","onUpdate:modelValue":e[3]||(e[3]=l=>t.form.release=l),required:t.isWatchlist},null,8,Uo),[[G,t.form.release]]),t.isWatchlist?(d(),u("div",Ro," ðŸ“… Set the release date to track countdown or status ")):y("",!0),t.isWatchlist&&t.form.release?(d(),u("div",Po,[e[34]||(e[34]=s("strong",null,"Preview:",-1)),Ae(" "+f(t.getReleasePreview()),1)])):y("",!0)]),s("div",Bo,[e[35]||(e[35]=s("label",{for:"apiRating"},"API Rating:",-1)),U(s("input",{type:"number",id:"apiRating","onUpdate:modelValue":e[4]||(e[4]=l=>t.form.apiRating=l),step:"0.1",min:"0",max:"10",placeholder:"0-10",readonly:""},null,512),[[G,t.form.apiRating]]),e[36]||(e[36]=s("div",{class:"field-hint"},"From API - read only",-1))]),s("div",Fo,[e[37]||(e[37]=s("label",{for:"personalRating"},"Personal Rating:",-1)),U(s("input",{type:"number",id:"personalRating","onUpdate:modelValue":e[5]||(e[5]=l=>t.form.personalRating=l),step:"0.1",min:"0",max:"10",placeholder:"0-10"},null,512),[[G,t.form.personalRating]]),e[38]||(e[38]=s("div",{class:"field-hint"},"Your personal rating",-1))])]),s("div",Eo,[s("div",Lo,[e[39]||(e[39]=s("label",{for:"views"},"Views:",-1)),U(s("input",{type:"number",id:"views","onUpdate:modelValue":e[6]||(e[6]=l=>t.form.count=l),min:"0",placeholder:"0"},null,512),[[G,t.form.count]])]),s("div",No,[e[40]||(e[40]=s("label",{for:"discovered"},"Discovered:",-1)),U(s("input",{type:"date",id:"discovered","onUpdate:modelValue":e[7]||(e[7]=l=>t.form.discovered=l)},null,512),[[G,t.form.discovered]])])]),s("div",Go,[s("div",Wo,[e[41]||(e[41]=s("label",{for:"platforms"},"Platforms:",-1)),U(s("input",{type:"text",id:"platforms","onUpdate:modelValue":e[8]||(e[8]=l=>t.form.platforms=l),placeholder:"PC, PS5, Xbox"},null,512),[[G,t.form.platforms]])]),s("div",Vo,[e[42]||(e[42]=s("label",{for:"genre"},"Genre:",-1)),U(s("input",{type:"text",id:"genre","onUpdate:modelValue":e[9]||(e[9]=l=>t.form.genre=l),placeholder:"Action, Adventure, RPG"},null,512),[[G,t.form.genre]])])]),s("div",Oo,[s("div",zo,[e[43]||(e[43]=s("label",{for:"description"},"Description:",-1)),U(s("textarea",{id:"description","onUpdate:modelValue":e[10]||(e[10]=l=>t.form.description=l),placeholder:"Enter description...",rows:"3"},null,512),[[G,t.form.description]])])]),t.form.category==="watchlist"?(d(),u("div",jo,[s("div",Yo,[e[45]||(e[45]=s("label",{for:"watchlistType"},[Ae("Type: "),s("span",{class:"required"},"*")],-1)),U(s("select",{id:"watchlistType","onUpdate:modelValue":e[11]||(e[11]=l=>t.form.watchlistType=l)},[...e[44]||(e[44]=[Ve('<option value="" data-v-c046ffe3>Select Type</option><option value="game" data-v-c046ffe3>Game</option><option value="series" data-v-c046ffe3>Series</option><option value="movie" data-v-c046ffe3>Movie</option><option value="buecher" data-v-c046ffe3>BÃ¼cher</option>',5)])],512),[[ke,t.form.watchlistType]]),t.form.category==="watchlist"&&!t.form.watchlistType?(d(),u("div",qo," Please select a type for watchlist items ")):y("",!0)])])):y("",!0),t.form.category==="buecher"||t.form.watchlistType==="buecher"?(d(),xe(i,{key:1,expanded:!1,onPreferencesChanged:t.handlePreferencesChanged},null,8,["onPreferencesChanged"])):y("",!0),s("div",Ho,[s("div",Qo,[e[46]||(e[46]=s("label",{for:"link"},"Link:",-1)),U(s("input",{type:"url",id:"link","onUpdate:modelValue":e[12]||(e[12]=l=>t.form.link=l),placeholder:"https://..."},null,512),[[G,t.form.link]])]),s("div",Jo,[e[47]||(e[47]=s("label",{for:"path"},"Image Path:",-1)),U(s("input",{type:"text",id:"path","onUpdate:modelValue":e[13]||(e[13]=l=>t.form.path=l),placeholder:"images/movies/filename.jpg"},null,512),[[G,t.form.path]])])]),t.isGame?(d(),u("div",Ko,[s("div",Zo,[e[48]||(e[48]=s("label",{for:"playtime"},"Playtime (Minutes):",-1)),U(s("input",{type:"number",id:"playtime","onUpdate:modelValue":e[14]||(e[14]=l=>t.form.spielzeit=l),min:"0",placeholder:"0"},null,512),[[G,t.form.spielzeit]])])])):y("",!0),t.isSeries?(d(),u("div",Xo,[s("div",$o,[e[50]||(e[50]=s("label",{for:"isAiring"},"Status:",-1)),U(s("select",{id:"isAiring","onUpdate:modelValue":e[15]||(e[15]=l=>t.form.isAiring=l)},[...e[49]||(e[49]=[s("option",{value:!1},"Finished",-1),s("option",{value:!0},"Airing",-1)])],512),[[ke,t.form.isAiring]])]),t.form.isAiring?(d(),u("div",en,[e[51]||(e[51]=s("label",{for:"nextSeason"},"Next Season:",-1)),U(s("input",{type:"number",id:"nextSeason","onUpdate:modelValue":e[16]||(e[16]=l=>t.form.nextSeason=l),min:"1",placeholder:"1"},null,512),[[G,t.form.nextSeason]])])):y("",!0)])):y("",!0),t.isSeries?(d(),u("div",tn,[s("div",sn,[e[52]||(e[52]=s("label",{for:"extraLink"},"Extra Link:",-1)),U(s("input",{type:"url",id:"extraLink","onUpdate:modelValue":e[17]||(e[17]=l=>t.form.extraLink=l),placeholder:"https://... (e.g., streaming platform, official website)"},null,512),[[G,t.form.extraLink]]),e[53]||(e[53]=s("div",{class:"field-hint"},"Optional: Additional link for series (e.g., streaming platform, official website)",-1))])])):y("",!0),t.form.isAiring?(d(),u("div",an,[s("div",on,[e[54]||(e[54]=s("label",{for:"nextSeasonRelease"},"Next Season Release:",-1)),U(s("input",{type:"date",id:"nextSeasonRelease","onUpdate:modelValue":e[18]||(e[18]=l=>t.form.nextSeasonRelease=l)},null,512),[[G,t.form.nextSeasonRelease]])])])):y("",!0),s("div",nn,[s("div",rn,[e[55]||(e[55]=s("label",{for:"imageUrl"},"Image URL (optional):",-1)),U(s("input",{type:"text",id:"imageUrl","onUpdate:modelValue":e[19]||(e[19]=l=>t.form.imageUrl=l),placeholder:"https://... or leave empty for API images"},null,512),[[G,t.form.imageUrl]])]),s("div",ln,[e[56]||(e[56]=s("label",{for:"imageUpload"},"Upload Image:",-1)),s("div",dn,[s("input",{type:"file",id:"imageUpload",ref:"imageUploadRef",onChange:e[20]||(e[20]=(...l)=>t.handleImageUpload&&t.handleImageUpload(...l)),accept:"image/*",style:{display:"none"}},null,544),s("button",{type:"button",onClick:e[21]||(e[21]=(...l)=>t.triggerImageUpload&&t.triggerImageUpload(...l)),class:"upload-btn",disabled:t.loading}," ðŸ“ Choose Image ",8,cn),t.uploadedImagePath?(d(),u("div",un,[Ae(" âœ… Image uploaded: "+f(t.uploadedImagePath)+" ",1),s("button",{type:"button",onClick:e[22]||(e[22]=(...l)=>t.removeUploadedImage&&t.removeUploadedImage(...l)),class:"remove-uploaded-btn",title:"Remove uploaded image to enable API search"}," âœ• Remove ")])):y("",!0)])])]),t.form.imageUrl||t.uploadedImagePath?(d(),u("div",mn,[s("div",gn,[e[57]||(e[57]=s("label",null,"Image Preview:",-1)),s("div",fn,[s("img",{src:t.getImagePreviewUrl(),alt:t.form.title,onError:e[23]||(e[23]=(...l)=>t.handleImageError&&t.handleImageError(...l))},null,40,pn),s("button",{type:"button",onClick:e[24]||(e[24]=(...l)=>t.clearImage&&t.clearImage(...l)),class:"clear-image-btn",title:"Remove image"}," âœ• ")])])])):y("",!0),t.error?(d(),u("div",vn,f(t.error),1)):y("",!0),s("div",hn,[s("button",{type:"submit",disabled:t.loading},f(t.loading?"Saving...":"Save"),9,yn),s("button",{type:"button",onClick:e[25]||(e[25]=(...l)=>t.closeModal&&t.closeModal(...l)),disabled:t.loading}," Cancel ",8,bn),t.isEditing?(d(),u("button",{key:0,type:"button",onClick:e[26]||(e[26]=(...l)=>t.deleteItem&&t.deleteItem(...l)),disabled:t.loading,class:"delete-btn"}," Delete ",8,kn)):y("",!0),s("button",{type:"button",onClick:e[27]||(e[27]=(...l)=>t.handleSave&&t.handleSave(...l)),disabled:t.loading,class:"check-btn",title:"Add to list"}," âœ“ ",8,wn)])],32)])])}const _n=oe(co,[["render",Sn],["__scopeId","data-v-c046ffe3"]]),In={name:"BulkAddModal",props:{show:{type:Boolean,default:!1},currentCategory:{type:String,default:""}},emits:["close"],setup(n,{emit:e}){const a=ze(),t=b(1),o=b(!1),r=b(!0),i=b(!1),l=b(0),g=b(0),c=b(0),T=b(0),A=b(null),I=b(""),k=b(""),K=b([]),X=b([]),V=b({category:"",itemsText:"",defaultRating:null}),le=z(()=>V.value.category&&V.value.itemsText.trim()&&!o.value),pe=z(()=>{const j=me().length;return j>0?Math.round(l.value/j*100):0}),me=()=>!V.value.itemsText||!V.value.itemsText.trim()?[]:V.value.itemsText.split(`
`).map(j=>j.trim()).filter(j=>j.length>0).map(j=>{const v=j.split("|").map(x=>x.trim());return{searchTerm:v[0]||"",additionalInfo:v[1]||null}}),m=()=>{l.value=0,g.value=0,c.value=0,T.value=0,A.value=null,I.value="",k.value="",K.value=[],X.value=[]},O=(j,v,x)=>{A.value=j,I.value=v,k.value=x},de=(j,v,x="")=>{const H={searching:"Searching...",found:"Found",adding:"Adding...",added:"Added",skipped:"Skipped",error:"Error"}[v]||v;K.value.push({title:j,status:v,statusText:H,message:x})},ce=async()=>{var x,H,p;if(!le.value)return;t.value=2,o.value=!0,r.value=!0,m();const j=me();let v=0;try{let h=[];const S=localStorage.getItem("authToken"),C=localStorage.getItem("currentUser");if(S&&C)try{O({title:"Checking all items..."},"searching","Checking profile for duplicates..."),h=(await fe.checkExistingItems(j.map(_=>({title:_.searchTerm,category:V.value.category})))).existing_items||[]}catch(M){console.warn("Failed to check existing items, falling back to individual checks:",M)}for(let M=0;M<j.length;M++){const _=j[M];l.value=M+1,O({title:_.searchTerm,description:_.additionalInfo},"searching","Processing...");try{let F=!1;if(S&&C&&h.length>0?F=h.some(E=>E.title.toLowerCase().trim()===_.searchTerm.toLowerCase().trim()):F=(a.mediaData||[]).some(ge=>ge.title&&ge.title.toLowerCase().trim()===_.searchTerm.toLowerCase().trim()&&ge.category===V.value.category),F){console.log(`âœ… Found exact match in profile for "${_.searchTerm}"`),O({title:_.searchTerm},"skipped","Already exists in profile - skipped"),X.value.push({searchTerm:_.searchTerm,additionalInfo:_.additionalInfo,reason:"duplicate"}),c.value++,de(_.searchTerm,"skipped","Already exists in profile - skipped");continue}O({title:_.searchTerm,description:_.additionalInfo},"searching","Searching API..."),de(_.searchTerm,"searching","Searching API...");const re=await fe.searchApi(_.searchTerm,V.value.category,1);if(re&&re.length>0&&re[0]&&re[0].api_source&&re[0].image){const E=re[0];console.log(`âœ… Found real API data for "${_.searchTerm}":`,{title:E.title,api_source:E.api_source,has_image:!!E.image,has_genre:!!E.genre,has_release:!!E.release}),O({title:E.title,description:`Found: ${E.genre||"Unknown genre"} â€¢ ${E.release||"Unknown year"} â€¢ ${E.api_source}`},"found","Found in API with data"),de(_.searchTerm,"found",`Found: ${E.title} (${E.api_source})`),O({title:E.title},"adding","Adding to library...");const ge={title:E.title,category:V.value.category,release:E.release||null,rating:E.rating?Math.round(E.rating):V.value.defaultRating||null,platforms:E.platforms||null,genre:E.genre||null,link:E.link||null,path:E.image||null,external_id:E.id||null,count:1,is_airing:!1,spielzeit:0,description:E.overview||_.additionalInfo||null};await a.addMediaItem(ge,!0),g.value++,O({title:E.title},"added","Successfully added with API data"),de(_.searchTerm,"added",`Added: ${E.title} with API data`)}else console.log(`âŒ No real API data found for "${_.searchTerm}"`),O({title:_.searchTerm},"skipped","No API data found - will retry"),X.value.push({searchTerm:_.searchTerm,additionalInfo:_.additionalInfo,reason:"no_api_data"}),c.value++,de(_.searchTerm,"skipped","No API data found - ready for retry")}catch(F){console.error(`Error processing "${_.searchTerm}":`,F),F.isDuplicate||((x=F.response)==null?void 0:x.status)===409&&((p=(H=F.response)==null?void 0:H.data)!=null&&p.duplicate)?(O({title:_.searchTerm},"skipped","Already exists - skipped"),c.value++,de(_.searchTerm,"skipped","Item already exists in library")):(O({title:_.searchTerm},"error","Error occurred"),T.value++,de(_.searchTerm,"error",F.message||"Unknown error"))}if(v++,v>=5){console.log("ðŸ”„ Reloading media data after 5 items...");try{await a.loadMedia(),v=0}catch(F){console.warn("Failed to reload media data:",F)}}if(!o.value)break;for(;i.value&&o.value;)await new Promise(F=>setTimeout(F,100));await new Promise(F=>setTimeout(F,1e3))}console.log("ðŸ”„ Final media data reload...");try{await a.loadMedia()}catch(M){console.warn("Failed to reload media data at end:",M)}t.value=3,O(null,"","")}catch(h){console.error("Bulk processing error:",h),T.value++}finally{o.value=!1,r.value=!1}},Se=()=>{o.value=!1,r.value=!1,i.value=!1,t.value=1,m()},ve=()=>{i.value=!0},_e=()=>{i.value=!1},Ie=()=>{const j=X.value.filter(x=>x.reason!=="duplicate");if(j.length===0){$();return}const v=j.map(x=>x.additionalInfo?`${x.searchTerm} | ${x.additionalInfo}`:x.searchTerm).join(`
`);V.value.itemsText=v,l.value=0,g.value=0,T.value=0,A.value=null,I.value="",k.value="",K.value=[],t.value=1},$=()=>{t.value=1,o.value=!1,r.value=!0,m(),V.value={category:"",itemsText:"",defaultRating:null},e("close")};return Ce(()=>n.show,j=>{j&&n.currentCategory?V.value.category=n.currentCategory:j||$()}),{currentStep:t,isProcessing:o,canCancel:r,isPaused:i,processedCount:l,addedCount:g,skippedCount:c,errorCount:T,currentItem:A,currentItemStatus:I,currentItemStatusText:k,processingResults:K,skippedItems:X,bulkData:V,canStart:le,progressPercentage:pe,startProcessing:ce,cancelProcessing:Se,pauseProcessing:ve,resumeProcessing:_e,retrySkippedItems:Ie,closeModal:$}}},Cn={class:"modal-header"},Dn={class:"modal-body"},xn={key:0,class:"step-container"},An={class:"bulk-add-form"},Tn={class:"form-group"},Mn={class:"form-group"},Un={class:"form-group"},Rn={key:1,class:"step-container"},Pn={class:"processing-container"},Bn={class:"progress-overview"},Fn={class:"progress-stats"},En={class:"stat"},Ln={class:"stat-number"},Nn={class:"stat"},Gn={class:"stat-number"},Wn={class:"stat"},Vn={class:"stat-number"},On={class:"stat"},zn={class:"stat-number"},jn={class:"progress-bar"},Yn={class:"progress-text"},qn={class:"current-item"},Hn={class:"current-item-header"},Qn={class:"current-item-title"},Jn={key:0,class:"paused-indicator"},Kn={key:0,class:"current-item-description"},Zn={key:1,class:"api-data-indicator"},Xn={key:2,class:"no-api-indicator"},$n={class:"results-list"},ei={class:"result-header"},ti={class:"result-title"},si={class:"result-status"},ai={key:0,class:"result-message"},oi={key:2,class:"step-container"},ni={class:"results-summary"},ii={class:"summary-stats"},ri={class:"summary-stat success"},li={class:"stat-number"},di={class:"summary-stat warning"},ci={class:"stat-number"},ui={class:"summary-stat info"},mi={class:"stat-number"},gi={class:"summary-stat error"},fi={class:"stat-number"},pi={key:0,class:"retry-section"},vi={class:"retry-list"},hi=["onUpdate:modelValue","disabled"],yi={key:0,class:"retry-additional"},bi={key:1,class:"duplicate-badge"},ki={key:2,class:"retry-badge"},wi={key:1,class:"detailed-results"},Si={class:"results-list"},_i={class:"result-header"},Ii={class:"result-title"},Ci={class:"result-status"},Di={key:0,class:"result-message"},xi={class:"modal-footer"},Ai=["disabled"],Ti={key:2,class:"processing-controls"},Mi=["disabled"],Ui=["disabled"],Ri={key:3,class:"footer-buttons"};function Pi(n,e,a,t,o,r){var i,l;return a.show?(d(),u("div",{key:0,class:"modal-overlay",onClick:e[12]||(e[12]=(...g)=>t.closeModal&&t.closeModal(...g))},[s("div",{class:"modal-content",onClick:e[11]||(e[11]=ue(()=>{},["stop"]))},[s("div",Cn,[e[13]||(e[13]=s("h2",null,"Bulk Add Items",-1)),s("button",{class:"close-btn",onClick:e[0]||(e[0]=(...g)=>t.closeModal&&t.closeModal(...g))},"âœ•")]),s("div",Dn,[t.currentStep===1?(d(),u("div",xn,[e[19]||(e[19]=s("div",{class:"step-header"},[s("div",{class:"step-number"},"1"),s("h3",null,"Enter Your List")],-1)),s("div",An,[s("div",Tn,[e[15]||(e[15]=s("label",{for:"category"},"Category *",-1)),U(s("select",{id:"category","onUpdate:modelValue":e[1]||(e[1]=g=>t.bulkData.category=g),required:""},[...e[14]||(e[14]=[Ve('<option value="" data-v-cfe7bded>Select Category</option><option value="game" data-v-cfe7bded>Game</option><option value="series" data-v-cfe7bded>Series</option><option value="movie" data-v-cfe7bded>Movie</option><option value="buecher" data-v-cfe7bded>BÃ¼cher</option><option value="watchlist" data-v-cfe7bded>Watchlist</option>',6)])],512),[[ke,t.bulkData.category]])]),s("div",Mn,[e[16]||(e[16]=s("label",{for:"items-text"},"Items (one per line) *",-1)),U(s("textarea",{id:"items-text","onUpdate:modelValue":e[2]||(e[2]=g=>t.bulkData.itemsText=g),placeholder:`Enter items one per line, for example:
The Witcher 3
Cyberpunk 2077
Red Dead Redemption 2`,rows:"10",required:""},null,512),[[G,t.bulkData.itemsText]]),e[17]||(e[17]=s("small",{class:"help-text"},"Enter one item per line. The system will automatically search and add each item individually.",-1))]),s("div",Un,[e[18]||(e[18]=s("label",{for:"default-rating"},"Default Rating",-1)),U(s("input",{id:"default-rating","onUpdate:modelValue":e[3]||(e[3]=g=>t.bulkData.defaultRating=g),type:"number",min:"0",max:"10",step:"0.1",placeholder:"Optional rating for all items"},null,512),[[G,t.bulkData.defaultRating,void 0,{number:!0}]])])])])):y("",!0),t.currentStep===2?(d(),u("div",Rn,[e[24]||(e[24]=s("div",{class:"step-header"},[s("div",{class:"step-number"},"2"),s("h3",null,"Processing Items")],-1)),s("div",Pn,[s("div",Bn,[s("div",Fn,[s("span",En,[s("span",Ln,f(t.processedCount),1),e[20]||(e[20]=s("span",{class:"stat-label"},"Processed",-1))]),s("span",Nn,[s("span",Gn,f(t.addedCount),1),e[21]||(e[21]=s("span",{class:"stat-label"},"Added",-1))]),s("span",Wn,[s("span",Vn,f(t.skippedCount),1),e[22]||(e[22]=s("span",{class:"stat-label"},"Skipped",-1))]),s("span",On,[s("span",zn,f(t.errorCount),1),e[23]||(e[23]=s("span",{class:"stat-label"},"Errors",-1))])]),s("div",jn,[s("div",{class:"progress-fill",style:Te({width:t.progressPercentage+"%"})},null,4)]),s("div",Yn,f(t.progressPercentage)+"% Complete",1)]),s("div",qn,[s("div",Hn,[s("span",Qn,"Processing: "+f(((i=t.currentItem)==null?void 0:i.title)||"..."),1),s("span",{class:J(["current-item-status",t.currentItemStatus])},[t.isPaused?(d(),u("span",Jn,"â¸ï¸ PAUSED - ")):y("",!0),Ae(f(t.currentItemStatusText),1)],2)]),(l=t.currentItem)!=null&&l.description?(d(),u("div",Kn,f(t.currentItem.description),1)):y("",!0),t.currentItemStatus==="found"?(d(),u("div",Zn," âœ… Real API data found with image and metadata ")):y("",!0),t.currentItemStatus==="skipped"?(d(),u("div",Xn," âŒ No API data found - will be retried ")):y("",!0)]),s("div",$n,[(d(!0),u(se,null,ae(t.processingResults,(g,c)=>(d(),u("div",{key:c,class:J(["result-item",g.status])},[s("div",ei,[s("span",ti,f(g.title),1),s("span",si,f(g.statusText),1)]),g.message?(d(),u("div",ai,f(g.message),1)):y("",!0)],2))),128))])])])):y("",!0),t.currentStep===3?(d(),u("div",oi,[e[32]||(e[32]=s("div",{class:"step-header"},[s("div",{class:"step-number"},"3"),s("h3",null,"Results")],-1)),s("div",ni,[s("div",ii,[s("div",ri,[s("span",li,f(t.addedCount),1),e[25]||(e[25]=s("span",{class:"stat-label"},"Successfully Added",-1))]),s("div",di,[s("span",ci,f(t.skippedItems.filter(g=>g.reason!=="duplicate").length),1),e[26]||(e[26]=s("span",{class:"stat-label"},"Not Found (Ready for Retry)",-1))]),s("div",ui,[s("span",mi,f(t.skippedItems.filter(g=>g.reason==="duplicate").length),1),e[27]||(e[27]=s("span",{class:"stat-label"},"Already in Profile",-1))]),s("div",gi,[s("span",fi,f(t.errorCount),1),e[28]||(e[28]=s("span",{class:"stat-label"},"Errors",-1))])]),t.skippedItems.length>0?(d(),u("div",pi,[e[29]||(e[29]=s("h4",null,"Items Ready for Retry",-1)),e[30]||(e[30]=s("p",{class:"retry-description"}," The following items can be edited and tried again: ",-1)),s("div",vi,[(d(!0),u(se,null,ae(t.skippedItems,(g,c)=>(d(),u("div",{key:c,class:J(["retry-item",{"duplicate-item":g.reason==="duplicate"}])},[U(s("input",{"onUpdate:modelValue":T=>g.searchTerm=T,class:"retry-input",placeholder:"Edit search term...",disabled:g.reason==="duplicate"},null,8,hi),[[G,g.searchTerm]]),g.additionalInfo?(d(),u("span",yi," | "+f(g.additionalInfo),1)):y("",!0),g.reason==="duplicate"?(d(),u("span",bi," Already in profile ")):(d(),u("span",ki," No API data "))],2))),128))])])):y("",!0),t.processingResults.length>0?(d(),u("div",wi,[e[31]||(e[31]=s("h4",null,"Detailed Results",-1)),s("div",Si,[(d(!0),u(se,null,ae(t.processingResults,(g,c)=>(d(),u("div",{key:c,class:J(["result-item",g.status])},[s("div",_i,[s("span",Ii,f(g.title),1),s("span",Ci,f(g.statusText),1)]),g.message?(d(),u("div",Di,f(g.message),1)):y("",!0)],2))),128))])])):y("",!0)])])):y("",!0)]),s("div",xi,[t.currentStep===1?(d(),u("button",{key:0,class:"btn btn-secondary",onClick:e[4]||(e[4]=(...g)=>t.closeModal&&t.closeModal(...g))}," Cancel ")):y("",!0),t.currentStep===1?(d(),u("button",{key:1,class:"btn btn-primary",onClick:e[5]||(e[5]=(...g)=>t.startProcessing&&t.startProcessing(...g)),disabled:!t.canStart}," Check All and Add ",8,Ai)):y("",!0),t.currentStep===2?(d(),u("div",Ti,[s("button",{class:"btn btn-secondary",onClick:e[6]||(e[6]=(...g)=>t.cancelProcessing&&t.cancelProcessing(...g)),disabled:!t.canCancel}," Cancel ",8,Mi),t.isPaused?y("",!0):(d(),u("button",{key:0,class:"btn btn-warning",onClick:e[7]||(e[7]=(...g)=>t.pauseProcessing&&t.pauseProcessing(...g)),disabled:!t.isProcessing}," Pause ",8,Ui)),t.isPaused?(d(),u("button",{key:1,class:"btn btn-primary",onClick:e[8]||(e[8]=(...g)=>t.resumeProcessing&&t.resumeProcessing(...g))}," Resume ")):y("",!0)])):y("",!0),t.currentStep===3?(d(),u("div",Ri,[t.skippedItems.filter(g=>g.reason!=="duplicate").length>0?(d(),u("button",{key:0,class:"btn btn-warning",onClick:e[9]||(e[9]=(...g)=>t.retrySkippedItems&&t.retrySkippedItems(...g))}," Retry "+f(t.skippedItems.filter(g=>g.reason!=="duplicate").length)+" Items ",1)):y("",!0),s("button",{class:"btn btn-primary",onClick:e[10]||(e[10]=(...g)=>t.closeModal&&t.closeModal(...g))}," Done ")])):y("",!0)])])])):y("",!0)}const Bi=oe(In,[["render",Pi],["__scopeId","data-v-cfe7bded"]]),Fi={name:"TxtImportModal",props:{show:{type:Boolean,default:!1}},emits:["close","fileProcessed"],methods:{handleFileUpload(n){const e=n.target.files[0];if(!e)return;if(!e.name.toLowerCase().endsWith(".txt")){alert("Bitte wÃ¤hlen Sie eine .txt Datei aus.");return}const a=new FileReader;a.onload=t=>{const o=t.target.result;this.$emit("fileProcessed",o)},a.readAsText(e,"UTF-8")}}},Ei={class:"file-upload-area"},Li={class:"modal-buttons"};function Ni(n,e,a,t,o,r){return a.show?(d(),u("div",{key:0,class:"modal",onClick:e[3]||(e[3]=i=>n.$emit("close"))},[s("div",{class:"modal-content",onClick:e[2]||(e[2]=ue(()=>{},["stop"]))},[e[5]||(e[5]=s("h2",null,"ðŸ“„ Import from TXT File",-1)),e[6]||(e[6]=s("p",null,"WÃ¤hlen Sie eine .txt Datei mit einer Liste von Titeln aus, um zu prÃ¼fen, welche Items in der aktuellen Kategorie fehlen.",-1)),s("div",Ei,[s("input",{type:"file",id:"txtFileInput",accept:".txt",onChange:e[0]||(e[0]=(...i)=>r.handleFileUpload&&r.handleFileUpload(...i)),style:{display:"none"}},null,32),e[4]||(e[4]=s("label",{for:"txtFileInput",class:"file-upload-label"},[s("span",{class:"upload-icon"},"ðŸ“"),s("span",{class:"upload-text"},"TXT-Datei auswÃ¤hlen"),s("span",{class:"upload-hint"},"Eine .txt Datei mit einer Liste von Titeln")],-1))]),s("div",Li,[s("button",{type:"button",onClick:e[1]||(e[1]=i=>n.$emit("close"))}," Cancel ")])])])):y("",!0)}const Gi=oe(Fi,[["render",Ni],["__scopeId","data-v-e20860d6"]]),Wi={name:"TxtImportResultsModal",props:{show:{type:Boolean,default:!1},results:{type:Object,default:null}},emits:["close"]},Vi={class:"results-summary"},Oi={class:"summary-item"},zi={class:"summary-value"},ji={class:"summary-item"},Yi={class:"summary-value"},qi={class:"summary-item"},Hi={class:"summary-value existing"},Qi={class:"summary-item"},Ji={class:"summary-value missing"},Ki={key:0,class:"missing-items"},Zi={class:"items-list"},Xi={key:1,class:"existing-items"},$i={class:"items-list"},er={class:"modal-buttons"};function tr(n,e,a,t,o,r){return a.show&&a.results?(d(),u("div",{key:0,class:"modal",onClick:e[2]||(e[2]=i=>n.$emit("close"))},[s("div",{class:"modal-content results-modal",onClick:e[1]||(e[1]=ue(()=>{},["stop"]))},[e[7]||(e[7]=s("h2",null,"ðŸ“Š TXT Import Ergebnisse",-1)),s("div",Vi,[s("div",Oi,[e[3]||(e[3]=s("span",{class:"summary-label"},"Kategorie:",-1)),s("span",zi,f(a.results.categoryName),1)]),s("div",ji,[e[4]||(e[4]=s("span",{class:"summary-label"},"Titel in Datei:",-1)),s("span",Yi,f(a.results.totalInFile),1)]),s("div",qi,[e[5]||(e[5]=s("span",{class:"summary-label"},"Bereits vorhanden:",-1)),s("span",Hi,f(a.results.existingItems.length),1)]),s("div",Qi,[e[6]||(e[6]=s("span",{class:"summary-label"},"Fehlende Titel:",-1)),s("span",Ji,f(a.results.missingItems.length),1)])]),a.results.missingItems.length>0?(d(),u("div",Ki,[s("h3",null,"âŒ Fehlende Titel ("+f(a.results.missingItems.length)+"):",1),s("div",Zi,[(d(!0),u(se,null,ae(a.results.missingItems,(i,l)=>(d(),u("div",{key:l,class:"missing-item"},f(i),1))),128))])])):y("",!0),a.results.existingItems.length>0?(d(),u("div",Xi,[s("h3",null,"âœ… Bereits vorhanden ("+f(a.results.existingItems.length)+"):",1),s("div",$i,[(d(!0),u(se,null,ae(a.results.existingItems,(i,l)=>(d(),u("div",{key:l,class:"existing-item"},f(i),1))),128))])])):y("",!0),s("div",er,[s("button",{type:"button",onClick:e[0]||(e[0]=i=>n.$emit("close"))}," SchlieÃŸen ")])])])):y("",!0)}const sr=oe(Wi,[["render",tr],["__scopeId","data-v-ec385b83"]]),ar={name:"SimpleAddItem",setup(){const n=b(!1),e=b(null),a=Me({title:"Test Game",category:"game",release:"2003-01-01",count:1});return{form:a,loading:n,result:e,addItem:async()=>{n.value=!0,e.value=null;try{const o=window.location.origin,r=await fetch(`${o}/api/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:"admin@example.com",password:"admin123"})});if(!r.ok)throw new Error("Login failed");const l=(await r.json()).token,c=await(await fetch(`${o}/api/media`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify(a)})).json();c.success?e.value={success:!0,message:`Success! Item added with ID: ${c.data.id}`}:e.value={success:!1,message:`Error: ${JSON.stringify(c)}`}}catch(o){e.value={success:!1,message:`Error: ${o.message}`}}finally{n.value=!1}}}}},or={class:"simple-add-item"},nr=["disabled"];function ir(n,e,a,t,o,r){return d(),u("div",or,[e[10]||(e[10]=s("h3",null,"Simple Add Item Test",-1)),s("form",{onSubmit:e[4]||(e[4]=ue((...i)=>t.addItem&&t.addItem(...i),["prevent"]))},[s("div",null,[e[5]||(e[5]=s("label",null,"Title:",-1)),U(s("input",{"onUpdate:modelValue":e[0]||(e[0]=i=>t.form.title=i),type:"text",required:""},null,512),[[G,t.form.title]])]),s("div",null,[e[7]||(e[7]=s("label",null,"Category:",-1)),U(s("select",{"onUpdate:modelValue":e[1]||(e[1]=i=>t.form.category=i)},[...e[6]||(e[6]=[s("option",{value:"game"},"Game",-1),s("option",{value:"movie"},"Movie",-1),s("option",{value:"series"},"Series",-1)])],512),[[ke,t.form.category]])]),s("div",null,[e[8]||(e[8]=s("label",null,"Release:",-1)),U(s("input",{"onUpdate:modelValue":e[2]||(e[2]=i=>t.form.release=i),type:"date"},null,512),[[G,t.form.release]])]),s("div",null,[e[9]||(e[9]=s("label",null,"Count:",-1)),U(s("input",{"onUpdate:modelValue":e[3]||(e[3]=i=>t.form.count=i),type:"number",min:"0"},null,512),[[G,t.form.count]])]),s("button",{type:"submit",disabled:t.loading},f(t.loading?"Adding...":"Add Item"),9,nr)],32),t.result?(d(),u("div",{key:0,class:J(["result",t.result.success?"success":"error"])},f(t.result.message),3)):y("",!0)])}const rr=oe(ar,[["render",ir],["__scopeId","data-v-4298065b"]]),lr={name:"LoadingSpinner",props:{loading:{type:Boolean,default:!0},message:{type:String,default:"Loading..."}}},dr={key:0,class:"loading-spinner"},cr={key:0};function ur(n,e,a,t,o,r){return a.loading?(d(),u("div",dr,[e[0]||(e[0]=s("div",{class:"spinner"},null,-1)),a.message?(d(),u("p",cr,f(a.message),1)):y("",!0)])):y("",!0)}const mr=oe(lr,[["render",ur],["__scopeId","data-v-0e82c46a"]]),gr={name:"MessageBox",props:{show:{type:Boolean,default:!1},type:{type:String,default:"info",validator:n=>["success","error","warning","info"].includes(n)},title:{type:String,default:""},message:{type:String,required:!0},details:{type:String,default:""}},emits:["close"],setup(n,{emit:e}){const a=()=>{e("close")},t=z(()=>{switch(n.type){case"success":return"âœ…";case"error":return"âŒ";case"warning":return"âš ï¸";case"info":return"â„¹ï¸";default:return"â„¹ï¸"}}),o=z(()=>`message-${n.type}`);return{closeMessage:a,icon:t,messageType:o}}},fr={class:"message-header"},pr={class:"message-icon"},vr={class:"message-title"},hr={class:"message-body"},yr={key:0,class:"message-details"},br={class:"message-footer"};function kr(n,e,a,t,o,r){return a.show?(d(),u("div",{key:0,class:"message-overlay",onClick:e[3]||(e[3]=(...i)=>t.closeMessage&&t.closeMessage(...i))},[s("div",{class:J(["message-box",t.messageType]),onClick:e[2]||(e[2]=ue(()=>{},["stop"]))},[s("div",fr,[s("span",pr,f(t.icon),1),s("h3",vr,f(a.title),1),s("button",{class:"close-btn",onClick:e[0]||(e[0]=(...i)=>t.closeMessage&&t.closeMessage(...i))},"âœ•")]),s("div",hr,[s("p",null,f(a.message),1),a.details?(d(),u("div",yr,[s("pre",null,f(a.details),1)])):y("",!0)]),s("div",br,[s("button",{class:"btn btn-primary",onClick:e[1]||(e[1]=(...i)=>t.closeMessage&&t.closeMessage(...i))},"OK")])],2)])):y("",!0)}const wr=oe(gr,[["render",kr],["__scopeId","data-v-198ec3cc"]]),Sr={name:"ConfirmDialog",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm Action"},message:{type:String,required:!0}},emits:["confirm","close"],setup(n,{emit:e}){const a=()=>{e("close")};return{closeDialog:a,confirmAction:()=>{e("confirm"),a()}}}},_r={class:"confirm-header"},Ir={class:"confirm-title"},Cr={class:"confirm-body"},Dr={class:"confirm-footer"};function xr(n,e,a,t,o,r){return a.show?(d(),u("div",{key:0,class:"confirm-overlay",onClick:e[4]||(e[4]=(...i)=>t.closeDialog&&t.closeDialog(...i))},[s("div",{class:"confirm-dialog",onClick:e[3]||(e[3]=ue(()=>{},["stop"]))},[s("div",_r,[s("h3",Ir,f(a.title),1),s("button",{class:"close-btn",onClick:e[0]||(e[0]=(...i)=>t.closeDialog&&t.closeDialog(...i))},"âœ•")]),s("div",Cr,[s("p",null,f(a.message),1)]),s("div",Dr,[s("button",{class:"btn btn-secondary",onClick:e[1]||(e[1]=(...i)=>t.closeDialog&&t.closeDialog(...i))},"Cancel"),s("button",{class:"btn btn-danger",onClick:e[2]||(e[2]=(...i)=>t.confirmAction&&t.confirmAction(...i))},"Confirm")])])])):y("",!0)}const Ar=oe(Sr,[["render",xr],["__scopeId","data-v-fd570f57"]]),Tr={name:"InputDialog",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Input Required"},message:{type:String,required:!0},placeholder:{type:String,default:""},inputType:{type:String,default:"text"},defaultValue:{type:String,default:""}},emits:["confirm","close"],setup(n,{emit:e}){const a=b(""),t=b(null),o=()=>{e("close")},r=()=>{e("confirm",a.value),o()};return Ce(()=>n.show,async i=>{i&&(a.value=n.defaultValue,await Ht(),t.value&&(t.value.focus(),t.value.select()))}),{inputValue:a,inputRef:t,closeDialog:o,confirmAction:r}}},Mr={class:"input-header"},Ur={class:"input-title"},Rr={class:"input-body"},Pr={class:"input-message"},Br=["type","placeholder"],Fr={class:"input-footer"};function Er(n,e,a,t,o,r){return a.show?(d(),u("div",{key:0,class:"input-overlay",onClick:e[6]||(e[6]=(...i)=>t.closeDialog&&t.closeDialog(...i))},[s("div",{class:"input-dialog",onClick:e[5]||(e[5]=ue(()=>{},["stop"]))},[s("div",Mr,[s("h3",Ur,f(a.title),1),s("button",{class:"close-btn",onClick:e[0]||(e[0]=(...i)=>t.closeDialog&&t.closeDialog(...i))},"âœ•")]),s("div",Rr,[s("p",Pr,f(a.message),1),U(s("input",{"onUpdate:modelValue":e[1]||(e[1]=i=>t.inputValue=i),type:a.inputType,placeholder:a.placeholder,class:"input-field",onKeyup:e[2]||(e[2]=qt((...i)=>t.confirmAction&&t.confirmAction(...i),["enter"])),ref:"inputRef"},null,40,Br),[[Yt,t.inputValue]])]),s("div",Fr,[s("button",{class:"btn btn-secondary",onClick:e[3]||(e[3]=(...i)=>t.closeDialog&&t.closeDialog(...i))},"Cancel"),s("button",{class:"btn btn-primary",onClick:e[4]||(e[4]=(...i)=>t.confirmAction&&t.confirmAction(...i))},"OK")])])])):y("",!0)}const Lr=oe(Tr,[["render",Er],["__scopeId","data-v-0ee78a4d"]]),Nr={name:"MediaLibrary",components:{MediaItem:vs,Sidebar:Js,MainHeader:ia,FloatingActionButton:ma,LoginModal:_a,RegisterModal:Wa,EditModal:_n,BulkAddModal:Bi,TxtImportModal:Gi,TxtImportResultsModal:sr,SimpleAddItem:rr,LoadingSpinner:mr,MessageBox:wr,ConfirmDialog:Ar,InputDialog:Lr},setup(){const n=ze(),e=ct(),a=ut(),t=mt(),o=Oe(),r=gt(),i=z(()=>!r||typeof r!="object"?(console.warn("SidebarStore not properly initialized, using fallback values"),{collapsed:!1,mobileOpen:!1,toggleSidebar:()=>{},toggleMobileSidebar:()=>{},closeMobileSidebar:()=>{}}):r),l=b(!1),g=b(null),c=b(new Date),T=b(null),A=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],I=b(null),k=Me({firstName:"",lastName:"",displayName:"",email:"",bio:"",avatar:"",language:"en",timezone:"UTC",dateFormat:"MM/DD/YYYY",booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}),{showLoginModal:K,showRegisterModal:X,showEditModal:V,showFloatingMenu:le,showBulkAddModal:pe,showTxtImportModal:me,showTxtImportResults:m,editingItem:O,sortBy:de,categories:ce,txtImportResults:Se,isLoggedIn:ve,isAdmin:_e,userName:Ie,currentCategory:$,searchQuery:j,categoryCounts:v,loading:x,error:H,paginatedMedia:p,setCategory:h,clearSearch:S,editItem:C,closeEditModal:M,closeBulkAddModal:_,handleBulkAddItems:F,handleSaveItem:re,handleDeleteItem:ne,logout:E,loadMedia:ge,toggleFloatingMenu:je,addNewItem:Be,bulkAddItems:Ue,importFromTxt:Ye,importFromAPI:qe,createCollection:He,exportMediaCollection:Fe,exportAsCSV:Ee,exportAsJSON:Le,downloadFile:Re,deleteAllInCategory:$e,getCategoryDisplayName:Ne,navigateToCalendar:et,navigateToProfile:tt,processTxtContent:D,closeTxtImportResults:P,cleanup:Z,router:N}=Kt(),W=z(()=>{try{return Ne?Ne($.value):$.value}catch(w){return console.error("Error getting category display name:",w),$.value||"Unknown"}}),ee=z(()=>c.value.getFullYear()),Y=z(()=>c.value.getMonth()),De=z(()=>c.value.toLocaleDateString("en-US",{month:"long"})),he=b([]),Qe=b(!1),Je=b(null),st=z(()=>{const w=ee.value,R=Y.value,L=new Date(w,R,1),q=new Date(L),B=L.getDay(),Q=B===0?6:B-1;q.setDate(q.getDate()-Q);const we=[],te=new Date;for(let Ke=0;Ke<42;Ke++){const ye=new Date(q);ye.setDate(q.getDate()+Ke);const Wt=ye.getMonth()===R,Vt=ye.toDateString()===te.toDateString(),Ot=ye.getDay()===0||ye.getDay()===6;we.push({date:ye.getDate(),month:ye.getMonth(),year:ye.getFullYear(),fullDate:new Date(ye),isCurrentMonth:Wt,isToday:Vt,isWeekend:Ot,hasEvents:at(ye),events:ot(ye)})}return we}),ft=z(()=>{const w=n.mediaData||[],R={totalItems:w.length,totalCollections:0,totalPlaytime:0,avgRating:0,categoryDistribution:{},ratingDistribution:{},platformDistribution:{},genreDistribution:{},recentActivity:[],airingSeries:[]};let L=0,q=0;return w.forEach(B=>{const Q=B.category||"unknown";if(R.categoryDistribution[Q]=(R.categoryDistribution[Q]||0)+1,B.rating&&B.rating>0){const we=Math.floor(B.rating);R.ratingDistribution[we]=(R.ratingDistribution[we]||0)+1,L+=B.rating,q++}if(B.platforms&&B.category==="game"&&B.platforms.split(",").map(te=>te.trim()).filter(te=>te).forEach(te=>{R.platformDistribution[te]=(R.platformDistribution[te]||0)+1}),B.genre&&(B.category==="series"||B.category==="movie")&&B.genre.split(",").map(te=>te.trim()).filter(te=>te).forEach(te=>{R.genreDistribution[te]=(R.genreDistribution[te]||0)+1}),B.spielzeit&&B.spielzeit>0&&(R.totalPlaytime+=B.spielzeit),B.category==="series"&&B.isAiring===!0&&R.airingSeries.push({title:B.title,nextSeason:B.nextSeason,nextSeasonRelease:B.nextSeasonRelease}),B.discovered){const we=new Date(B.discovered),te=new Date;te.setDate(te.getDate()-30),we>=te&&R.recentActivity.push({title:B.title,category:B.category,discovered:B.discovered})}}),q>0&&(R.avgRating=(L/q).toFixed(1)),R.totalPlaytime=Math.round(R.totalPlaytime/60),R.recentActivity.sort((B,Q)=>new Date(Q.discovered)-new Date(B.discovered)),R}),pt=w=>w?new Date(w).toLocaleDateString():"",vt=w=>{const R=Math.max(0,Math.min(5,parseInt(w)||0)),L="â˜…".repeat(R),q="â˜†".repeat(5-R);return L+q},ht=w=>{h(w),Be()},yt=()=>{K.value=!1,X.value=!0},bt=()=>{K.value=!0},kt=w=>{K.value=!1,ge()},wt=()=>{X.value=!1,ge()},St=async()=>{l.value=!0,g.value=null;try{const w=await o.adminSetup();w.success?(console.log("âœ… Admin setup successful:",w),g.value={type:"success",text:`âœ… Admin created and logged in! User: ${w.user.name} (${w.user.email})`},await ge(),setTimeout(()=>{g.value=null},5e3)):(console.log("â„¹ï¸ Admin already exists:",w),g.value={type:"info",text:`â„¹ï¸ ${w.message} (${w.admin_count} admin(s) exist)`},setTimeout(()=>{g.value=null},3e3))}catch(w){console.error("âŒ Admin setup failed:",w),g.value={type:"error",text:`âŒ Admin setup failed: ${w.message||"Unknown error"}`},setTimeout(()=>{g.value=null},5e3)}finally{l.value=!1}},_t=()=>{console.log("ðŸ”¥ DEBUG: Direct admin navigation called!"),console.log("ðŸ”¥ DEBUG: Router object:",N);try{N.push("/admin"),console.log("ðŸ”¥ DEBUG: Successfully navigated to /admin!")}catch(w){console.error("ðŸ”¥ DEBUG: Error navigating to admin:",w)}},It=()=>{c.value=new Date(c.value.getFullYear(),c.value.getMonth()-1,1),T.value=null},Ct=()=>{c.value=new Date(c.value.getFullYear(),c.value.getMonth()+1,1),T.value=null},Dt=w=>{w.isCurrentMonth&&(T.value=w)},xt=w=>w.fullDate.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),at=w=>nt(w).length>0,ot=w=>nt(w).map(L=>({id:L.id,title:L.title,time:"Release",type:L.watchlistType||L.watchlist_type||"unknown",item:L})),nt=w=>n.mediaData.filter(L=>L.category==="watchlist"&&L.release).filter(L=>{if(!L.release)return!1;const q=new Date(L.release),B=new Date(w);return q.getFullYear()===B.getFullYear()&&q.getMonth()===B.getMonth()&&q.getDate()===B.getDate()}),At=()=>{var L,q;const w=((L=k.firstName)==null?void 0:L.charAt(0))||"U",R=((q=k.lastName)==null?void 0:q.charAt(0))||"S";return(w+R).toUpperCase()},Tt=()=>{var w;(w=I.value)==null||w.click()},Mt=w=>{const R=w.target.files[0];if(R){const L=new FileReader;L.onload=q=>{k.avatar=q.target.result},L.readAsDataURL(R)}},it=async()=>{if(!$.value||$.value==="statistics"||$.value==="calendar"||$.value==="profile"){he.value=[];return}Qe.value=!0,Je.value=null;try{const w=await fe.getGenres($.value);if(w.success)he.value=w.genres||[];else throw new Error(w.error||"Failed to load genres")}catch(w){console.error("Failed to load genres:",w),Je.value=w.message||"Failed to load genres",he.value=[]}finally{Qe.value=!1}},Ut=w=>{n.setGenres(w)},Rt=()=>{n.clearGenres()};Ce($,w=>{w&&w!=="statistics"&&w!=="calendar"&&w!=="profile"?(it(),n.clearGenres()):(he.value=[],n.clearGenres())},{immediate:!0});const Pt=()=>{const w={profile:k,media:n.mediaData,settings:{language:k.language,timezone:k.timezone,dateFormat:k.dateFormat},exportDate:new Date().toISOString()},R=new Blob([JSON.stringify(w,null,2)],{type:"application/json"}),L=URL.createObjectURL(R),q=document.createElement("a");q.href=L,q.download=`media-library-backup-${new Date().toISOString().split("T")[0]}.json`,q.click(),URL.revokeObjectURL(L)},Bt=()=>{const w=document.createElement("input");w.type="file",w.accept=".json",w.onchange=R=>{const L=R.target.files[0];if(L){const q=new FileReader;q.onload=B=>{try{const Q=JSON.parse(B.target.result);Q.profile&&Object.assign(k,Q.profile),Q.media&&(n.mediaData=Q.media,n.saveMedia()),Q.settings&&Object.assign(k,Q.settings),Ge()}catch(Q){console.error("Failed to import data:",Q)}},q.readAsText(L)}},w.click()},Ft=()=>{const w={profile:k,media:n.mediaData,settings:{language:k.language,timezone:k.timezone,dateFormat:k.dateFormat},backupDate:new Date().toISOString()},R=`backup_${Date.now()}`;localStorage.setItem(R,JSON.stringify(w)),alert("Backup created successfully!")},Et=()=>{alert("Cache cleared successfully!")},Lt=()=>{confirm("Are you sure you want to reset all settings?")&&(Object.assign(k,{firstName:"",lastName:"",displayName:"",email:"",bio:"",avatar:"",language:"en",timezone:"UTC",dateFormat:"MM/DD/YYYY",booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}),Ge())},Nt=()=>{confirm("Are you sure you want to clear all data? This cannot be undone!")&&(localStorage.clear(),window.location.reload())},Ge=()=>{localStorage.setItem("profileData",JSON.stringify(k))},Gt=()=>{Ge(),alert("All changes saved successfully!")};return lt(async()=>{var w,R;try{await ge();const L=localStorage.getItem("profileData");if(L)try{const Q=JSON.parse(L);Object.assign(k,Q)}catch(Q){console.error("Failed to load profile data:",Q)}o.user&&(k.firstName=((w=o.user.name)==null?void 0:w.split(" ")[0])||"",k.lastName=((R=o.user.name)==null?void 0:R.split(" ").slice(1).join(" "))||"",k.email=o.user.email||"");const q=new Date,B=st.value.find(Q=>Q.isToday&&Q.isCurrentMonth);if(B&&(T.value=B),ve.value)try{n.initializeRealtimeUpdates()}catch(Q){console.error("Error initializing realtime updates:",Q)}}catch(L){console.error("Error during initialization:",L)}}),Qt(()=>{if(ve.value)try{n.cleanupRealtimeUpdates()}catch(w){console.error("Error cleaning up realtime updates:",w)}Z()}),{showLoginModal:K,showRegisterModal:X,showEditModal:V,showFloatingMenu:le,showBulkAddModal:pe,showTxtImportModal:me,showTxtImportResults:m,editingItem:O,sortBy:de,categories:ce,txtImportResults:Se,adminSetupLoading:l,adminSetupMessage:g,currentDate:c,selectedDay:T,weekdays:A,avatarInput:I,profileData:k,isLoggedIn:ve,isAdmin:_e,userName:Ie,currentCategory:$,currentCategoryDisplayName:W,searchQuery:j,categoryCounts:v,loading:x,error:H,paginatedMedia:p,selectedGenres:n.selectedGenres,genres:he,genreLoading:Qe,genreError:Je,currentYear:ee,currentMonth:Y,currentMonthName:De,calendarDays:st,setCategory:h,clearSearch:S,navigateToCalendar:et,navigateToProfile:tt,addItemFromSidebar:ht,editItem:C,switchToRegister:yt,showAdminLogin:bt,handleLoginSuccess:kt,handleRegisterSuccess:wt,handleAdminSetup:St,debugNavigateToAdmin:_t,closeEditModal:M,closeBulkAddModal:_,handleBulkAddItems:F,handleSaveItem:re,handleDeleteItem:ne,logout:E,loadMedia:ge,toggleFloatingMenu:je,addNewItem:Be,bulkAddItems:Ue,importFromTxt:Ye,importFromAPI:qe,createCollection:He,exportMediaCollection:Fe,exportAsCSV:Ee,exportAsJSON:Le,downloadFile:Re,deleteAllInCategory:$e,getCategoryDisplayName:Ne,processTxtContent:D,closeTxtImportResults:P,handleGenresUpdated:Ut,handleGenresCleared:Rt,loadGenres:it,previousMonth:It,nextMonth:Ct,selectDay:Dt,formatSelectedDay:xt,hasEventsForDate:at,getEventsForDate:ot,getInitials:At,changeAvatar:Tt,handleAvatarChange:Mt,exportData:Pt,importData:Bt,createBackup:Ft,clearCache:Et,resetSettings:Lt,clearAllData:Nt,saveProfileData:Ge,saveAllChanges:Gt,messageStore:e,confirmStore:a,inputStore:t,statistics:ft,formatDate:pt,getRatingStars:vt,sidebarStore:r,safeSidebarStore:i}}},Gr={class:"vue-app"},Wr={class:"main-content"},Vr={class:"content-area"},Or={key:1,class:"error"},zr={key:2},jr={key:0,class:"calendar-view"},Yr={class:"calendar-header"},qr=["disabled"],Hr={class:"month-year-display"},Qr={class:"month-name"},Jr={class:"year"},Kr=["disabled"],Zr={class:"calendar-container"},Xr={class:"calendar-grid"},$r=["onClick"],el={class:"day-number"},tl={key:0,class:"event-indicator"},sl={key:0,class:"event-count"},al={key:0,class:"selected-day-info"},ol={class:"day-events"},nl={key:0,class:"no-events"},il={key:1,class:"events-list"},rl={class:"event-header"},ll={class:"event-time"},dl={class:"event-type-badge"},cl={class:"event-title"},ul={key:0,class:"event-platforms"},ml={key:1,class:"event-genre"},gl={key:1,class:"profile-container"},fl={class:"profile-header"},pl={class:"profile-avatar-section"},vl=["src"],hl={key:1,class:"avatar-initials"},yl={class:"profile-info-header"},bl={class:"profile-stats"},kl={class:"stat-item"},wl={class:"stat-number"},Sl={class:"stat-item"},_l={class:"stat-number"},Il={class:"settings-sections"},Cl={class:"settings-section"},Dl={class:"section-content"},xl={class:"form-row"},Al={class:"form-group"},Tl={class:"form-group"},Ml={class:"form-group"},Ul={class:"form-group"},Rl={class:"form-group"},Pl={class:"settings-section"},Bl={class:"section-content"},Fl={class:"form-row"},El={class:"form-group"},Ll={class:"form-group"},Nl={class:"form-row"},Gl={class:"form-group"},Wl={class:"form-group"},Vl={class:"form-row"},Ol={class:"form-group"},zl={class:"checkbox-container"},jl={class:"settings-section"},Yl={class:"section-content"},ql={class:"data-actions"},Hl={class:"settings-section danger-zone"},Ql={class:"section-content"},Jl={class:"danger-actions"},Kl={key:2,class:"statistics-container"},Zl={class:"statistics-header"},Xl={class:"refresh-controls"},$l={class:"statistics-content"},ed={class:"stats-summary"},td={class:"summary-card"},sd={class:"summary-number"},ad={class:"summary-card"},od={class:"summary-number"},nd={class:"summary-card"},id={class:"summary-number"},rd={class:"summary-card"},ld={class:"summary-number"},dd={class:"chart-container"},cd={class:"category-stats"},ud={class:"category-name"},md={class:"category-bar"},gd={class:"category-count"},fd={class:"chart-container"},pd={class:"rating-stats"},vd={class:"rating-stars"},hd={class:"rating-bar"},yd={class:"rating-count"},bd={class:"chart-container"},kd={class:"platform-stats"},wd={class:"platform-name"},Sd={class:"platform-bar"},_d={class:"platform-count"},Id={class:"chart-container"},Cd={class:"genre-stats"},Dd={class:"genre-name"},xd={class:"genre-bar"},Ad={class:"genre-count"},Td={class:"chart-container"},Md={class:"recent-activity"},Ud={class:"activity-title"},Rd={class:"activity-category"},Pd={class:"activity-date"},Bd={class:"chart-container"},Fd={class:"airing-series"},Ed={class:"airing-title"},Ld={class:"airing-next"},Nd={class:"airing-date"},Gd={key:3,class:"grid"},Wd={key:0,class:"admin-setup-container"},Vd=["disabled"],Od={key:0},zd={key:1};function jd(n,e,a,t,o,r){const i=ie("Sidebar"),l=ie("MainHeader"),g=ie("LoadingSpinner"),c=ie("MediaItem"),T=ie("LoginModal"),A=ie("RegisterModal"),I=ie("EditModal"),k=ie("BulkAddModal"),K=ie("TxtImportModal"),X=ie("TxtImportResultsModal"),V=ie("FloatingActionButton"),le=ie("MessageBox"),pe=ie("ConfirmDialog"),me=ie("InputDialog");return d(),u("div",Gr,[s("div",{class:J(["mobile-overlay",{show:t.safeSidebarStore.mobileOpen}]),onClick:e[0]||(e[0]=(...m)=>t.safeSidebarStore.closeMobileSidebar&&t.safeSidebarStore.closeMobileSidebar(...m))},null,2),be(i,{collapsed:t.safeSidebarStore.collapsed,"mobile-open":t.safeSidebarStore.mobileOpen,"is-logged-in":t.isLoggedIn,"is-admin":t.isAdmin,"user-name":t.userName,"current-category":t.currentCategory,"category-counts":t.categoryCounts,categories:t.categories,"selected-genres":t.selectedGenres,genres:t.genres,"genre-loading":t.genreLoading,"genre-error":t.genreError,onToggle:t.safeSidebarStore.toggleSidebar,onSetCategory:t.setCategory,onNavigateToCalendar:t.navigateToCalendar,onNavigateToProfile:t.navigateToProfile,onNavigateToAdmin:t.debugNavigateToAdmin,onAddItem:t.addItemFromSidebar,onShowLogin:e[1]||(e[1]=m=>t.showLoginModal=!0),onShowRegister:e[2]||(e[2]=m=>t.showRegisterModal=!0),onShowAdminLogin:t.showAdminLogin,onLogout:t.logout,onGenresUpdated:t.handleGenresUpdated,onGenresCleared:t.handleGenresCleared,onLoadGenres:t.loadGenres},null,8,["collapsed","mobile-open","is-logged-in","is-admin","user-name","current-category","category-counts","categories","selected-genres","genres","genre-loading","genre-error","onToggle","onSetCategory","onNavigateToCalendar","onNavigateToProfile","onNavigateToAdmin","onAddItem","onShowAdminLogin","onLogout","onGenresUpdated","onGenresCleared","onLoadGenres"]),s("div",Wr,[be(l,{"search-query":t.searchQuery,"onUpdate:searchQuery":e[3]||(e[3]=m=>t.searchQuery=m),"sort-by":t.sortBy,"onUpdate:sortBy":e[4]||(e[4]=m=>t.sortBy=m),onToggleMobileSidebar:t.safeSidebarStore.toggleMobileSidebar,onClearSearch:t.clearSearch},null,8,["search-query","sort-by","onToggleMobileSidebar","onClearSearch"]),s("main",Vr,[t.loading?(d(),xe(g,{key:0,message:"Loading media data..."})):t.error?(d(),u("div",Or,[s("p",null,f(t.error),1),s("button",{onClick:e[5]||(e[5]=(...m)=>t.loadMedia&&t.loadMedia(...m))},"Retry")])):(d(),u("div",zr,[t.currentCategory==="calendar"?(d(),u("div",jr,[s("div",Yr,[s("button",{class:"month-nav-btn",onClick:e[6]||(e[6]=(...m)=>t.previousMonth&&t.previousMonth(...m)),disabled:n.isLoading},[...e[31]||(e[31]=[s("span",{class:"nav-icon"},"â€¹",-1)])],8,qr),s("div",Hr,[s("h2",Qr,f(t.currentMonthName),1),s("span",Jr,f(t.currentYear),1)]),s("button",{class:"month-nav-btn",onClick:e[7]||(e[7]=(...m)=>t.nextMonth&&t.nextMonth(...m)),disabled:n.isLoading},[...e[32]||(e[32]=[s("span",{class:"nav-icon"},"â€º",-1)])],8,Kr)]),s("div",Zr,[s("div",Xr,[(d(!0),u(se,null,ae(t.weekdays,m=>(d(),u("div",{class:"weekday-header",key:m},f(m),1))),128)),(d(!0),u(se,null,ae(t.calendarDays,m=>(d(),u("div",{key:`${m.date}-${m.month}`,class:J(["calendar-day",{"other-month":!m.isCurrentMonth,today:m.isToday,weekend:m.isWeekend,"has-events":m.hasEvents}]),onClick:O=>t.selectDay(m)},[s("span",el,f(m.day),1),m.hasEvents?(d(),u("div",tl,[e[33]||(e[33]=s("div",{class:"event-dot"},null,-1)),m.events&&m.events.length>1?(d(),u("span",sl,f(m.events.length),1)):y("",!0)])):y("",!0)],10,$r))),128))])]),t.selectedDay?(d(),u("div",al,[s("h3",null,f(t.formatSelectedDay(t.selectedDay)),1),s("div",ol,[!t.selectedDay.events||t.selectedDay.events.length===0?(d(),u("p",nl," No watchlist releases scheduled for this day ")):(d(),u("div",il,[(d(!0),u(se,null,ae(t.selectedDay.events,m=>(d(),u("div",{key:m.id,class:J(["event-item",`event-${m.type}`])},[s("div",rl,[s("span",ll,f(m.time),1),s("span",dl,f(m.type),1)]),s("span",cl,f(m.title),1),m.item.platforms?(d(),u("div",ul,f(m.item.platforms),1)):y("",!0),m.item.genre?(d(),u("div",ml,f(m.item.genre),1)):y("",!0)],2))),128))]))])])):y("",!0)])):t.currentCategory==="profile"?(d(),u("div",gl,[s("div",fl,[s("div",pl,[s("div",{class:"profile-avatar-large",onClick:e[8]||(e[8]=(...m)=>t.changeAvatar&&t.changeAvatar(...m))},[t.profileData.avatar?(d(),u("img",{key:0,src:t.profileData.avatar,alt:"Profile Picture"},null,8,vl)):(d(),u("span",hl,f(t.getInitials()),1))]),s("input",{type:"file",ref:"avatarInput",accept:"image/*",onChange:e[9]||(e[9]=(...m)=>t.handleAvatarChange&&t.handleAvatarChange(...m)),style:{display:"none"}},null,544)]),s("div",yl,[s("h2",null,f(t.profileData.displayName||t.profileData.firstName+" "+t.profileData.lastName||"User"),1),s("p",null,f(t.profileData.email||"user@example.com"),1),s("div",bl,[s("div",kl,[s("span",wl,f(n.totalItems),1),e[34]||(e[34]=s("span",{class:"stat-label"},"Total Items",-1))]),s("div",Sl,[s("span",_l,f(new Date().getFullYear()),1),e[35]||(e[35]=s("span",{class:"stat-label"},"Member Since",-1))])])])]),s("div",Il,[s("div",Cl,[e[41]||(e[41]=s("div",{class:"section-header"},[s("h3",null,"Personal Information"),s("p",null,"Manage your personal details and account information")],-1)),s("div",Dl,[s("div",xl,[s("div",Al,[e[36]||(e[36]=s("label",{for:"firstName"},"First Name",-1)),U(s("input",{type:"text",id:"firstName","onUpdate:modelValue":e[10]||(e[10]=m=>t.profileData.firstName=m),placeholder:"Enter your first name"},null,512),[[G,t.profileData.firstName]])]),s("div",Tl,[e[37]||(e[37]=s("label",{for:"lastName"},"Last Name",-1)),U(s("input",{type:"text",id:"lastName","onUpdate:modelValue":e[11]||(e[11]=m=>t.profileData.lastName=m),placeholder:"Enter your last name"},null,512),[[G,t.profileData.lastName]])])]),s("div",Ml,[e[38]||(e[38]=s("label",{for:"displayName"},"Display Name",-1)),U(s("input",{type:"text",id:"displayName","onUpdate:modelValue":e[12]||(e[12]=m=>t.profileData.displayName=m),placeholder:"How others see your name"},null,512),[[G,t.profileData.displayName]])]),s("div",Ul,[e[39]||(e[39]=s("label",{for:"email"},"Email Address",-1)),U(s("input",{type:"email",id:"email","onUpdate:modelValue":e[13]||(e[13]=m=>t.profileData.email=m),placeholder:"your.email@example.com"},null,512),[[G,t.profileData.email]])]),s("div",Rl,[e[40]||(e[40]=s("label",{for:"bio"},"Bio",-1)),U(s("textarea",{id:"bio","onUpdate:modelValue":e[14]||(e[14]=m=>t.profileData.bio=m),placeholder:"Tell us about yourself...",rows:"4"},null,512),[[G,t.profileData.bio]])])])]),s("div",Pl,[e[53]||(e[53]=s("div",{class:"section-header"},[s("h3",null,"Preferences"),s("p",null,"Customize your application experience")],-1)),s("div",Bl,[s("div",Fl,[s("div",El,[e[43]||(e[43]=s("label",{for:"language"},"Language",-1)),U(s("select",{id:"language","onUpdate:modelValue":e[15]||(e[15]=m=>t.profileData.language=m)},[...e[42]||(e[42]=[s("option",{value:"en"},"English",-1),s("option",{value:"de"},"Deutsch",-1),s("option",{value:"fr"},"FranÃ§ais",-1),s("option",{value:"es"},"EspaÃ±ol",-1)])],512),[[ke,t.profileData.language]])]),s("div",Ll,[e[45]||(e[45]=s("label",{for:"timezone"},"Timezone",-1)),U(s("select",{id:"timezone","onUpdate:modelValue":e[16]||(e[16]=m=>t.profileData.timezone=m)},[...e[44]||(e[44]=[s("option",{value:"UTC"},"UTC",-1),s("option",{value:"Europe/Berlin"},"Europe/Berlin",-1),s("option",{value:"America/New_York"},"America/New_York",-1),s("option",{value:"America/Los_Angeles"},"America/Los_Angeles",-1)])],512),[[ke,t.profileData.timezone]])])]),s("div",Nl,[s("div",Gl,[e[47]||(e[47]=s("label",{for:"dateFormat"},"Date Format",-1)),U(s("select",{id:"dateFormat","onUpdate:modelValue":e[17]||(e[17]=m=>t.profileData.dateFormat=m)},[...e[46]||(e[46]=[s("option",{value:"MM/DD/YYYY"},"MM/DD/YYYY",-1),s("option",{value:"DD/MM/YYYY"},"DD/MM/YYYY",-1),s("option",{value:"YYYY-MM-DD"},"YYYY-MM-DD",-1)])],512),[[ke,t.profileData.dateFormat]])]),s("div",Wl,[e[49]||(e[49]=s("label",{for:"booksApiProvider"},"Books API Provider",-1)),U(s("select",{id:"booksApiProvider","onUpdate:modelValue":e[18]||(e[18]=m=>t.profileData.booksApiProvider=m)},[...e[48]||(e[48]=[s("option",{value:"wikipedia"},"Wikipedia (Primary)",-1),s("option",{value:"google_books"},"Google Books (Fallback)",-1),s("option",{value:"both"},"Both (Wikipedia + Google Books)",-1)])],512),[[ke,t.profileData.booksApiProvider]])])]),s("div",Vl,[s("div",Ol,[e[51]||(e[51]=s("label",{for:"enableGoogleBooksFallback"},"Enable Google Books Fallback",-1)),s("div",zl,[U(s("input",{type:"checkbox",id:"enableGoogleBooksFallback","onUpdate:modelValue":e[19]||(e[19]=m=>t.profileData.enableGoogleBooksFallback=m)},null,512),[[dt,t.profileData.enableGoogleBooksFallback]]),e[50]||(e[50]=s("label",{for:"enableGoogleBooksFallback",class:"checkbox-label"}," Use Google Books as fallback when Wikipedia search fails ",-1))])]),e[52]||(e[52]=s("div",{class:"form-group"},null,-1))])])]),s("div",jl,[e[58]||(e[58]=s("div",{class:"section-header"},[s("h3",null,"Data Management"),s("p",null,"Manage your data and account")],-1)),s("div",Yl,[s("div",ql,[s("button",{class:"data-btn export-btn",onClick:e[20]||(e[20]=(...m)=>t.exportData&&t.exportData(...m))},[...e[54]||(e[54]=[s("span",{class:"btn-icon"},"ðŸ“¦",-1),s("span",{class:"btn-text"},"Export All Data",-1),s("span",{class:"btn-description"},"Download your complete media library",-1)])]),s("button",{class:"data-btn import-btn",onClick:e[21]||(e[21]=(...m)=>t.importData&&t.importData(...m))},[...e[55]||(e[55]=[s("span",{class:"btn-icon"},"ðŸ“¥",-1),s("span",{class:"btn-text"},"Import Data",-1),s("span",{class:"btn-description"},"Import data from a backup file",-1)])]),s("button",{class:"data-btn backup-btn",onClick:e[22]||(e[22]=(...m)=>t.createBackup&&t.createBackup(...m))},[...e[56]||(e[56]=[s("span",{class:"btn-icon"},"ðŸ’¾",-1),s("span",{class:"btn-text"},"Create Backup",-1),s("span",{class:"btn-description"},"Create a local backup of your data",-1)])]),s("button",{class:"data-btn cache-btn",onClick:e[23]||(e[23]=(...m)=>t.clearCache&&t.clearCache(...m))},[...e[57]||(e[57]=[s("span",{class:"btn-icon"},"ðŸ—‘ï¸",-1),s("span",{class:"btn-text"},"Clear Cache",-1),s("span",{class:"btn-description"},"Clear temporary files and cache",-1)])])])])]),s("div",Hl,[e[61]||(e[61]=s("div",{class:"section-header"},[s("h3",null,"Danger Zone"),s("p",null,"Irreversible and destructive actions")],-1)),s("div",Ql,[s("div",Jl,[s("button",{class:"danger-btn reset-btn",onClick:e[24]||(e[24]=(...m)=>t.resetSettings&&t.resetSettings(...m))},[...e[59]||(e[59]=[s("span",{class:"btn-icon"},"ðŸ”„",-1),s("span",{class:"btn-text"},"Reset All Settings",-1),s("span",{class:"btn-description"},"Reset all settings to default values",-1)])]),s("button",{class:"danger-btn clear-btn",onClick:e[25]||(e[25]=(...m)=>t.clearAllData&&t.clearAllData(...m))},[...e[60]||(e[60]=[s("span",{class:"btn-icon"},"ðŸ—‘ï¸",-1),s("span",{class:"btn-text"},"Clear All Data",-1),s("span",{class:"btn-description"},"Permanently delete all your data",-1)])])])])])])])):t.currentCategory==="statistics"?(d(),u("div",Kl,[s("div",Zl,[e[62]||(e[62]=s("h1",null,"ðŸ“Š Media Library Statistics",-1)),e[63]||(e[63]=s("p",null,"Ãœbersicht Ã¼ber deine Media Collection",-1)),s("div",Xl,[s("button",{class:"refresh-btn",onClick:e[26]||(e[26]=(...m)=>t.loadMedia&&t.loadMedia(...m))},"ðŸ”„ Refresh Statistics")])]),s("div",$l,[s("div",ed,[s("div",td,[s("div",sd,f(t.statistics.totalItems),1),e[64]||(e[64]=s("div",{class:"summary-label"},"Total Items",-1))]),s("div",ad,[s("div",od,f(t.statistics.totalCollections),1),e[65]||(e[65]=s("div",{class:"summary-label"},"Collections",-1))]),s("div",nd,[s("div",id,f(t.statistics.totalPlaytime)+"h",1),e[66]||(e[66]=s("div",{class:"summary-label"},"Total Playtime",-1))]),s("div",rd,[s("div",ld,f(t.statistics.avgRating),1),e[67]||(e[67]=s("div",{class:"summary-label"},"Avg Rating",-1))])]),s("div",dd,[e[68]||(e[68]=s("h3",{class:"chart-title"},"ðŸ“ˆ Category Distribution",-1)),s("div",cd,[(d(!0),u(se,null,ae(t.statistics.categoryDistribution,(m,O)=>(d(),u("div",{key:O,class:"category-stat"},[s("div",ud,f(O),1),s("div",md,[s("div",{class:"category-fill",style:Te({width:`${m/t.statistics.totalItems*100}%`})},null,4)]),s("div",gd,f(m)+" ("+f((m/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",fd,[e[69]||(e[69]=s("h3",{class:"chart-title"},"â­ Rating Distribution",-1)),s("div",pd,[(d(!0),u(se,null,ae(t.statistics.ratingDistribution,(m,O)=>(d(),u("div",{key:O,class:"rating-stat"},[s("div",vd,f(t.getRatingStars(O)),1),s("div",hd,[s("div",{class:"rating-fill",style:Te({width:`${m/t.statistics.totalItems*100}%`})},null,4)]),s("div",yd,f(m)+" ("+f((m/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",bd,[e[70]||(e[70]=s("h3",{class:"chart-title"},"ðŸŽ® Platform Distribution",-1)),s("div",kd,[(d(!0),u(se,null,ae(t.statistics.platformDistribution,(m,O)=>(d(),u("div",{key:O,class:"platform-stat"},[s("div",wd,f(O),1),s("div",Sd,[s("div",{class:"platform-fill",style:Te({width:`${m/t.statistics.totalItems*100}%`})},null,4)]),s("div",_d,f(m)+" ("+f((m/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",Id,[e[71]||(e[71]=s("h3",{class:"chart-title"},"ðŸŽ­ Top Genres",-1)),s("div",Cd,[(d(!0),u(se,null,ae(t.statistics.genreDistribution,(m,O)=>(d(),u("div",{key:O,class:"genre-stat"},[s("div",Dd,f(O),1),s("div",xd,[s("div",{class:"genre-fill",style:Te({width:`${m/t.statistics.totalItems*100}%`})},null,4)]),s("div",Ad,f(m)+" ("+f((m/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",Td,[e[72]||(e[72]=s("h3",{class:"chart-title"},"ðŸ“… Recent Activity",-1)),s("div",Md,[(d(!0),u(se,null,ae(t.statistics.recentActivity,m=>(d(),u("div",{key:m.title,class:"activity-item"},[s("div",Ud,f(m.title),1),s("div",Rd,f(m.category),1),s("div",Pd,f(t.formatDate(m.discovered)),1)]))),128))])]),s("div",Bd,[e[73]||(e[73]=s("h3",{class:"chart-title"},"ðŸ“º Currently Airing Series",-1)),s("div",Fd,[(d(!0),u(se,null,ae(t.statistics.airingSeries,m=>(d(),u("div",{key:m.title,class:"airing-item"},[s("div",Ed,f(m.title),1),s("div",Ld,"Next: Season "+f(m.nextSeason),1),s("div",Nd,f(m.nextSeasonRelease?t.formatDate(m.nextSeasonRelease):"TBA"),1)]))),128))])])])])):(d(),u("div",Gd,[(d(!0),u(se,null,ae(t.paginatedMedia,m=>(d(),xe(c,{key:m.id,item:m,onEdit:t.editItem},null,8,["item","onEdit"]))),128))]))]))])]),t.isLoggedIn?y("",!0):(d(),u("div",Wd,[s("button",{onClick:e[27]||(e[27]=(...m)=>t.handleAdminSetup&&t.handleAdminSetup(...m)),disabled:t.adminSetupLoading,class:"admin-setup-btn",title:"Setup Admin Account (Creates admin account with default password)"},[t.adminSetupLoading?(d(),u("span",Od,"ðŸ”§ Setting up...")):(d(),u("span",zd,"ðŸ”§ Admin Setup"))],8,Vd),t.adminSetupMessage?(d(),u("div",{key:0,class:J(["admin-setup-message",t.adminSetupMessage.type])},f(t.adminSetupMessage.text),3)):y("",!0)])),t.showLoginModal?(d(),xe(T,{key:1,onClose:e[28]||(e[28]=m=>t.showLoginModal=!1),onSuccess:t.handleLoginSuccess,onSwitchToRegister:t.switchToRegister},null,8,["onSuccess","onSwitchToRegister"])):y("",!0),t.showRegisterModal?(d(),xe(A,{key:2,onClose:e[29]||(e[29]=m=>t.showRegisterModal=!1),onSuccess:t.handleRegisterSuccess},null,8,["onSuccess"])):y("",!0),t.showEditModal?(d(),xe(I,{key:3,item:t.editingItem,"current-category":t.currentCategory,onClose:t.closeEditModal,onSave:t.handleSaveItem,onDelete:t.handleDeleteItem},null,8,["item","current-category","onClose","onSave","onDelete"])):y("",!0),be(k,{show:t.showBulkAddModal,"current-category":t.currentCategory,onClose:t.closeBulkAddModal},null,8,["show","current-category","onClose"]),be(K,{show:t.showTxtImportModal,onClose:e[30]||(e[30]=m=>t.showTxtImportModal=!1),onFileProcessed:t.processTxtContent},null,8,["show","onFileProcessed"]),be(X,{show:t.showTxtImportResults,results:t.txtImportResults,onClose:t.closeTxtImportResults},null,8,["show","results","onClose"]),be(V,{"show-menu":t.showFloatingMenu,"show-delete-all":t.isLoggedIn&&t.currentCategory!=="all"&&t.categoryCounts[t.currentCategory]>0,"category-name":t.currentCategoryDisplayName,"item-count":t.categoryCounts[t.currentCategory]||0,onToggleMenu:t.toggleFloatingMenu,onAddNewItem:t.addNewItem,onBulkAddItems:t.bulkAddItems,onImportFromTxt:t.importFromTxt,onImportFromApi:t.importFromAPI,onCreateCollection:t.createCollection,onDeleteAllInCategory:t.deleteAllInCategory},null,8,["show-menu","show-delete-all","category-name","item-count","onToggleMenu","onAddNewItem","onBulkAddItems","onImportFromTxt","onImportFromApi","onCreateCollection","onDeleteAllInCategory"]),be(le,{show:t.messageStore.show,type:t.messageStore.type,title:t.messageStore.title,message:t.messageStore.message,details:t.messageStore.details,onClose:t.messageStore.closeMessage},null,8,["show","type","title","message","details","onClose"]),be(pe,{show:t.confirmStore.show,title:t.confirmStore.title,message:t.confirmStore.message,onConfirm:t.confirmStore.confirm,onClose:t.confirmStore.cancel},null,8,["show","title","message","onConfirm","onClose"]),be(me,{show:t.inputStore.show,title:t.inputStore.title,message:t.inputStore.message,placeholder:t.inputStore.placeholder,"input-type":t.inputStore.inputType,"default-value":t.inputStore.defaultValue,onConfirm:t.inputStore.confirm,onClose:t.inputStore.cancel},null,8,["show","title","message","placeholder","input-type","default-value","onConfirm","onClose"])])}const qd=oe(Nr,[["render",jd],["__scopeId","data-v-fe065bdb"]]);export{qd as default};
