import{A as os,d as Ve,r as w,w as Ee,c as G,m as le,u as ns,a as je,_ as ee,b as f,e as s,f as k,F as X,g as $,t as v,n as H,o as m,h as oe,i as ve,j as ae,k as Be,l as is,T as ls,p as Oe,q as Fe,s as A,v as B,x as it,y as be,z as yt,B as bt,C as Le,D as Pe,E as rs,G as ds,H as cs}from"./index-DVfx0lad.js";class us{constructor(){this.isConnected={value:!1},this.listeners=new Map,this.pollingInterval=null,this.lastUpdate=null,this.pollingIntervalMs=2e4}getApiBaseUrl(){return os.BASE_URL}connect(){if(this.pollingInterval)return;const e=localStorage.getItem("authToken"),o=localStorage.getItem("currentUser");!e||!o||(this.isConnected.value=!0,this.lastUpdate=new Date,this.pollingInterval=setInterval(()=>{this.checkForUpdates()},this.pollingIntervalMs))}async checkForUpdates(){try{const e=localStorage.getItem("authToken"),o=localStorage.getItem("currentUser");if(!e||!o)return;const t=this.getApiBaseUrl(),i=await fetch(`${t}/api/media`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!i.ok){if(i.status===401){this.disconnect();return}throw new Error(`HTTP error! status: ${i.status}`)}const c=await i.json();c&&c.length>0&&this.listeners.forEach((d,u)=>{try{d({type:"media_updated",items:c,count:c.length,timestamp:new Date().toISOString()})}catch{}}),this.lastUpdate=new Date}catch{}}addListener(e,o){this.listeners.set(e,o)}removeListener(e){this.listeners.delete(e)}disconnect(){this.pollingInterval&&(clearInterval(this.pollingInterval),this.pollingInterval=null),this.isConnected.value=!1}destroy(){this.disconnect(),this.listeners.clear()}}const ot=new us,Ke=Ve("media",()=>{const n=()=>{try{return localStorage.getItem("currentCategory")||"game"}catch(l){return console.error("Failed to load current category from localStorage:",l),"game"}},e=l=>{try{localStorage.setItem("currentCategory",l)}catch(r){console.error("Failed to save current category to localStorage:",r)}},o=()=>{try{return localStorage.getItem("searchQuery")||""}catch(l){return console.error("Failed to load search query from localStorage:",l),""}},t=l=>{try{localStorage.setItem("searchQuery",l)}catch(r){console.error("Failed to save search query to localStorage:",r)}},i=w(g()),c=w(n()),d=w(o()),u=w(null),p=w([]),S=w([]),T=w(!1),C=w(null),I=w(!1);Ee(c,l=>{e(l)},{immediate:!1}),Ee(d,l=>{t(l)},{immediate:!1});function g(){try{const l=localStorage.getItem("authToken"),r=localStorage.getItem("currentUser");if(!l||!r){const y=localStorage.getItem("mediaData");return y?JSON.parse(y):[]}return[]}catch(l){return console.error("Failed to load media from storage:",l),[]}}function Y(){try{const l=localStorage.getItem("authToken"),r=localStorage.getItem("currentUser");(!l||!r)&&localStorage.setItem("mediaData",JSON.stringify(i.value))}catch(l){console.error("Failed to save media to storage:",l)}}const ne=G(()=>i.value.length),U=G(()=>{const l={};return i.value.forEach(r=>{const y=r.category||"unknown";l[y]=(l[y]||0)+1}),l}),ie=G(()=>{let l=[...i.value];if(c.value&&c.value!=="all"&&(l=l.filter(r=>c.value==="watchlist"?r.category==="watchlist"||r.isNew===!0:r.category===c.value)),p.value&&p.value.length>0&&(l=l.filter(r=>{if(!r.genre)return!1;const y=r.genre.split(",").map(a=>a.trim().toLowerCase());return p.value.some(a=>y.some(_=>_.includes(a.toLowerCase())))})),S.value&&S.value.length>0&&(l=l.filter(r=>{if(!r.genre)return!0;const y=r.genre.split(",").map(a=>a.trim().toLowerCase());return!S.value.some(a=>y.some(_=>_.includes(a.toLowerCase())))})),d.value){const r=d.value.toLowerCase();l=l.filter(y=>{var a,_,D,V;return((a=y.title)==null?void 0:a.toLowerCase().includes(r))||((_=y.description)==null?void 0:_.toLowerCase().includes(r))||((D=y.genre)==null?void 0:D.toLowerCase().includes(r))||((V=y.platforms)==null?void 0:V.toLowerCase().includes(r))})}return l});async function K(){var l,r;T.value=!0,C.value=null;try{const y=localStorage.getItem("authToken"),a=localStorage.getItem("currentUser");if(y&&a)try{const _=await le.getMedia();i.value=_||[]}catch(_){console.warn("API load failed for logged in user:",_),i.value=[]}else{const _=g();if(_.length>0)i.value=_;else{const D=await le.getMedia();i.value=D||[],Y()}}}catch(y){C.value=((r=(l=y.response)==null?void 0:l.data)==null?void 0:r.message)||y.message||"Failed to load media data",console.error("Failed to load media:",y)}finally{T.value=!1}}function de(l){c.value=l}function ue(l){d.value=l}function h(l){u.value=l}function O(){u.value=null}function Ae(l){p.value=l}function Te(){p.value=[]}function ce(l){S.value=l}function we(){S.value=[]}function _e(l){const r=[...S.value],y=r.indexOf(l);y>-1?r.splice(y,1):r.push(l),S.value=r}function ge(){I.value=!I.value}function z(l){I.value=l}async function Z(l,r){try{const y=localStorage.getItem("authToken"),a=localStorage.getItem("currentUser");if(y&&a)try{await le.updateMediaItem(l,{personal_rating:r});const _=i.value.findIndex(D=>D.id===l);return _!==-1&&(i.value[_].personal_rating=r),!0}catch(_){throw console.error("API rating update failed:",_),_}else{const _=i.value.findIndex(D=>D.id===l);if(_!==-1)return i.value[_].personal_rating=r,Y(),!0;throw new Error("Media item not found")}}catch(y){throw console.error("Failed to update rating:",y),y}}async function j(l,r=!1){var y,a,_;C.value=null;try{const D=localStorage.getItem("authToken"),V=localStorage.getItem("currentUser");if(D&&V)try{const te=await le.addMediaItem(l);if(!r)await K();else{const re={...te,__order:i.value.length};i.value.push(re)}return te}catch(te){if(((y=te.response)==null?void 0:y.status)===409&&((_=(a=te.response)==null?void 0:a.data)!=null&&_.duplicate)){const re=new Error(te.response.data.error||"Ein Eintrag mit diesem Titel und dieser Kategorie existiert bereits.");throw re.isDuplicate=!0,re}throw C.value=te.message||"Failed to add media item",console.error("API save failed for logged in user:",te),te}else{const te={id:Date.now(),...l,__order:i.value.length};return i.value.push(te),Y(),te}}catch(D){throw D}}async function he(l,r){C.value=null,console.log("ðŸ” ULTRA DEBUG - Store updateMediaItem called with:",{id:l,watchlist_release_date:r.watchlist_release_date,next_season_release:r.next_season_release,watchlist_number:r.watchlist_number,is_airing:r.is_airing,type_watchlist:typeof r.watchlist_release_date,type_next:typeof r.next_season_release,type_watchlist_number:typeof r.watchlist_number,is_null_watchlist:r.watchlist_release_date===null,is_null_next:r.next_season_release===null,is_null_watchlist_number:r.watchlist_number===null,is_undefined_watchlist:r.watchlist_release_date===void 0,is_undefined_next:r.next_season_release===void 0,is_undefined_watchlist_number:r.watchlist_number===void 0,is_empty_watchlist:r.watchlist_release_date==="",is_empty_next:r.next_season_release==="",is_empty_watchlist_number:r.watchlist_number==="",FULL_ITEM_DATA:r});try{const y=localStorage.getItem("authToken"),a=localStorage.getItem("currentUser");if(y&&a)try{console.log("ðŸ” ULTRA DEBUG - Store calling API updateMediaItem with:",{id:l,watchlist_release_date:r.watchlist_release_date,next_season_release:r.next_season_release,watchlist_number:r.watchlist_number,type_watchlist:typeof r.watchlist_release_date,type_next:typeof r.next_season_release,type_watchlist_number:typeof r.watchlist_number,is_null_watchlist:r.watchlist_release_date===null,is_null_next:r.next_season_release===null,is_null_watchlist_number:r.watchlist_number===null,is_undefined_watchlist:r.watchlist_release_date===void 0,is_undefined_next:r.next_season_release===void 0,is_undefined_watchlist_number:r.watchlist_number===void 0,FULL_ITEM_DATA:r});const _=await le.updateMediaItem(l,r);return console.log("ðŸ” COMPREHENSIVE DEBUG - Store API updateMediaItem returned:",_),await K(),_}catch(_){throw console.error("API update failed for logged in user:",_),_}else{const _=i.value.findIndex(D=>D.id===l);if(_!==-1)return i.value[_]={...i.value[_],...r},Y(),i.value[_];throw new Error("Media item not found")}}catch(y){throw y.isDuplicate||(C.value=y.message||"Failed to update media item"),y}}async function pe(l){var r;try{const y=localStorage.getItem("authToken"),a=localStorage.getItem("currentUser");if(y&&a)try{return await le.deleteMediaItem(l),await K(),!0}catch(_){if(((r=_.response)==null?void 0:r.status)===404||_.isNotFound)return await K(),!0;throw console.error("API delete failed for logged in user:",_),_}else{const _=i.value.findIndex(D=>D.id===l);if(_!==-1)return i.value.splice(_,1),Y(),!0;throw new Error("Media item not found")}}catch(y){throw C.value=y.message||"Failed to delete media item",y}}async function ke(l){try{const r=localStorage.getItem("authToken"),y=localStorage.getItem("currentUser");if(r&&y)try{const a=await le.batchAddMediaItems(l);return await K(),a}catch(a){throw console.error("API batch add failed for logged in user:",a),a}else{const a=l.map((_,D)=>({id:Date.now()+D,..._,__order:i.value.length+D}));return i.value.push(...a),Y(),{success:!0,stats:{created:a.length,failed:0,errors:[]}}}}catch(r){throw C.value=r.message||"Failed to add media items",r}}async function Se(l){try{const r=localStorage.getItem("authToken"),y=localStorage.getItem("currentUser");if(r&&y)try{return await le.batchDeleteMediaItems(l),await K(),!0}catch(a){if(a.silent)return console.log("Silent batch delete error (some items may not exist):",a.message),await K(),!0;throw console.error("API batch delete failed for logged in user:",a),a}else return i.value=i.value.filter(a=>!l.includes(a.id)),Y(),!0}catch(r){throw r.silent||(C.value=r.message||"Failed to delete media items"),r}}async function xe(){try{const l=localStorage.getItem("authToken"),r=localStorage.getItem("currentUser");l&&r?await le.saveMedia(i.value):Y()}catch(l){console.error("Failed to save media:",l)}}function me(){C.value=null}function Ce(l){if(console.log("Processing real-time update:",l),l.type==="media_updated"&&l.items)l.items.forEach(r=>{const y=i.value.findIndex(a=>a.id===r.id);y!==-1?i.value[y]={...i.value[y],...r}:i.value.push(r)});else if(l.action==="created"||l.action==="updated"){const r=l.item,y=i.value.findIndex(a=>a.id===r.id);y!==-1?i.value[y]={...i.value[y],...r}:i.value.push(r)}else if(l.action==="deleted"){const r=i.value.findIndex(y=>y.id===l.id);r!==-1&&i.value.splice(r,1)}Y()}function fe(){const l=localStorage.getItem("authToken"),r=localStorage.getItem("currentUser");if(!l||!r){console.log("Skipping realtime initialization - user not authenticated");return}try{ot.addListener("media-store",Ce),ot.connect()}catch(y){console.error("Failed to initialize realtime updates:",y)}}function Ie(){ot.removeListener("media-store")}return{mediaData:i,currentCategory:c,searchQuery:d,selectedGenre:u,selectedGenres:p,excludedGenres:S,loading:T,error:C,editMode:I,totalItems:ne,categoryCounts:U,filteredMedia:ie,loadMedia:K,setCategory:de,setSearchQuery:ue,setGenre:h,clearGenre:O,setGenres:Ae,clearGenres:Te,setExcludedGenres:ce,clearExcludedGenres:we,toggleGenreExclude:_e,toggleEditMode:ge,setEditMode:z,updateItemRating:Z,addMediaItem:j,updateMediaItem:he,deleteMediaItem:pe,batchAddMediaItems:ke,batchDeleteMediaItems:Se,saveMedia:xe,clearError:me,initializeRealtimeUpdates:fe,cleanupRealtimeUpdates:Ie,resetMediaState:()=>{c.value="game",d.value="",localStorage.removeItem("currentCategory"),localStorage.removeItem("searchQuery")}}}),wt=Ve("message",()=>{const n=w(!1),e=w("info"),o=w(""),t=w(""),i=w("");function c(C){e.value=C.type||"info",o.value=C.title||"",t.value=C.message||"",i.value=C.details||"",n.value=!0}function d(C,I="Success",g=""){c({type:"success",title:I,message:C,details:g})}function u(C,I="Error",g=""){c({type:"error",title:I,message:C,details:g})}function p(C,I="Warning",g=""){c({type:"warning",title:I,message:C,details:g})}function S(C,I="Info",g=""){c({type:"info",title:I,message:C,details:g})}function T(){n.value=!1,setTimeout(()=>{e.value="info",o.value="",t.value="",i.value=""},300)}return{show:n,type:e,title:o,message:t,details:i,showMessage:c,showSuccess:d,showError:u,showWarning:p,showInfo:S,closeMessage:T}}),_t=Ve("confirm",()=>{const n=w(!1),e=w("Confirm Action"),o=w(""),t=w(null);function i(u){return new Promise(p=>{e.value=u.title||"Confirm Action",o.value=u.message||"",n.value=!0,t.value=p})}function c(){t.value&&(t.value(!0),t.value=null),n.value=!1}function d(){t.value&&(t.value(!1),t.value=null),n.value=!1}return{show:n,title:e,message:o,showConfirm:i,confirm:c,cancel:d}}),kt=Ve("input",()=>{const n=w(!1),e=w("Input Required"),o=w(""),t=w(""),i=w("text"),c=w(""),d=w(null);function u(T){return new Promise(C=>{e.value=T.title||"Input Required",o.value=T.message||"",t.value=T.placeholder||"",i.value=T.inputType||"text",c.value=T.defaultValue||"",n.value=!0,d.value=C})}function p(T){d.value&&(d.value(T),d.value=null),n.value=!1}function S(){d.value&&(d.value(null),d.value=null),n.value=!1}return{show:n,title:e,message:o,placeholder:t,inputType:i,defaultValue:c,showInput:u,confirm:p,cancel:S}}),St=Ve("sidebar",()=>{const n=()=>{try{const g=localStorage.getItem("sidebarState");if(g)return{collapsed:JSON.parse(g).collapsed||!1,mobileOpen:!1}}catch(g){console.error("Failed to load sidebar state from localStorage:",g)}return{collapsed:!1,mobileOpen:!1}},e=g=>{try{localStorage.setItem("sidebarState",JSON.stringify({collapsed:g.collapsed}))}catch(Y){console.error("Failed to save sidebar state to localStorage:",Y)}},o=n(),t=w(o.collapsed),i=w(o.mobileOpen);Ee(t,g=>{e({collapsed:g,mobileOpen:i.value})},{immediate:!1});const c=()=>{t.value=!t.value},d=()=>{i.value=!i.value},u=()=>{i.value=!1},p=g=>{t.value=g},S=g=>{i.value=g},T=()=>{t.value=!1,i.value=!1,localStorage.removeItem("sidebarState")},C=G(()=>t.value),I=G(()=>i.value);return{collapsed:t,mobileOpen:i,toggleSidebar:c,toggleMobileSidebar:d,closeMobileSidebar:u,setCollapsed:p,setMobileOpen:S,resetSidebarState:T,isCollapsed:C,isMobileOpen:I}});function gs(){const n=ns(),e=je(),o=Ke(),t=wt(),i=_t(),c=kt(),d=w(!1),u=w(!1),p=w(!1),S=w(!1),T=w(!1),C=w(!1),I=w(!1),g=w(null),Y=()=>typeof window<"u"?window.innerWidth>768?8:3:8,ne=w(Y()),ie=w(typeof window<"u"&&localStorage.getItem("mediaLibrary_sortBy")||"order_asc"),K=w(null),de=x=>{let R=null;if(x.category==="watchlist"?R=x.watchlist_release_date?new Date(x.watchlist_release_date):x.release?new Date(x.release):null:x.category==="series"&&x.is_airing&&x.next_season_release?R=new Date(x.next_season_release):R=x.release?new Date(x.release):null,!R||isNaN(R.getTime()))return 1/0;const Q=new Date,P=R.getTime()-Q.getTime();return Math.ceil(P/(1e3*3600*24))},ue=()=>{ne.value=Y()};typeof window<"u"&&window.addEventListener("resize",ue);const h=[{key:"game",name:"Games",icon:"ðŸŽ®"},{key:"series",name:"Series",icon:"ðŸ“º"},{key:"movie",name:"Movies",icon:"ðŸŽ¬"},{key:"buecher",name:"BÃ¼cher",icon:"ðŸ“š"},{key:"watchlist",name:"Watchlist",icon:"â¤ï¸"}],O=G(()=>{try{return e.isLoggedIn}catch(x){return console.error("Error accessing authStore.isLoggedIn:",x),!1}}),Ae=G(()=>{try{return e.userName}catch(x){return console.error("Error accessing authStore.userName:",x),""}}),Te=G(()=>{try{return e.isAdmin}catch(x){return console.error("Error accessing authStore.isAdmin:",x),!1}}),ce=G(()=>{try{return o.currentCategory}catch(x){return console.error("Error accessing mediaStore.currentCategory:",x),"game"}}),we=G({get:()=>{try{return o.searchQuery}catch(x){return console.error("Error accessing mediaStore.searchQuery:",x),""}},set:x=>{try{o.setSearchQuery(x)}catch(R){console.error("Error setting mediaStore.searchQuery:",R)}}}),_e=G(()=>{try{return o.categoryCounts}catch(x){return console.error("Error accessing mediaStore.categoryCounts:",x),{}}}),ge=G(()=>{try{return o.excludedGenres}catch(x){return console.error("Error accessing mediaStore.excludedGenres:",x),[]}}),z=G(()=>{try{return o.loading}catch(x){return console.error("Error accessing mediaStore.loading:",x),!1}}),Z=G(()=>{try{return o.error}catch(x){return console.error("Error accessing mediaStore.error:",x),null}}),j=G(()=>{try{const x=[...o.filteredMedia||[]],[R,Q]=ie.value.split("_");return x.sort((P,F)=>{let J=P[R],W=F[R];if(R==="order")J=P.__order||0,W=F.__order||0;else if(R==="airing")J=P.is_airing?1:0,W=F.is_airing?1:0;else if(R==="api_rating")J=P.api_rating||P.rating||0,W=F.api_rating||F.rating||0;else if(R==="personal_rating")J=P.personal_rating||0,W=F.personal_rating||0;else if(R==="release")J=P.release?new Date(P.release).getTime():0,W=F.release?new Date(F.release).getTime():0;else if(R==="title")J=P.title||"",W=F.title||"";else if(R==="days_left"){if(J=de(P),W=de(F),J===1/0&&W===1/0)return 0;if(J===1/0)return Q==="asc"?1:-1;if(W===1/0)return Q==="asc"?-1:1}return R!=="days_left"&&(J==null&&(J=0),W==null&&(W=0)),typeof J=="string"&&(J=J.toLowerCase(),W=W.toLowerCase()),Q==="asc"?J>W?1:-1:J<W?1:-1})}catch(x){return console.error("Error in sortedMedia computed:",x),[]}}),he=G(()=>j.value),pe=x=>{o.setCategory(x),St().closeMobileSidebar()},ke=()=>{o.setSearchQuery("")},Se=x=>{ie.value=x,typeof window<"u"&&localStorage.setItem("mediaLibrary_sortBy",x)},xe=x=>{g.value=x,p.value=!0},me=()=>{p.value=!1,g.value=null},Ce=()=>{T.value=!1},fe=async x=>{console.log("handleBulkAddItems called but not used in new workflow")},Ie=async x=>{g.value?await o.updateMediaItem(g.value.id,x):await o.addMediaItem(x),me()},De=async x=>{var R;try{await o.deleteMediaItem(x.id)}catch(Q){((R=Q.response)==null?void 0:R.status)!==404&&!Q.silent&&(console.error("Delete failed:",Q),t.showError("Failed to delete item: "+(Q.message||"Unknown error"),"Delete Failed"))}},l=async()=>{await e.logout(),await r()},r=async()=>{try{await o.loadMedia()}catch(x){console.error("Error loading media:",x)}},y=()=>{S.value=!S.value},a=()=>{if(S.value=!1,!O.value){t.showWarning("Bitte loggen Sie sich ein, um neue Items hinzuzufÃ¼gen.","Login erforderlich");return}g.value=null,p.value=!0},_=()=>{if(S.value=!1,!O.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}T.value=!0},D=()=>{if(S.value=!1,!O.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}C.value=!0},V=()=>{if(S.value=!1,!O.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}t.showInfo("API Import feature coming soon!","Feature in Entwicklung")},te=()=>{if(S.value=!1,!O.value){t.showWarning("Bitte loggen Sie sich ein, um diese Funktion zu nutzen.","Login erforderlich");return}ze()},re=x=>{if(!x)return"Unknown";const R=h.find(Q=>Q.key===x);return R?R.name:x},Ze=async()=>{const x=re(ce.value),R=_e.value[ce.value]||0;if(R===0){t.showInfo("No items to delete in this category.","Nothing to Delete");return}const Q=`Are you sure you want to delete ALL ${R} items in "${x}"?

This action cannot be undone!`;if(await i.showConfirm({title:"Delete All Items",message:Q}))try{const J=((o==null?void 0:o.mediaData)||[]).filter(W=>ce.value==="watchlist"?W.category==="watchlist"||W.isNew===!0:W.category===ce.value).map(W=>W.id);await o.batchDeleteMediaItems(J),await r(),t.showSuccess(`Successfully deleted ${R} items from "${x}"`,"Items Deleted")}catch(F){console.error("Error deleting items:",F),F.silent?t.showSuccess(`Items deleted from "${x}" (some items may not have existed)`,"Items Deleted"):F.isNotFound?t.showWarning("Some items were not found and could not be deleted, but the operation completed.","Partial Success"):t.showError("Error occurred while deleting items. Please try again.","Delete Failed")}},Xe=x=>{const R=x.split(`
`).map(W=>W.trim()).filter(W=>W.length>0);if(R.length===0){t.showWarning("Die TXT-Datei ist leer oder enthÃ¤lt keine gÃ¼ltigen EintrÃ¤ge.","Leere Datei");return}const P=o.filteredMedia.map(W=>W.title.toLowerCase().trim()),F=R.filter(W=>{const Ue=W.toLowerCase().trim();return!P.some(Re=>Re.includes(Ue)||Ue.includes(Re))}),J=R.filter(W=>{const Ue=W.toLowerCase().trim();return P.some(Re=>Re.includes(Ue)||Ue.includes(Re))});K.value={totalInFile:R.length,missingItems:F,existingItems:J,currentCategory:ce.value,categoryName:re(ce.value)},C.value=!1,I.value=!0},$e=()=>{K.value=null,I.value=!1},ze=async()=>{const x=(o==null?void 0:o.mediaData)||[];if(x.length===0){t.showInfo("Keine Media Items zum Exportieren gefunden.","Nichts zu exportieren");return}const R=await c.showInput({title:"Export Format wÃ¤hlen",message:`1 = CSV
2 = JSON
3 = Beide

Geben Sie die Nummer ein:`,placeholder:"1",defaultValue:"1"});if(!R||!["1","2","3"].includes(R))return;const Q=new Date().toISOString().split("T")[0];(R==="1"||R==="3")&&Ye(x,Q),(R==="2"||R==="3")&&He(x,Q),t.showSuccess(`Collection mit ${x.length} Items wurde erfolgreich exportiert!`,"Export erfolgreich")},Ye=(x,R)=>{const P=[["Titel","Kategorie","Release","Rating","Platforms","Genre","Spielzeit","Status","Beschreibung"].join(","),...x.map(F=>[`"${(F.title||"").replace(/"/g,'""')}"`,`"${(F.category||F.category_name||"Unbekannt").replace(/"/g,'""')}"`,`"${F.release||""}"`,`"${F.rating||""}"`,`"${(F.platforms||"").replace(/"/g,'""')}"`,`"${(F.genre||"").replace(/"/g,'""')}"`,`"${F.spielzeit||""}"`,`"${F.isAiring?"Airing":"Abgeschlossen"}"`,`"${(F.description||"").replace(/"/g,'""')}"`].join(","))].join(`
`);Ge(P,`media_collection_${R}.csv`,"text/csv;charset=utf-8;")},He=(x,R)=>{const Q={exportDate:new Date().toISOString(),totalItems:x.length,categories:[...new Set(x.map(P=>P.category||P.category_name||"Unbekannt"))],items:x.map(P=>({id:P.id,title:P.title||"",category:P.category||P.category_name||"Unbekannt",release:P.release||"",rating:P.rating||null,platforms:P.platforms||"",genre:P.genre||"",spielzeit:P.spielzeit||null,status:P.isAiring?"Airing":"Abgeschlossen",description:P.description||"",isNew:P.isNew||!1,nextSeason:P.nextSeason||null,discovered:P.discovered||null}))};Ge(JSON.stringify(Q,null,2),`media_collection_${R}.json`,"application/json;charset=utf-8;")},Ge=(x,R,Q)=>{const P=new Blob([x],{type:Q}),F=document.createElement("a"),J=URL.createObjectURL(P);F.setAttribute("href",J),F.setAttribute("download",R),F.style.visibility="hidden",document.body.appendChild(F),F.click(),document.body.removeChild(F),URL.revokeObjectURL(J)};return{showLoginModal:d,showRegisterModal:u,showEditModal:p,showFloatingMenu:S,showBulkAddModal:T,showTxtImportModal:C,showTxtImportResults:I,editingItem:g,gridColumns:ne,sortBy:ie,categories:h,txtImportResults:K,isLoggedIn:O,isAdmin:Te,userName:Ae,currentCategory:ce,searchQuery:we,categoryCounts:_e,excludedGenres:ge,loading:z,error:Z,paginatedMedia:he,setCategory:pe,clearSearch:ke,updateSortBy:Se,editItem:xe,closeEditModal:me,closeBulkAddModal:Ce,handleBulkAddItems:fe,handleSaveItem:Ie,handleDeleteItem:De,logout:l,loadMedia:r,toggleFloatingMenu:y,addNewItem:a,bulkAddItems:_,importFromTxt:D,importFromAPI:V,createCollection:te,exportMediaCollection:ze,exportAsCSV:Ye,exportAsJSON:He,downloadFile:Ge,deleteAllInCategory:Ze,getCategoryDisplayName:re,navigateToCalendar:()=>{pe("calendar")},navigateToProfile:()=>{pe("profile")},navigateToAdmin:()=>{console.log("ðŸ”¥ navigateToAdmin function called!"),console.log("ðŸ”¥ Router object:",n),console.log("ðŸ”¥ Pushing to /admin...");try{n.push("/admin"),console.log("ðŸ”¥ Successfully navigated to /admin!")}catch(x){console.error("ðŸ”¥ Error navigating to admin:",x)}},processTxtContent:Xe,closeTxtImportResults:$e,cleanup:()=>{typeof window<"u"&&window.removeEventListener("resize",ue)},router:n}}const ms={name:"StarRating",props:{rating:{type:Number,default:0},editMode:{type:Boolean,default:!1},itemId:{type:[Number,String],required:!0}},emits:["rating-changed"],data(){return{currentRating:this.rating||0,hoverRating:0}},watch:{rating(n){this.currentRating=n||0}},methods:{handleStarClick(n){this.editMode&&(this.currentRating=n,this.showSuccessAnimation(),this.$emit("rating-changed",{itemId:this.itemId,rating:n}))},showSuccessAnimation(){const n=document.createElement("div");n.innerHTML="âœ“",n.style.cssText=`
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: #4CAF50;
        color: white;
        padding: 8px 12px;
        border-radius: 50%;
        font-size: 16px;
        font-weight: bold;
        z-index: 10000;
        animation: successPulse 0.6s ease-out;
        pointer-events: none;
      `;const e=document.createElement("style");e.textContent=`
        @keyframes successPulse {
          0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
          50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
          100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
        }
      `,document.head.appendChild(e),document.body.appendChild(n),setTimeout(()=>{document.body.removeChild(n),document.head.removeChild(e)},600)},handleMouseEnter(n){this.editMode&&(this.hoverRating=n)},handleMouseLeave(){this.editMode&&(this.hoverRating=0)},clearRating(){this.editMode&&(this.currentRating=0,this.$emit("rating-changed",{itemId:this.itemId,rating:0}))}}},fs={class:"stars-container"},hs=["onClick","onMouseenter","disabled","title"],ps={class:"star-number"},vs={key:0,class:"rating-info"},ys={class:"rating-text"};function bs(n,e,o,t,i,c){return m(),f("div",{class:H(["star-rating",{"edit-mode":o.editMode}])},[s("div",fs,[(m(),f(X,null,$(10,d=>s("button",{key:d,class:H(["star",{filled:d<=i.currentRating,hover:d<=i.hoverRating,"edit-mode":o.editMode}]),onClick:u=>c.handleStarClick(d),onMouseenter:u=>c.handleMouseEnter(d),onMouseleave:e[0]||(e[0]=(...u)=>c.handleMouseLeave&&c.handleMouseLeave(...u)),disabled:!o.editMode,title:o.editMode?`Rate ${d}/10`:`Current rating: ${i.currentRating}/10`},[e[2]||(e[2]=s("span",{class:"star-icon"},"â˜…",-1)),s("span",ps,v(d),1)],42,hs)),64))]),o.editMode&&i.currentRating>0?(m(),f("div",vs,[s("span",ys,v(i.currentRating)+"/10",1),s("button",{class:"clear-rating",onClick:e[1]||(e[1]=(...d)=>c.clearRating&&c.clearRating(...d)),title:"Clear rating"}," âœ• ")])):k("",!0)],2)}const ws=ee(ms,[["render",bs],["__scopeId","data-v-b5a8c120"]]),_s={name:"MediaItem",components:{StarRating:ws},props:{item:{type:Object,required:!0},editMode:{type:Boolean,default:!1}},emits:["edit","watchlist-toggled","show-message","rating-changed"],computed:{showWatchlistTag(){return this.item.category==="watchlist"||this.item.isNew===!0},isWatchlistItem(){return this.item.category==="watchlist"||this.item.isNew===!0},isSeries(){return this.item.category==="series"||this.item.watchlist_type==="series"},isInWatchlist(){return this.item.category==="watchlist"?!0:this.item.is_in_watchlist||!1},shouldShowHeartButton(){return this.isSeries}},methods:{getImageUrl(n){return n?n.startsWith("http")?n.startsWith("http://")?n.replace("http://","https://"):n:n.startsWith("/")?n:n.startsWith("storage/")?`/${n}`:`/${n}`:""},handleImageError(n){var e;n.target.style.display="none",(e=n.target.nextElementSibling)==null||e.classList.add("show")},formatDate(n){return n?new Date(n).toLocaleDateString():""},editItem(){this.editMode||this.$emit("edit",this.item)},handleRatingChanged(n){this.$emit("rating-changed",n)},openExtraLink(){this.item.extra_link&&window.open(this.item.extra_link,"_blank","noopener,noreferrer")},getStatusIcon(){switch(this.item.series_status){case"Ended":return"âœ…";case"Canceled":return"âŒ";case"In Production":return"ðŸ”§";default:return"ðŸ“º"}},getDaysLeftText(){if(!this.item.next_season_release)return"";const n=new Date(this.item.next_season_release),e=new Date,o=n.getTime()-e.getTime(),t=Math.ceil(o/(1e3*3600*24));return t>0?`${t} day${t>1?"s":""} left`:t===0?"Airs today!":`Aired ${Math.abs(t)} day${Math.abs(t)>1?"s":""} ago`},handleHeartClick(){console.log("ðŸ’– Heart button clicked!"),console.log("ðŸ’– Button visible:",this.isSeries&&this.item.is_airing),console.log("ðŸ’– Series check:",this.isSeries),console.log("ðŸ’– Airing check:",this.item.is_airing),this.toggleToWatchlist()},async toggleToWatchlist(){var n;try{console.log("ðŸ’– Toggling series to watchlist:",this.item.title),console.log("ðŸ’– Item details:",{id:this.item.id,title:this.item.title,category:this.item.category,is_airing:this.item.is_airing}),this.showHeartLoading();const e=await le.toggleSeriesToWatchlist(this.item.id);e.success?(console.log("ðŸ’– Watchlist toggle successful:",e),this.showHeartSuccess(),this.$emit("watchlist-toggled",{seriesId:this.item.id,action:e.action,watchlistType:e.watchlist_type,seasonInfo:e.season_info,message:e.message})):(console.error("âŒ Watchlist toggle failed:",e.error),this.$emit("show-message",{type:"error",text:e.error||"Failed to toggle watchlist"}))}catch(e){if(console.error("âŒ Watchlist toggle error:",e),e.response&&e.response.status===400){const o=((n=e.response.data)==null?void 0:n.error)||"Only airing series can be added to watchlist";this.$emit("show-message",{type:"error",text:o})}else this.$emit("show-message",{type:"error",text:"Failed to toggle watchlist"})}},showHeartLoading(){const n=this.$el.querySelector(".heart-toggle-button");n&&(n.style.opacity="0.7",n.style.transform="scale(0.95)",n.style.transition="all 0.2s ease")},showHeartSuccess(){const n=this.$el.querySelector(".heart-toggle-button");n&&(n.style.background="rgba(40, 167, 69, 0.9)",n.style.transform="scale(1.1)",n.style.boxShadow="0 4px 15px rgba(40, 167, 69, 0.4)",setTimeout(()=>{n.style.background="rgba(0, 0, 0, 0.8)",n.style.transform="scale(1)",n.style.boxShadow="none"},600))},getWatchlistDaysLeft(){const n=this.item.watchlist_release_date?new Date(this.item.watchlist_release_date):this.item.release?new Date(this.item.release):null;if(!n)return"";const e=new Date,o=n.getTime()-e.getTime(),t=Math.ceil(o/(1e3*3600*24));return t>0?`${t} day${t>1?"s":""} left`:t===0?"Releases today!":`Released ${Math.abs(t)} day${Math.abs(t)>1?"s":""} ago`},getWatchlistReleaseStatus(){if(!this.item.release)return"";const n=new Date(this.item.release),e=new Date;e.setHours(0,0,0,0),n.setHours(0,0,0,0);const o=n.getTime()-e.getTime(),t=Math.ceil(o/(1e3*3600*24));if(t>0)return t===1?"Tomorrow!":t<=7?`${t} days left`:t<=30?`${t} days left`:`${Math.ceil(t/30)} months left`;if(t===0)return"Released today!";{const i=this.getTypeTagText().toLowerCase();return i==="game"?"Unplayed yet":i==="series"||i==="movie"?"Unwatched yet":i==="buecher"?"Unread yet":"Unconsumed yet"}},getWatchlistReleaseStatusClass(){if(!this.item.release)return"";const n=new Date(this.item.release),e=new Date;e.setHours(0,0,0,0),n.setHours(0,0,0,0);const o=n.getTime()-e.getTime(),t=Math.ceil(o/(1e3*3600*24));return t>0?"countdown":t===0?"released-today":"unconsumed"},getTypeTagText(){var e,o,t;const n=this.item.watchlistType||this.item.watchlist_type;if(n)return n.charAt(0).toUpperCase()+n.slice(1);if(this.item.genre){const i=this.item.genre.toLowerCase();if(i.includes("game")||i.includes("gaming")||(e=this.item.platforms)!=null&&e.toLowerCase().includes("steam")||(o=this.item.platforms)!=null&&o.toLowerCase().includes("ps")||(t=this.item.platforms)!=null&&t.toLowerCase().includes("xbox"))return"Game";if(i.includes("series")||i.includes("tv")||i.includes("episode")||this.item.isAiring)return"Series";if(i.includes("movie")||i.includes("film")||i.includes("cinema"))return"Movie";if(i.includes("book")||i.includes("literature")||i.includes("novel")||i.includes("author"))return"BÃ¼cher"}if(this.item.platforms){const i=this.item.platforms.toLowerCase();if(i.includes("steam")||i.includes("ps")||i.includes("xbox")||i.includes("nintendo")||i.includes("pc"))return"Game";if(i.includes("netflix")||i.includes("hulu")||i.includes("disney")||i.includes("hbo"))return"Series";if(i.includes("cinema")||i.includes("theater"))return"Movie";if(i.includes("book")||i.includes("kindle")||i.includes("audible")||i.includes("author"))return"BÃ¼cher"}return"Media"},getTypeTagClass(){return`type-${this.getTypeTagText().toLowerCase()}`},getNextSeasonCountdown(){if(!this.item.nextSeasonRelease)return"";const n=new Date(this.item.nextSeasonRelease),e=new Date;e.setHours(0,0,0,0),n.setHours(0,0,0,0);const o=n.getTime()-e.getTime(),t=Math.ceil(o/(1e3*3600*24));return t>0?t===1?"Tomorrow!":t<=7?`${t} days`:t<=30?`${t} days`:`${Math.ceil(t/30)} months`:t===0?"Today!":"Released"},getCategoryClass(){var e,o;const n=((e=this.item.category)==null?void 0:e.toLowerCase())||((o=this.item.category_name)==null?void 0:o.toLowerCase());return n==="movies"||n==="movie"?"category-movies":n==="books"||n==="buecher"||n==="book"?"category-books":n==="series"||n==="tv"||n==="serie"?"category-series":n==="games"||n==="game"||n==="spiele"?"category-games":n==="watchlist"?"category-watchlist":"category-default"},getCategoryIcon(){var e,o,t,i;if(this.isWatchlistItem){const c=this.item.watchlistType||this.item.watchlist_type;if(c){const d=c.toLowerCase();if(d==="movies"||d==="movie")return"ðŸŽ¬";if(d==="books"||d==="buecher")return"ðŸ“š";if(d==="series"||d==="tv")return"ðŸ“º";if(d==="games"||d==="game")return"ðŸŽ®"}if(this.item.genre){const d=this.item.genre.toLowerCase();if(d.includes("game")||d.includes("gaming")||(e=this.item.platforms)!=null&&e.toLowerCase().includes("steam")||(o=this.item.platforms)!=null&&o.toLowerCase().includes("ps")||(t=this.item.platforms)!=null&&t.toLowerCase().includes("xbox"))return"ðŸŽ®";if(d.includes("book")||d.includes("buecher"))return"ðŸ“š";if(d.includes("series")||d.includes("tv")||d.includes("tv show"))return"ðŸ“º";if(d.includes("movie")||d.includes("film"))return"ðŸŽ¬"}return"ðŸ“"}const n=(i=this.item.category)==null?void 0:i.toLowerCase();return n==="movies"||n==="movie"?"ðŸŽ¬":n==="books"||n==="buecher"?"ðŸ“š":n==="series"||n==="tv"?"ðŸ“º":n==="games"||n==="game"?"ðŸŽ®":"ðŸ“"},getCategoryStyle(){var e;const n=(e=this.item.category)==null?void 0:e.toLowerCase();if(n==="games"||n==="game"){const o=this.item.rating||0;return this.getGameStyleByRating(o)}return{}},getGameStyleByRating(n){return n>=4.5?{"--game-primary":"#ffd700","--game-secondary":"#ffed4e","--game-accent":"#ff6b35","--game-glow":"0 0 20px rgba(255, 215, 0, 0.6)","--game-border":"3px solid #ffd700"}:n>=4?{"--game-primary":"#00d4ff","--game-secondary":"#e8f4fd","--game-accent":"#00ff88","--game-glow":"0 0 15px rgba(0, 212, 255, 0.5)","--game-border":"3px solid #00d4ff"}:n>=3.5?{"--game-primary":"#00ff88","--game-secondary":"#4caf50","--game-accent":"#8bc34a","--game-glow":"0 0 12px rgba(0, 255, 136, 0.4)","--game-border":"3px solid #00ff88"}:n>=3?{"--game-primary":"#ff9800","--game-secondary":"#ffc107","--game-accent":"#ff5722","--game-glow":"0 0 10px rgba(255, 152, 0, 0.3)","--game-border":"3px solid #ff9800"}:n>=2?{"--game-primary":"#ff5722","--game-secondary":"#f44336","--game-accent":"#d32f2f","--game-glow":"0 0 8px rgba(255, 87, 34, 0.3)","--game-border":"3px solid #ff5722"}:{"--game-primary":"#9e9e9e","--game-secondary":"#757575","--game-accent":"#616161","--game-glow":"0 0 5px rgba(158, 158, 158, 0.2)","--game-border":"3px solid #9e9e9e"}}}},ks={class:"media-image"},Ss=["src","alt"],xs={key:1,class:"no-image"},Cs={class:"no-image-icon"},Is={class:"media-info"},Ds={class:"labels-container"},As={key:0,class:"category-type-tag"},Ts={key:1,class:"watchlist-tag new-season"},Ms={key:2,class:"status-badge airing"},Rs={key:3,class:"status-badge finished"},Es={key:4,class:"season-info"},Us={key:5,class:"days-left"},Ls={key:6,class:"days-left"},Bs={class:"title-container"},Ps={class:"media-title"},Fs={class:"heart-text"},Ns={key:3,class:"star-rating-overlay"};function Gs(n,e,o,t,i,c){const d=ae("StarRating");return m(),f("div",{class:H(["media-item",c.getCategoryClass()]),style:Be(c.getCategoryStyle()),onClick:e[4]||(e[4]=(...u)=>c.editItem&&c.editItem(...u))},[s("div",ks,[o.item.image_url||o.item.path?(m(),f("img",{key:0,src:c.getImageUrl(o.item.image_url||o.item.path),alt:o.item.title,onError:e[0]||(e[0]=(...u)=>c.handleImageError&&c.handleImageError(...u))},null,40,Ss)):(m(),f("div",xs,[s("span",Cs,v(c.getCategoryIcon()),1)]))]),s("div",Is,[s("div",Ds,[c.isWatchlistItem&&c.getTypeTagText()?(m(),f("div",As,v(c.getCategoryIcon()),1)):k("",!0),c.isWatchlistItem&&o.item.watchlist_series_type==="new_season"?(m(),f("div",Ts," ðŸ“º "+v(o.item.watchlist_season_info||"New Season"),1)):k("",!0),c.isSeries&&!c.isWatchlistItem&&o.item.is_airing?(m(),f("div",Ms," ðŸ”´ Airing ")):c.isSeries&&!c.isWatchlistItem&&o.item.series_status?(m(),f("div",Rs,v(c.getStatusIcon())+" "+v(o.item.series_status),1)):k("",!0),c.isSeries&&o.item.is_airing&&o.item.next_season?(m(),f("div",Es," ðŸ“º S"+v(o.item.next_season),1)):k("",!0),c.isWatchlistItem&&o.item.release?(m(),f("div",Us," â° "+v(c.getWatchlistDaysLeft()),1)):c.isSeries&&o.item.is_airing&&o.item.next_season_release?(m(),f("div",Ls," â° "+v(c.getDaysLeftText()),1)):k("",!0)]),s("div",Bs,[s("h3",Ps,v(o.item.title),1)])]),c.isSeries&&!c.isWatchlistItem&&o.item.extra_link?(m(),f("div",{key:0,class:"series-extra-button",onClick:e[1]||(e[1]=oe((...u)=>c.openExtraLink&&c.openExtraLink(...u),["stop"]))},[...e[5]||(e[5]=[s("span",{class:"extra-link-icon"},"ðŸ”—",-1),s("span",{class:"extra-link-text"},"Extra Link",-1)])])):k("",!0),c.isWatchlistItem&&o.item.extra_link?(m(),f("div",{key:1,class:"watchlist-extra-button",onClick:e[2]||(e[2]=oe((...u)=>c.openExtraLink&&c.openExtraLink(...u),["stop"]))},[...e[6]||(e[6]=[s("span",{class:"extra-link-icon"},"ðŸ”—",-1),s("span",{class:"extra-link-text"},"Go to Link",-1)])])):k("",!0),c.shouldShowHeartButton?(m(),f("div",{key:2,class:"heart-toggle-button",onClick:e[3]||(e[3]=oe((...u)=>c.handleHeartClick&&c.handleHeartClick(...u),["stop"]))},[s("span",{class:H(["heart-icon",{active:c.isInWatchlist}])},v(c.isInWatchlist?"â¤ï¸":"ðŸ¤"),3),s("span",Fs,v(c.isInWatchlist?"In Watchlist":"Add to Watchlist"),1)])):k("",!0),o.editMode?(m(),f("div",Ns,[ve(d,{rating:o.item.personal_rating||0,"edit-mode":o.editMode,"item-id":o.item.id,onRatingChanged:c.handleRatingChanged},null,8,["rating","edit-mode","item-id","onRatingChanged"])])):k("",!0),e[7]||(e[7]=s("div",{class:"edit-indicator"},[s("span",{class:"edit-icon"},"âœï¸")],-1))],6)}const Ws=ee(_s,[["render",Gs],["__scopeId","data-v-09584710"]]),Os={name:"VersionInfo",data(){return{version:"1.0.0"}}},Vs={class:"version-info"},js={class:"version-label"};function zs(n,e,o,t,i,c){return m(),f("div",Vs,[s("span",js,"Build #"+v(i.version),1)])}const Ys=ee(Os,[["render",zs],["__scopeId","data-v-2d54e3c7"]]),Hs={name:"Sidebar",components:{VersionInfo:Ys},props:{collapsed:{type:Boolean,default:!1},mobileOpen:{type:Boolean,default:!1},isLoggedIn:{type:Boolean,default:!1},userName:{type:String,default:""},currentCategory:{type:String,default:"watchlist"},categoryCounts:{type:Object,default:()=>({})},categories:{type:Array,default:()=>[{key:"game",name:"Games",icon:"ðŸŽ®"},{key:"series",name:"Series",icon:"ðŸ“º"},{key:"movie",name:"Movies",icon:"ðŸŽ¬"},{key:"buecher",name:"BÃ¼cher",icon:"ðŸ“š"},{key:"watchlist",name:"Watchlist",icon:"â¤ï¸"}]},selectedGenres:{type:Array,default:()=>[]},excludedGenres:{type:Array,default:()=>[]},genres:{type:Array,default:()=>[]},genreLoading:{type:Boolean,default:!1},genreError:{type:String,default:null}},emits:["toggle","setCategory","addItem","navigateToCalendar","navigateToProfile","showLogin","showRegister","logout","changePassword","deleteAccount","genres-updated","genres-excluded","genres-cleared","load-genres"],data(){return{showAllGenres:!1}},computed:{showGenreSection(){return this.currentCategory&&this.currentCategory!=="statistics"&&this.currentCategory!=="calendar"&&this.currentCategory!=="profile"},visibleGenres(){return this.showAllGenres||this.genres.length<=5?this.genres:this.genres.slice(0,5)},genreCheckboxStates(){return this.visibleGenres.map(n=>({...n,isIncluded:this.selectedGenres.includes(n.name),isExcluded:this.excludedGenres.includes(n.name)}))}},methods:{toggleGenreInclude(n){const e=[...this.selectedGenres],o=[...this.excludedGenres];if(e.includes(n)){const i=e.indexOf(n);e.splice(i,1)}else{e.push(n);const i=o.indexOf(n);i>-1&&o.splice(i,1)}this.$emit("genres-updated",e),this.$emit("genres-excluded",o)},toggleGenreExclude(n){const e=[...this.selectedGenres],o=[...this.excludedGenres];if(o.includes(n)){const i=o.indexOf(n);o.splice(i,1)}else{o.push(n);const i=e.indexOf(n);i>-1&&e.splice(i,1)}this.$emit("genres-updated",e),this.$emit("genres-excluded",o)},clearGenreFilter(){this.$emit("genres-cleared"),this.$emit("genres-excluded",[])},loadGenres(){this.$emit("load-genres")},toggleShowAllGenres(){this.showAllGenres=!this.showAllGenres}}},qs={class:"sidebar-content"},Js={class:"sidebar-section"},Qs={class:"sidebar-nav"},Ks=["onClick"],Zs={class:"nav-icon"},Xs={class:"nav-text"},$s={class:"nav-count"},ea=["onClick","title"],ta={key:0,class:"sidebar-section genre-section"},sa={key:0,class:"genre-loading"},aa={key:1,class:"genre-error"},oa={key:2,class:"genre-empty"},na=["title"],ia={class:"genre-name"},la={class:"checkbox-container"},ra={class:"genre-checkbox-label include-checkbox"},da=["value","checked","onChange"],ca={class:"genre-checkbox-label exclude-checkbox"},ua=["value","checked","onChange"],ga={class:"genre-count"},ma=["title"],fa={class:"sidebar-section"},ha={key:0,class:"auth-buttons"},pa={key:1,class:"user-info"},va={class:"user-profile"},ya={class:"profile-details"},ba={class:"user-name"};function wa(n,e,o,t,i,c){const d=ae("VersionInfo");return m(),f("aside",{id:"sidebar",class:H(["sidebar",{collapsed:o.collapsed,open:o.mobileOpen}])},[s("div",{class:"sidebar-header",onClick:e[0]||(e[0]=u=>n.$emit("toggle"))},[...e[13]||(e[13]=[s("h2",null,"Media Library",-1),s("button",{class:"sidebar-toggle"},"â˜°",-1)])]),s("div",qs,[s("div",Js,[e[18]||(e[18]=s("h3",null,"Browse",-1)),s("nav",Qs,[(m(!0),f(X,null,$(o.categories,u=>(m(),f("div",{key:u.key,class:"nav-item"},[s("button",{class:H(["nav-btn",{active:o.currentCategory===u.key}]),onClick:p=>n.$emit("setCategory",u.key)},[s("span",Zs,v(u.icon),1),s("span",Xs,v(u.name),1),s("span",$s,v(o.categoryCounts[u.key]||0),1)],10,Ks),s("button",{class:"add-btn",onClick:p=>n.$emit("addItem",u.key),title:`Add ${u.name}`},[...e[14]||(e[14]=[s("span",{class:"add-icon"},"+",-1)])],8,ea)]))),128)),s("button",{class:H(["nav-btn",{active:o.currentCategory==="statistics"}]),onClick:e[1]||(e[1]=u=>n.$emit("setCategory","statistics"))},[...e[15]||(e[15]=[s("span",{class:"nav-icon"},"ðŸ“Š",-1),s("span",{class:"nav-text"},"Statistics",-1)])],2),s("button",{class:H(["nav-btn",{active:o.currentCategory==="calendar"}]),onClick:e[2]||(e[2]=u=>n.$emit("setCategory","calendar"))},[...e[16]||(e[16]=[s("span",{class:"nav-icon"},"ðŸ“…",-1),s("span",{class:"nav-text"},"Calendar",-1)])],2),s("button",{class:H(["nav-btn",{active:o.currentCategory==="profile"}]),onClick:e[3]||(e[3]=u=>n.$emit("setCategory","profile"))},[...e[17]||(e[17]=[s("span",{class:"nav-icon"},"ðŸ‘¤",-1),s("span",{class:"nav-text"},"Profile",-1)])],2)])]),c.showGenreSection?(m(),f("div",ta,[e[22]||(e[22]=s("h3",null,"Genres",-1)),o.genreLoading?(m(),f("div",sa,[...e[19]||(e[19]=[s("div",{class:"loading-spinner"},null,-1),s("span",null,"Loading genres...",-1)])])):o.genreError?(m(),f("div",aa,[e[20]||(e[20]=s("span",null,"Failed to load genres",-1)),s("button",{onClick:e[4]||(e[4]=(...u)=>c.loadGenres&&c.loadGenres(...u)),class:"retry-btn"},"Retry")])):o.genres.length===0?(m(),f("div",oa,[...e[21]||(e[21]=[s("span",null,"No genres available",-1)])])):(m(),f("div",{key:3,class:H(["genre-list",{loading:o.genreLoading}])},[ve(ls,{name:"genre-fade",tag:"div"},{default:is(()=>[(m(!0),f(X,null,$(c.genreCheckboxStates,(u,p)=>(m(),f("div",{key:u.name,class:"genre-checkbox-item",title:`${u.name} (${u.count} items)`,style:Be({"--animation-delay":`${p*50}ms`})},[s("span",ia,v(u.name),1),s("div",la,[s("label",ra,[s("input",{type:"checkbox",value:u.name,checked:u.isIncluded,onChange:S=>c.toggleGenreInclude(u.name),class:"genre-checkbox include-checkbox-input"},null,40,da)]),s("label",ca,[s("input",{type:"checkbox",value:u.name,checked:u.isExcluded,onChange:S=>c.toggleGenreExclude(u.name),class:"genre-checkbox exclude-checkbox-input"},null,40,ua)])]),s("span",ga,v(u.count),1)],12,na))),128))]),_:1}),o.genres.length>5?(m(),f("button",{key:0,class:"show-more-btn",onClick:e[5]||(e[5]=(...u)=>c.toggleShowAllGenres&&c.toggleShowAllGenres(...u)),title:i.showAllGenres?"Show fewer genres":"Show all genres"},v(i.showAllGenres?"Show Less":`Show More (${o.genres.length-5})`),9,ma)):k("",!0),o.selectedGenres.length>0||o.excludedGenres.length>0?(m(),f("button",{key:1,class:"clear-genre-btn",onClick:e[6]||(e[6]=(...u)=>c.clearGenreFilter&&c.clearGenreFilter(...u)),title:"Clear all genre filters"}," Clear All Filters ("+v(o.selectedGenres.length+o.excludedGenres.length)+") ",1)):k("",!0)],2))])):k("",!0),s("div",fa,[e[24]||(e[24]=s("h3",null,"Account",-1)),o.isLoggedIn?(m(),f("div",pa,[s("div",va,[e[23]||(e[23]=s("div",{class:"profile-avatar"},[s("span",{class:"avatar-text"},"ðŸ‘¤")],-1)),s("div",ya,[s("span",ba,v(o.userName),1)]),s("button",{class:"account-btn",onClick:e[9]||(e[9]=u=>n.$emit("navigateToProfile"))},"âš™ï¸")]),s("button",{class:"auth-btn",onClick:e[10]||(e[10]=u=>n.$emit("logout"))},"Logout"),s("button",{class:"change-password-btn",onClick:e[11]||(e[11]=u=>n.$emit("changePassword"))},"CHANGE PASSWORD"),s("button",{class:"delete-account-btn",onClick:e[12]||(e[12]=u=>n.$emit("deleteAccount"))},"DELETE ACCOUNT")])):(m(),f("div",ha,[s("button",{class:"auth-btn",onClick:e[7]||(e[7]=u=>n.$emit("showLogin"))},"Login"),s("button",{class:"auth-btn",onClick:e[8]||(e[8]=u=>n.$emit("showRegister"))},"Register")]))])]),ve(d)],2)}const _a=ee(Hs,[["render",wa],["__scopeId","data-v-ba54cc66"]]),ka={name:"MainHeader",props:{searchQuery:{type:String,default:""},sortBy:{type:String,default:"order_asc"},editMode:{type:Boolean,default:!1}},emits:["update:searchQuery","update:sortBy","toggleMobileSidebar","clearSearch","toggleEditMode"]},Sa={class:"main-header"},xa={class:"header-left"},Ca={class:"header-center"},Ia={class:"search-container"},Da=["value"],Aa={class:"header-right"},Ta={class:"edit-mode-container"},Ma=["title"],Ra={class:"edit-icon"},Ea={class:"edit-text"},Ua={class:"sort-container"},La=["value"];function Ba(n,e,o,t,i,c){return m(),f("header",Sa,[s("div",xa,[s("button",{class:"mobile-sidebar-toggle",onClick:e[0]||(e[0]=d=>n.$emit("toggleMobileSidebar"))},"â˜°")]),s("div",Ca,[s("div",Ia,[s("input",{type:"text",value:o.searchQuery,onInput:e[1]||(e[1]=d=>n.$emit("update:searchQuery",d.target.value)),placeholder:"Search..."},null,40,Da),s("button",{class:"search-clear",onClick:e[2]||(e[2]=d=>n.$emit("clearSearch"))},"Ã—")])]),s("div",Aa,[s("div",Ta,[s("button",{class:H(["edit-mode-toggle",{active:o.editMode}]),onClick:e[3]||(e[3]=d=>n.$emit("toggleEditMode")),title:o.editMode?"Exit Edit Mode":"Enter Edit Mode"},[s("span",Ra,v(o.editMode?"âœ“":"âœï¸"),1),s("span",Ea,v(o.editMode?"Done":"Edit"),1)],10,Ma)]),s("div",Ua,[s("select",{value:o.sortBy,onChange:e[4]||(e[4]=d=>n.$emit("update:sortBy",d.target.value))},[...e[5]||(e[5]=[Oe('<option value="order_asc" data-v-0359334b>Original order â†‘</option><option value="order_desc" data-v-0359334b>Original order â†“</option><option value="title_asc" data-v-0359334b>Title A-Z</option><option value="title_desc" data-v-0359334b>Title Z-A</option><option value="release_asc" data-v-0359334b>Release â†‘</option><option value="release_desc" data-v-0359334b>Release â†“</option><option value="api_rating_asc" data-v-0359334b>API Rating â†‘</option><option value="api_rating_desc" data-v-0359334b>API Rating â†“</option><option value="personal_rating_asc" data-v-0359334b>Personal Rating â†‘</option><option value="personal_rating_desc" data-v-0359334b>Personal Rating â†“</option><option value="airing_desc" data-v-0359334b>Airing first</option><option value="airing_asc" data-v-0359334b>Finished first</option><option value="days_left_asc" data-v-0359334b>Days left â†‘</option><option value="days_left_desc" data-v-0359334b>Days left â†“</option>',14)])],40,La)])])])}const Pa=ee(ka,[["render",Ba],["__scopeId","data-v-0359334b"]]),Fa={name:"FloatingActionButton",props:{showMenu:{type:Boolean,default:!1},showDeleteAll:{type:Boolean,default:!1},categoryName:{type:String,default:""},itemCount:{type:Number,default:0}},emits:["toggleMenu","addNewItem","bulkAddItems","importFromTxt","importFromAPI","createCollection","deleteAllInCategory"]},Na={class:"floating-actions"},Ga={class:"menu-text"},Wa={class:"item-count-badge"};function Oa(n,e,o,t,i,c){return m(),f("div",Na,[s("div",{class:H(["floating-menu",{show:o.showMenu}])},[s("button",{class:"floating-menu-item",onClick:e[0]||(e[0]=d=>n.$emit("addNewItem"))},[...e[7]||(e[7]=[s("span",{class:"menu-icon"},"âž•",-1),s("span",{class:"menu-text"},"Add Item",-1)])]),s("button",{class:"floating-menu-item",onClick:e[1]||(e[1]=d=>n.$emit("bulkAddItems"))},[...e[8]||(e[8]=[s("span",{class:"menu-icon"},"ðŸ“¦",-1),s("span",{class:"menu-text"},"Bulk Add",-1)])]),s("button",{class:"floating-menu-item",onClick:e[2]||(e[2]=d=>n.$emit("importFromTxt"))},[...e[9]||(e[9]=[s("span",{class:"menu-icon"},"ðŸ“„",-1),s("span",{class:"menu-text"},"Import from TXT",-1)])]),s("button",{class:"floating-menu-item",onClick:e[3]||(e[3]=d=>n.$emit("importFromAPI"))},[...e[10]||(e[10]=[s("span",{class:"menu-icon"},"ðŸŒ",-1),s("span",{class:"menu-text"},"Import from API",-1)])]),s("button",{class:"floating-menu-item",onClick:e[4]||(e[4]=d=>n.$emit("createCollection"))},[...e[11]||(e[11]=[s("span",{class:"menu-icon"},"ðŸ“š",-1),s("span",{class:"menu-text"},"Create Collection",-1)])]),o.showDeleteAll&&o.itemCount>0?(m(),f("button",{key:0,class:"floating-menu-item delete-all-item",onClick:e[5]||(e[5]=d=>n.$emit("deleteAllInCategory"))},[e[12]||(e[12]=s("span",{class:"menu-icon"},"ðŸ—‘ï¸",-1)),s("span",Ga,"Delete All "+v(o.categoryName),1),s("span",Wa,"("+v(o.itemCount)+")",1)])):k("",!0)],2),s("button",{class:"floating-add-btn",onClick:e[6]||(e[6]=d=>n.$emit("toggleMenu"))},v(o.showMenu?"âœ•":"+"),1)])}const Va=ee(Fa,[["render",Oa],["__scopeId","data-v-f77e6366"]]),ja={name:"LoginModal",emits:["close","success"],setup(n,{emit:e}){const o=je(),t=Fe({email:""}),i=w(!1),c=w("");return{form:t,loading:i,error:c,handleLogin:async()=>{i.value=!0,c.value="";try{const C=await o.login(t.email);C.success?e("success",C):c.value=C.error}catch(C){c.value=C.message||"Login failed"}finally{i.value=!1}},closeModal:()=>{e("close")},checkLocalDB:async()=>{try{const I=await(await fetch("http://127.0.0.1:8000/api/check-db")).json();alert(`Local DB: ${I.success?"âœ… Connected":"âŒ Error"}
Users: ${I.user_count}
Error: ${I.error||"None"}`)}catch(C){alert(`Local DB Check Failed: ${C.message}`)}},checkProdDB:async()=>{try{const C=window.location.origin,g=await(await fetch(`${C}/api/check-db`)).json();alert(`Prod DB: ${g.success?"âœ… Connected":"âŒ Error"}
Users: ${g.user_count}
Error: ${g.error||"None"}`)}catch(C){alert(`Prod DB Check Failed: ${C.message}`)}},deleteAllUsers:async()=>{if(confirm("âš ï¸ WARNING: This will delete ALL users! Are you sure?"))try{const C=window.location.origin,g=await(await fetch(`${C}/api/delete-all-users`,{method:"POST",headers:{"Content-Type":"application/json"}})).json();alert(`Delete Result: ${g.success?"âœ… Success":"âŒ Error"}
Deleted: ${g.deleted_count} users
Error: ${g.error||"None"}`)}catch(C){alert(`Delete Failed: ${C.message}`)}}}}},za={class:"form-group"},Ya=["disabled"],Ha={key:0,class:"error-message"},qa={class:"modal-buttons"},Ja=["disabled"],Qa=["disabled"];function Ka(n,e,o,t,i,c){return m(),f("div",{class:"modal",onClick:e[4]||(e[4]=(...d)=>t.closeModal&&t.closeModal(...d))},[s("div",{class:"modal-content auth-modal",onClick:e[3]||(e[3]=oe(()=>{},["stop"]))},[e[6]||(e[6]=s("h2",null,"Login",-1)),s("form",{onSubmit:e[2]||(e[2]=oe((...d)=>t.handleLogin&&t.handleLogin(...d),["prevent"]))},[s("div",za,[e[5]||(e[5]=s("label",{for:"email"},"Email:",-1)),A(s("input",{type:"email",id:"email","onUpdate:modelValue":e[0]||(e[0]=d=>t.form.email=d),required:"",disabled:t.loading,placeholder:"Enter your email address"},null,8,Ya),[[B,t.form.email]])]),t.error?(m(),f("div",Ha,v(t.error),1)):k("",!0),s("div",qa,[s("button",{type:"submit",disabled:t.loading},v(t.loading?"Logging in...":"Login"),9,Ja),s("button",{type:"button",onClick:e[1]||(e[1]=(...d)=>t.closeModal&&t.closeModal(...d)),disabled:t.loading}," Cancel ",8,Qa)])],32)])])}const Za=ee(ja,[["render",Ka],["__scopeId","data-v-88129817"]]),Xa={name:"RegisterModal",emits:["close","success"],setup(n,{emit:e}){const o=je(),t=Fe({name:"",username:"",email:"",password:"",passwordConfirm:""}),i=w(!1),c=w(""),d=G(()=>t.name&&t.username&&t.email&&t.password&&t.passwordConfirm&&t.password===t.passwordConfirm&&t.password.length>=8);return{form:t,loading:i,error:c,isFormValid:d,handleRegister:async()=>{if(!d.value){c.value="Please fill in all fields and ensure passwords match";return}i.value=!0,c.value="";try{const S=await o.register(t.name,t.username,t.email,t.password,t.passwordConfirm);S.success?e("success"):c.value=S.error}catch(S){c.value=S.message||"Registration failed"}finally{i.value=!1}},closeModal:()=>{e("close")}}}},$a={class:"form-group"},eo=["disabled"],to={class:"form-group"},so=["disabled"],ao={class:"form-group"},oo=["disabled"],no={class:"form-group"},io=["disabled"],lo={class:"form-group"},ro=["disabled"],co={key:0,class:"error-message"},uo={class:"modal-buttons"},go=["disabled"],mo=["disabled"];function fo(n,e,o,t,i,c){return m(),f("div",{class:"modal",onClick:e[8]||(e[8]=(...d)=>t.closeModal&&t.closeModal(...d))},[s("div",{class:"modal-content auth-modal",onClick:e[7]||(e[7]=oe(()=>{},["stop"]))},[e[14]||(e[14]=s("h2",null,"Register",-1)),s("form",{onSubmit:e[6]||(e[6]=oe((...d)=>t.handleRegister&&t.handleRegister(...d),["prevent"]))},[s("div",$a,[e[9]||(e[9]=s("label",{for:"name"},"Name:",-1)),A(s("input",{type:"text",id:"name","onUpdate:modelValue":e[0]||(e[0]=d=>t.form.name=d),required:"",disabled:t.loading},null,8,eo),[[B,t.form.name]])]),s("div",to,[e[10]||(e[10]=s("label",{for:"username"},"Username:",-1)),A(s("input",{type:"text",id:"username","onUpdate:modelValue":e[1]||(e[1]=d=>t.form.username=d),required:"",disabled:t.loading},null,8,so),[[B,t.form.username]])]),s("div",ao,[e[11]||(e[11]=s("label",{for:"email"},"Email:",-1)),A(s("input",{type:"email",id:"email","onUpdate:modelValue":e[2]||(e[2]=d=>t.form.email=d),required:"",disabled:t.loading},null,8,oo),[[B,t.form.email]])]),s("div",no,[e[12]||(e[12]=s("label",{for:"password"},"Password:",-1)),A(s("input",{type:"password",id:"password","onUpdate:modelValue":e[3]||(e[3]=d=>t.form.password=d),required:"",minlength:"8",disabled:t.loading},null,8,io),[[B,t.form.password]])]),s("div",lo,[e[13]||(e[13]=s("label",{for:"passwordConfirm"},"Confirm Password:",-1)),A(s("input",{type:"password",id:"passwordConfirm","onUpdate:modelValue":e[4]||(e[4]=d=>t.form.passwordConfirm=d),required:"",minlength:"8",disabled:t.loading},null,8,ro),[[B,t.form.passwordConfirm]])]),t.error?(m(),f("div",co,v(t.error),1)):k("",!0),s("div",uo,[s("button",{type:"submit",disabled:t.loading||!t.isFormValid},v(t.loading?"Registering...":"Register"),9,go),s("button",{type:"button",onClick:e[5]||(e[5]=(...d)=>t.closeModal&&t.closeModal(...d)),disabled:t.loading}," Cancel ",8,mo)])],32)])])}const ho=ee(Xa,[["render",fo],["__scopeId","data-v-eec5201a"]]),vt="http://127.0.0.1:8000/api",po={async getConfig(){try{const n=await fetch(`${vt}/google-books-config`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);return await n.json()}catch(n){throw console.error("Simple Google Books - Config failed:",n),n}},async searchBooks(n,e=10){try{const o=await fetch(`${vt}/google-books/search?q=${encodeURIComponent(n)}&maxResults=${e}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!o.ok)throw new Error(`HTTP ${o.status}: ${o.statusText}`);return await o.json()}catch(o){throw console.error("Simple Google Books - Search failed:",o),o}}},vo=!1,yo=!0,bo="production",wo={production:{apiUrl:"https://teabubble.attrebi.ch",apiBaseUrl:"https://teabubble.attrebi.ch/api",googleBooksUrl:"https://teabubble.attrebi.ch/api/google-books",debug:!1}};function _o(){return wo.production}const Qe=_o();Qe.debug&&console.log("ðŸ”§ Environment Configuration:",{mode:bo,isDevelopment:vo,isProduction:yo,apiUrl:Qe.apiUrl,apiBaseUrl:Qe.apiBaseUrl,googleBooksUrl:Qe.googleBooksUrl});class ko{constructor(){this.baseUrl="https://en.wikipedia.org/w/api.php",this.timeout=1e4,this.maxResults=10}async searchBooks(e,o=10){if(!e||typeof e!="string"||e.trim().length===0)return console.warn("ðŸ“š [Wikipedia] Invalid query provided"),{success:!1,error:"Search query is required",data:[]};try{const t=await this.searchPages(e,o);if(!t.success||t.data.length===0)return{success:!1,error:"No results found",data:[]};const i=await this.getPageDetails(t.data),c=this.filterAndFormatBookResults(i);return console.log("ðŸ“š [Wikipedia] Search completed:",{totalResults:i.length,bookResults:c.length}),{success:!0,data:c,source:"wikipedia"}}catch(t){return console.error("ðŸ“š [Wikipedia] Search failed:",t),{success:!1,error:`Search failed: ${t.message}`,data:[]}}}async searchPages(e,o){var i;const t=new URLSearchParams({action:"query",format:"json",list:"search",srsearch:`${e} book novel`,srnamespace:0,srlimit:o,srprop:"snippet|timestamp",origin:"*"});try{const c=await fetch(`${this.baseUrl}?${t}`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout)});if(!c.ok)throw new Error(`HTTP ${c.status}: ${c.statusText}`);const d=await c.json();if(d.error)throw new Error(d.error.info||"Wikipedia API error");return{success:!0,data:(((i=d.query)==null?void 0:i.search)||[]).map(p=>({pageid:p.pageid,title:p.title,snippet:p.snippet,timestamp:p.timestamp}))}}catch(c){return console.error("ðŸ“š [Wikipedia] Page search failed:",c),{success:!1,error:c.message,data:[]}}}async getPageDetails(e){var i;if(!e||e.length===0)return[];const o=e.map(c=>c.pageid).join("|"),t=new URLSearchParams({action:"query",format:"json",pageids:o,prop:"extracts|pageimages|info",exintro:"true",explaintext:"true",exsectionformat:"plain",piprop:"thumbnail|original",pithumbsize:300,pilimit:1,inprop:"url",origin:"*"});try{const c=await fetch(`${this.baseUrl}?${t}`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout)});if(!c.ok)throw new Error(`HTTP ${c.status}: ${c.statusText}`);const d=await c.json();if(d.error)throw new Error(d.error.info||"Wikipedia API error");const u=((i=d.query)==null?void 0:i.pages)||{};return Object.values(u).map(p=>{var S;return{pageid:p.pageid,title:p.title,extract:p.extract||"",thumbnail:((S=p.thumbnail)==null?void 0:S.source)||null,fullurl:p.fullurl||null,canonicalurl:p.canonicalurl||null}})}catch(c){return console.error("ðŸ“š [Wikipedia] Page details failed:",c),[]}}filterAndFormatBookResults(e){const o=["book","novel","fiction","non-fiction","author","published","publisher","isbn","literature","story","chapter","edition","written by","series","trilogy","saga","collection","anthology"];return e.filter(t=>{const i=(t.extract||"").toLowerCase(),c=(t.title||"").toLowerCase(),d=o.some(S=>i.includes(S)||c.includes(S)),p=["book","novel","story","tale","chronicles","saga","trilogy"].some(S=>c.includes(S));return d||p}).map(t=>{const i=t.extract||"",c=t.title||"",d=i.match(/written by[^,.\n]*?([A-Z][^,.\n]*?[A-Z][^,.\n]*?)(?:\s|\.|,|$)/i),u=i.match(/(\d{4})/),p=i.match(/(?:published by|publisher)\s+([^,.\n]+)/i);let S="";if(d&&(S=d[1].trim().replace(/^(British|American|German|French|Spanish|Italian)\s+(?:author|writer|novelist)?\s*/i,""),S.includes("author")||S.includes("writer"))){const C=S.match(/([A-Z][^,.\n]*?[A-Z][^,.\n]*?)(?:\s|\.|,|$)/);S=C?C[1].trim():S}if(!S){const T=i.match(/(?:by|author|written by)\s+([A-Z][^,.\n]*?[A-Z][^,.\n]*?)(?:\s|\.|,|$)/i);T&&(S=T[1].trim().replace(/^(British|American|German|French|Spanish|Italian)\s+(?:author|writer|novelist)?\s*/i,""))}return{id:`wikipedia_${t.pageid}`,title:c,author:S,description:i.substring(0,300)+(i.length>300?"...":""),publishedDate:u?u[1]:"",publisher:p?p[1].trim():"",imageUrl:t.thumbnail||null,link:t.fullurl||t.canonicalurl||"",apiSource:"wikipedia",snippet:i.substring(0,150)+(i.length>150?"...":""),categories:this.extractCategories(i)}}).slice(0,this.maxResults)}extractCategories(e){const o=[],t=e.toLowerCase();return t.includes("fiction")&&o.push("Fiction"),(t.includes("non-fiction")||t.includes("nonfiction"))&&o.push("Non-Fiction"),t.includes("novel")&&o.push("Novel"),t.includes("biography")&&o.push("Biography"),t.includes("history")&&o.push("History"),t.includes("science")&&o.push("Science"),t.includes("philosophy")&&o.push("Philosophy"),t.includes("poetry")&&o.push("Poetry"),t.includes("drama")&&o.push("Drama"),t.includes("mystery")&&o.push("Mystery"),t.includes("romance")&&o.push("Romance"),t.includes("fantasy")&&o.push("Fantasy"),(t.includes("science fiction")||t.includes("sci-fi"))&&o.push("Science Fiction"),t.includes("thriller")&&o.push("Thriller"),t.includes("horror")&&o.push("Horror"),o}async getBookById(e){var o,t;try{const i=new URLSearchParams({action:"query",format:"json",pageids:e,prop:"extracts|pageimages|info",exintro:"true",explaintext:"true",piprop:"thumbnail",pithumbsize:300,inprop:"url",origin:"*"}),c=await fetch(`${this.baseUrl}?${i}`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout)});if(!c.ok)throw new Error(`HTTP ${c.status}: ${c.statusText}`);const d=await c.json(),u=Object.values(((o=d.query)==null?void 0:o.pages)||{})[0];if(!u)throw new Error("Page not found");return{success:!0,data:{id:`wikipedia_${u.pageid}`,title:u.title,description:u.extract||"",imageUrl:((t=u.thumbnail)==null?void 0:t.source)||null,link:u.fullurl||u.canonicalurl||"",apiSource:"wikipedia"}}}catch(i){return console.error("ðŸ“š [Wikipedia] Get book by ID failed:",i),{success:!1,error:i.message,data:null}}}}const So=new ko;class xo{constructor(){this.wikipediaService=So,this.googleBooksService=po}getUserPreferences(){try{const e=localStorage.getItem("profileData");if(e){const o=JSON.parse(e);return{booksApiProvider:o.booksApiProvider||"wikipedia",enableGoogleBooksFallback:o.enableGoogleBooksFallback!==!1}}}catch(e){console.warn("Failed to load user preferences:",e)}return{booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}}async searchBooks(e,o=10){const t=this.getUserPreferences();if(!e||typeof e!="string"||e.trim().length===0)return{success:!1,error:"Search query is required",data:[]};try{let i=[],c="",d=!1;switch(t.booksApiProvider){case"wikipedia":i=await this.searchWithWikipediaFirst(e,o,t),c="wikipedia";break;case"google_books":i=await this.searchWithGoogleBooksFirst(e,o,t),c="google_books";break;case"both":i=await this.searchWithBothApis(e,o,t),c="both";break;default:i=await this.searchWithWikipediaFirst(e,o,t),c="wikipedia"}return{success:!0,data:i,source:c,fallbackUsed:d}}catch(i){return console.error("ðŸ“š [UnifiedBooks] Search failed:",i),{success:!1,error:`Search failed: ${i.message}`,data:[]}}}async searchWithWikipediaFirst(e,o,t){const i=await this.wikipediaService.searchBooks(e,o);if(i.success&&i.data.length>0)return i.data;if(t.enableGoogleBooksFallback){const c=await this.googleBooksService.searchBooks(e,o);if(c.success&&c.data.length>0)return c.data}return[]}async searchWithGoogleBooksFirst(e,o,t){const i=await this.googleBooksService.searchBooks(e,o);if(i.success&&i.data.length>0)return i.data;if(t.enableGoogleBooksFallback){const c=await this.wikipediaService.searchBooks(e,o);if(c.success&&c.data.length>0)return c.data}return[]}async searchWithBothApis(e,o,t){const[i,c]=await Promise.allSettled([this.wikipediaService.searchBooks(e,Math.ceil(o/2)),this.googleBooksService.searchBooks(e,Math.ceil(o/2))]);let d=[];return i.status==="fulfilled"&&i.value.success&&(d=d.concat(i.value.data)),c.status==="fulfilled"&&c.value.success&&(d=d.concat(c.value.data)),d=this.removeDuplicateResults(d),d=d.slice(0,o),d}removeDuplicateResults(e){const o=new Set,t=[];for(const i of e){const c=i.title.toLowerCase().replace(/[^\w\s]/g,"").trim();o.has(c)||(o.add(c),t.push(i))}return t}async getBookById(e){if(e.startsWith("wikipedia_")){const o=e.replace("wikipedia_","");return await this.wikipediaService.getBookById(o)}else return await this.googleBooksService.getBookById(e)}getApiStatus(){const e=this.getUserPreferences();return{primaryProvider:e.booksApiProvider,fallbackEnabled:e.enableGoogleBooksFallback,availableProviders:["wikipedia","google_books"],wikipediaAvailable:!0,googleBooksAvailable:!0}}}const nt=new xo,Co={name:"BooksApiControlPanel",props:{expanded:{type:Boolean,default:!1}},emits:["preferences-changed"],setup(n,{emit:e}){const o=w(n.expanded),t=w(!1),i=w(null),c=w("checking"),d=Fe({booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}),u=()=>{o.value=!o.value},p=()=>{try{const I=localStorage.getItem("profileData");if(I){const g=JSON.parse(I);d.booksApiProvider=g.booksApiProvider||"wikipedia",d.enableGoogleBooksFallback=g.enableGoogleBooksFallback!==!1}}catch(I){console.warn("Failed to load preferences:",I)}},S=()=>{try{const I=localStorage.getItem("profileData"),g=I?JSON.parse(I):{};g.booksApiProvider=d.booksApiProvider,g.enableGoogleBooksFallback=d.enableGoogleBooksFallback,localStorage.setItem("profileData",JSON.stringify(g)),e("preferences-changed",{...d})}catch(I){console.error("Failed to save preferences:",I)}},T=async()=>{t.value=!0,i.value=null;try{const I=await nt.searchBooks("Harry Potter",3);I.success&&I.data.length>0?i.value={success:!0,message:`âœ… Found ${I.data.length} results using ${I.source}`}:i.value={success:!1,message:`âŒ No results found: ${I.error||"Unknown error"}`}}catch(I){i.value={success:!1,message:`âŒ Test failed: ${I.message}`}}finally{t.value=!1}},C=async()=>{try{const I=await nt.getApiStatus();c.value=I.googleBooksAvailable?"available":"unavailable"}catch{c.value="unavailable"}};return it(()=>{p(),C()}),{isExpanded:o,localPreferences:d,testing:t,testResult:i,googleBooksStatus:c,toggleExpanded:u,updatePreferences:S,testSearch:T}}},Io={class:"books-api-control-panel"},Do={class:"control-header"},Ao={key:0,class:"control-content"},To={class:"form-group"},Mo={class:"form-group"},Ro={class:"checkbox-container"},Eo={class:"api-status"},Uo={class:"status-item"},Lo={class:"search-preview"},Bo=["disabled"];function Po(n,e,o,t,i,c){return m(),f("div",Io,[s("div",Do,[e[6]||(e[6]=s("h4",null,"ðŸ“š Books API Settings",-1)),s("button",{class:H(["toggle-btn",{expanded:t.isExpanded}]),onClick:e[0]||(e[0]=(...d)=>t.toggleExpanded&&t.toggleExpanded(...d))},v(t.isExpanded?"â–¼":"â–¶"),3)]),t.isExpanded?(m(),f("div",Ao,[s("div",To,[e[8]||(e[8]=s("label",{for:"apiProvider"},"Primary API Provider:",-1)),A(s("select",{id:"apiProvider","onUpdate:modelValue":e[1]||(e[1]=d=>t.localPreferences.booksApiProvider=d),onChange:e[2]||(e[2]=(...d)=>t.updatePreferences&&t.updatePreferences(...d))},[...e[7]||(e[7]=[s("option",{value:"wikipedia"},"Wikipedia (Recommended)",-1),s("option",{value:"google_books"},"Google Books",-1),s("option",{value:"both"},"Both APIs",-1)])],544),[[be,t.localPreferences.booksApiProvider]]),e[9]||(e[9]=s("div",{class:"field-hint"}," Choose your primary source for book information ",-1))]),s("div",Mo,[s("div",Ro,[A(s("input",{type:"checkbox",id:"enableFallback","onUpdate:modelValue":e[3]||(e[3]=d=>t.localPreferences.enableGoogleBooksFallback=d),onChange:e[4]||(e[4]=(...d)=>t.updatePreferences&&t.updatePreferences(...d))},null,544),[[yt,t.localPreferences.enableGoogleBooksFallback]]),e[10]||(e[10]=s("label",{for:"enableFallback",class:"checkbox-label"}," Enable Google Books Fallback ",-1))]),e[11]||(e[11]=s("div",{class:"field-hint"}," Use Google Books when primary API fails ",-1))]),s("div",Eo,[e[13]||(e[13]=s("div",{class:"status-item"},[s("span",{class:"status-label"},"Wikipedia:"),s("span",{class:"status-value available"},"âœ… Available")],-1)),s("div",Uo,[e[12]||(e[12]=s("span",{class:"status-label"},"Google Books:",-1)),s("span",{class:H(["status-value",t.googleBooksStatus])},v(t.googleBooksStatus==="available"?"âœ… Available":"âš ï¸ Check API Key"),3)])]),s("div",Lo,[s("button",{class:"test-search-btn",onClick:e[5]||(e[5]=(...d)=>t.testSearch&&t.testSearch(...d)),disabled:t.testing},v(t.testing?"Testing...":"Test Search"),9,Bo),t.testResult?(m(),f("div",{key:0,class:H(["test-result",t.testResult.success?"success":"error"])},v(t.testResult.message),3)):k("",!0)])])):k("",!0)])}const Fo=ee(Co,[["render",Po],["__scopeId","data-v-09652cba"]]),No={name:"EditModal",components:{BooksApiControlPanel:Fo},props:{item:{type:Object,default:null},currentCategory:{type:String,default:"watchlist"}},emits:["close","save","delete"],setup(n,{emit:e}){const o=Ke(),t=w(!1),i=w(""),c=w([]),d=w(null),u=w(null),p=w(""),S=w(!1),T=w(""),C=w(!1),I=w(!1),g=Fe({category:"watchlist",title:"",release:"",apiRating:"",personalRating:"",count:"",platforms:"",genre:"",description:"",link:"",extraLink:"",path:"",discovered:"",spielzeit:"",isAiring:!1,nextSeason:"",nextSeasonRelease:"",imageUrl:"",watchlistType:"",watchlistReleaseDate:"",watchlistNumber:"",imageCleared:!1,tmdbId:"",nextSeasonName:"",lastAirDate:"",totalSeasons:"",totalEpisodes:"",seriesStatus:"",networks:"",createdBy:""}),Y=G(()=>!!n.item),ne=G(()=>g.category==="game"),U=G(()=>g.category==="series"),ie=G(()=>g.category==="watchlist");Ee(()=>n.item,l=>{if(l){if(l.watchlist_type!==void 0?g.watchlistType=l.watchlist_type||"":l.watchlistType!==void 0?g.watchlistType=l.watchlistType||"":g.watchlistType="",l.watchlist_release_date!==void 0){const r=l.watchlist_release_date;r instanceof Date?g.watchlistReleaseDate=r.toISOString().split("T")[0]:typeof r=="string"&&r.includes("T")?g.watchlistReleaseDate=r.split("T")[0]:g.watchlistReleaseDate=r||""}else l.watchlistReleaseDate!==void 0?g.watchlistReleaseDate=l.watchlistReleaseDate||"":g.watchlistReleaseDate="";if(l.watchlist_number!==void 0?g.watchlistNumber=l.watchlist_number||"":l.watchlistNumber!==void 0?g.watchlistNumber=l.watchlistNumber||"":g.watchlistNumber="",Object.keys(g).forEach(r=>{r!=="watchlistType"&&r!=="watchlistReleaseDate"&&r!=="watchlistNumber"&&(g[r]=l[r]||"")}),l.is_airing!==void 0&&(console.log("DEBUG: Loading isAiring from backend:",{is_airing:l.is_airing,type:typeof l.is_airing,form_isAiring_before:g.isAiring}),g.isAiring=l.is_airing,console.log("DEBUG: form.isAiring after setting:",g.isAiring)),l.tmdb_id!==void 0&&(g.tmdbId=l.tmdb_id),l.next_season_name!==void 0&&(g.nextSeasonName=l.next_season_name),l.last_air_date!==void 0&&(g.lastAirDate=l.last_air_date),l.total_seasons!==void 0&&(g.totalSeasons=l.total_seasons),l.total_episodes!==void 0&&(g.totalEpisodes=l.total_episodes),l.series_status!==void 0&&(g.seriesStatus=l.series_status),l.networks!==void 0&&(g.networks=l.networks),l.created_by!==void 0&&(g.createdBy=l.created_by),l.next_season!==void 0&&(g.nextSeason=l.next_season),l.next_season_release!==void 0){const r=l.next_season_release;r instanceof Date?g.nextSeasonRelease=r.toISOString().split("T")[0]:typeof r=="string"&&r.includes("T")?g.nextSeasonRelease=r.split("T")[0]:g.nextSeasonRelease=r||""}l.api_rating!==void 0&&(g.apiRating=l.api_rating),l.personal_rating!==void 0&&(g.personalRating=l.personal_rating),l.description!==void 0&&(g.description=l.description),l.image_url!==void 0&&(g.imageUrl=l.image_url),l.path!==void 0&&(g.path=l.path),l.extra_link!==void 0&&(g.extraLink=l.extra_link),l.rating!==void 0&&!g.personalRating&&(g.personalRating=l.rating)}else Object.keys(g).forEach(r=>{r==="category"?g[r]=n.currentCategory||"watchlist":r==="release"?g[r]=new Date().toISOString().split("T")[0]:r==="watchlistType"?g[r]=n.currentCategory==="watchlist"?"series":"":g[r]=""})},{immediate:!0}),Ee(()=>n.currentCategory,l=>{!n.item&&l&&(g.category=l)});const K=async()=>{var l,r,y;if(!g.title){i.value="Title is required";return}if(g.category==="watchlist"&&!g.watchlistType){i.value="Please select a type for watchlist items";return}if(g.category==="watchlist"&&!g.release){i.value="Release date is required for watchlist items";return}t.value=!0,i.value="";try{const a={...g};console.log("ðŸ” ULTRA DEBUG - Form data before processing:",{watchlistReleaseDate:g.watchlistReleaseDate,nextSeasonRelease:g.nextSeasonRelease,watchlistNumber:g.watchlistNumber,extraLink:g.extraLink,type_watchlist:typeof g.watchlistReleaseDate,type_next:typeof g.nextSeasonRelease,type_watchlist_number:typeof g.watchlistNumber,type_extraLink:typeof g.extraLink,is_empty_watchlist:g.watchlistReleaseDate==="",is_empty_next:g.nextSeasonRelease==="",is_empty_watchlist_number:g.watchlistNumber==="",is_empty_extraLink:g.extraLink==="",is_null_watchlist:g.watchlistReleaseDate===null,is_null_next:g.nextSeasonRelease===null,is_null_watchlist_number:g.watchlistNumber===null,is_null_extraLink:g.extraLink===null,is_undefined_watchlist:g.watchlistReleaseDate===void 0,is_undefined_next:g.nextSeasonRelease===void 0,is_undefined_watchlist_number:g.watchlistNumber===void 0,is_undefined_extraLink:g.extraLink===void 0,ALL_FORM_DATA:g}),Object.keys(a).forEach(_=>{a[_]===""&&_!=="watchlistType"&&_!=="imageUrl"&&_!=="path"&&_!=="extraLink"&&_!=="watchlistReleaseDate"&&_!=="nextSeasonRelease"&&_!=="lastAirDate"&&_!=="watchlistNumber"&&(a[_]=null)}),a.extraLink===""&&(a.extraLink=null),console.log("ðŸ” ULTRA DEBUG - Form data after null conversion:",{watchlistReleaseDate:a.watchlistReleaseDate,nextSeasonRelease:a.nextSeasonRelease,watchlistNumber:a.watchlistNumber,type_watchlist:typeof a.watchlistReleaseDate,type_next:typeof a.nextSeasonRelease,type_watchlist_number:typeof a.watchlistNumber,is_empty_watchlist:a.watchlistReleaseDate==="",is_empty_next:a.nextSeasonRelease==="",is_empty_watchlist_number:a.watchlistNumber==="",is_null_watchlist:a.watchlistReleaseDate===null,is_null_next:a.nextSeasonRelease===null,is_null_watchlist_number:a.watchlistNumber===null,is_undefined_watchlist:a.watchlistReleaseDate===void 0,is_undefined_next:a.nextSeasonRelease===void 0,is_undefined_watchlist_number:a.watchlistNumber===void 0,ALL_ITEM_DATA:a}),p.value?(a.path=p.value,a.imageUrl=p.value):a.imageUrl&&a.imageUrl.trim()?a.path=a.imageUrl:Y.value&&n.item?n.item.image_url?(a.imageUrl=n.item.image_url,a.path=n.item.path||n.item.image_url):n.item.path&&(a.path=n.item.path,a.imageUrl=n.item.path):(a.imageUrl=null,a.path=null),a.apiRating!==void 0&&a.apiRating!==null&&a.apiRating!==""&&(a.apiRating=parseFloat(a.apiRating)),a.personalRating!==void 0&&a.personalRating!==null&&a.personalRating!==""&&(a.personalRating=parseFloat(a.personalRating)),a.count!==void 0&&a.count!==null&&a.count!==""&&(a.count=parseInt(a.count)),a.spielzeit!==void 0&&a.spielzeit!==null&&a.spielzeit!==""&&(a.spielzeit=parseInt(a.spielzeit)),a.nextSeason!==void 0&&a.nextSeason!==null&&a.nextSeason!==""&&(a.nextSeason=parseInt(a.nextSeason)),a.watchlistType!==void 0&&(a.watchlist_type=a.watchlistType||null,delete a.watchlistType),a.watchlistReleaseDate!==void 0&&(console.log("ðŸ” ULTRA DEBUG - watchlistReleaseDate mapping:",{original:a.watchlistReleaseDate,type:typeof a.watchlistReleaseDate,is_empty:a.watchlistReleaseDate==="",is_null:a.watchlistReleaseDate===null,is_undefined:a.watchlistReleaseDate===void 0,mapped:a.watchlistReleaseDate===""?null:a.watchlistReleaseDate,FINAL_VALUE:a.watchlistReleaseDate===""?null:a.watchlistReleaseDate,BEFORE_DELETE:a.watchlistReleaseDate}),a.watchlist_release_date=a.watchlistReleaseDate===""?null:a.watchlistReleaseDate,console.log("ðŸ” ULTRA DEBUG - watchlistReleaseDate after mapping:",{watchlist_release_date:a.watchlist_release_date,type:typeof a.watchlist_release_date,is_null:a.watchlist_release_date===null,is_undefined:a.watchlist_release_date===void 0}),delete a.watchlistReleaseDate),a.watchlistNumber!==void 0&&(console.log("ðŸ” ULTRA DEBUG - watchlistNumber mapping:",{original:a.watchlistNumber,type:typeof a.watchlistNumber,is_empty:a.watchlistNumber==="",is_null:a.watchlistNumber===null,is_undefined:a.watchlistNumber===void 0,mapped:a.watchlistNumber===""?null:a.watchlistNumber,FINAL_VALUE:a.watchlistNumber===""?null:a.watchlistNumber,BEFORE_DELETE:a.watchlistNumber}),a.watchlist_number=a.watchlistNumber===""?null:a.watchlistNumber,console.log("ðŸ” ULTRA DEBUG - watchlistNumber after mapping:",{watchlist_number:a.watchlist_number,type:typeof a.watchlist_number,is_null:a.watchlist_number===null,is_undefined:a.watchlist_number===void 0}),delete a.watchlistNumber),a.isAiring!==void 0&&(a.is_airing=a.isAiring,delete a.isAiring),a.tmdbId!==void 0&&(a.tmdb_id=a.tmdbId,delete a.tmdbId),a.nextSeasonName!==void 0&&(a.next_season_name=a.nextSeasonName,delete a.nextSeasonName),a.lastAirDate!==void 0&&(a.last_air_date=a.lastAirDate,delete a.lastAirDate),a.totalSeasons!==void 0&&(a.total_seasons=a.totalSeasons,delete a.totalSeasons),a.totalEpisodes!==void 0&&(a.total_episodes=a.totalEpisodes,delete a.totalEpisodes),a.seriesStatus!==void 0&&(a.series_status=a.seriesStatus,delete a.seriesStatus),a.networks!==void 0&&(a.networks=a.networks),a.createdBy!==void 0&&(a.created_by=a.createdBy,delete a.createdBy),a.nextSeason!==void 0&&(a.next_season=a.nextSeason||null,delete a.nextSeason),a.nextSeasonRelease!==void 0&&(console.log("ðŸ” ULTRA DEBUG - nextSeasonRelease mapping:",{original:a.nextSeasonRelease,type:typeof a.nextSeasonRelease,is_empty:a.nextSeasonRelease==="",is_null:a.nextSeasonRelease===null,is_undefined:a.nextSeasonRelease===void 0,mapped:a.nextSeasonRelease===""?null:a.nextSeasonRelease,FINAL_VALUE:a.nextSeasonRelease===""?null:a.nextSeasonRelease,BEFORE_DELETE:a.nextSeasonRelease}),a.next_season_release=a.nextSeasonRelease===""?null:a.nextSeasonRelease,console.log("ðŸ” ULTRA DEBUG - nextSeasonRelease after mapping:",{next_season_release:a.next_season_release,type:typeof a.next_season_release,is_null:a.next_season_release===null,is_undefined:a.next_season_release===void 0}),delete a.nextSeasonRelease),a.personalRating!==void 0?(a.rating=a.personalRating,delete a.personalRating):a.apiRating!==void 0&&(a.rating=a.apiRating,delete a.apiRating),a.imageUrl&&(a.image_url=a.imageUrl,delete a.imageUrl),a.extraLink!==void 0&&(console.log("ðŸ” ULTRA DEBUG - extraLink processing:",{original_extraLink:a.extraLink,type:typeof a.extraLink,is_empty:a.extraLink==="",is_null:a.extraLink===null,is_undefined:a.extraLink===void 0,mapped_to:"extra_link"}),a.extraLink&&a.extraLink.trim()!==""?a.extra_link=a.extraLink:a.extra_link=null,delete a.extraLink,console.log("ðŸ” ULTRA DEBUG - extraLink after mapping:",{extra_link:a.extra_link,type:typeof a.extra_link,is_null:a.extra_link===null,is_undefined:a.extra_link===void 0})),Y.value&&n.item?(console.log("ðŸ” ULTRA DEBUG - Final data being sent to store:",{id:n.item.id,watchlist_release_date:a.watchlist_release_date,next_season_release:a.next_season_release,watchlist_number:a.watchlist_number,extra_link:a.extra_link,is_airing:a.is_airing,watchlist_type:a.watchlist_type,type_watchlist_release:typeof a.watchlist_release_date,type_next_season:typeof a.next_season_release,type_watchlist_number:typeof a.watchlist_number,type_extra_link:typeof a.extra_link,is_null_watchlist:a.watchlist_release_date===null,is_null_next:a.next_season_release===null,is_null_watchlist_number:a.watchlist_number===null,is_null_extra_link:a.extra_link===null,is_undefined_watchlist:a.watchlist_release_date===void 0,is_undefined_next:a.next_season_release===void 0,is_undefined_watchlist_number:a.watchlist_number===void 0,is_undefined_extra_link:a.extra_link===void 0,FULL_ITEM_DATA:a}),await o.updateMediaItem(n.item.id,a)):await o.addMediaItem(a),de()}catch(a){a.isDuplicate||((l=a.response)==null?void 0:l.status)===409&&((y=(r=a.response)==null?void 0:r.data)!=null&&y.duplicate)?i.value="Ein Eintrag mit diesem Titel und dieser Kategorie existiert bereits. Bitte wÃ¤hlen Sie einen anderen Titel oder bearbeiten Sie den bestehenden Eintrag.":i.value=a.message||"Failed to save item"}finally{t.value=!1}},de=()=>{i.value="",e("close")},ue=()=>{document.body.style.overflow="hidden"},h=()=>{document.body.style.overflow=""};it(()=>{ue()}),bt(()=>{h()});const O=()=>{e("delete",n.item),de()},Ae=async()=>{if(p.value){c.value=[];return}if(d.value&&clearTimeout(d.value),!g.title||g.title.length<3){c.value=[];return}d.value=setTimeout(async()=>{try{const l=g.category==="watchlist"?g.watchlistType:g.category;if(g.category==="watchlist"&&!g.watchlistType){c.value=[];return}let r=[],y=[];if(l==="buecher"){const a=await nt.searchBooks(g.title,10);a.success&&a.data&&(y=a.data.map(_=>({title:_.title,release:_.publishedDate?we(_.publishedDate):"",genre:_.categories?_.categories.join(", "):"",platforms:_.author||"",link:_.link||"",imageUrl:_.imageUrl||"",rating:"",apiSource:_.apiSource||a.source,id:_.id,author:_.author,description:_.description,publisher:_.publisher,isbn10:_.isbn10,isbn13:_.isbn13})))}else r=await le.searchApi(g.title,l,10),r&&r.length>0&&(y=r.map(a=>({title:a.title,release:a.release,genre:a.genre||"",description:a.overview||"",platforms:a.platforms||"",link:a.link||"",imageUrl:a.image||"",rating:a.rating||"",apiSource:a.api_source||"",id:a.id||""})));y.length>0?c.value=y:c.value=[{title:`"${g.title}" - Keine Ergebnisse gefunden`,release:"",genre:"Bitte manuell ausfÃ¼llen",isPlaceholder:!0}]}catch{c.value=[{title:`"${g.title}" - API nicht verfÃ¼gbar`,release:"",genre:"Bitte manuell ausfÃ¼llen",isPlaceholder:!0}]}},500)},Te=async l=>{if(l.isPlaceholder){c.value=[];return}if(g.title=l.title,l.release&&(g.release=l.release),l.platforms&&(g.platforms=l.platforms),l.genre&&(g.genre=l.genre),l.description&&(g.description=l.description),l.link&&(g.link=l.link),l.rating&&(g.apiRating=l.rating),(l.apiSource==="google_books"||l.apiSource==="wikipedia")&&(l.author&&(g.platforms=l.author),l.publisher)){const r=g.link||"";g.link=r||`Publisher: ${l.publisher}`}l.imageUrl?(g.imageUrl=l.imageUrl,g.path=l.imageUrl):(g.imageUrl="",g.path=""),g.category==="series"&&(console.log("ðŸ” Auto-fetching TMDB info for series:",g.title),await De()),c.value=[]},ce=l=>l?new Date(l).toLocaleDateString():"",we=l=>{if(!l)return"";let r;if(typeof l=="string"){if(/^\d{4}$/.test(l))return`${l}-01-01`;if(/^\d{4}-\d{2}$/.test(l))return`${l}-01`;if(/^\d{4}-\d{2}-\d{2}$/.test(l))return l;r=new Date(l)}else r=new Date(l);return isNaN(r.getTime())?"":r.toISOString().split("T")[0]},_e=l=>l&&(l.startsWith("http://")?l.replace("http://","https://"):l),ge=()=>{var _;if(!g.release)return"";const l=new Date(g.release),r=new Date;r.setHours(0,0,0,0),l.setHours(0,0,0,0);const y=l.getTime()-r.getTime(),a=Math.ceil(y/(1e3*3600*24));if(a>0)return a===1?"Tomorrow!":a<=7?`${a} days left`:a<=30?`${a} days left`:`${Math.ceil(a/30)} months left`;if(a===0)return"Released today!";{const D=((_=g.watchlistType)==null?void 0:_.toLowerCase())||"media";return D==="game"?"Unplayed yet":D==="series"||D==="movie"?"Unwatched yet":"Unconsumed yet"}},z=()=>{var l;(l=u.value)==null||l.click()},Z=async l=>{const r=l.target.files[0];if(r){if(!r.type.startsWith("image/")){i.value="Please select a valid image file";return}if(r.size>10*1024*1024){i.value="Image file too large. Maximum size is 10MB";return}t.value=!0,i.value="";try{const y=g.title.replace(/[^a-zA-Z0-9\s\-_\.]/g,"").trim()||"item",a=Date.now(),_=r.name.split(".").pop()||"jpg",D=`images_downloads/uploads/${y}_${a}.${_}`,V=await le.uploadImage(r,D);V.success?(p.value=V.saved,g.path=V.saved,g.imageUrl=V.saved):i.value=V.error||"Failed to upload image"}catch(y){i.value=y.message||"Failed to upload image"}finally{t.value=!1}}},j=()=>p.value?p.value.startsWith("storage/")?`/${p.value}`:`/${p.value}`:g.imageUrl?g.imageUrl.startsWith("http")?g.imageUrl:g.imageUrl.startsWith("storage/")?`/${g.imageUrl}`:`/${g.imageUrl}`:"",he=l=>{l.target.style.display="none",i.value="Failed to load image: "+l.target.src},pe=l=>{i.value&&i.value.includes("Failed to load image")&&(i.value="")},ke=l=>{},Se=l=>{},xe=()=>{g.imageUrl="",g.path="",p.value="",u.value&&(u.value.value="")},me=()=>{p.value="",g.imageUrl===p.value&&(g.imageUrl=""),g.path===p.value&&(g.path=""),u.value&&(u.value.value="")},Ce=G(()=>!!(g.imageUrl||p.value)),fe=l=>{c.value=[]},Ie=()=>{I.value=!I.value},De=async()=>{if(!g.title||g.title.trim()===""){T.value="Please enter a series title first";return}console.log("ðŸ” Starting TMDB API check for:",g.title),S.value=!0,T.value="",C.value=!1;try{console.log("ðŸ“¡ Calling checkSeriesInfo API...");const l=await le.checkSeriesInfo(g.title);if(console.log("ðŸ“¡ API Response:",l),l.success&&l.data){const r=l.data;console.log("ðŸ“Š Series Data received:",r),r.tmdb_id&&(g.tmdbId=r.tmdb_id,console.log("âœ… Set tmdbId:",r.tmdb_id)),r.is_airing!==void 0&&(g.isAiring=r.is_airing,console.log("âœ… Set isAiring:",r.is_airing)),r.next_episode&&(g.nextSeason=r.next_episode.season_number,g.nextSeasonRelease=r.next_episode.air_date,g.nextSeasonName=r.next_episode.name,console.log("âœ… Set next season info:",{season:r.next_episode.season_number,release:r.next_episode.air_date,name:r.next_episode.name})),r.last_air_date&&(g.lastAirDate=r.last_air_date,console.log("âœ… Set lastAirDate:",r.last_air_date)),r.number_of_seasons&&(g.totalSeasons=r.number_of_seasons,console.log("âœ… Set totalSeasons:",r.number_of_seasons)),r.number_of_episodes&&(g.totalEpisodes=r.number_of_episodes,console.log("âœ… Set totalEpisodes:",r.number_of_episodes)),r.status&&(g.seriesStatus=r.status,console.log("âœ… Set seriesStatus:",r.status)),r.networks&&r.networks.length>0&&(g.networks=r.networks.join(", "),console.log("âœ… Set networks:",r.networks.join(", "))),r.created_by&&r.created_by.length>0&&(g.createdBy=r.created_by.join(", "),console.log("âœ… Set createdBy:",r.created_by.join(", "))),r.overview&&(g.description=r.overview,console.log("âœ… Set description")),r.genres&&r.genres.length>0&&(g.genre=r.genres.join(", "),console.log("âœ… Set genre:",r.genres.join(", "))),r.poster_path&&(g.imageUrl=r.poster_path,g.path=r.poster_path,console.log("âœ… Set imageUrl:",r.poster_path)),console.log("ðŸ“ Final form state:",g),C.value=!0,setTimeout(()=>{C.value=!1},3e3)}else console.error("âŒ API returned error:",l.error),T.value=l.error||"Failed to fetch series information"}catch(l){console.error("âŒ TMDB API check failed:",l),T.value=l.message||"Failed to check series information"}finally{S.value=!1}};return{form:g,loading:t,error:i,apiResults:c,isEditing:Y,isGame:ne,isSeries:U,isWatchlist:ie,imageUploadRef:u,uploadedImagePath:p,apiLoading:S,apiError:T,apiSuccess:C,seriesDetailsExpanded:I,handleSave:K,closeModal:de,deleteItem:O,searchApi:Ae,selectApiResult:Te,formatDate:ce,formatDateForInput:we,ensureHttpsUrl:_e,getReleasePreview:ge,triggerImageUpload:z,handleImageUpload:Z,getImagePreviewUrl:j,handleImageError:he,handleImageLoad:pe,handleImageLoadStart:ke,handleImageLoadEnd:Se,clearImage:xe,removeUploadedImage:me,shouldShowImagePreview:Ce,handlePreferencesChanged:fe,toggleSeriesDetails:Ie,checkSeriesAPI:De}}},Go={class:"form-area category-area"},Wo={class:"form-group"},Oo={class:"form-area title-area"},Vo={class:"form-group"},jo={class:"search-container"},zo=["placeholder","disabled"],Yo={key:0,class:"search-results"},Ho=["onClick"],qo={class:"result-thumbnail"},Jo=["src","alt"],Qo={key:1,class:"no-image"},Ko={class:"result-content"},Zo={class:"result-title"},Xo={class:"result-meta"},$o={key:0},en={key:1},tn={key:2,class:"rating"},sn={class:"form-area details-area"},an={class:"form-group"},on={for:"release"},nn={key:0,class:"required"},ln=["required"],rn={class:"form-group"},dn={key:0,class:"form-group"},cn={class:"form-group"},un={class:"form-area button-area"},gn={class:"control-buttons"},mn=["disabled"],fn=["disabled"],hn=["disabled"],pn={class:"main-form-area"},vn={class:"form-columns"},yn={class:"form-column-left"},bn={class:"form-group"},wn={class:"form-group"},_n={class:"form-group"},kn={class:"form-group"},Sn={class:"form-column-right"},xn={class:"form-group"},Cn={class:"form-group"},In={class:"form-group"},Dn={class:"image-input-group"},An=["disabled"],Tn={key:0,class:"upload-success"},Mn={key:0,class:"watchlist-fields"},Rn={class:"form-group"},En={key:0,class:"field-error"},Un={class:"form-group"},Ln={class:"form-group"},Bn={class:"form-group"},Pn={key:1,class:"game-fields"},Fn={class:"form-group"},Nn={class:"collapsible-sections"},Gn={key:0,class:"collapsible-section"},Wn={key:0,class:"collapsible-content"},On={class:"form-row"},Vn={class:"form-group"},jn={class:"form-group"},zn={class:"form-row"},Yn={class:"form-group"},Hn={class:"form-group"},qn={class:"form-row"},Jn={class:"form-group"},Qn={class:"form-group"},Kn={class:"form-row"},Zn={class:"form-group full-width"},Xn={class:"form-row"},$n={class:"form-group full-width"},ei={key:0,class:"form-row"},ti={class:"form-group"},si={class:"form-row"},ai={class:"form-group full-width"},oi={class:"api-check-container"},ni=["disabled"],ii={key:0},li={key:1},ri={key:0,class:"api-error"},di={key:1,class:"api-success"},ci={key:3,class:"error-message"};function ui(n,e,o,t,i,c){const d=ae("BooksApiControlPanel");return m(),f("div",{class:"modal",onClick:e[36]||(e[36]=(...u)=>t.closeModal&&t.closeModal(...u))},[s("div",{class:"modal-content",onClick:e[35]||(e[35]=oe(()=>{},["stop"]))},[s("h2",null,v(t.isEditing?"Edit Item":"Add Item"),1),s("form",{onSubmit:e[34]||(e[34]=oe((...u)=>t.handleSave&&t.handleSave(...u),["prevent"]))},[s("div",Go,[s("div",Wo,[e[38]||(e[38]=s("label",{for:"category"},"Category:",-1)),A(s("select",{id:"category","onUpdate:modelValue":e[0]||(e[0]=u=>t.form.category=u),required:""},[...e[37]||(e[37]=[Oe('<option value="watchlist" data-v-5a61e078>Watchlist</option><option value="game" data-v-5a61e078>Game</option><option value="series" data-v-5a61e078>Series</option><option value="movie" data-v-5a61e078>Movie</option><option value="buecher" data-v-5a61e078>BÃ¼cher</option>',5)])],512),[[be,t.form.category]])])]),s("div",Oo,[s("div",Vo,[e[39]||(e[39]=s("label",{for:"title"},"Title:",-1)),s("div",jo,[A(s("input",{type:"text",id:"title","onUpdate:modelValue":e[1]||(e[1]=u=>t.form.title=u),onInput:e[2]||(e[2]=(...u)=>t.searchApi&&t.searchApi(...u)),required:"",placeholder:t.isWatchlist?"Enter title (API search + manual input available)":"Enter title",disabled:t.loading},null,40,zo),[[B,t.form.title]]),t.apiResults.length>0?(m(),f("div",Yo,[(m(!0),f(X,null,$(t.apiResults,u=>(m(),f("div",{key:u.title,class:"search-result-item",onClick:p=>t.selectApiResult(u)},[s("div",qo,[u.imageUrl?(m(),f("img",{key:0,src:t.ensureHttpsUrl(u.imageUrl),alt:u.title},null,8,Jo)):(m(),f("div",Qo,[s("span",null,v(u.title.charAt(0).toUpperCase()),1)]))]),s("div",Ko,[s("div",Zo,v(u.title),1),s("div",Xo,[u.release?(m(),f("span",$o,v(t.formatDate(u.release)),1)):k("",!0),u.genre?(m(),f("span",en,v(u.genre),1)):k("",!0),u.rating?(m(),f("span",tn,"â­ "+v(u.rating),1)):k("",!0)])])],8,Ho))),128))])):k("",!0)])])]),s("div",sn,[s("div",an,[s("label",on,[Pe(v(t.isWatchlist?"Release Date:":"Release:")+" ",1),t.isWatchlist?(m(),f("span",nn,"*")):k("",!0)]),A(s("input",{type:"date",id:"release","onUpdate:modelValue":e[3]||(e[3]=u=>t.form.release=u),required:t.isWatchlist},null,8,ln),[[B,t.form.release]])]),s("div",rn,[e[40]||(e[40]=s("label",{for:"personalRating"},"Personal Rating:",-1)),A(s("input",{type:"number",id:"personalRating","onUpdate:modelValue":e[4]||(e[4]=u=>t.form.personalRating=u),step:"0.1",min:"0",max:"10",placeholder:"0-10"},null,512),[[B,t.form.personalRating]])]),t.isSeries?(m(),f("div",dn,[e[42]||(e[42]=s("label",{for:"isAiring"},"Status:",-1)),A(s("select",{id:"isAiring","onUpdate:modelValue":e[5]||(e[5]=u=>t.form.isAiring=u)},[...e[41]||(e[41]=[s("option",{value:!1},"Finished",-1),s("option",{value:!0},"Airing",-1)])],512),[[be,t.form.isAiring]])])):k("",!0),s("div",cn,[e[43]||(e[43]=s("label",{for:"apiRating"},"API Rating:",-1)),A(s("input",{type:"number",id:"apiRating","onUpdate:modelValue":e[6]||(e[6]=u=>t.form.apiRating=u),step:"0.1",min:"0",max:"10",placeholder:"0-10",readonly:""},null,512),[[B,t.form.apiRating]])])]),s("div",un,[s("div",gn,[s("button",{type:"submit",disabled:t.loading,class:"save-btn"},v(t.loading?"Saving...":"ðŸ’¾ Save"),9,mn),s("button",{type:"button",onClick:e[7]||(e[7]=(...u)=>t.closeModal&&t.closeModal(...u)),disabled:t.loading,class:"cancel-btn"}," âœ• Cancel ",8,fn),t.isEditing?(m(),f("button",{key:0,type:"button",onClick:e[8]||(e[8]=(...u)=>t.deleteItem&&t.deleteItem(...u)),disabled:t.loading,class:"delete-btn"}," ðŸ—‘ï¸ Delete ",8,hn)):k("",!0)])]),s("div",pn,[s("div",vn,[s("div",yn,[s("div",bn,[e[44]||(e[44]=s("label",{for:"views"},"Views:",-1)),A(s("input",{type:"number",id:"views","onUpdate:modelValue":e[9]||(e[9]=u=>t.form.count=u),min:"0",placeholder:"0"},null,512),[[B,t.form.count]])]),s("div",wn,[e[45]||(e[45]=s("label",{for:"discovered"},"Discovered:",-1)),A(s("input",{type:"date",id:"discovered","onUpdate:modelValue":e[10]||(e[10]=u=>t.form.discovered=u)},null,512),[[B,t.form.discovered]])]),s("div",_n,[e[46]||(e[46]=s("label",{for:"platforms"},"Platforms:",-1)),A(s("input",{type:"text",id:"platforms","onUpdate:modelValue":e[11]||(e[11]=u=>t.form.platforms=u),placeholder:"PC, PS5, Xbox"},null,512),[[B,t.form.platforms]])]),s("div",kn,[e[47]||(e[47]=s("label",{for:"genre"},"Genre:",-1)),A(s("input",{type:"text",id:"genre","onUpdate:modelValue":e[12]||(e[12]=u=>t.form.genre=u),placeholder:"Action, Adventure, RPG"},null,512),[[B,t.form.genre]])])]),s("div",Sn,[s("div",xn,[e[48]||(e[48]=s("label",{for:"description"},"Description:",-1)),A(s("textarea",{id:"description","onUpdate:modelValue":e[13]||(e[13]=u=>t.form.description=u),placeholder:"Enter description...",rows:"3"},null,512),[[B,t.form.description]])]),s("div",Cn,[e[49]||(e[49]=s("label",{for:"link"},"Link:",-1)),A(s("input",{type:"url",id:"link","onUpdate:modelValue":e[14]||(e[14]=u=>t.form.link=u),placeholder:"https://..."},null,512),[[B,t.form.link]])]),s("div",In,[e[50]||(e[50]=s("label",{for:"imageUrl"},"Image URL:",-1)),s("div",Dn,[A(s("input",{type:"text",id:"imageUrl","onUpdate:modelValue":e[15]||(e[15]=u=>t.form.imageUrl=u),placeholder:"https://... or leave empty for API images"},null,512),[[B,t.form.imageUrl]]),s("button",{type:"button",onClick:e[16]||(e[16]=(...u)=>t.triggerImageUpload&&t.triggerImageUpload(...u)),class:"upload-btn",disabled:t.loading}," ðŸ“ Upload ",8,An)]),t.uploadedImagePath?(m(),f("div",Tn,[Pe(" âœ… Image uploaded: "+v(t.uploadedImagePath)+" ",1),s("button",{type:"button",onClick:e[17]||(e[17]=(...u)=>t.removeUploadedImage&&t.removeUploadedImage(...u)),class:"remove-uploaded-btn",title:"Remove uploaded image to enable API search"}," âœ• Remove ")])):k("",!0)])])])]),t.form.category==="watchlist"?(m(),f("div",Mn,[s("div",Rn,[e[52]||(e[52]=s("label",{for:"watchlistType"},[Pe("Type: "),s("span",{class:"required"},"*")],-1)),A(s("select",{id:"watchlistType","onUpdate:modelValue":e[18]||(e[18]=u=>t.form.watchlistType=u)},[...e[51]||(e[51]=[Oe('<option value="" data-v-5a61e078>Select Type</option><option value="game" data-v-5a61e078>Game</option><option value="series" data-v-5a61e078>Series</option><option value="movie" data-v-5a61e078>Movie</option><option value="buecher" data-v-5a61e078>BÃ¼cher</option>',5)])],512),[[be,t.form.watchlistType]]),t.form.category==="watchlist"&&!t.form.watchlistType?(m(),f("div",En," Please select a type for watchlist items ")):k("",!0)]),s("div",Un,[e[53]||(e[53]=s("label",{for:"watchlistReleaseDate"},"Watchlist Release Date",-1)),A(s("input",{type:"date",id:"watchlistReleaseDate","onUpdate:modelValue":e[19]||(e[19]=u=>t.form.watchlistReleaseDate=u),placeholder:"When does this release?"},null,512),[[B,t.form.watchlistReleaseDate]])]),s("div",Ln,[e[54]||(e[54]=s("label",{for:"watchlistNumber"},"Watchlist Number",-1)),A(s("input",{type:"number",id:"watchlistNumber","onUpdate:modelValue":e[20]||(e[20]=u=>t.form.watchlistNumber=u),placeholder:"Enter a number",min:"1"},null,512),[[B,t.form.watchlistNumber]])]),s("div",Bn,[e[55]||(e[55]=s("label",{for:"extraLink"},"Extra Link:",-1)),A(s("input",{type:"url",id:"extraLink","onUpdate:modelValue":e[21]||(e[21]=u=>t.form.extraLink=u),placeholder:"https://... (e.g., streaming platform, official website)"},null,512),[[B,t.form.extraLink]]),e[56]||(e[56]=s("div",{class:"field-hint"},"Optional: Additional link for watchlist items (e.g., streaming platform, official website)",-1))])])):k("",!0),t.isGame?(m(),f("div",Pn,[s("div",Fn,[e[57]||(e[57]=s("label",{for:"playtime"},"Playtime (Minutes):",-1)),A(s("input",{type:"number",id:"playtime","onUpdate:modelValue":e[22]||(e[22]=u=>t.form.spielzeit=u),min:"0",placeholder:"0"},null,512),[[B,t.form.spielzeit]])])])):k("",!0),s("div",Nn,[t.isSeries?(m(),f("div",Gn,[s("button",{type:"button",onClick:e[23]||(e[23]=(...u)=>t.toggleSeriesDetails&&t.toggleSeriesDetails(...u)),class:H(["collapsible-header",{expanded:t.seriesDetailsExpanded}])}," ðŸ“º Series Details "+v(t.seriesDetailsExpanded?"â–¼":"â–¶"),3),t.seriesDetailsExpanded?(m(),f("div",Wn,[s("div",On,[s("div",Vn,[e[58]||(e[58]=s("label",{for:"nextSeasonName"},"Next Season Name:",-1)),A(s("input",{type:"text",id:"nextSeasonName","onUpdate:modelValue":e[24]||(e[24]=u=>t.form.nextSeasonName=u),placeholder:"e.g., The Final Season"},null,512),[[B,t.form.nextSeasonName]])]),s("div",jn,[e[59]||(e[59]=s("label",{for:"lastAirDate"},"Last Air Date:",-1)),A(s("input",{type:"date",id:"lastAirDate","onUpdate:modelValue":e[25]||(e[25]=u=>t.form.lastAirDate=u)},null,512),[[B,t.form.lastAirDate]])])]),s("div",zn,[s("div",Yn,[e[60]||(e[60]=s("label",{for:"totalSeasons"},"Total Seasons:",-1)),A(s("input",{type:"number",id:"totalSeasons","onUpdate:modelValue":e[26]||(e[26]=u=>t.form.totalSeasons=u),min:"0",placeholder:"0"},null,512),[[B,t.form.totalSeasons]])]),s("div",Hn,[e[61]||(e[61]=s("label",{for:"totalEpisodes"},"Total Episodes:",-1)),A(s("input",{type:"number",id:"totalEpisodes","onUpdate:modelValue":e[27]||(e[27]=u=>t.form.totalEpisodes=u),min:"0",placeholder:"0"},null,512),[[B,t.form.totalEpisodes]])])]),s("div",qn,[s("div",Jn,[e[63]||(e[63]=s("label",{for:"seriesStatus"},"Series Status:",-1)),A(s("select",{id:"seriesStatus","onUpdate:modelValue":e[28]||(e[28]=u=>t.form.seriesStatus=u)},[...e[62]||(e[62]=[Oe('<option value="" data-v-5a61e078>Select Status</option><option value="Returning Series" data-v-5a61e078>Returning Series</option><option value="Ended" data-v-5a61e078>Ended</option><option value="In Production" data-v-5a61e078>In Production</option><option value="Canceled" data-v-5a61e078>Canceled</option>',5)])],512),[[be,t.form.seriesStatus]])]),s("div",Qn,[e[64]||(e[64]=s("label",{for:"networks"},"Networks:",-1)),A(s("input",{type:"text",id:"networks","onUpdate:modelValue":e[29]||(e[29]=u=>t.form.networks=u),placeholder:"e.g., Netflix, HBO"},null,512),[[B,t.form.networks]])])]),s("div",Kn,[s("div",Zn,[e[65]||(e[65]=s("label",{for:"createdBy"},"Created By:",-1)),A(s("input",{type:"text",id:"createdBy","onUpdate:modelValue":e[30]||(e[30]=u=>t.form.createdBy=u),placeholder:"e.g., The Duffer Brothers"},null,512),[[B,t.form.createdBy]])])]),s("div",Xn,[s("div",$n,[e[66]||(e[66]=s("label",{for:"extraLink"},"Extra Link:",-1)),A(s("input",{type:"url",id:"extraLink","onUpdate:modelValue":e[31]||(e[31]=u=>t.form.extraLink=u),placeholder:"https://... (e.g., streaming platform, official website)"},null,512),[[B,t.form.extraLink]]),e[67]||(e[67]=s("div",{class:"field-hint"},"Optional: Additional link for series (e.g., streaming platform, official website)",-1))])]),t.form.isAiring?(m(),f("div",ei,[s("div",ti,[e[68]||(e[68]=s("label",{for:"nextSeasonRelease"},"Next Season Release:",-1)),A(s("input",{type:"date",id:"nextSeasonRelease","onUpdate:modelValue":e[32]||(e[32]=u=>t.form.nextSeasonRelease=u)},null,512),[[B,t.form.nextSeasonRelease]])])])):k("",!0),s("div",si,[s("div",ai,[e[69]||(e[69]=s("label",null,"TMDB Series Information:",-1)),s("div",oi,[s("button",{type:"button",onClick:e[33]||(e[33]=(...u)=>t.checkSeriesAPI&&t.checkSeriesAPI(...u)),disabled:t.loading||!t.form.title,class:"api-check-btn"},[t.apiLoading?(m(),f("span",ii,"ðŸ” Checking...")):(m(),f("span",li,"ðŸ” Check Series Info"))],8,ni),t.apiError?(m(),f("div",ri,v(t.apiError),1)):k("",!0),t.apiSuccess?(m(),f("div",di," âœ… Series information updated from TMDB ")):k("",!0)])])])])):k("",!0)])):k("",!0)]),t.form.category==="buecher"||t.form.watchlistType==="buecher"?(m(),Le(d,{key:2,expanded:!1,onPreferencesChanged:t.handlePreferencesChanged},null,8,["onPreferencesChanged"])):k("",!0),t.error?(m(),f("div",ci,v(t.error),1)):k("",!0)],32)])])}const gi=ee(No,[["render",ui],["__scopeId","data-v-5a61e078"]]),mi={name:"ChangePasswordModal",emits:["close","success"],setup(n,{emit:e}){const o=je(),t=Fe({password:"",password_confirmation:""}),i=w(!1),c=w("");return{form:t,loading:i,error:c,handleChangePassword:async()=>{if(t.password!==t.password_confirmation){c.value="Passwords do not match";return}if(t.password.length<8){c.value="Password must be at least 8 characters long";return}i.value=!0,c.value="";try{const p=window.location.origin,S=o.token,C=await(await fetch(`${p}/api/change-password`,{method:"POST",headers:{Authorization:`Bearer ${S}`,"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({password:t.password,password_confirmation:t.password_confirmation})})).json();C.success?e("success",C):C.errors?c.value=Object.values(C.errors).flat().join(", "):c.value=C.error||"Failed to change password"}catch(p){c.value=p.message||"Failed to change password"}finally{i.value=!1}},closeModal:()=>{e("close")}}}},fi={class:"form-group"},hi=["disabled"],pi={class:"form-group"},vi=["disabled"],yi={key:0,class:"error-message"},bi={class:"modal-buttons"},wi=["disabled"],_i=["disabled"];function ki(n,e,o,t,i,c){return m(),f("div",{class:"modal",onClick:e[5]||(e[5]=(...d)=>t.closeModal&&t.closeModal(...d))},[s("div",{class:"modal-content auth-modal",onClick:e[4]||(e[4]=oe(()=>{},["stop"]))},[e[8]||(e[8]=s("h2",null,"Change Password",-1)),s("form",{onSubmit:e[3]||(e[3]=oe((...d)=>t.handleChangePassword&&t.handleChangePassword(...d),["prevent"]))},[s("div",fi,[e[6]||(e[6]=s("label",{for:"newPassword"},"New Password:",-1)),A(s("input",{type:"password",id:"newPassword","onUpdate:modelValue":e[0]||(e[0]=d=>t.form.password=d),required:"",disabled:t.loading,placeholder:"Enter new password (min. 8 characters)",minlength:"8"},null,8,hi),[[B,t.form.password]])]),s("div",pi,[e[7]||(e[7]=s("label",{for:"confirmPassword"},"Confirm Password:",-1)),A(s("input",{type:"password",id:"confirmPassword","onUpdate:modelValue":e[1]||(e[1]=d=>t.form.password_confirmation=d),required:"",disabled:t.loading,placeholder:"Confirm new password",minlength:"8"},null,8,vi),[[B,t.form.password_confirmation]])]),t.error?(m(),f("div",yi,v(t.error),1)):k("",!0),s("div",bi,[s("button",{type:"submit",disabled:t.loading},v(t.loading?"Changing...":"Change Password"),9,wi),s("button",{type:"button",onClick:e[2]||(e[2]=(...d)=>t.closeModal&&t.closeModal(...d)),disabled:t.loading}," Cancel ",8,_i)])],32)])])}const Si=ee(mi,[["render",ki],["__scopeId","data-v-ed612632"]]),xi={name:"BulkAddModal",props:{show:{type:Boolean,default:!1},currentCategory:{type:String,default:""}},emits:["close"],setup(n,{emit:e}){const o=Ke(),t=w(1),i=w(!1),c=w(!0),d=w(!1),u=w(0),p=w(0),S=w(0),T=w(0),C=w(null),I=w(""),g=w(""),Y=w([]),ne=w([]),U=w({category:"",itemsText:"",defaultRating:null}),ie=G(()=>U.value.category&&U.value.itemsText.trim()&&!i.value),K=G(()=>{const z=de().length;return z>0?Math.round(u.value/z*100):0}),de=()=>!U.value.itemsText||!U.value.itemsText.trim()?[]:U.value.itemsText.split(`
`).map(z=>z.trim()).filter(z=>z.length>0).map(z=>{const Z=z.split("|").map(j=>j.trim());return{searchTerm:Z[0]||"",additionalInfo:Z[1]||null}}),ue=()=>{u.value=0,p.value=0,S.value=0,T.value=0,C.value=null,I.value="",g.value="",Y.value=[],ne.value=[]},h=(z,Z,j)=>{C.value=z,I.value=Z,g.value=j},O=(z,Z,j="")=>{const he={searching:"Searching...",found:"Found",adding:"Adding...",added:"Added",skipped:"Skipped",error:"Error"}[Z]||Z;Y.value.push({title:z,status:Z,statusText:he,message:j})},Ae=async()=>{var j,he,pe,ke,Se,xe,me,Ce;if(!ie.value)return;t.value=2,i.value=!0,c.value=!0,ue();const z=de();let Z=0;try{let fe=[];const Ie=localStorage.getItem("authToken"),De=localStorage.getItem("currentUser");if(Ie&&De)try{h({title:"Checking all items..."},"searching","Checking profile for duplicates..."),fe=(await le.checkExistingItems(z.map(r=>({title:r.searchTerm,category:U.value.category})))).existing_items||[]}catch(l){console.warn("Failed to check existing items, falling back to individual checks:",l)}for(let l=0;l<z.length;l++){const r=z[l];u.value=l+1,h({title:r.searchTerm,description:r.additionalInfo},"searching","Processing...");try{let y=!1;if(Ie&&De&&fe.length>0?y=fe.some(D=>D.title.toLowerCase().trim()===r.searchTerm.toLowerCase().trim()):y=(o.mediaData||[]).some(V=>V.title&&V.title.toLowerCase().trim()===r.searchTerm.toLowerCase().trim()&&V.category===U.value.category),y){console.log(`âœ… Found exact match in profile for "${r.searchTerm}"`),h({title:r.searchTerm},"skipped","Already exists in profile - skipped"),ne.value.push({searchTerm:r.searchTerm,additionalInfo:r.additionalInfo,reason:"duplicate"}),S.value++,O(r.searchTerm,"skipped","Already exists in profile - skipped");continue}h({title:r.searchTerm,description:r.additionalInfo},"searching","Searching API..."),O(r.searchTerm,"searching","Searching API...");const a=await le.searchApi(r.searchTerm,U.value.category,1);if(a&&a.length>0&&a[0]&&a[0].api_source&&a[0].image){const D=a[0];console.log(`âœ… Found real API data for "${r.searchTerm}":`,{title:D.title,api_source:D.api_source,has_image:!!D.image,has_genre:!!D.genre,has_release:!!D.release}),h({title:D.title,description:`Found: ${D.genre||"Unknown genre"} â€¢ ${D.release||"Unknown year"} â€¢ ${D.api_source}`},"found","Found in API with data"),O(r.searchTerm,"found",`Found: ${D.title} (${D.api_source})`);let V=null;if(U.value.category==="series"){h({title:D.title},"fetching","Fetching TMDB series info...");try{console.log("ðŸ” Fetching TMDB info for series:",D.title);const re=await le.checkSeriesInfo(D.title);re.success&&re.data&&(V=re.data,console.log("âœ… TMDB data received:",V))}catch(re){console.warn("âš ï¸ Failed to fetch TMDB info:",re)}}h({title:D.title},"adding","Adding to library...");const te={title:D.title,category:U.value.category,release:D.release||null,rating:D.rating?Math.round(D.rating):U.value.defaultRating||null,platforms:D.platforms||null,genre:D.genre||null,link:D.link||null,path:D.image||null,external_id:D.id||null,count:1,is_airing:!1,spielzeit:0,description:D.overview||r.additionalInfo||null,...V&&{tmdb_id:V.tmdb_id,is_airing:V.is_airing||!1,next_season:((j=V.next_episode)==null?void 0:j.season_number)||null,next_season_release:((he=V.next_episode)==null?void 0:he.air_date)||null,next_season_name:((pe=V.next_episode)==null?void 0:pe.name)||null,last_air_date:V.last_air_date||null,total_seasons:V.number_of_seasons||null,total_episodes:V.number_of_episodes||null,series_status:V.status||null,networks:((ke=V.networks)==null?void 0:ke.join(", "))||null,created_by:((Se=V.created_by)==null?void 0:Se.join(", "))||null}};await o.addMediaItem(te,!0),p.value++,h({title:D.title},"added","Successfully added with API data"),O(r.searchTerm,"added",`Added: ${D.title} with API data`)}else console.log(`âŒ No real API data found for "${r.searchTerm}"`),h({title:r.searchTerm},"skipped","No API data found - will retry"),ne.value.push({searchTerm:r.searchTerm,additionalInfo:r.additionalInfo,reason:"no_api_data"}),S.value++,O(r.searchTerm,"skipped","No API data found - ready for retry")}catch(y){console.error(`Error processing "${r.searchTerm}":`,y),y.isDuplicate||((xe=y.response)==null?void 0:xe.status)===409&&((Ce=(me=y.response)==null?void 0:me.data)!=null&&Ce.duplicate)?(h({title:r.searchTerm},"skipped","Already exists - skipped"),S.value++,O(r.searchTerm,"skipped","Item already exists in library")):(h({title:r.searchTerm},"error","Error occurred"),T.value++,O(r.searchTerm,"error",y.message||"Unknown error"))}if(Z++,Z>=5){console.log("ðŸ”„ Reloading media data after 5 items...");try{await o.loadMedia(),Z=0}catch(y){console.warn("Failed to reload media data:",y)}}if(!i.value)break;for(;d.value&&i.value;)await new Promise(y=>setTimeout(y,100));await new Promise(y=>setTimeout(y,1e3))}console.log("ðŸ”„ Final media data reload...");try{await o.loadMedia()}catch(l){console.warn("Failed to reload media data at end:",l)}t.value=3,h(null,"","")}catch(fe){console.error("Bulk processing error:",fe),T.value++}finally{i.value=!1,c.value=!1}},Te=()=>{i.value=!1,c.value=!1,d.value=!1,t.value=1,ue()},ce=()=>{d.value=!0},we=()=>{d.value=!1},_e=()=>{const z=ne.value.filter(j=>j.reason!=="duplicate");if(z.length===0){ge();return}const Z=z.map(j=>j.additionalInfo?`${j.searchTerm} | ${j.additionalInfo}`:j.searchTerm).join(`
`);U.value.itemsText=Z,u.value=0,p.value=0,T.value=0,C.value=null,I.value="",g.value="",Y.value=[],t.value=1},ge=()=>{t.value=1,i.value=!1,c.value=!0,ue(),U.value={category:"",itemsText:"",defaultRating:null},e("close")};return Ee(()=>n.show,z=>{z&&n.currentCategory?U.value.category=n.currentCategory:z||ge()}),{currentStep:t,isProcessing:i,canCancel:c,isPaused:d,processedCount:u,addedCount:p,skippedCount:S,errorCount:T,currentItem:C,currentItemStatus:I,currentItemStatusText:g,processingResults:Y,skippedItems:ne,bulkData:U,canStart:ie,progressPercentage:K,startProcessing:Ae,cancelProcessing:Te,pauseProcessing:ce,resumeProcessing:we,retrySkippedItems:_e,closeModal:ge}}},Ci={class:"modal-header"},Ii={class:"modal-body"},Di={key:0,class:"step-container"},Ai={class:"bulk-add-form"},Ti={class:"form-row"},Mi={class:"form-group"},Ri={class:"form-group"},Ei={class:"form-group"},Ui={key:1,class:"step-container"},Li={class:"processing-container"},Bi={class:"progress-overview"},Pi={class:"progress-stats"},Fi={class:"stat"},Ni={class:"stat-number"},Gi={class:"stat"},Wi={class:"stat-number"},Oi={class:"stat"},Vi={class:"stat-number"},ji={class:"stat"},zi={class:"stat-number"},Yi={class:"progress-bar"},Hi={class:"progress-text"},qi={class:"current-item"},Ji={class:"current-item-header"},Qi={class:"current-item-title"},Ki={key:0,class:"paused-indicator"},Zi={key:0,class:"current-item-description"},Xi={key:1,class:"api-data-indicator"},$i={key:2,class:"no-api-indicator"},el={class:"results-list"},tl={class:"result-header"},sl={class:"result-title"},al={class:"result-status"},ol={key:0,class:"result-message"},nl={key:2,class:"step-container"},il={class:"results-summary"},ll={class:"summary-stats"},rl={class:"summary-stat success"},dl={class:"stat-number"},cl={class:"summary-stat warning"},ul={class:"stat-number"},gl={class:"summary-stat info"},ml={class:"stat-number"},fl={class:"summary-stat error"},hl={class:"stat-number"},pl={key:0,class:"retry-section"},vl={class:"retry-list"},yl=["onUpdate:modelValue","disabled"],bl={key:0,class:"retry-additional"},wl={key:1,class:"duplicate-badge"},_l={key:2,class:"retry-badge"},kl={key:1,class:"detailed-results"},Sl={class:"results-list"},xl={class:"result-header"},Cl={class:"result-title"},Il={class:"result-status"},Dl={key:0,class:"result-message"},Al={class:"modal-footer"},Tl=["disabled"],Ml={key:2,class:"processing-controls"},Rl=["disabled"],El=["disabled"],Ul={key:3,class:"footer-buttons"};function Ll(n,e,o,t,i,c){var d,u;return o.show?(m(),f("div",{key:0,class:"modal-overlay",onClick:e[12]||(e[12]=(...p)=>t.closeModal&&t.closeModal(...p))},[s("div",{class:"modal-content",onClick:e[11]||(e[11]=oe(()=>{},["stop"]))},[s("div",Ci,[e[13]||(e[13]=s("h2",null,"Bulk Add Items",-1)),s("button",{class:"close-btn",onClick:e[0]||(e[0]=(...p)=>t.closeModal&&t.closeModal(...p))},"âœ•")]),s("div",Ii,[t.currentStep===1?(m(),f("div",Di,[e[19]||(e[19]=s("div",{class:"step-header"},[s("div",{class:"step-number"},"1"),s("h3",null,"Enter Your List")],-1)),s("div",Ai,[s("div",Ti,[s("div",Mi,[e[15]||(e[15]=s("label",{for:"category"},"Category *",-1)),A(s("select",{id:"category","onUpdate:modelValue":e[1]||(e[1]=p=>t.bulkData.category=p),required:""},[...e[14]||(e[14]=[Oe('<option value="" data-v-04d8250b>Select Category</option><option value="game" data-v-04d8250b>Game</option><option value="series" data-v-04d8250b>Series</option><option value="movie" data-v-04d8250b>Movie</option><option value="buecher" data-v-04d8250b>BÃ¼cher</option><option value="watchlist" data-v-04d8250b>Watchlist</option>',6)])],512),[[be,t.bulkData.category]])]),s("div",Ri,[e[16]||(e[16]=s("label",{for:"default-rating"},"Default Rating",-1)),A(s("input",{id:"default-rating","onUpdate:modelValue":e[2]||(e[2]=p=>t.bulkData.defaultRating=p),type:"number",min:"0",max:"10",step:"0.1",placeholder:"Optional rating for all items"},null,512),[[B,t.bulkData.defaultRating,void 0,{number:!0}]])])]),s("div",Ei,[e[17]||(e[17]=s("label",{for:"items-text"},"Items (one per line) *",-1)),A(s("textarea",{id:"items-text","onUpdate:modelValue":e[3]||(e[3]=p=>t.bulkData.itemsText=p),placeholder:`Enter items one per line, for example:
The Witcher 3
Cyberpunk 2077
Red Dead Redemption 2`,rows:"6",required:""},null,512),[[B,t.bulkData.itemsText]]),e[18]||(e[18]=s("small",{class:"help-text"},"Enter one item per line. The system will automatically search and add each item individually.",-1))])])])):k("",!0),t.currentStep===2?(m(),f("div",Ui,[e[24]||(e[24]=s("div",{class:"step-header"},[s("div",{class:"step-number"},"2"),s("h3",null,"Processing Items")],-1)),s("div",Li,[s("div",Bi,[s("div",Pi,[s("span",Fi,[s("span",Ni,v(t.processedCount),1),e[20]||(e[20]=s("span",{class:"stat-label"},"Processed",-1))]),s("span",Gi,[s("span",Wi,v(t.addedCount),1),e[21]||(e[21]=s("span",{class:"stat-label"},"Added",-1))]),s("span",Oi,[s("span",Vi,v(t.skippedCount),1),e[22]||(e[22]=s("span",{class:"stat-label"},"Skipped",-1))]),s("span",ji,[s("span",zi,v(t.errorCount),1),e[23]||(e[23]=s("span",{class:"stat-label"},"Errors",-1))])]),s("div",Yi,[s("div",{class:"progress-fill",style:Be({width:t.progressPercentage+"%"})},null,4)]),s("div",Hi,v(t.progressPercentage)+"% Complete",1)]),s("div",qi,[s("div",Ji,[s("span",Qi,"Processing: "+v(((d=t.currentItem)==null?void 0:d.title)||"..."),1),s("span",{class:H(["current-item-status",t.currentItemStatus])},[t.isPaused?(m(),f("span",Ki,"â¸ï¸ PAUSED - ")):k("",!0),Pe(v(t.currentItemStatusText),1)],2)]),(u=t.currentItem)!=null&&u.description?(m(),f("div",Zi,v(t.currentItem.description),1)):k("",!0),t.currentItemStatus==="found"?(m(),f("div",Xi," âœ… Real API data found with image and metadata ")):k("",!0),t.currentItemStatus==="skipped"?(m(),f("div",$i," âŒ No API data found - will be retried ")):k("",!0)]),s("div",el,[(m(!0),f(X,null,$(t.processingResults,(p,S)=>(m(),f("div",{key:S,class:H(["result-item",p.status])},[s("div",tl,[s("span",sl,v(p.title),1),s("span",al,v(p.statusText),1)]),p.message?(m(),f("div",ol,v(p.message),1)):k("",!0)],2))),128))])])])):k("",!0),t.currentStep===3?(m(),f("div",nl,[e[32]||(e[32]=s("div",{class:"step-header"},[s("div",{class:"step-number"},"3"),s("h3",null,"Results")],-1)),s("div",il,[s("div",ll,[s("div",rl,[s("span",dl,v(t.addedCount),1),e[25]||(e[25]=s("span",{class:"stat-label"},"Successfully Added",-1))]),s("div",cl,[s("span",ul,v(t.skippedItems.filter(p=>p.reason!=="duplicate").length),1),e[26]||(e[26]=s("span",{class:"stat-label"},"Not Found (Ready for Retry)",-1))]),s("div",gl,[s("span",ml,v(t.skippedItems.filter(p=>p.reason==="duplicate").length),1),e[27]||(e[27]=s("span",{class:"stat-label"},"Already in Profile",-1))]),s("div",fl,[s("span",hl,v(t.errorCount),1),e[28]||(e[28]=s("span",{class:"stat-label"},"Errors",-1))])]),t.skippedItems.length>0?(m(),f("div",pl,[e[29]||(e[29]=s("h4",null,"Items Ready for Retry",-1)),e[30]||(e[30]=s("p",{class:"retry-description"}," The following items can be edited and tried again: ",-1)),s("div",vl,[(m(!0),f(X,null,$(t.skippedItems,(p,S)=>(m(),f("div",{key:S,class:H(["retry-item",{"duplicate-item":p.reason==="duplicate"}])},[A(s("input",{"onUpdate:modelValue":T=>p.searchTerm=T,class:"retry-input",placeholder:"Edit search term...",disabled:p.reason==="duplicate"},null,8,yl),[[B,p.searchTerm]]),p.additionalInfo?(m(),f("span",bl," | "+v(p.additionalInfo),1)):k("",!0),p.reason==="duplicate"?(m(),f("span",wl," Already in profile ")):(m(),f("span",_l," No API data "))],2))),128))])])):k("",!0),t.processingResults.length>0?(m(),f("div",kl,[e[31]||(e[31]=s("h4",null,"Detailed Results",-1)),s("div",Sl,[(m(!0),f(X,null,$(t.processingResults,(p,S)=>(m(),f("div",{key:S,class:H(["result-item",p.status])},[s("div",xl,[s("span",Cl,v(p.title),1),s("span",Il,v(p.statusText),1)]),p.message?(m(),f("div",Dl,v(p.message),1)):k("",!0)],2))),128))])])):k("",!0)])])):k("",!0)]),s("div",Al,[t.currentStep===1?(m(),f("button",{key:0,class:"btn btn-secondary",onClick:e[4]||(e[4]=(...p)=>t.closeModal&&t.closeModal(...p))}," Cancel ")):k("",!0),t.currentStep===1?(m(),f("button",{key:1,class:"btn btn-primary",onClick:e[5]||(e[5]=(...p)=>t.startProcessing&&t.startProcessing(...p)),disabled:!t.canStart}," Check All and Add ",8,Tl)):k("",!0),t.currentStep===2?(m(),f("div",Ml,[s("button",{class:"btn btn-secondary",onClick:e[6]||(e[6]=(...p)=>t.cancelProcessing&&t.cancelProcessing(...p)),disabled:!t.canCancel}," Cancel ",8,Rl),t.isPaused?k("",!0):(m(),f("button",{key:0,class:"btn btn-warning",onClick:e[7]||(e[7]=(...p)=>t.pauseProcessing&&t.pauseProcessing(...p)),disabled:!t.isProcessing}," Pause ",8,El)),t.isPaused?(m(),f("button",{key:1,class:"btn btn-primary",onClick:e[8]||(e[8]=(...p)=>t.resumeProcessing&&t.resumeProcessing(...p))}," Resume ")):k("",!0)])):k("",!0),t.currentStep===3?(m(),f("div",Ul,[t.skippedItems.filter(p=>p.reason!=="duplicate").length>0?(m(),f("button",{key:0,class:"btn btn-warning",onClick:e[9]||(e[9]=(...p)=>t.retrySkippedItems&&t.retrySkippedItems(...p))}," Retry "+v(t.skippedItems.filter(p=>p.reason!=="duplicate").length)+" Items ",1)):k("",!0),s("button",{class:"btn btn-primary",onClick:e[10]||(e[10]=(...p)=>t.closeModal&&t.closeModal(...p))}," Done ")])):k("",!0)])])])):k("",!0)}const Bl=ee(xi,[["render",Ll],["__scopeId","data-v-04d8250b"]]),Pl={name:"TxtImportModal",props:{show:{type:Boolean,default:!1}},emits:["close","fileProcessed"],methods:{handleFileUpload(n){const e=n.target.files[0];if(!e)return;if(!e.name.toLowerCase().endsWith(".txt")){alert("Bitte wÃ¤hlen Sie eine .txt Datei aus.");return}const o=new FileReader;o.onload=t=>{const i=t.target.result;this.$emit("fileProcessed",i)},o.readAsText(e,"UTF-8")}}},Fl={class:"file-upload-area"},Nl={class:"modal-buttons"};function Gl(n,e,o,t,i,c){return o.show?(m(),f("div",{key:0,class:"modal",onClick:e[3]||(e[3]=d=>n.$emit("close"))},[s("div",{class:"modal-content",onClick:e[2]||(e[2]=oe(()=>{},["stop"]))},[e[5]||(e[5]=s("h2",null,"ðŸ“„ Import from TXT File",-1)),e[6]||(e[6]=s("p",null,"WÃ¤hlen Sie eine .txt Datei mit einer Liste von Titeln aus, um zu prÃ¼fen, welche Items in der aktuellen Kategorie fehlen.",-1)),s("div",Fl,[s("input",{type:"file",id:"txtFileInput",accept:".txt",onChange:e[0]||(e[0]=(...d)=>c.handleFileUpload&&c.handleFileUpload(...d)),style:{display:"none"}},null,32),e[4]||(e[4]=s("label",{for:"txtFileInput",class:"file-upload-label"},[s("span",{class:"upload-icon"},"ðŸ“"),s("span",{class:"upload-text"},"TXT-Datei auswÃ¤hlen"),s("span",{class:"upload-hint"},"Eine .txt Datei mit einer Liste von Titeln")],-1))]),s("div",Nl,[s("button",{type:"button",onClick:e[1]||(e[1]=d=>n.$emit("close"))}," Cancel ")])])])):k("",!0)}const Wl=ee(Pl,[["render",Gl],["__scopeId","data-v-e20860d6"]]),Ol={name:"TxtImportResultsModal",props:{show:{type:Boolean,default:!1},results:{type:Object,default:null}},emits:["close"]},Vl={class:"results-summary"},jl={class:"summary-item"},zl={class:"summary-value"},Yl={class:"summary-item"},Hl={class:"summary-value"},ql={class:"summary-item"},Jl={class:"summary-value existing"},Ql={class:"summary-item"},Kl={class:"summary-value missing"},Zl={key:0,class:"missing-items"},Xl={class:"items-list"},$l={key:1,class:"existing-items"},er={class:"items-list"},tr={class:"modal-buttons"};function sr(n,e,o,t,i,c){return o.show&&o.results?(m(),f("div",{key:0,class:"modal",onClick:e[2]||(e[2]=d=>n.$emit("close"))},[s("div",{class:"modal-content results-modal",onClick:e[1]||(e[1]=oe(()=>{},["stop"]))},[e[7]||(e[7]=s("h2",null,"ðŸ“Š TXT Import Ergebnisse",-1)),s("div",Vl,[s("div",jl,[e[3]||(e[3]=s("span",{class:"summary-label"},"Kategorie:",-1)),s("span",zl,v(o.results.categoryName),1)]),s("div",Yl,[e[4]||(e[4]=s("span",{class:"summary-label"},"Titel in Datei:",-1)),s("span",Hl,v(o.results.totalInFile),1)]),s("div",ql,[e[5]||(e[5]=s("span",{class:"summary-label"},"Bereits vorhanden:",-1)),s("span",Jl,v(o.results.existingItems.length),1)]),s("div",Ql,[e[6]||(e[6]=s("span",{class:"summary-label"},"Fehlende Titel:",-1)),s("span",Kl,v(o.results.missingItems.length),1)])]),o.results.missingItems.length>0?(m(),f("div",Zl,[s("h3",null,"âŒ Fehlende Titel ("+v(o.results.missingItems.length)+"):",1),s("div",Xl,[(m(!0),f(X,null,$(o.results.missingItems,(d,u)=>(m(),f("div",{key:u,class:"missing-item"},v(d),1))),128))])])):k("",!0),o.results.existingItems.length>0?(m(),f("div",$l,[s("h3",null,"âœ… Bereits vorhanden ("+v(o.results.existingItems.length)+"):",1),s("div",er,[(m(!0),f(X,null,$(o.results.existingItems,(d,u)=>(m(),f("div",{key:u,class:"existing-item"},v(d),1))),128))])])):k("",!0),s("div",tr,[s("button",{type:"button",onClick:e[0]||(e[0]=d=>n.$emit("close"))}," SchlieÃŸen ")])])])):k("",!0)}const ar=ee(Ol,[["render",sr],["__scopeId","data-v-ec385b83"]]),or={name:"SimpleAddItem",setup(){const n=w(!1),e=w(null),o=Fe({title:"Test Game",category:"game",release:"2003-01-01",count:1});return{form:o,loading:n,result:e,addItem:async()=>{n.value=!0,e.value=null;try{const i=window.location.origin,c=await fetch(`${i}/api/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:"admin@example.com",password:"admin123"})});if(!c.ok)throw new Error("Login failed");const u=(await c.json()).token,S=await(await fetch(`${i}/api/media`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`},body:JSON.stringify(o)})).json();S.success?e.value={success:!0,message:`Success! Item added with ID: ${S.data.id}`}:e.value={success:!1,message:`Error: ${JSON.stringify(S)}`}}catch(i){e.value={success:!1,message:`Error: ${i.message}`}}finally{n.value=!1}}}}},nr={class:"simple-add-item"},ir=["disabled"];function lr(n,e,o,t,i,c){return m(),f("div",nr,[e[10]||(e[10]=s("h3",null,"Simple Add Item Test",-1)),s("form",{onSubmit:e[4]||(e[4]=oe((...d)=>t.addItem&&t.addItem(...d),["prevent"]))},[s("div",null,[e[5]||(e[5]=s("label",null,"Title:",-1)),A(s("input",{"onUpdate:modelValue":e[0]||(e[0]=d=>t.form.title=d),type:"text",required:""},null,512),[[B,t.form.title]])]),s("div",null,[e[7]||(e[7]=s("label",null,"Category:",-1)),A(s("select",{"onUpdate:modelValue":e[1]||(e[1]=d=>t.form.category=d)},[...e[6]||(e[6]=[s("option",{value:"game"},"Game",-1),s("option",{value:"movie"},"Movie",-1),s("option",{value:"series"},"Series",-1)])],512),[[be,t.form.category]])]),s("div",null,[e[8]||(e[8]=s("label",null,"Release:",-1)),A(s("input",{"onUpdate:modelValue":e[2]||(e[2]=d=>t.form.release=d),type:"date"},null,512),[[B,t.form.release]])]),s("div",null,[e[9]||(e[9]=s("label",null,"Count:",-1)),A(s("input",{"onUpdate:modelValue":e[3]||(e[3]=d=>t.form.count=d),type:"number",min:"0"},null,512),[[B,t.form.count]])]),s("button",{type:"submit",disabled:t.loading},v(t.loading?"Adding...":"Add Item"),9,ir)],32),t.result?(m(),f("div",{key:0,class:H(["result",t.result.success?"success":"error"])},v(t.result.message),3)):k("",!0)])}const rr=ee(or,[["render",lr],["__scopeId","data-v-4298065b"]]),dr={name:"LoadingSpinner",props:{loading:{type:Boolean,default:!0},message:{type:String,default:"Loading..."}}},cr={key:0,class:"loading-spinner"},ur={key:0};function gr(n,e,o,t,i,c){return o.loading?(m(),f("div",cr,[e[0]||(e[0]=s("div",{class:"spinner"},null,-1)),o.message?(m(),f("p",ur,v(o.message),1)):k("",!0)])):k("",!0)}const mr=ee(dr,[["render",gr],["__scopeId","data-v-0e82c46a"]]),fr={name:"MessageBox",props:{show:{type:Boolean,default:!1},type:{type:String,default:"info",validator:n=>["success","error","warning","info"].includes(n)},title:{type:String,default:""},message:{type:String,required:!0},details:{type:String,default:""}},emits:["close"],setup(n,{emit:e}){const o=()=>{e("close")},t=G(()=>{switch(n.type){case"success":return"âœ…";case"error":return"âŒ";case"warning":return"âš ï¸";case"info":return"â„¹ï¸";default:return"â„¹ï¸"}}),i=G(()=>`message-${n.type}`);return{closeMessage:o,icon:t,messageType:i}}},hr={class:"message-header"},pr={class:"message-icon"},vr={class:"message-title"},yr={class:"message-body"},br={key:0,class:"message-details"},wr={class:"message-footer"};function _r(n,e,o,t,i,c){return o.show?(m(),f("div",{key:0,class:"message-overlay",onClick:e[3]||(e[3]=(...d)=>t.closeMessage&&t.closeMessage(...d))},[s("div",{class:H(["message-box",t.messageType]),onClick:e[2]||(e[2]=oe(()=>{},["stop"]))},[s("div",hr,[s("span",pr,v(t.icon),1),s("h3",vr,v(o.title),1),s("button",{class:"close-btn",onClick:e[0]||(e[0]=(...d)=>t.closeMessage&&t.closeMessage(...d))},"âœ•")]),s("div",yr,[s("p",null,v(o.message),1),o.details?(m(),f("div",br,[s("pre",null,v(o.details),1)])):k("",!0)]),s("div",wr,[s("button",{class:"btn btn-primary",onClick:e[1]||(e[1]=(...d)=>t.closeMessage&&t.closeMessage(...d))},"OK")])],2)])):k("",!0)}const kr=ee(fr,[["render",_r],["__scopeId","data-v-198ec3cc"]]),Sr={name:"ConfirmDialog",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Confirm Action"},message:{type:String,required:!0}},emits:["confirm","close"],setup(n,{emit:e}){const o=()=>{e("close")};return{closeDialog:o,confirmAction:()=>{e("confirm"),o()}}}},xr={class:"confirm-header"},Cr={class:"confirm-title"},Ir={class:"confirm-body"},Dr={class:"confirm-footer"};function Ar(n,e,o,t,i,c){return o.show?(m(),f("div",{key:0,class:"confirm-overlay",onClick:e[4]||(e[4]=(...d)=>t.closeDialog&&t.closeDialog(...d))},[s("div",{class:"confirm-dialog",onClick:e[3]||(e[3]=oe(()=>{},["stop"]))},[s("div",xr,[s("h3",Cr,v(o.title),1),s("button",{class:"close-btn",onClick:e[0]||(e[0]=(...d)=>t.closeDialog&&t.closeDialog(...d))},"âœ•")]),s("div",Ir,[s("p",null,v(o.message),1)]),s("div",Dr,[s("button",{class:"btn btn-secondary",onClick:e[1]||(e[1]=(...d)=>t.closeDialog&&t.closeDialog(...d))},"Cancel"),s("button",{class:"btn btn-danger",onClick:e[2]||(e[2]=(...d)=>t.confirmAction&&t.confirmAction(...d))},"Confirm")])])])):k("",!0)}const Tr=ee(Sr,[["render",Ar],["__scopeId","data-v-fd570f57"]]),Mr={name:"InputDialog",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Input Required"},message:{type:String,required:!0},placeholder:{type:String,default:""},inputType:{type:String,default:"text"},defaultValue:{type:String,default:""}},emits:["confirm","close"],setup(n,{emit:e}){const o=w(""),t=w(null),i=()=>{e("close")},c=()=>{e("confirm",o.value),i()};return Ee(()=>n.show,async d=>{d&&(o.value=n.defaultValue,await cs(),t.value&&(t.value.focus(),t.value.select()))}),{inputValue:o,inputRef:t,closeDialog:i,confirmAction:c}}},Rr={class:"input-header"},Er={class:"input-title"},Ur={class:"input-body"},Lr={class:"input-message"},Br=["type","placeholder"],Pr={class:"input-footer"};function Fr(n,e,o,t,i,c){return o.show?(m(),f("div",{key:0,class:"input-overlay",onClick:e[6]||(e[6]=(...d)=>t.closeDialog&&t.closeDialog(...d))},[s("div",{class:"input-dialog",onClick:e[5]||(e[5]=oe(()=>{},["stop"]))},[s("div",Rr,[s("h3",Er,v(o.title),1),s("button",{class:"close-btn",onClick:e[0]||(e[0]=(...d)=>t.closeDialog&&t.closeDialog(...d))},"âœ•")]),s("div",Ur,[s("p",Lr,v(o.message),1),A(s("input",{"onUpdate:modelValue":e[1]||(e[1]=d=>t.inputValue=d),type:o.inputType,placeholder:o.placeholder,class:"input-field",onKeyup:e[2]||(e[2]=ds((...d)=>t.confirmAction&&t.confirmAction(...d),["enter"])),ref:"inputRef"},null,40,Br),[[rs,t.inputValue]])]),s("div",Pr,[s("button",{class:"btn btn-secondary",onClick:e[3]||(e[3]=(...d)=>t.closeDialog&&t.closeDialog(...d))},"Cancel"),s("button",{class:"btn btn-primary",onClick:e[4]||(e[4]=(...d)=>t.confirmAction&&t.confirmAction(...d))},"OK")])])])):k("",!0)}const Nr=ee(Mr,[["render",Fr],["__scopeId","data-v-0ee78a4d"]]),Gr={name:"MediaLibrary",components:{MediaItem:Ws,Sidebar:_a,MainHeader:Pa,FloatingActionButton:Va,LoginModal:Za,RegisterModal:ho,EditModal:gi,ChangePasswordModal:Si,BulkAddModal:Bl,TxtImportModal:Wl,TxtImportResultsModal:ar,SimpleAddItem:rr,LoadingSpinner:mr,MessageBox:kr,ConfirmDialog:Tr,InputDialog:Nr},setup(){const n=Ke(),e=wt(),o=_t(),t=kt(),i=je(),c=St(),d=G(()=>!c||typeof c!="object"?(console.warn("SidebarStore not properly initialized, using fallback values"),{collapsed:!1,mobileOpen:!1,toggleSidebar:()=>{},toggleMobileSidebar:()=>{},closeMobileSidebar:()=>{}}):c),u=w(!1),p=w(null),S=w(!1),T=w(null),C=w([]),I=w(new Date),g=w(null),Y=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],ne=w(null),U=Fe({firstName:"",lastName:"",displayName:"",email:"",bio:"",avatar:"",language:"en",timezone:"UTC",dateFormat:"MM/DD/YYYY",booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}),{showLoginModal:ie,showRegisterModal:K,showEditModal:de,showFloatingMenu:ue,showBulkAddModal:h,showTxtImportModal:O,showTxtImportResults:Ae,editingItem:Te,sortBy:ce,categories:we,txtImportResults:_e,isLoggedIn:ge,isAdmin:z,userName:Z,currentCategory:j,searchQuery:he,categoryCounts:pe,loading:ke,error:Se,paginatedMedia:xe,setCategory:me,clearSearch:Ce,updateSortBy:fe,editItem:Ie,closeEditModal:De,closeBulkAddModal:l,handleBulkAddItems:r,handleSaveItem:y,handleDeleteItem:a,logout:_,loadMedia:D,toggleFloatingMenu:V,addNewItem:te,bulkAddItems:re,importFromTxt:Ze,importFromAPI:Xe,createCollection:$e,exportMediaCollection:ze,exportAsCSV:Ye,exportAsJSON:He,downloadFile:Ge,deleteAllInCategory:lt,getCategoryDisplayName:qe,navigateToCalendar:rt,navigateToProfile:dt,processTxtContent:x,closeTxtImportResults:R,cleanup:Q,router:P}=gs(),F=G(()=>n.editMode),J=()=>{n.toggleEditMode()},W=async b=>{try{await n.updateItemRating(b.itemId,b.rating),console.log("âœ… Rating updated successfully:",b),Ne({type:"success",text:`Rating updated to ${b.rating}/10`})}catch(E){console.error("âŒ Failed to update rating:",E),Ne({type:"error",text:"Failed to update rating. Please try again."})}},Ue=G(()=>{try{return qe?qe(j.value):j.value}catch(b){return console.error("Error getting category display name:",b),j.value||"Unknown"}}),Re=G(()=>I.value.getFullYear()),ct=G(()=>I.value.getMonth()),xt=G(()=>I.value.toLocaleDateString("en-US",{month:"long"})),We=w([]),et=w(!1),tt=w(null),ut=G(()=>{const b=Re.value,E=ct.value,M=new Date(b,E,1),N=new Date(M),L=M.getDay(),q=L===0?6:L-1;N.setDate(N.getDate()-q);const Me=[],se=new Date;for(let at=0;at<42;at++){const ye=new Date(N);ye.setDate(N.getDate()+at);const ts=ye.getMonth()===E,ss=ye.toDateString()===se.toDateString(),as=ye.getDay()===0||ye.getDay()===6;Me.push({date:ye.getDate(),month:ye.getMonth(),year:ye.getFullYear(),fullDate:new Date(ye),isCurrentMonth:ts,isToday:ss,isWeekend:as,hasEvents:mt(ye),events:ft(ye)})}return Me}),Ct=G(()=>{const b=n.mediaData||[],E={totalItems:b.length,totalCollections:0,totalPlaytime:0,avgRating:0,categoryDistribution:{},ratingDistribution:{},platformDistribution:{},genreDistribution:{},recentActivity:[],airingSeries:[]};let M=0,N=0;return b.forEach(L=>{const q=L.category||"unknown";if(E.categoryDistribution[q]=(E.categoryDistribution[q]||0)+1,L.rating&&L.rating>0){const Me=Math.floor(L.rating);E.ratingDistribution[Me]=(E.ratingDistribution[Me]||0)+1,M+=L.rating,N++}if(L.platforms&&L.category==="game"&&L.platforms.split(",").map(se=>se.trim()).filter(se=>se).forEach(se=>{E.platformDistribution[se]=(E.platformDistribution[se]||0)+1}),L.genre&&(L.category==="series"||L.category==="movie")&&L.genre.split(",").map(se=>se.trim()).filter(se=>se).forEach(se=>{E.genreDistribution[se]=(E.genreDistribution[se]||0)+1}),L.spielzeit&&L.spielzeit>0&&(E.totalPlaytime+=L.spielzeit),L.category==="series"&&L.isAiring===!0&&E.airingSeries.push({title:L.title,nextSeason:L.nextSeason,nextSeasonRelease:L.nextSeasonRelease}),L.discovered){const Me=new Date(L.discovered),se=new Date;se.setDate(se.getDate()-30),Me>=se&&E.recentActivity.push({title:L.title,category:L.category,discovered:L.discovered})}}),N>0&&(E.avgRating=(M/N).toFixed(1)),E.totalPlaytime=Math.round(E.totalPlaytime/60),E.recentActivity.sort((L,q)=>new Date(q.discovered)-new Date(L.discovered)),E}),It=b=>b?new Date(b).toLocaleDateString():"",Dt=b=>{const E=Math.max(0,Math.min(5,parseInt(b)||0)),M="â˜…".repeat(E),N="â˜†".repeat(5-E);return M+N},At=b=>{me(b),te()},Tt=()=>{ie.value=!1,K.value=!0},Mt=()=>{ie.value=!0},Rt=b=>{ie.value=!1,D()},Et=()=>{K.value=!1,D()},gt=w(!1),Ut=()=>{gt.value=!1,Ne({type:"success",text:"Password changed successfully!"})},Lt=async()=>{u.value=!0,p.value=null;try{const b=await i.adminSetup();b.success?(console.log("âœ… Admin setup successful:",b),p.value={type:"success",text:`âœ… Admin created and logged in! User: ${b.user.name} (${b.user.email})`},await D(),setTimeout(()=>{p.value=null},5e3)):(console.log("â„¹ï¸ Admin already exists:",b),p.value={type:"info",text:`â„¹ï¸ ${b.message} (${b.admin_count} admin(s) exist)`},setTimeout(()=>{p.value=null},3e3))}catch(b){console.error("âŒ Admin setup failed:",b),p.value={type:"error",text:`âŒ Admin setup failed: ${b.message||"Unknown error"}`},setTimeout(()=>{p.value=null},5e3)}finally{u.value=!1}},Bt=async()=>{S.value=!0,T.value=null,C.value=[];try{const b=window.location.origin,E=await fetch(`${b}/api/check-db-users`,{headers:{Accept:"application/json","Content-Type":"application/json"}});if(!E.ok){const N=await E.text();console.error("âŒ Response not OK:",E.status,N),T.value={type:"error",text:`âŒ HTTP Error ${E.status}: ${N.substring(0,200)}`};return}let M;try{M=await E.json()}catch(N){const L=await E.text();console.error("âŒ JSON parse error:",N,"Response text:",L),T.value={type:"error",text:`âŒ Invalid JSON response: ${L.substring(0,200)}`};return}if(M.success)console.log("âœ… DB check successful:",M),C.value=M.users||[],T.value={type:"success",text:`âœ… Found ${M.count||0} user(s)`};else{console.error("âŒ DB check failed:",M);let N=`âŒ DB check failed: ${M.error||"Unknown error"}`;M.hint&&(N+=`
ðŸ’¡ Hint: ${M.hint}`),T.value={type:"error",text:N}}}catch(b){console.error("âŒ DB check failed:",b),T.value={type:"error",text:`âŒ DB check failed: ${b.message||"Unknown error"}`}}finally{S.value=!1}},Pt=()=>{console.log("ðŸ”¥ DEBUG: Direct admin navigation called!"),console.log("ðŸ”¥ DEBUG: Router object:",P);try{P.push("/admin"),console.log("ðŸ”¥ DEBUG: Successfully navigated to /admin!")}catch(b){console.error("ðŸ”¥ DEBUG: Error navigating to admin:",b)}},Ft=()=>{I.value=new Date(I.value.getFullYear(),I.value.getMonth()-1,1),g.value=null},Nt=()=>{I.value=new Date(I.value.getFullYear(),I.value.getMonth()+1,1),g.value=null},Gt=b=>{b.isCurrentMonth&&(g.value=b)},Wt=b=>b.fullDate.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),mt=b=>ht(b).length>0,ft=b=>ht(b).map(M=>({id:M.id,title:M.title,time:"Release",type:M.watchlistType||M.watchlist_type||"unknown",item:M})),ht=b=>n.mediaData.filter(M=>M.category==="watchlist"&&M.release).filter(M=>{if(!M.release)return!1;const N=new Date(M.release),L=new Date(b);return N.getFullYear()===L.getFullYear()&&N.getMonth()===L.getMonth()&&N.getDate()===L.getDate()}),Ot=()=>{var M,N;const b=((M=U.firstName)==null?void 0:M.charAt(0))||"U",E=((N=U.lastName)==null?void 0:N.charAt(0))||"S";return(b+E).toUpperCase()},Vt=()=>{var b;(b=ne.value)==null||b.click()},jt=b=>{const E=b.target.files[0];if(E){const M=new FileReader;M.onload=N=>{U.avatar=N.target.result},M.readAsDataURL(E)}},pt=async()=>{if(!j.value||j.value==="statistics"||j.value==="calendar"||j.value==="profile"){We.value=[];return}et.value=!0,tt.value=null;try{const b=await le.getGenres(j.value);if(b.success)We.value=b.genres||[];else throw new Error(b.error||"Failed to load genres")}catch(b){console.error("Failed to load genres:",b),tt.value=b.message||"Failed to load genres",We.value=[]}finally{et.value=!1}},zt=b=>{n.setGenres(b)},Yt=b=>{n.setExcludedGenres(b)},Ht=()=>{n.clearGenres(),n.clearExcludedGenres()},Ne=b=>{console.log("ðŸ“¢ Message:",b.type,b.text),b.type==="error"?e.showMessage("Error",b.text,"error"):e.showMessage("Success",b.text,"success")};Ee(j,b=>{b&&b!=="statistics"&&b!=="calendar"&&b!=="profile"?(pt(),n.clearGenres()):(We.value=[],n.clearGenres())},{immediate:!0});const qt=()=>{const b={profile:U,media:n.mediaData,settings:{language:U.language,timezone:U.timezone,dateFormat:U.dateFormat},exportDate:new Date().toISOString()},E=new Blob([JSON.stringify(b,null,2)],{type:"application/json"}),M=URL.createObjectURL(E),N=document.createElement("a");N.href=M,N.download=`media-library-backup-${new Date().toISOString().split("T")[0]}.json`,N.click(),URL.revokeObjectURL(M)},Jt=()=>{const b=document.createElement("input");b.type="file",b.accept=".json",b.onchange=E=>{const M=E.target.files[0];if(M){const N=new FileReader;N.onload=L=>{try{const q=JSON.parse(L.target.result);q.profile&&Object.assign(U,q.profile),q.media&&(n.mediaData=q.media,n.saveMedia()),q.settings&&Object.assign(U,q.settings),Je()}catch(q){console.error("Failed to import data:",q)}},N.readAsText(M)}},b.click()},Qt=()=>{const b={profile:U,media:n.mediaData,settings:{language:U.language,timezone:U.timezone,dateFormat:U.dateFormat},backupDate:new Date().toISOString()},E=`backup_${Date.now()}`;localStorage.setItem(E,JSON.stringify(b)),alert("Backup created successfully!")},Kt=()=>{alert("Cache cleared successfully!")},Zt=()=>{confirm("Are you sure you want to reset all settings?")&&(Object.assign(U,{firstName:"",lastName:"",displayName:"",email:"",bio:"",avatar:"",language:"en",timezone:"UTC",dateFormat:"MM/DD/YYYY",booksApiProvider:"wikipedia",enableGoogleBooksFallback:!0}),Je())},Xt=()=>{confirm("Are you sure you want to clear all data? This cannot be undone!")&&(localStorage.clear(),window.location.reload())},st=w(!1),$t=async()=>{if(!(!confirm(`âš ï¸ WARNING: This will permanently delete your account and ALL associated data (media items, collections, etc.). This action CANNOT be undone!

Are you absolutely sure you want to delete your account?`)||!confirm("This is your last chance! Are you REALLY sure you want to delete your account?"))){st.value=!0;try{const M=window.location.origin,N=i.token,q=await(await fetch(`${M}/api/account`,{method:"DELETE",headers:{Authorization:`Bearer ${N}`,"Content-Type":"application/json",Accept:"application/json"}})).json();q.success?(await i.logout(),Ne({type:"success",text:"Account deleted successfully. You will be redirected..."}),setTimeout(()=>{window.location.href="/"},2e3)):Ne({type:"error",text:`Failed to delete account: ${q.error||"Unknown error"}`})}catch(M){console.error("âŒ Account deletion failed:",M),Ne({type:"error",text:`Failed to delete account: ${M.message||"Unknown error"}`})}finally{st.value=!1}}},Je=()=>{localStorage.setItem("profileData",JSON.stringify(U))},es=()=>{Je(),alert("All changes saved successfully!")};return it(async()=>{var b,E;try{await D();const M=localStorage.getItem("profileData");if(M)try{const q=JSON.parse(M);Object.assign(U,q)}catch(q){console.error("Failed to load profile data:",q)}i.user&&(U.firstName=((b=i.user.name)==null?void 0:b.split(" ")[0])||"",U.lastName=((E=i.user.name)==null?void 0:E.split(" ").slice(1).join(" "))||"",U.email=i.user.email||"");const N=new Date,L=ut.value.find(q=>q.isToday&&q.isCurrentMonth);if(L&&(g.value=L),ge.value)try{n.initializeRealtimeUpdates()}catch(q){console.error("Error initializing realtime updates:",q)}}catch(M){console.error("Error during initialization:",M)}}),bt(()=>{if(ge.value)try{n.cleanupRealtimeUpdates()}catch(b){console.error("Error cleaning up realtime updates:",b)}Q()}),{showLoginModal:ie,showRegisterModal:K,showEditModal:de,showChangePasswordModal:gt,showFloatingMenu:ue,showBulkAddModal:h,showTxtImportModal:O,showTxtImportResults:Ae,editingItem:Te,sortBy:ce,categories:we,txtImportResults:_e,adminSetupLoading:u,adminSetupMessage:p,dbCheckLoading:S,dbCheckMessage:T,dbCheckUsers:C,editMode:F,currentDate:I,selectedDay:g,weekdays:Y,avatarInput:ne,profileData:U,isLoggedIn:ge,isAdmin:z,userName:Z,currentCategory:j,currentCategoryDisplayName:Ue,searchQuery:he,categoryCounts:pe,loading:ke,error:Se,paginatedMedia:xe,selectedGenres:G(()=>n.selectedGenres),genres:We,genreLoading:et,genreError:tt,currentYear:Re,currentMonth:ct,currentMonthName:xt,calendarDays:ut,setCategory:me,clearSearch:Ce,updateSortBy:fe,navigateToCalendar:rt,navigateToProfile:dt,addItemFromSidebar:At,editItem:Ie,switchToRegister:Tt,showAdminLogin:Mt,handleLoginSuccess:Rt,handleRegisterSuccess:Et,handlePasswordChangeSuccess:Ut,handleAdminSetup:Lt,handleCheckDb:Bt,debugNavigateToAdmin:Pt,closeEditModal:De,closeBulkAddModal:l,handleBulkAddItems:r,handleSaveItem:y,handleDeleteItem:a,logout:_,loadMedia:D,toggleFloatingMenu:V,addNewItem:te,bulkAddItems:re,importFromTxt:Ze,importFromAPI:Xe,createCollection:$e,exportMediaCollection:ze,exportAsCSV:Ye,exportAsJSON:He,downloadFile:Ge,deleteAllInCategory:lt,getCategoryDisplayName:qe,processTxtContent:x,closeTxtImportResults:R,handleGenresUpdated:zt,handleGenresExcluded:Yt,handleGenresCleared:Ht,loadGenres:pt,toggleEditMode:J,handleRatingChanged:W,previousMonth:Ft,nextMonth:Nt,selectDay:Gt,formatSelectedDay:Wt,hasEventsForDate:mt,getEventsForDate:ft,getInitials:Ot,changeAvatar:Vt,handleAvatarChange:jt,exportData:qt,importData:Jt,createBackup:Qt,clearCache:Kt,resetSettings:Zt,clearAllData:Xt,deleteAccount:$t,deleteAccountLoading:st,saveProfileData:Je,saveAllChanges:es,messageStore:e,confirmStore:o,inputStore:t,statistics:Ct,formatDate:It,getRatingStars:Dt,sidebarStore:c,safeSidebarStore:d}}},Wr={class:"vue-app"},Or={class:"main-content"},Vr={class:"content-area"},jr={key:1,class:"error"},zr={key:2},Yr={key:0,class:"calendar-view"},Hr={class:"calendar-header"},qr=["disabled"],Jr={class:"month-year-display"},Qr={class:"month-name"},Kr={class:"year"},Zr=["disabled"],Xr={class:"calendar-container"},$r={class:"calendar-grid"},ed=["onClick"],td={class:"day-number"},sd={key:0,class:"event-indicator"},ad={key:0,class:"event-count"},od={key:0,class:"selected-day-info"},nd={class:"day-events"},id={key:0,class:"no-events"},ld={key:1,class:"events-list"},rd={class:"event-header"},dd={class:"event-time"},cd={class:"event-type-badge"},ud={class:"event-title"},gd={key:0,class:"event-platforms"},md={key:1,class:"event-genre"},fd={key:1,class:"profile-container"},hd={class:"profile-header"},pd={class:"profile-avatar-section"},vd=["src"],yd={key:1,class:"avatar-initials"},bd={class:"profile-info-header"},wd={class:"profile-stats"},_d={class:"stat-item"},kd={class:"stat-number"},Sd={class:"stat-item"},xd={class:"stat-number"},Cd={class:"settings-sections"},Id={class:"settings-section"},Dd={class:"section-content"},Ad={class:"form-row"},Td={class:"form-group"},Md={class:"form-group"},Rd={class:"form-group"},Ed={class:"form-group"},Ud={class:"form-group"},Ld={class:"settings-section"},Bd={class:"section-content"},Pd={class:"form-row"},Fd={class:"form-group"},Nd={class:"form-group"},Gd={class:"form-row"},Wd={class:"form-group"},Od={class:"form-group"},Vd={class:"form-row"},jd={class:"form-group"},zd={class:"checkbox-container"},Yd={class:"settings-section"},Hd={class:"section-content"},qd={class:"data-actions"},Jd={class:"settings-section danger-zone"},Qd={class:"section-content"},Kd={class:"danger-actions"},Zd=["disabled"],Xd={class:"btn-text"},$d={key:2,class:"statistics-container"},ec={class:"statistics-header"},tc={class:"refresh-controls"},sc={class:"statistics-content"},ac={class:"stats-summary"},oc={class:"summary-card"},nc={class:"summary-number"},ic={class:"summary-card"},lc={class:"summary-number"},rc={class:"summary-card"},dc={class:"summary-number"},cc={class:"summary-card"},uc={class:"summary-number"},gc={class:"chart-container"},mc={class:"category-stats"},fc={class:"category-name"},hc={class:"category-bar"},pc={class:"category-count"},vc={class:"chart-container"},yc={class:"rating-stats"},bc={class:"rating-stars"},wc={class:"rating-bar"},_c={class:"rating-count"},kc={class:"chart-container"},Sc={class:"platform-stats"},xc={class:"platform-name"},Cc={class:"platform-bar"},Ic={class:"platform-count"},Dc={class:"chart-container"},Ac={class:"genre-stats"},Tc={class:"genre-name"},Mc={class:"genre-bar"},Rc={class:"genre-count"},Ec={class:"chart-container"},Uc={class:"recent-activity"},Lc={class:"activity-title"},Bc={class:"activity-category"},Pc={class:"activity-date"},Fc={class:"chart-container"},Nc={class:"airing-series"},Gc={class:"airing-title"},Wc={class:"airing-next"},Oc={class:"airing-date"},Vc={key:0,class:"admin-setup-container"},jc=["disabled"],zc={key:0},Yc={key:1},Hc={class:"db-check-container",style:{position:"fixed",top:"80px",right:"20px","z-index":"1001"}},qc=["disabled"],Jc={key:0},Qc={key:1},Kc={key:1,class:"db-check-users-list"},Zc={class:"user-field"},Xc={class:"user-field"},$c={class:"user-field"};function eu(n,e,o,t,i,c){const d=ae("Sidebar"),u=ae("MainHeader"),p=ae("LoadingSpinner"),S=ae("MediaItem"),T=ae("LoginModal"),C=ae("RegisterModal"),I=ae("ChangePasswordModal"),g=ae("EditModal"),Y=ae("BulkAddModal"),ne=ae("TxtImportModal"),U=ae("TxtImportResultsModal"),ie=ae("FloatingActionButton"),K=ae("MessageBox"),de=ae("ConfirmDialog"),ue=ae("InputDialog");return m(),f("div",Wr,[s("div",{class:H(["mobile-overlay",{show:t.safeSidebarStore.mobileOpen}]),onClick:e[0]||(e[0]=(...h)=>t.safeSidebarStore.closeMobileSidebar&&t.safeSidebarStore.closeMobileSidebar(...h))},null,2),ve(d,{collapsed:t.safeSidebarStore.collapsed,"mobile-open":t.safeSidebarStore.mobileOpen,"is-logged-in":t.isLoggedIn,"is-admin":t.isAdmin,"user-name":t.userName,"current-category":t.currentCategory,"category-counts":t.categoryCounts,categories:t.categories,"selected-genres":t.selectedGenres,"excluded-genres":n.excludedGenres,genres:t.genres,"genre-loading":t.genreLoading,"genre-error":t.genreError,onToggle:t.safeSidebarStore.toggleSidebar,onSetCategory:t.setCategory,onNavigateToCalendar:t.navigateToCalendar,onNavigateToProfile:t.navigateToProfile,onNavigateToAdmin:t.debugNavigateToAdmin,onAddItem:t.addItemFromSidebar,onShowLogin:e[1]||(e[1]=h=>t.showLoginModal=!0),onShowRegister:e[2]||(e[2]=h=>t.showRegisterModal=!0),onShowAdminLogin:t.showAdminLogin,onLogout:t.logout,onChangePassword:e[3]||(e[3]=h=>t.showChangePasswordModal=!0),onDeleteAccount:t.deleteAccount,onGenresUpdated:t.handleGenresUpdated,onGenresExcluded:t.handleGenresExcluded,onGenresCleared:t.handleGenresCleared,onLoadGenres:t.loadGenres},null,8,["collapsed","mobile-open","is-logged-in","is-admin","user-name","current-category","category-counts","categories","selected-genres","excluded-genres","genres","genre-loading","genre-error","onToggle","onSetCategory","onNavigateToCalendar","onNavigateToProfile","onNavigateToAdmin","onAddItem","onShowAdminLogin","onLogout","onDeleteAccount","onGenresUpdated","onGenresExcluded","onGenresCleared","onLoadGenres"]),s("div",Or,[ve(u,{"search-query":t.searchQuery,"onUpdate:searchQuery":e[4]||(e[4]=h=>t.searchQuery=h),"sort-by":t.sortBy,"edit-mode":t.editMode,onToggleMobileSidebar:t.safeSidebarStore.toggleMobileSidebar,onClearSearch:t.clearSearch,onToggleEditMode:t.toggleEditMode,"onUpdate:sortBy":t.updateSortBy},null,8,["search-query","sort-by","edit-mode","onToggleMobileSidebar","onClearSearch","onToggleEditMode","onUpdate:sortBy"]),s("main",Vr,[t.loading?(m(),Le(p,{key:0,message:"Loading media data..."})):t.error?(m(),f("div",jr,[s("p",null,v(t.error),1),s("button",{onClick:e[5]||(e[5]=(...h)=>t.loadMedia&&t.loadMedia(...h))},"Retry")])):(m(),f("div",zr,[t.currentCategory==="calendar"?(m(),f("div",Yr,[s("div",Hr,[s("button",{class:"month-nav-btn",onClick:e[6]||(e[6]=(...h)=>t.previousMonth&&t.previousMonth(...h)),disabled:n.isLoading},[...e[34]||(e[34]=[s("span",{class:"nav-icon"},"â€¹",-1)])],8,qr),s("div",Jr,[s("h2",Qr,v(t.currentMonthName),1),s("span",Kr,v(t.currentYear),1)]),s("button",{class:"month-nav-btn",onClick:e[7]||(e[7]=(...h)=>t.nextMonth&&t.nextMonth(...h)),disabled:n.isLoading},[...e[35]||(e[35]=[s("span",{class:"nav-icon"},"â€º",-1)])],8,Zr)]),s("div",Xr,[s("div",$r,[(m(!0),f(X,null,$(t.weekdays,h=>(m(),f("div",{class:"weekday-header",key:h},v(h),1))),128)),(m(!0),f(X,null,$(t.calendarDays,h=>(m(),f("div",{key:`${h.date}-${h.month}`,class:H(["calendar-day",{"other-month":!h.isCurrentMonth,today:h.isToday,weekend:h.isWeekend,"has-events":h.hasEvents}]),onClick:O=>t.selectDay(h)},[s("span",td,v(h.day),1),h.hasEvents?(m(),f("div",sd,[e[36]||(e[36]=s("div",{class:"event-dot"},null,-1)),h.events&&h.events.length>1?(m(),f("span",ad,v(h.events.length),1)):k("",!0)])):k("",!0)],10,ed))),128))])]),t.selectedDay?(m(),f("div",od,[s("h3",null,v(t.formatSelectedDay(t.selectedDay)),1),s("div",nd,[!t.selectedDay.events||t.selectedDay.events.length===0?(m(),f("p",id," No watchlist releases scheduled for this day ")):(m(),f("div",ld,[(m(!0),f(X,null,$(t.selectedDay.events,h=>(m(),f("div",{key:h.id,class:H(["event-item",`event-${h.type}`])},[s("div",rd,[s("span",dd,v(h.time),1),s("span",cd,v(h.type),1)]),s("span",ud,v(h.title),1),h.item.platforms?(m(),f("div",gd,v(h.item.platforms),1)):k("",!0),h.item.genre?(m(),f("div",md,v(h.item.genre),1)):k("",!0)],2))),128))]))])])):k("",!0)])):t.currentCategory==="profile"?(m(),f("div",fd,[s("div",hd,[s("div",pd,[s("div",{class:"profile-avatar-large",onClick:e[8]||(e[8]=(...h)=>t.changeAvatar&&t.changeAvatar(...h))},[t.profileData.avatar?(m(),f("img",{key:0,src:t.profileData.avatar,alt:"Profile Picture"},null,8,vd)):(m(),f("span",yd,v(t.getInitials()),1))]),s("input",{type:"file",ref:"avatarInput",accept:"image/*",onChange:e[9]||(e[9]=(...h)=>t.handleAvatarChange&&t.handleAvatarChange(...h)),style:{display:"none"}},null,544)]),s("div",bd,[s("h2",null,v(t.profileData.displayName||t.profileData.firstName+" "+t.profileData.lastName||"User"),1),s("p",null,v(t.profileData.email||"user@example.com"),1),s("div",wd,[s("div",_d,[s("span",kd,v(n.totalItems),1),e[37]||(e[37]=s("span",{class:"stat-label"},"Total Items",-1))]),s("div",Sd,[s("span",xd,v(new Date().getFullYear()),1),e[38]||(e[38]=s("span",{class:"stat-label"},"Member Since",-1))])])])]),s("div",Cd,[s("div",Id,[e[44]||(e[44]=s("div",{class:"section-header"},[s("h3",null,"Personal Information"),s("p",null,"Manage your personal details and account information")],-1)),s("div",Dd,[s("div",Ad,[s("div",Td,[e[39]||(e[39]=s("label",{for:"firstName"},"First Name",-1)),A(s("input",{type:"text",id:"firstName","onUpdate:modelValue":e[10]||(e[10]=h=>t.profileData.firstName=h),placeholder:"Enter your first name"},null,512),[[B,t.profileData.firstName]])]),s("div",Md,[e[40]||(e[40]=s("label",{for:"lastName"},"Last Name",-1)),A(s("input",{type:"text",id:"lastName","onUpdate:modelValue":e[11]||(e[11]=h=>t.profileData.lastName=h),placeholder:"Enter your last name"},null,512),[[B,t.profileData.lastName]])])]),s("div",Rd,[e[41]||(e[41]=s("label",{for:"displayName"},"Display Name",-1)),A(s("input",{type:"text",id:"displayName","onUpdate:modelValue":e[12]||(e[12]=h=>t.profileData.displayName=h),placeholder:"How others see your name"},null,512),[[B,t.profileData.displayName]])]),s("div",Ed,[e[42]||(e[42]=s("label",{for:"email"},"Email Address",-1)),A(s("input",{type:"email",id:"email","onUpdate:modelValue":e[13]||(e[13]=h=>t.profileData.email=h),placeholder:"your.email@example.com"},null,512),[[B,t.profileData.email]])]),s("div",Ud,[e[43]||(e[43]=s("label",{for:"bio"},"Bio",-1)),A(s("textarea",{id:"bio","onUpdate:modelValue":e[14]||(e[14]=h=>t.profileData.bio=h),placeholder:"Tell us about yourself...",rows:"4"},null,512),[[B,t.profileData.bio]])])])]),s("div",Ld,[e[56]||(e[56]=s("div",{class:"section-header"},[s("h3",null,"Preferences"),s("p",null,"Customize your application experience")],-1)),s("div",Bd,[s("div",Pd,[s("div",Fd,[e[46]||(e[46]=s("label",{for:"language"},"Language",-1)),A(s("select",{id:"language","onUpdate:modelValue":e[15]||(e[15]=h=>t.profileData.language=h)},[...e[45]||(e[45]=[s("option",{value:"en"},"English",-1),s("option",{value:"de"},"Deutsch",-1),s("option",{value:"fr"},"FranÃ§ais",-1),s("option",{value:"es"},"EspaÃ±ol",-1)])],512),[[be,t.profileData.language]])]),s("div",Nd,[e[48]||(e[48]=s("label",{for:"timezone"},"Timezone",-1)),A(s("select",{id:"timezone","onUpdate:modelValue":e[16]||(e[16]=h=>t.profileData.timezone=h)},[...e[47]||(e[47]=[s("option",{value:"UTC"},"UTC",-1),s("option",{value:"Europe/Berlin"},"Europe/Berlin",-1),s("option",{value:"America/New_York"},"America/New_York",-1),s("option",{value:"America/Los_Angeles"},"America/Los_Angeles",-1)])],512),[[be,t.profileData.timezone]])])]),s("div",Gd,[s("div",Wd,[e[50]||(e[50]=s("label",{for:"dateFormat"},"Date Format",-1)),A(s("select",{id:"dateFormat","onUpdate:modelValue":e[17]||(e[17]=h=>t.profileData.dateFormat=h)},[...e[49]||(e[49]=[s("option",{value:"MM/DD/YYYY"},"MM/DD/YYYY",-1),s("option",{value:"DD/MM/YYYY"},"DD/MM/YYYY",-1),s("option",{value:"YYYY-MM-DD"},"YYYY-MM-DD",-1)])],512),[[be,t.profileData.dateFormat]])]),s("div",Od,[e[52]||(e[52]=s("label",{for:"booksApiProvider"},"Books API Provider",-1)),A(s("select",{id:"booksApiProvider","onUpdate:modelValue":e[18]||(e[18]=h=>t.profileData.booksApiProvider=h)},[...e[51]||(e[51]=[s("option",{value:"wikipedia"},"Wikipedia (Primary)",-1),s("option",{value:"google_books"},"Google Books (Fallback)",-1),s("option",{value:"both"},"Both (Wikipedia + Google Books)",-1)])],512),[[be,t.profileData.booksApiProvider]])])]),s("div",Vd,[s("div",jd,[e[54]||(e[54]=s("label",{for:"enableGoogleBooksFallback"},"Enable Google Books Fallback",-1)),s("div",zd,[A(s("input",{type:"checkbox",id:"enableGoogleBooksFallback","onUpdate:modelValue":e[19]||(e[19]=h=>t.profileData.enableGoogleBooksFallback=h)},null,512),[[yt,t.profileData.enableGoogleBooksFallback]]),e[53]||(e[53]=s("label",{for:"enableGoogleBooksFallback",class:"checkbox-label"}," Use Google Books as fallback when Wikipedia search fails ",-1))])]),e[55]||(e[55]=s("div",{class:"form-group"},null,-1))])])]),s("div",Yd,[e[61]||(e[61]=s("div",{class:"section-header"},[s("h3",null,"Data Management"),s("p",null,"Manage your data and account")],-1)),s("div",Hd,[s("div",qd,[s("button",{class:"data-btn export-btn",onClick:e[20]||(e[20]=(...h)=>t.exportData&&t.exportData(...h))},[...e[57]||(e[57]=[s("span",{class:"btn-icon"},"ðŸ“¦",-1),s("span",{class:"btn-text"},"Export All Data",-1),s("span",{class:"btn-description"},"Download your complete media library",-1)])]),s("button",{class:"data-btn import-btn",onClick:e[21]||(e[21]=(...h)=>t.importData&&t.importData(...h))},[...e[58]||(e[58]=[s("span",{class:"btn-icon"},"ðŸ“¥",-1),s("span",{class:"btn-text"},"Import Data",-1),s("span",{class:"btn-description"},"Import data from a backup file",-1)])]),s("button",{class:"data-btn backup-btn",onClick:e[22]||(e[22]=(...h)=>t.createBackup&&t.createBackup(...h))},[...e[59]||(e[59]=[s("span",{class:"btn-icon"},"ðŸ’¾",-1),s("span",{class:"btn-text"},"Create Backup",-1),s("span",{class:"btn-description"},"Create a local backup of your data",-1)])]),s("button",{class:"data-btn cache-btn",onClick:e[23]||(e[23]=(...h)=>t.clearCache&&t.clearCache(...h))},[...e[60]||(e[60]=[s("span",{class:"btn-icon"},"ðŸ—‘ï¸",-1),s("span",{class:"btn-text"},"Clear Cache",-1),s("span",{class:"btn-description"},"Clear temporary files and cache",-1)])])])])]),s("div",Jd,[e[66]||(e[66]=s("div",{class:"section-header"},[s("h3",null,"Danger Zone"),s("p",null,"Irreversible and destructive actions")],-1)),s("div",Qd,[s("div",Kd,[s("button",{class:"danger-btn reset-btn",onClick:e[24]||(e[24]=(...h)=>t.resetSettings&&t.resetSettings(...h))},[...e[62]||(e[62]=[s("span",{class:"btn-icon"},"ðŸ”„",-1),s("span",{class:"btn-text"},"Reset All Settings",-1),s("span",{class:"btn-description"},"Reset all settings to default values",-1)])]),s("button",{class:"danger-btn clear-btn",onClick:e[25]||(e[25]=(...h)=>t.clearAllData&&t.clearAllData(...h))},[...e[63]||(e[63]=[s("span",{class:"btn-icon"},"ðŸ—‘ï¸",-1),s("span",{class:"btn-text"},"Clear All Data",-1),s("span",{class:"btn-description"},"Permanently delete all your data",-1)])]),s("button",{class:"danger-btn delete-account-btn",onClick:e[26]||(e[26]=(...h)=>t.deleteAccount&&t.deleteAccount(...h)),disabled:t.deleteAccountLoading},[e[64]||(e[64]=s("span",{class:"btn-icon"},"âš ï¸",-1)),s("span",Xd,v(t.deleteAccountLoading?"Deleting...":"Delete Account"),1),e[65]||(e[65]=s("span",{class:"btn-description"},"Permanently delete your account and all associated data",-1))],8,Zd)])])])])])):t.currentCategory==="statistics"?(m(),f("div",$d,[s("div",ec,[e[67]||(e[67]=s("h1",null,"ðŸ“Š Media Library Statistics",-1)),e[68]||(e[68]=s("p",null,"Ãœbersicht Ã¼ber deine Media Collection",-1)),s("div",tc,[s("button",{class:"refresh-btn",onClick:e[27]||(e[27]=(...h)=>t.loadMedia&&t.loadMedia(...h))},"ðŸ”„ Refresh Statistics")])]),s("div",sc,[s("div",ac,[s("div",oc,[s("div",nc,v(t.statistics.totalItems),1),e[69]||(e[69]=s("div",{class:"summary-label"},"Total Items",-1))]),s("div",ic,[s("div",lc,v(t.statistics.totalCollections),1),e[70]||(e[70]=s("div",{class:"summary-label"},"Collections",-1))]),s("div",rc,[s("div",dc,v(t.statistics.totalPlaytime)+"h",1),e[71]||(e[71]=s("div",{class:"summary-label"},"Total Playtime",-1))]),s("div",cc,[s("div",uc,v(t.statistics.avgRating),1),e[72]||(e[72]=s("div",{class:"summary-label"},"Avg Rating",-1))])]),s("div",gc,[e[73]||(e[73]=s("h3",{class:"chart-title"},"ðŸ“ˆ Category Distribution",-1)),s("div",mc,[(m(!0),f(X,null,$(t.statistics.categoryDistribution,(h,O)=>(m(),f("div",{key:O,class:"category-stat"},[s("div",fc,v(O),1),s("div",hc,[s("div",{class:"category-fill",style:Be({width:`${h/t.statistics.totalItems*100}%`})},null,4)]),s("div",pc,v(h)+" ("+v((h/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",vc,[e[74]||(e[74]=s("h3",{class:"chart-title"},"â­ Rating Distribution",-1)),s("div",yc,[(m(!0),f(X,null,$(t.statistics.ratingDistribution,(h,O)=>(m(),f("div",{key:O,class:"rating-stat"},[s("div",bc,v(t.getRatingStars(O)),1),s("div",wc,[s("div",{class:"rating-fill",style:Be({width:`${h/t.statistics.totalItems*100}%`})},null,4)]),s("div",_c,v(h)+" ("+v((h/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",kc,[e[75]||(e[75]=s("h3",{class:"chart-title"},"ðŸŽ® Platform Distribution",-1)),s("div",Sc,[(m(!0),f(X,null,$(t.statistics.platformDistribution,(h,O)=>(m(),f("div",{key:O,class:"platform-stat"},[s("div",xc,v(O),1),s("div",Cc,[s("div",{class:"platform-fill",style:Be({width:`${h/t.statistics.totalItems*100}%`})},null,4)]),s("div",Ic,v(h)+" ("+v((h/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",Dc,[e[76]||(e[76]=s("h3",{class:"chart-title"},"ðŸŽ­ Top Genres",-1)),s("div",Ac,[(m(!0),f(X,null,$(t.statistics.genreDistribution,(h,O)=>(m(),f("div",{key:O,class:"genre-stat"},[s("div",Tc,v(O),1),s("div",Mc,[s("div",{class:"genre-fill",style:Be({width:`${h/t.statistics.totalItems*100}%`})},null,4)]),s("div",Rc,v(h)+" ("+v((h/t.statistics.totalItems*100).toFixed(1))+"%)",1)]))),128))])]),s("div",Ec,[e[77]||(e[77]=s("h3",{class:"chart-title"},"ðŸ“… Recent Activity",-1)),s("div",Uc,[(m(!0),f(X,null,$(t.statistics.recentActivity,h=>(m(),f("div",{key:h.title,class:"activity-item"},[s("div",Lc,v(h.title),1),s("div",Bc,v(h.category),1),s("div",Pc,v(t.formatDate(h.discovered)),1)]))),128))])]),s("div",Fc,[e[78]||(e[78]=s("h3",{class:"chart-title"},"ðŸ“º Currently Airing Series",-1)),s("div",Nc,[(m(!0),f(X,null,$(t.statistics.airingSeries,h=>(m(),f("div",{key:h.title,class:"airing-item"},[s("div",Gc,v(h.title),1),s("div",Wc,"Next: Season "+v(h.nextSeason),1),s("div",Oc,v(h.nextSeasonRelease?t.formatDate(h.nextSeasonRelease):"TBA"),1)]))),128))])])])])):(m(),f("div",{key:3,class:H(["grid",{"edit-mode":t.editMode}])},[(m(!0),f(X,null,$(t.paginatedMedia,h=>(m(),Le(S,{key:h.id,item:h,"edit-mode":t.editMode,onEdit:t.editItem,onWatchlistToggled:n.handleWatchlistToggled,onShowMessage:n.showMessage,onRatingChanged:t.handleRatingChanged},null,8,["item","edit-mode","onEdit","onWatchlistToggled","onShowMessage","onRatingChanged"]))),128))],2))]))])]),t.isLoggedIn?k("",!0):(m(),f("div",Vc,[s("button",{onClick:e[28]||(e[28]=(...h)=>t.handleAdminSetup&&t.handleAdminSetup(...h)),disabled:t.adminSetupLoading,class:"admin-setup-btn",title:"Setup Admin Account (Creates admin account with default password)"},[t.adminSetupLoading?(m(),f("span",zc,"ðŸ”§ Setting up...")):(m(),f("span",Yc,"ðŸ”§ Admin Setup"))],8,jc),t.adminSetupMessage?(m(),f("div",{key:0,class:H(["admin-setup-message",t.adminSetupMessage.type])},v(t.adminSetupMessage.text),3)):k("",!0)])),s("div",Hc,[s("button",{onClick:e[29]||(e[29]=(...h)=>t.handleCheckDb&&t.handleCheckDb(...h)),disabled:t.dbCheckLoading,class:"db-check-btn",title:"Check Database - Get all user login data",style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",color:"#1a1a1a",border:"none",padding:"12px 20px","border-radius":"8px","font-size":"14px","font-weight":"600",cursor:"pointer","box-shadow":"0 4px 15px rgba(245, 87, 108, 0.3)"}},[t.dbCheckLoading?(m(),f("span",Jc,"ðŸ” Checking...")):(m(),f("span",Qc,"ðŸ” Check DB"))],8,qc),t.dbCheckMessage?(m(),f("div",{key:0,class:H(["db-check-message",t.dbCheckMessage.type])},v(t.dbCheckMessage.text),3)):k("",!0),t.dbCheckUsers&&t.dbCheckUsers.length>0?(m(),f("div",Kc,[e[82]||(e[82]=s("h3",null,"User Login Daten:",-1)),(m(!0),f(X,null,$(t.dbCheckUsers,h=>(m(),f("div",{key:h.id,class:"db-check-user-item"},[s("div",Zc,[e[79]||(e[79]=s("strong",null,"Email:",-1)),Pe(" "+v(h.email),1)]),s("div",Xc,[e[80]||(e[80]=s("strong",null,"Username:",-1)),Pe(" "+v(h.username||"N/A"),1)]),s("div",$c,[e[81]||(e[81]=s("strong",null,"Password (hash):",-1)),Pe(" "+v(h.password),1)])]))),128))])):k("",!0)]),t.showLoginModal?(m(),Le(T,{key:1,onClose:e[30]||(e[30]=h=>t.showLoginModal=!1),onSuccess:t.handleLoginSuccess,onSwitchToRegister:t.switchToRegister},null,8,["onSuccess","onSwitchToRegister"])):k("",!0),t.showRegisterModal?(m(),Le(C,{key:2,onClose:e[31]||(e[31]=h=>t.showRegisterModal=!1),onSuccess:t.handleRegisterSuccess},null,8,["onSuccess"])):k("",!0),t.showChangePasswordModal?(m(),Le(I,{key:3,onClose:e[32]||(e[32]=h=>t.showChangePasswordModal=!1),onSuccess:t.handlePasswordChangeSuccess},null,8,["onSuccess"])):k("",!0),t.showEditModal?(m(),Le(g,{key:4,item:t.editingItem,"current-category":t.currentCategory,onClose:t.closeEditModal,onSave:t.handleSaveItem,onDelete:t.handleDeleteItem},null,8,["item","current-category","onClose","onSave","onDelete"])):k("",!0),ve(Y,{show:t.showBulkAddModal,"current-category":t.currentCategory,onClose:t.closeBulkAddModal},null,8,["show","current-category","onClose"]),ve(ne,{show:t.showTxtImportModal,onClose:e[33]||(e[33]=h=>t.showTxtImportModal=!1),onFileProcessed:t.processTxtContent},null,8,["show","onFileProcessed"]),ve(U,{show:t.showTxtImportResults,results:t.txtImportResults,onClose:t.closeTxtImportResults},null,8,["show","results","onClose"]),ve(ie,{"show-menu":t.showFloatingMenu,"show-delete-all":t.isLoggedIn&&t.currentCategory!=="all"&&t.categoryCounts[t.currentCategory]>0,"category-name":t.currentCategoryDisplayName,"item-count":t.categoryCounts[t.currentCategory]||0,onToggleMenu:t.toggleFloatingMenu,onAddNewItem:t.addNewItem,onBulkAddItems:t.bulkAddItems,onImportFromTxt:t.importFromTxt,onImportFromApi:t.importFromAPI,onCreateCollection:t.createCollection,onDeleteAllInCategory:t.deleteAllInCategory},null,8,["show-menu","show-delete-all","category-name","item-count","onToggleMenu","onAddNewItem","onBulkAddItems","onImportFromTxt","onImportFromApi","onCreateCollection","onDeleteAllInCategory"]),ve(K,{show:t.messageStore.show,type:t.messageStore.type,title:t.messageStore.title,message:t.messageStore.message,details:t.messageStore.details,onClose:t.messageStore.closeMessage},null,8,["show","type","title","message","details","onClose"]),ve(de,{show:t.confirmStore.show,title:t.confirmStore.title,message:t.confirmStore.message,onConfirm:t.confirmStore.confirm,onClose:t.confirmStore.cancel},null,8,["show","title","message","onConfirm","onClose"]),ve(ue,{show:t.inputStore.show,title:t.inputStore.title,message:t.inputStore.message,placeholder:t.inputStore.placeholder,"input-type":t.inputStore.inputType,"default-value":t.inputStore.defaultValue,onConfirm:t.inputStore.confirm,onClose:t.inputStore.cancel},null,8,["show","title","message","placeholder","input-type","default-value","onConfirm","onClose"])])}const su=ee(Gr,[["render",eu],["__scopeId","data-v-0620aaf2"]]);export{su as default};
