import{_ as ie,b as h,e as t,z as k,A as I,f as p,n as ce,B as F,j as de,l as ge,x as ue,t as i,g as R,F as me,m as ve,a as he,r as d,c as b,C as be,p as L,u as fe,o as g}from"./index-uLsN5JDP.js";import{u as ye}from"./media-CKP7GJ5i.js";import{u as Ce}from"./message-C0FehQbN.js";import{R as we,L as Se,M as Te,S as Me}from"./RegisterModal-CxPViVok.js";const pe={name:"Features",components:{Sidebar:Me,MainHeader:Te,LoginModal:Se,RegisterModal:we},setup(){const r=fe(),o=he(),a=ye(),e=Ce(),w=d(!1),c=d(!1),S=d(!1),T=d(!1),f=d(""),y=d(!1),s=d(!1),m=d(null),u=d(""),M=b(()=>o.isLoggedIn),E=b(()=>o.userName),D=b(()=>a.currentCategory),N=b(()=>a.categoryCounts),A=b(()=>a.platforms),B=b(()=>a.genres),z=b(()=>[{key:"game",name:"Games",icon:"üéÆ"},{key:"series",name:"Series",icon:"üì∫"},{key:"movie",name:"Movies",icon:"üé¨"},{key:"buecher",name:"B√ºcher",icon:"üìö"},{key:"watchlist",name:"Watchlist",icon:"‚ù§Ô∏è"}]),P=()=>{w.value=!w.value},U=()=>{c.value=!c.value},x=()=>{c.value=!1},G=n=>{a.setCategory(n)},V=()=>{a.setSearchQuery("")},H=n=>{a.togglePlatformFilter(n)},K=n=>{a.toggleGenreFilter(n)},O=()=>{a.toggleAiringFilter()},Q=n=>{r.push("/")},j=async()=>{await o.logout(),e.showMessage("Erfolgreich abgemeldet","success")},q=()=>{r.push("/statistics"),c.value=!1},W=()=>{r.push("/calendar"),c.value=!1},J=()=>{r.push("/features"),c.value=!1},X=()=>{r.push("/profile"),c.value=!1},Y=async()=>{if(f.value.trim()){y.value=!0,u.value="",m.value=null;try{const n=await L.searchApi(f.value,"movie",1);if(!n||n.length===0)throw new Error("Kein Film mit diesem Namen gefunden");const l=n[0].id.replace("tmdb_movie_",""),v=await Z(l);if(!v.belongs_to_collection)throw new Error("Dieser Film geh√∂rt zu keiner Collection");const ae=v.belongs_to_collection.id,_=await $(ae);if(!_.parts||_.parts.length<2)throw new Error("Collection hat weniger als 2 Filme");m.value={movie:v,collection:_},e.showMessage("Collection erfolgreich gefunden!","success")}catch(n){console.error("Collection test failed:",n),u.value=n.message||"Unbekannter Fehler beim Testen der Collection",e.showMessage("Collection-Test fehlgeschlagen","error")}finally{y.value=!1}}},Z=async n=>{const l=await fetch(`https://teabubble.attrebi.ch/api/tmdb/movie/${n}`);if(!l.ok)throw new Error("Film-Details konnten nicht abgerufen werden");return await l.json()},$=async n=>{const l=await fetch(`https://teabubble.attrebi.ch/api/tmdb/collection/${n}`);if(!l.ok)throw new Error("Collection-Details konnten nicht abgerufen werden");return await l.json()},ee=async()=>{if(!(!m.value||!M.value)){s.value=!0;try{const n=m.value.collection.parts;let C=0;for(const l of n)try{const v={title:l.title,category:"movie",watchlistType:"watchlist",release:l.release_date,rating:Math.round(l.vote_average),platforms:"Cinema",genre:"Collection",link:`https://www.themoviedb.org/movie/${l.id}`,path:null,discovered:new Date().toISOString().split("T")[0],externalId:`tmdb_movie_${l.id}`};await L.addMediaItem(v),C++}catch(v){console.warn(`Failed to add movie ${l.title}:`,v)}e.showMessage(`${C} von ${n.length} Filmen erfolgreich hinzugef√ºgt`,"success"),await a.loadMedia()}catch(n){console.error("Failed to add collection:",n),e.showMessage("Fehler beim Hinzuf√ºgen der Collection","error")}finally{s.value=!1}}},oe=()=>{m.value=null,u.value="",f.value=""},te=()=>{u.value=""},se=n=>n?new Date(n).toLocaleDateString("de-DE"):"Unbekannt",ne=n=>{n.target.style.display="none"},le=()=>{S.value=!1,e.showMessage("Erfolgreich angemeldet","success")},re=()=>{T.value=!1,e.showMessage("Erfolgreich registriert","success")};return be(async()=>{await a.loadMedia()}),{sidebarCollapsed:w,mobileSidebarOpen:c,showLoginModal:S,showRegisterModal:T,movieInput:f,isTesting:y,isAddingCollection:s,testResults:m,testError:u,isLoggedIn:M,userName:E,currentCategory:D,categoryCounts:N,platforms:A,genres:B,categories:z,toggleSidebar:P,toggleMobileSidebar:U,closeMobileSidebar:x,setCategory:G,clearSearch:V,togglePlatformFilter:H,toggleGenreFilter:K,toggleAiringFilter:O,addItemFromSidebar:Q,logout:j,navigateToStatistics:q,navigateToCalendar:W,navigateToFeatures:J,navigateToProfile:X,testCollection:Y,addCollectionToLibrary:ee,clearResults:oe,clearError:te,formatDate:se,handleImageError:ne,handleLoginSuccess:le,handleRegisterSuccess:re}}},Fe={class:"vue-app"},_e={class:"main-content"},ke={class:"content-area"},Ie={class:"features-container"},Re={class:"feature-card"},Le={class:"feature-content"},Ee={class:"input-group"},De={class:"input-with-button"},Ne=["disabled"],Ae=["disabled"],Be={key:0,class:"test-results"},ze={class:"result-header"},Pe={class:"collection-movies"},Ue={class:"movie-list"},xe={class:"movie-poster"},Ge=["src","alt"],Ve={key:1,class:"no-poster"},He={class:"movie-info"},Ke={class:"movie-release"},Oe={class:"movie-overview"},Qe={class:"movie-meta"},je={class:"rating"},qe={class:"id"},We={class:"collection-actions"},Je=["disabled"],Xe={key:1,class:"error-message"};function Ye(r,o,a,e,w,c){const S=F("Sidebar"),T=F("MainHeader"),f=F("LoginModal"),y=F("RegisterModal");return g(),h("div",Fe,[t("div",{class:ce(["mobile-overlay",{show:e.mobileSidebarOpen}]),onClick:o[0]||(o[0]=(...s)=>e.closeMobileSidebar&&e.closeMobileSidebar(...s))},null,2),k(S,{collapsed:e.sidebarCollapsed,"mobile-open":e.mobileSidebarOpen,"is-logged-in":e.isLoggedIn,"user-name":e.userName,"current-category":e.currentCategory,"category-counts":e.categoryCounts,platforms:e.platforms,genres:e.genres,categories:e.categories,onToggle:e.toggleSidebar,onSetCategory:e.setCategory,onNavigateToStatistics:e.navigateToStatistics,onNavigateToCalendar:e.navigateToCalendar,onNavigateToFeatures:e.navigateToFeatures,onNavigateToProfile:e.navigateToProfile,onTogglePlatformFilter:e.togglePlatformFilter,onToggleGenreFilter:e.toggleGenreFilter,onToggleAiringFilter:e.toggleAiringFilter,onAddItem:e.addItemFromSidebar,onShowLogin:o[1]||(o[1]=s=>e.showLoginModal=!0),onShowRegister:o[2]||(o[2]=s=>e.showRegisterModal=!0),onLogout:e.logout},null,8,["collapsed","mobile-open","is-logged-in","user-name","current-category","category-counts","platforms","genres","categories","onToggle","onSetCategory","onNavigateToStatistics","onNavigateToCalendar","onNavigateToFeatures","onNavigateToProfile","onTogglePlatformFilter","onToggleGenreFilter","onToggleAiringFilter","onAddItem","onLogout"]),t("div",_e,[k(T,{"search-query":r.searchQuery,"onUpdate:searchQuery":o[3]||(o[3]=s=>r.searchQuery=s),"grid-columns":r.gridColumns,"onUpdate:gridColumns":o[4]||(o[4]=s=>r.gridColumns=s),"sort-by":r.sortBy,"onUpdate:sortBy":o[5]||(o[5]=s=>r.sortBy=s),onToggleMobileSidebar:e.toggleMobileSidebar,onClearSearch:e.clearSearch},null,8,["search-query","grid-columns","sort-by","onToggleMobileSidebar","onClearSearch"]),t("main",ke,[t("div",Ie,[o[20]||(o[20]=t("h1",null,"Features",-1)),o[21]||(o[21]=t("p",{class:"features-description"}," Erweiterte Funktionen f√ºr Ihre Media Library ",-1)),t("div",Re,[o[19]||(o[19]=t("div",{class:"feature-header"},[t("h2",null,"üé¨ TMDb Collection Test"),t("p",null,"Testen Sie TMDb Collections und f√ºgen Sie ganze Filmreihen hinzu")],-1)),t("div",Le,[t("div",Ee,[o[15]||(o[15]=t("label",{for:"movieInput"},"Film-Titel oder TMDb ID eingeben:",-1)),t("div",De,[de(t("input",{id:"movieInput","onUpdate:modelValue":o[6]||(o[6]=s=>e.movieInput=s),type:"text",placeholder:"z.B. 'The Lord of the Rings', 'Matrix' oder '120'",onKeyup:o[7]||(o[7]=ue((...s)=>e.testCollection&&e.testCollection(...s),["enter"])),disabled:e.isTesting},null,40,Ne),[[ge,e.movieInput]]),t("button",{onClick:o[8]||(o[8]=(...s)=>e.testCollection&&e.testCollection(...s)),disabled:!e.movieInput.trim()||e.isTesting,class:"test-button"},i(e.isTesting?"Teste...":"Collection testen"),9,Ae)]),o[16]||(o[16]=t("div",{class:"input-hint"},[t("p",null,[R("üí° "),t("strong",null,"Tipp:"),R(' Versuchen Sie "The Lord of the Rings", "Matrix", "Star Wars" oder "Harry Potter"')])],-1))]),e.testResults?(g(),h("div",Be,[t("div",ze,[o[17]||(o[17]=t("h3",null,"Collection gefunden!",-1)),t("p",null,[t("strong",null,i(e.testResults.collection.name),1)]),t("p",null,i(e.testResults.collection.overview||"Keine Beschreibung verf√ºgbar"),1)]),t("div",Pe,[t("h4",null,"Filme in der Collection ("+i(e.testResults.collection.parts.length)+"):",1),t("div",Ue,[(g(!0),h(me,null,ve(e.testResults.collection.parts,(s,m)=>{var u;return g(),h("div",{key:s.id,class:"movie-item"},[t("div",xe,[s.poster_path?(g(),h("img",{key:0,src:`https://image.tmdb.org/t/p/w200${s.poster_path}`,alt:s.title,onError:o[9]||(o[9]=(...M)=>e.handleImageError&&e.handleImageError(...M))},null,40,Ge)):(g(),h("div",Ve,"üé¨"))]),t("div",He,[t("h5",null,i(s.title),1),t("p",Ke,i(e.formatDate(s.release_date)),1),t("p",Oe,i(s.overview||"Keine Beschreibung verf√ºgbar"),1),t("div",Qe,[t("span",je,"‚≠ê "+i(((u=s.vote_average)==null?void 0:u.toFixed(1))||"N/A"),1),t("span",qe,"ID: "+i(s.id),1)])])])}),128))])]),t("div",We,[t("button",{onClick:o[10]||(o[10]=(...s)=>e.addCollectionToLibrary&&e.addCollectionToLibrary(...s)),disabled:e.isAddingCollection,class:"add-collection-button"},i(e.isAddingCollection?"F√ºge hinzu...":`Alle ${e.testResults.collection.parts.length} Filme zur Bibliothek hinzuf√ºgen`),9,Je),t("button",{onClick:o[11]||(o[11]=(...s)=>e.clearResults&&e.clearResults(...s)),class:"clear-button"}," Neuen Test starten ")])])):p("",!0),e.testError?(g(),h("div",Xe,[o[18]||(o[18]=t("h4",null,"‚ùå Test fehlgeschlagen",-1)),t("p",null,i(e.testError),1),t("button",{onClick:o[12]||(o[12]=(...s)=>e.clearError&&e.clearError(...s)),class:"clear-button"},"Erneut versuchen")])):p("",!0)])])])])]),e.showLoginModal?(g(),I(f,{key:0,onClose:o[13]||(o[13]=s=>e.showLoginModal=!1),onSuccess:e.handleLoginSuccess},null,8,["onSuccess"])):p("",!0),e.showRegisterModal?(g(),I(y,{key:1,onClose:o[14]||(o[14]=s=>e.showRegisterModal=!1),onSuccess:e.handleRegisterSuccess},null,8,["onSuccess"])):p("",!0)])}const to=ie(pe,[["render",Ye],["__scopeId","data-v-8f9229e8"]]);export{to as default};
